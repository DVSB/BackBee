var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function eachProp(e,t){var n;for(n in e)if(e.hasOwnProperty(n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,function(t,a){(n||!hasProp(e,a))&&(i&&"string"!=typeof t?(e[a]||(e[a]={}),mixin(e[a],t,n,i)):e[a]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeContextModuleFunc(e,t,n){return function(){var i,a=aps.call(arguments,0);return n&&isFunction(i=a[a.length-1])&&(i.__requireJsBuild=!0),a.push(t),e.apply(null,a)}}function addRequireMethods(e,t,n){each([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(i){var a=i[1]||i[0];e[i[0]]=t?makeContextModuleFunc(t[a],n):function(){var e=contexts[defContextName];return e[a].apply(e,arguments)}})}function makeError(e,t,n,i){var a=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return a.requireType=e,a.requireModules=i,n&&(a.originalError=n),a}function newContext(e){function t(e){var t,n;for(t=0;e[t];t+=1)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,i){var a,r,o,s,l,d,c,u,h,p,f,g=n&&n.split("/"),m=g,b=x.map,v=b&&b["*"];if(e&&"."===e.charAt(0)&&(n?(m=x.pkgs[n]?g=[n]:g.slice(0,g.length-1),e=m.concat(e.split("/")),t(e),r=x.pkgs[a=e[0]],e=e.join("/"),r&&e===a+"/"+r.main&&(e=a)):0===e.indexOf("./")&&(e=e.substring(2))),i&&(g||v)&&b){for(s=e.split("/"),l=s.length;l>0;l-=1){if(c=s.slice(0,l).join("/"),g)for(d=g.length;d>0;d-=1)if(o=b[g.slice(0,d).join("/")],o&&(o=o[c])){u=o,h=l;break}if(u)break;!p&&v&&v[c]&&(p=v[c],f=l)}!u&&p&&(u=p,h=f),u&&(s.splice(0,h,u),e=s.join("/"))}return e}function i(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function a(e){var t=x.paths[e];return t&&isArray(t)&&t.length>1?(i(e),t.shift(),w.undef(e),w.require([e]),!0):void 0}function r(e,t,i,a){var r,o,s,l=e?e.indexOf("!"):-1,d=null,c=t?t.name:null,u=e,h=!0,p="";return e||(h=!1,e="_@r"+(A+=1)),-1!==l&&(d=e.substring(0,l),e=e.substring(l+1,e.length)),d&&(d=n(d,c,a),o=T[d]),e&&(d?p=o&&o.normalize?o.normalize(e,function(e){return n(e,c,a)}):n(e,c,a):(p=n(e,c,a),r=w.nameToUrl(p))),s=!d||o||i?"":"_unnormalized"+(D+=1),{prefix:d,name:p,parentMap:t,unnormalized:!!s,url:r,originalName:u,isDefine:h,id:(d?d+"!"+p:p)+s}}function o(e){var t=e.id,n=S[t];return n||(n=S[t]=new w.Module(e)),n}function s(e,t,n){var i=e.id,a=S[i];!hasProp(T,i)||a&&!a.defineEmitComplete?o(e).on(t,n):"defined"===t&&n(T[i])}function l(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,function(t){var n=S[t];n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))}),i||req.onError(e))}function d(){globalDefQueue.length&&(apsp.apply(N,[N.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function c(e,t,n){var i=e&&e.map,a=makeContextModuleFunc(n||w.require,i,t);return addRequireMethods(a,w,i),a.isBrowser=isBrowser,a}function u(e){delete S[e],each(O,function(t,n){return t.map.id===e?(O.splice(n,1),t.defined||(w.waitCount-=1),!0):void 0})}function h(e,t){var n,i=e.map.id,a=e.depMaps;if(e.inited)return t[i]?e:(t[i]=!0,each(a,function(e){var a=e.id,r=S[a];if(r)return r.inited&&r.enabled?n=h(r,mixin({},t)):(n=null,delete t[i],!0)}),n)}function p(e,t,n){var i=e.map.id,a=e.depMaps;if(e.inited&&e.map.isDefine)return t[i]?T[i]:(t[i]=e,each(a,function(a){var r,o=a.id,s=S[o];if(!C[o]&&s){if(!s.inited||!s.enabled)return void(n[i]=!0);r=p(s,t,n),n[o]||e.defineDepById(o,r)}}),e.check(!0),T[i])}function f(e){e.check()}function g(){var e,t,n,r,o=1e3*x.waitSeconds,s=o&&w.startTime+o<(new Date).getTime(),d=[],c=!1,u=!0;if(!y){if(y=!0,eachProp(S,function(n){if(e=n.map,t=e.id,n.enabled&&!n.error)if(!n.inited&&s)a(t)?(r=!0,c=!0):(d.push(t),i(t));else if(!n.inited&&n.fetched&&e.isDefine&&(c=!0,!e.prefix))return u=!1}),s&&d.length)return n=makeError("timeout","Load timeout for modules: "+d,null,d),n.contextName=w.contextName,l(n);u&&(each(O,function(e){if(!e.defined){var t=h(e,{}),n={};t&&(p(t,n,{}),eachProp(n,f))}}),eachProp(S,f)),s&&!r||!c||!isBrowser&&!isWebWorker||k||(k=setTimeout(function(){k=0,g()},50)),y=!1}}function m(e){o(r(e[0],null,!0)).init(e[1],e[2])}function b(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function v(e){var t=e.currentTarget||e.srcElement;return b(t,w.onScriptLoad,"load","onreadystatechange"),b(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}var y,_,w,C,k,x={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{}},S={},j={},N=[],T={},E={},A=1,D=1,O=[];return C={require:function(e){return c(e)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports=T[e.map.id]={}:void 0},module:function(e){return e.module={id:e.map.id,uri:e.map.url,config:function(){return x.config&&x.config[e.map.id]||{}},exports:T[e.map.id]}}},_=function(e){this.events=j[e.id]||{},this.map=e,this.shim=x.shim[e.id],this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},_.prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.depMaps.rjsSkipMap=e.rjsSkipMap,this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDepById:function(e,t){var n;return each(this.depMaps,function(t,i){return t.id===e?(n=i,!0):void 0}),this.defineDep(n,t)},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;return this.shim?void c(this,!0)(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;E[e]||(E[e]=!0,w.load(this.map.id,e))},check:function(e){if(this.enabled&&!this.enabling){var t,n,i=this.map.id,a=this.depExports,r=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error)try{r=w.execCb(i,o,a,r)}catch(s){t=s}else r=w.execCb(i,o,a,r);if(this.map.isDefine&&(n=this.module,n&&void 0!==n.exports&&n.exports!==this.exports?r=n.exports:void 0===r&&this.usingExports&&(r=this.exports)),t)return t.requireMap=this.map,t.requireModules=[this.map.id],t.requireType="define",l(this.error=t)}else r=o;this.exports=r,this.map.isDefine&&!this.ignore&&(T[i]=r,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),delete S[i],this.defined=!0,w.waitCount-=1,0===w.waitCount&&(O=[])}this.defining=!1,e||this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=r(e.prefix,null,!1,!0);s(i,"defined",bind(this,function(i){var a,d,h,p=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null;return this.map.unnormalized?(i.normalize&&(p=i.normalize(p,function(e){return n(e,f,!0)})||""),d=r(e.prefix+"!"+p,this.map.parentMap,!1,!0),s(d,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),h=S[d.id],void(h&&(this.events.error&&h.on("error",bind(this,function(e){this.emit("error",e)})),h.enable()))):(a=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),a.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(S,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&u(e.map.id)}),l(e)}),a.fromText=function(e,t){var n=useInteractive;n&&(useInteractive=!1),o(r(e)),req.exec(t),n&&(useInteractive=!0),w.completeLoad(e)},void i.load(e.name,c(e.parentMap,!0,function(e,t,n){return e.rjsSkipMap=!0,w.require(e,t,n)}),a,x))})),w.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){this.enabled=!0,this.waitPushed||(O.push(this),w.waitCount+=1,this.waitPushed=!0),this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,i,a;if("string"==typeof e){if(e=r(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.depMaps.rjsSkipMap),this.depMaps[t]=e,a=C[e.id])return void(this.depExports[t]=a(this));this.depCount+=1,s(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&s(e,"error",this.errback)}n=e.id,i=S[n],C[n]||!i||i.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=S[e.id];t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:x,contextName:e,registry:S,defined:T,urlFetched:E,waitCount:0,defQueue:N,Module:_,makeModuleMap:r,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=x.pkgs,n=x.shim,i=x.paths,a=x.map;mixin(x,e,!0),x.paths=mixin(i,e.paths,!0),e.map&&(x.map=mixin(a||{},e.map,!0,!0)),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),e.exports&&!e.exports.__buildReady&&(e.exports=w.makeShimExports(e.exports)),n[t]=e}),x.shim=n),e.packages&&(each(e.packages,function(e){var n;e="string"==typeof e?{name:e}:e,n=e.location,t[e.name]={name:e.name,location:n||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),x.pkgs=t),eachProp(S,function(e,t){e.inited||e.map.unnormalized||(e.map=r(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){var t;return"string"==typeof e?(t=function(){return getGlobal(e)},t.exports=e,t):function(){return e.apply(global,arguments)}},requireDefined:function(e,t){return hasProp(T,r(e,t,!1,!0).id)},requireSpecified:function(e,t){return e=r(e,t,!1,!0).id,hasProp(T,e)||hasProp(S,e)},require:function(t,n,i,a){var s,c,u,h,p;if("string"==typeof t)return isFunction(n)?l(makeError("requireargs","Invalid require call"),i):req.get?req.get(w,t,n):(s=t,a=n,u=r(s,a,!1,!0),c=u.id,hasProp(T,c)?T[c]:l(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e)));for(i&&!isFunction(i)&&(a=i,i=void 0),n&&!isFunction(n)&&(a=n,n=void 0),d();N.length;){if(p=N.shift(),null===p[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+p[p.length-1]));m(p)}return h=o(r(null,a)),h.init(t,n,i,{enabled:!0}),g(),w.require},undef:function(e){d();var t=r(e,null,!0),n=S[e];delete T[e],delete E[t.url],delete j[e],n&&(n.events.defined&&(j[e]=n.events),u(e))},enable:function(e){var t=S[e.id];t&&o(e).enable()},completeLoad:function(e){var t,n,i,r=x.shim[e]||{},o=r.exports&&r.exports.exports;for(d();N.length;){if(n=N.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);m(n)}if(i=S[e],!t&&!T[e]&&i&&!i.inited){if(!(!x.enforceDefine||o&&getGlobal(o)))return a(e)?void 0:l(makeError("nodefine","No define call for "+e,null,[e]));m([e,r.deps||[],r.exports])}g()},toUrl:function(e,t){var i=e.lastIndexOf("."),a=null;return-1!==i&&(a=e.substring(i,e.length),e=e.substring(0,i)),w.nameToUrl(n(e,t&&t.id,!0),a)},nameToUrl:function(e,t){var n,i,a,r,o,s,l,d,c;if(req.jsExtRegExp.test(e))d=e+(t||"");else{for(n=x.paths,i=x.pkgs,o=e.split("/"),s=o.length;s>0;s-=1){if(l=o.slice(0,s).join("/"),a=i[l],c=n[l]){isArray(c)&&(c=c[0]),o.splice(0,s,c);break}if(a){r=e===a.name?a.location+"/"+a.main:a.location,o.splice(0,s,r);break}}d=o.join("/"),d+=t||(/\?/.test(d)?"":".js"),d=("/"===d.charAt(0)||d.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+d}return x.urlArgs?d+((-1===d.indexOf("?")?"?":"&")+x.urlArgs):d},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=v(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=v(e);return a(t.id)?void 0:l(makeError("scripterror","Script error",e,[t.id]))}}}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.0.5",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,aps=ap.slice,apsp=ap.splice,isBrowser=!("undefined"==typeof window||!navigator||!document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var a,r,o=defContextName;return isArray(e)||"string"==typeof e||(r=e,isArray(t)?(e=t,t=n,n=i):e=[]),r&&r.context&&(o=r.context),a=contexts[o],a||(a=contexts[o]=req.s.newContext(o)),r&&a.configure(r),a.require(e,t,n)},req.config=function(e){return req(e)},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),addRequireMethods(req),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(e){throw e},req.load=function(e,t,n){var i,a=e&&e.config||{};return isBrowser?(i=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),i.type=a.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i):void(isWebWorker&&(importScripts(n),e.completeLoad(t)))},isBrowser&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript),dataMain=dataMain.replace(jsSuffixRegExp,""),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain],!0):void 0}),define=function(e,t,n){var i,a;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=[]),!t.length&&isFunction(n)&&n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t)),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(e||(e=i.getAttribute("data-requiremodule")),a=contexts[i.getAttribute("data-requirecontext")])),(a?a.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),function(e,t){function n(e){var t,n,i=P[e]={};for(e=e.split(/\s+/),t=0,n=e.length;n>t;t++)i[e[t]]=!0;return i}function i(e,n,i){if(i===t&&1===e.nodeType){var a="data-"+n.replace(B,"-$1").toLowerCase();if(i=e.getAttribute(a),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:R.isNumeric(i)?+i:z.test(i)?R.parseJSON(i):i}catch(r){}R.data(e,n,i)}else i=t}return i}function a(e){for(var t in e)if(("data"!==t||!R.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function r(e,t,n){var i=t+"defer",a=t+"queue",r=t+"mark",o=R._data(e,i);!o||"queue"!==n&&R._data(e,a)||"mark"!==n&&R._data(e,r)||setTimeout(function(){R._data(e,a)||R._data(e,r)||(R.removeData(e,i,!0),o.fire())},0)}function o(){return!1}function s(){return!0}function l(e){return!e||!e.parentNode||11===e.parentNode.nodeType}function d(e,t,n){if(t=t||0,R.isFunction(t))return R.grep(e,function(e,i){var a=!!t.call(e,i,e);return a===n});if(t.nodeType)return R.grep(e,function(e){return e===t===n});if("string"==typeof t){var i=R.grep(e,function(e){return 1===e.nodeType});if(ct.test(t))return R.filter(t,i,!n);t=R.filter(t,i)}return R.grep(e,function(e){return R.inArray(e,t)>=0===n})}function c(e){var t=ft.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function u(e){return R.nodeName(e,"table")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function h(e,t){if(1===t.nodeType&&R.hasData(e)){var n,i,a,r=R._data(e),o=R._data(t,r),s=r.events;if(s){delete o.handle,o.events={};for(n in s)for(i=0,a=s[n].length;a>i;i++)R.event.add(t,n,s[n][i])}o.data&&(o.data=R.extend({},o.data))}}function p(e,t){var n;1===t.nodeType&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),"object"===n?t.outerHTML=e.outerHTML:"input"!==n||"checkbox"!==e.type&&"radio"!==e.type?"option"===n?t.selected=e.defaultSelected:"input"===n||"textarea"===n?t.defaultValue=e.defaultValue:"script"===n&&t.text!==e.text&&(t.text=e.text):(e.checked&&(t.defaultChecked=t.checked=e.checked),t.value!==e.value&&(t.value=e.value)),t.removeAttribute(R.expando),t.removeAttribute("_submit_attached"),t.removeAttribute("_change_attached"))}function f(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function g(e){("checkbox"===e.type||"radio"===e.type)&&(e.defaultChecked=e.checked)}function m(e){var t=(e.nodeName||"").toLowerCase();"input"===t?g(e):"script"!==t&&"undefined"!=typeof e.getElementsByTagName&&R.grep(e.getElementsByTagName("input"),g)}function b(e){var t=O.createElement("div");return Tt.appendChild(t),t.innerHTML=e.outerHTML,t.firstChild}function v(e,t,n){var i="width"===t?e.offsetWidth:e.offsetHeight,a="width"===t?1:0,r=4;if(i>0){if("border"!==n)for(;r>a;a+=2)n||(i-=parseFloat(R.css(e,"padding"+Lt[a]))||0),"margin"===n?i+=parseFloat(R.css(e,n+Lt[a]))||0:i-=parseFloat(R.css(e,"border"+Lt[a]+"Width"))||0;return i+"px"}if(i=Et(e,t),(0>i||null==i)&&(i=e.style[t]),Pt.test(i))return i;if(i=parseFloat(i)||0,n)for(;r>a;a+=2)i+=parseFloat(R.css(e,"padding"+Lt[a]))||0,"padding"!==n&&(i+=parseFloat(R.css(e,"border"+Lt[a]+"Width"))||0),"margin"===n&&(i+=parseFloat(R.css(e,n+Lt[a]))||0);return i+"px"}function y(e){return function(t,n){if("string"!=typeof t&&(n=t,t="*"),R.isFunction(n))for(var i,a,r,o=t.toLowerCase().split(tn),s=0,l=o.length;l>s;s++)i=o[s],r=/^\+/.test(i),r&&(i=i.substr(1)||"*"),a=e[i]=e[i]||[],a[r?"unshift":"push"](n)}}function _(e,n,i,a,r,o){r=r||n.dataTypes[0],o=o||{},o[r]=!0;for(var s,l=e[r],d=0,c=l?l.length:0,u=e===on;c>d&&(u||!s);d++)s=l[d](n,i,a),"string"==typeof s&&(!u||o[s]?s=t:(n.dataTypes.unshift(s),s=_(e,n,i,a,s,o)));return!u&&s||o["*"]||(s=_(e,n,i,a,"*",o)),s}function w(e,n){var i,a,r=R.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((r[i]?e:a||(a={}))[i]=n[i]);a&&R.extend(!0,e,a)}function C(e,t,n,i){if(R.isArray(t))R.each(t,function(t,a){n||Wt.test(e)?i(e,a):C(e+"["+("object"==typeof a?t:"")+"]",a,n,i)});else if(n||"object"!==R.type(t))i(e,t);else for(var a in t)C(e+"["+a+"]",t[a],n,i)}function k(e,n,i){var a,r,o,s,l=e.contents,d=e.dataTypes,c=e.responseFields;for(r in c)r in i&&(n[c[r]]=i[r]);for(;"*"===d[0];)d.shift(),a===t&&(a=e.mimeType||n.getResponseHeader("content-type"));if(a)for(r in l)if(l[r]&&l[r].test(a)){d.unshift(r);break}if(d[0]in i)o=d[0];else{for(r in i){if(!d[0]||e.converters[r+" "+d[0]]){o=r;break}s||(s=r)}o=o||s}return o?(o!==d[0]&&d.unshift(o),i[o]):void 0}function x(e,n){e.dataFilter&&(n=e.dataFilter(n,e.dataType));var i,a,r,o,s,l,d,c,u=e.dataTypes,h={},p=u.length,f=u[0];for(i=1;p>i;i++){if(1===i)for(a in e.converters)"string"==typeof a&&(h[a.toLowerCase()]=e.converters[a]);if(o=f,f=u[i],"*"===f)f=o;else if("*"!==o&&o!==f){if(s=o+" "+f,l=h[s]||h["* "+f],!l){c=t;for(d in h)if(r=d.split(" "),(r[0]===o||"*"===r[0])&&(c=h[r[1]+" "+f])){d=h[d],d===!0?l=c:c===!0&&(l=d);break}}l||c||R.error("No conversion from "+s.replace(" "," to ")),l!==!0&&(n=l?l(n):c(d(n)))}}return n}function S(){try{return new e.XMLHttpRequest}catch(t){}}function j(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function N(){return setTimeout(T,0),vn=R.now()}function T(){vn=t}function E(e,t){var n={};return R.each(Cn.concat.apply([],Cn.slice(0,t)),function(){n[this]=e}),n}function A(e){if(!yn[e]){var t=O.body,n=R("<"+e+">").appendTo(t),i=n.css("display");n.remove(),("none"===i||""===i)&&(gn||(gn=O.createElement("iframe"),gn.frameBorder=gn.width=gn.height=0),t.appendChild(gn),mn&&gn.createElement||(mn=(gn.contentWindow||gn.contentDocument).document,mn.write((R.support.boxModel?"<!doctype html>":"")+"<html><body>"),mn.close()),n=mn.createElement(e),mn.body.appendChild(n),i=R.css(n,"display"),t.removeChild(gn)),yn[e]=i}return yn[e]}function D(e){return R.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var O=e.document,I=e.navigator,M=e.location,R=function(){function n(){if(!s.isReady){try{O.documentElement.doScroll("left")}catch(e){return void setTimeout(n,1)}s.ready()}}var i,a,r,o,s=function(e,t){return new s.fn.init(e,t,i)},l=e.jQuery,d=e.$,c=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,u=/\S/,h=/^\s+/,p=/\s+$/,f=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,g=/^[\],:{}\s]*$/,m=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,b=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,v=/(?:^|:|,)(?:\s*\[)+/g,y=/(webkit)[ \/]([\w.]+)/,_=/(opera)(?:.*version)?[ \/]([\w.]+)/,w=/(msie) ([\w.]+)/,C=/(mozilla)(?:.*? rv:([\w.]+))?/,k=/-([a-z]|[0-9])/gi,x=/^-ms-/,S=function(e,t){return(t+"").toUpperCase()},j=I.userAgent,N=Object.prototype.toString,T=Object.prototype.hasOwnProperty,E=Array.prototype.push,A=Array.prototype.slice,D=String.prototype.trim,M=Array.prototype.indexOf,R={};return s.fn=s.prototype={constructor:s,init:function(e,n,i){var a,r,o,l;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("body"===e&&!n&&O.body)return this.context=O,this[0]=O.body,this.selector=e,this.length=1,this;if("string"==typeof e){if(a="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:c.exec(e),!a||!a[1]&&n)return!n||n.jquery?(n||i).find(e):this.constructor(n).find(e);if(a[1])return n=n instanceof s?n[0]:n,l=n?n.ownerDocument||n:O,o=f.exec(e),o?s.isPlainObject(n)?(e=[O.createElement(o[1])],s.fn.attr.call(e,n,!0)):e=[l.createElement(o[1])]:(o=s.buildFragment([a[1]],[l]),e=(o.cacheable?s.clone(o.fragment):o.fragment).childNodes),s.merge(this,e);if(r=O.getElementById(a[2]),r&&r.parentNode){if(r.id!==a[2])return i.find(e);this.length=1,this[0]=r}return this.context=O,this.selector=e,this}return s.isFunction(e)?i.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),s.makeArray(e,this))},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return A.call(this,0)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e,t,n){var i=this.constructor();return s.isArray(e)?E.apply(i,e):s.merge(i,e),i.prevObject=this,i.context=this.context,"find"===t?i.selector=this.selector+(this.selector?" ":"")+n:t&&(i.selector=this.selector+"."+t+"("+n+")"),i},each:function(e,t){return s.each(this,e,t)},ready:function(e){return s.bindReady(),r.add(e),this},eq:function(e){return e=+e,-1===e?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(A.apply(this,arguments),"slice",A.call(arguments).join(","))},map:function(e){return this.pushStack(s.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},s.fn.init.prototype=s.fn,s.extend=s.fn.extend=function(){var e,n,i,a,r,o,l=arguments[0]||{},d=1,c=arguments.length,u=!1;for("boolean"==typeof l&&(u=l,l=arguments[1]||{},d=2),"object"==typeof l||s.isFunction(l)||(l={}),c===d&&(l=this,--d);c>d;d++)if(null!=(e=arguments[d]))for(n in e)i=l[n],a=e[n],l!==a&&(u&&a&&(s.isPlainObject(a)||(r=s.isArray(a)))?(r?(r=!1,o=i&&s.isArray(i)?i:[]):o=i&&s.isPlainObject(i)?i:{},l[n]=s.extend(u,o,a)):a!==t&&(l[n]=a));return l},s.extend({noConflict:function(t){return e.$===s&&(e.$=d),t&&e.jQuery===s&&(e.jQuery=l),s},isReady:!1,readyWait:1,holdReady:function(e){e?s.readyWait++:s.ready(!0)},ready:function(e){if(e===!0&&!--s.readyWait||e!==!0&&!s.isReady){if(!O.body)return setTimeout(s.ready,1);if(s.isReady=!0,e!==!0&&--s.readyWait>0)return;r.fireWith(O,[s]),s.fn.trigger&&s(O).trigger("ready").off("ready")}},bindReady:function(){if(!r){if(r=s.Callbacks("once memory"),"complete"===O.readyState)return setTimeout(s.ready,1);if(O.addEventListener)O.addEventListener("DOMContentLoaded",o,!1),e.addEventListener("load",s.ready,!1);else if(O.attachEvent){O.attachEvent("onreadystatechange",o),e.attachEvent("onload",s.ready);var t=!1;try{t=null==e.frameElement}catch(i){}O.documentElement.doScroll&&t&&n()}}},isFunction:function(e){return"function"===s.type(e)},isArray:Array.isArray||function(e){return"array"===s.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):R[N.call(e)]||"object"},isPlainObject:function(e){if(!e||"object"!==s.type(e)||e.nodeType||s.isWindow(e))return!1;try{if(e.constructor&&!T.call(e,"constructor")&&!T.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var i;for(i in e);return i===t||T.call(e,i)},isEmptyObject:function(e){for(var t in e)return!1;return!0},error:function(e){throw new Error(e)},parseJSON:function(t){return"string"==typeof t&&t?(t=s.trim(t),e.JSON&&e.JSON.parse?e.JSON.parse(t):g.test(t.replace(m,"@").replace(b,"]").replace(v,""))?new Function("return "+t)():void s.error("Invalid JSON: "+t)):null},parseXML:function(n){if("string"!=typeof n||!n)return null;var i,a;try{e.DOMParser?(a=new DOMParser,i=a.parseFromString(n,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(n))}catch(r){i=t}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||s.error("Invalid XML: "+n),i},noop:function(){},globalEval:function(t){t&&u.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(x,"ms-").replace(k,S)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toUpperCase()===t.toUpperCase()},each:function(e,n,i){var a,r=0,o=e.length,l=o===t||s.isFunction(e);if(i)if(l){for(a in e)if(n.apply(e[a],i)===!1)break}else for(;o>r&&n.apply(e[r++],i)!==!1;);else if(l){for(a in e)if(n.call(e[a],a,e[a])===!1)break}else for(;o>r&&n.call(e[r],r,e[r++])!==!1;);return e},trim:D?function(e){return null==e?"":D.call(e)}:function(e){return null==e?"":e.toString().replace(h,"").replace(p,"")},makeArray:function(e,t){var n=t||[];if(null!=e){var i=s.type(e);null==e.length||"string"===i||"function"===i||"regexp"===i||s.isWindow(e)?E.call(n,e):s.merge(n,e)}return n},inArray:function(e,t,n){var i;if(t){if(M)return M.call(t,e,n);for(i=t.length,n=n?0>n?Math.max(0,i+n):n:0;i>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var i=e.length,a=0;if("number"==typeof n.length)for(var r=n.length;r>a;a++)e[i++]=n[a];else for(;n[a]!==t;)e[i++]=n[a++];return e.length=i,e},grep:function(e,t,n){var i,a=[];n=!!n;for(var r=0,o=e.length;o>r;r++)i=!!t(e[r],r),n!==i&&a.push(e[r]);return a},map:function(e,n,i){var a,r,o=[],l=0,d=e.length,c=e instanceof s||d!==t&&"number"==typeof d&&(d>0&&e[0]&&e[d-1]||0===d||s.isArray(e));if(c)for(;d>l;l++)a=n(e[l],l,i),null!=a&&(o[o.length]=a);else for(r in e)a=n(e[r],r,i),null!=a&&(o[o.length]=a);return o.concat.apply([],o)},guid:1,proxy:function(e,n){if("string"==typeof n){var i=e[n];n=e,e=i}if(!s.isFunction(e))return t;var a=A.call(arguments,2),r=function(){return e.apply(n,a.concat(A.call(arguments)))};return r.guid=e.guid=e.guid||r.guid||s.guid++,r},access:function(e,n,i,a,r,o,l){var d,c=null==i,u=0,h=e.length;if(i&&"object"==typeof i){for(u in i)s.access(e,n,u,i[u],1,o,a);r=1}else if(a!==t){if(d=l===t&&s.isFunction(a),c&&(d?(d=n,n=function(e,t,n){return d.call(s(e),n)}):(n.call(e,a),n=null)),n)for(;h>u;u++)n(e[u],i,d?a.call(e[u],u,n(e[u],i)):a,l);r=1}return r?e:c?n.call(e):h?n(e[0],i):o},now:function(){return(new Date).getTime()},uaMatch:function(e){e=e.toLowerCase();var t=y.exec(e)||_.exec(e)||w.exec(e)||e.indexOf("compatible")<0&&C.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},sub:function(){function e(t,n){return new e.fn.init(t,n)}s.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(n,i){return i&&i instanceof s&&!(i instanceof e)&&(i=e(i)),s.fn.init.call(this,n,i,t)},e.fn.init.prototype=e.fn;var t=e(O);return e},browser:{}}),s.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){R["[object "+t+"]"]=t.toLowerCase()}),a=s.uaMatch(j),a.browser&&(s.browser[a.browser]=!0,s.browser.version=a.version),s.browser.webkit&&(s.browser.safari=!0),u.test(" ")&&(h=/^[\s\xA0]+/,p=/[\s\xA0]+$/),i=s(O),O.addEventListener?o=function(){O.removeEventListener("DOMContentLoaded",o,!1),s.ready()}:O.attachEvent&&(o=function(){"complete"===O.readyState&&(O.detachEvent("onreadystatechange",o),s.ready())}),s}(),P={};R.Callbacks=function(e){e=e?P[e]||n(e):{};var i,a,r,o,s,l,d=[],c=[],u=function(t){var n,i,a,r;for(n=0,i=t.length;i>n;n++)a=t[n],r=R.type(a),"array"===r?u(a):"function"===r&&(e.unique&&p.has(a)||d.push(a))},h=function(t,n){for(n=n||[],i=!e.memory||[t,n],a=!0,r=!0,l=o||0,o=0,s=d.length;d&&s>l;l++)if(d[l].apply(t,n)===!1&&e.stopOnFalse){i=!0;break}r=!1,d&&(e.once?i===!0?p.disable():d=[]:c&&c.length&&(i=c.shift(),p.fireWith(i[0],i[1])))},p={add:function(){if(d){var e=d.length;u(arguments),r?s=d.length:i&&i!==!0&&(o=e,h(i[0],i[1]))}return this},remove:function(){if(d)for(var t=arguments,n=0,i=t.length;i>n;n++)for(var a=0;a<d.length&&(t[n]!==d[a]||(r&&s>=a&&(s--,l>=a&&l--),d.splice(a--,1),!e.unique));a++);return this},has:function(e){if(d)for(var t=0,n=d.length;n>t;t++)if(e===d[t])return!0;return!1},empty:function(){return d=[],this},disable:function(){return d=c=i=t,this},disabled:function(){return!d},lock:function(){return c=t,i&&i!==!0||p.disable(),this},locked:function(){return!c},fireWith:function(t,n){return c&&(r?e.once||c.push([t,n]):e.once&&i||h(t,n)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!a}};return p};var F=[].slice;R.extend({Deferred:function(e){var t,n=R.Callbacks("once memory"),i=R.Callbacks("once memory"),a=R.Callbacks("memory"),r="pending",o={resolve:n,reject:i,notify:a},s={done:n.add,fail:i.add,progress:a.add,state:function(){return r},isResolved:n.fired,isRejected:i.fired,then:function(e,t,n){return l.done(e).fail(t).progress(n),this
},always:function(){return l.done.apply(l,arguments).fail.apply(l,arguments),this},pipe:function(e,t,n){return R.Deferred(function(i){R.each({done:[e,"resolve"],fail:[t,"reject"],progress:[n,"notify"]},function(e,t){var n,a=t[0],r=t[1];l[e](R.isFunction(a)?function(){n=a.apply(this,arguments),n&&R.isFunction(n.promise)?n.promise().then(i.resolve,i.reject,i.notify):i[r+"With"](this===l?i:this,[n])}:i[r])})}).promise()},promise:function(e){if(null==e)e=s;else for(var t in s)e[t]=s[t];return e}},l=s.promise({});for(t in o)l[t]=o[t].fire,l[t+"With"]=o[t].fireWith;return l.done(function(){r="resolved"},i.disable,a.lock).fail(function(){r="rejected"},n.disable,a.lock),e&&e.call(l,l),l},when:function(e){function t(e){return function(t){i[e]=arguments.length>1?F.call(arguments,0):t,--s||l.resolveWith(l,i)}}function n(e){return function(t){o[e]=arguments.length>1?F.call(arguments,0):t,l.notifyWith(d,o)}}var i=F.call(arguments,0),a=0,r=i.length,o=new Array(r),s=r,l=1>=r&&e&&R.isFunction(e.promise)?e:R.Deferred(),d=l.promise();if(r>1){for(;r>a;a++)i[a]&&i[a].promise&&R.isFunction(i[a].promise)?i[a].promise().then(t(a),l.reject,n(a)):--s;s||l.resolveWith(l,i)}else l!==e&&l.resolveWith(l,r?[e]:[]);return d}}),R.support=function(){{var t,n,i,a,r,o,s,l,d,c,u,h=O.createElement("div");O.documentElement}if(h.setAttribute("className","t"),h.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",n=h.getElementsByTagName("*"),i=h.getElementsByTagName("a")[0],!n||!n.length||!i)return{};a=O.createElement("select"),r=a.appendChild(O.createElement("option")),o=h.getElementsByTagName("input")[0],t={leadingWhitespace:3===h.firstChild.nodeType,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:"/a"===i.getAttribute("href"),opacity:/^0.55/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:"on"===o.value,optSelected:r.selected,getSetAttribute:"t"!==h.className,enctype:!!O.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==O.createElement("nav").cloneNode(!0).outerHTML,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},R.boxModel=t.boxModel="CSS1Compat"===O.compatMode,o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,a.disabled=!0,t.optDisabled=!r.disabled;try{delete h.test}catch(p){t.deleteExpando=!1}if(!h.addEventListener&&h.attachEvent&&h.fireEvent&&(h.attachEvent("onclick",function(){t.noCloneEvent=!1}),h.cloneNode(!0).fireEvent("onclick"),h.clearAttributes&&h.clearAttributes()),o=O.createElement("input"),o.value="t",o.setAttribute("type","radio"),t.radioValue="t"===o.value,o.setAttribute("checked","checked"),o.setAttribute("name","t"),h.appendChild(o),s=O.createDocumentFragment(),s.appendChild(h.lastChild),t.checkClone=s.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=o.checked,s.removeChild(o),s.appendChild(h),h.attachEvent)for(c in{submit:1,change:1,focusin:1})d="on"+c,u=d in h,u||(h.setAttribute(d,"return;"),u="function"==typeof h[d]),t[c+"Bubbles"]=u;return s.removeChild(h),s=a=r=h=o=null,R(function(){var n,i,a,r,o,s,d,c,p,f,g,m,b=O.getElementsByTagName("body")[0];b&&(d=1,m="padding:0;margin:0;border:",f="position:absolute;top:0;left:0;width:1px;height:1px;",g=m+"0;visibility:hidden;",c="style='"+f+m+"5px solid #000;",p="<div "+c+"display:block;'><div style='"+m+"0;display:block;overflow:hidden;'></div></div><table "+c+"' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",n=O.createElement("div"),n.style.cssText=g+"width:0;height:0;position:static;top:0;margin-top:"+d+"px",b.insertBefore(n,b.firstChild),h=O.createElement("div"),n.appendChild(h),h.innerHTML="<table><tr><td style='"+m+"0;display:none'></td><td>t</td></tr></table>",l=h.getElementsByTagName("td"),u=0===l[0].offsetHeight,l[0].style.display="",l[1].style.display="none",t.reliableHiddenOffsets=u&&0===l[0].offsetHeight,e.getComputedStyle&&(h.innerHTML="",s=O.createElement("div"),s.style.width="0",s.style.marginRight="0",h.style.width="2px",h.appendChild(s),t.reliableMarginRight=0===(parseInt((e.getComputedStyle(s,null)||{marginRight:0}).marginRight,10)||0)),"undefined"!=typeof h.style.zoom&&(h.innerHTML="",h.style.width=h.style.padding="1px",h.style.border=0,h.style.overflow="hidden",h.style.display="inline",h.style.zoom=1,t.inlineBlockNeedsLayout=3===h.offsetWidth,h.style.display="block",h.style.overflow="visible",h.innerHTML="<div style='width:5px;'></div>",t.shrinkWrapBlocks=3!==h.offsetWidth),h.style.cssText=f+g,h.innerHTML=p,i=h.firstChild,a=i.firstChild,r=i.nextSibling.firstChild.firstChild,o={doesNotAddBorder:5!==a.offsetTop,doesAddBorderForTableAndCells:5===r.offsetTop},a.style.position="fixed",a.style.top="20px",o.fixedPosition=20===a.offsetTop||15===a.offsetTop,a.style.position=a.style.top="",i.style.overflow="hidden",i.style.position="relative",o.subtractsBorderForOverflowNotVisible=-5===a.offsetTop,o.doesNotIncludeMarginInBodyOffset=b.offsetTop!==d,e.getComputedStyle&&(h.style.marginTop="1%",t.pixelMargin="1%"!==(e.getComputedStyle(h,null)||{marginTop:0}).marginTop),"undefined"!=typeof n.style.zoom&&(n.style.zoom=1),b.removeChild(n),s=h=n=null,R.extend(t,o))}),t}();var z=/^(?:\{.*\}|\[.*\])$/,B=/([A-Z])/g;R.extend({cache:{},uuid:0,expando:"jQuery"+(R.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?R.cache[e[R.expando]]:e[R.expando],!!e&&!a(e)},data:function(e,n,i,a){if(R.acceptData(e)){var r,o,s,l=R.expando,d="string"==typeof n,c=e.nodeType,u=c?R.cache:e,h=c?e[l]:e[l]&&l,p="events"===n;if(h&&u[h]&&(p||a||u[h].data)||!d||i!==t)return h||(c?e[l]=h=++R.uuid:h=l),u[h]||(u[h]={},c||(u[h].toJSON=R.noop)),("object"==typeof n||"function"==typeof n)&&(a?u[h]=R.extend(u[h],n):u[h].data=R.extend(u[h].data,n)),r=o=u[h],a||(o.data||(o.data={}),o=o.data),i!==t&&(o[R.camelCase(n)]=i),p&&!o[n]?r.events:(d?(s=o[n],null==s&&(s=o[R.camelCase(n)])):s=o,s)}},removeData:function(e,t,n){if(R.acceptData(e)){var i,r,o,s=R.expando,l=e.nodeType,d=l?R.cache:e,c=l?e[s]:s;if(d[c]){if(t&&(i=n?d[c]:d[c].data)){R.isArray(t)||(t in i?t=[t]:(t=R.camelCase(t),t=t in i?[t]:t.split(" ")));for(r=0,o=t.length;o>r;r++)delete i[t[r]];if(!(n?a:R.isEmptyObject)(i))return}(n||(delete d[c].data,a(d[c])))&&(R.support.deleteExpando||!d.setInterval?delete d[c]:d[c]=null,l&&(R.support.deleteExpando?delete e[s]:e.removeAttribute?e.removeAttribute(s):e[s]=null))}}},_data:function(e,t,n){return R.data(e,t,n,!0)},acceptData:function(e){if(e.nodeName){var t=R.noData[e.nodeName.toLowerCase()];if(t)return!(t===!0||e.getAttribute("classid")!==t)}return!0}}),R.fn.extend({data:function(e,n){var a,r,o,s,l,d=this[0],c=0,u=null;if(e===t){if(this.length&&(u=R.data(d),1===d.nodeType&&!R._data(d,"parsedAttrs"))){for(o=d.attributes,l=o.length;l>c;c++)s=o[c].name,0===s.indexOf("data-")&&(s=R.camelCase(s.substring(5)),i(d,s,u[s]));R._data(d,"parsedAttrs",!0)}return u}return"object"==typeof e?this.each(function(){R.data(this,e)}):(a=e.split(".",2),a[1]=a[1]?"."+a[1]:"",r=a[1]+"!",R.access(this,function(n){return n===t?(u=this.triggerHandler("getData"+r,[a[0]]),u===t&&d&&(u=R.data(d,e),u=i(d,e,u)),u===t&&a[1]?this.data(a[0]):u):(a[1]=n,void this.each(function(){var t=R(this);t.triggerHandler("setData"+r,a),R.data(this,e,n),t.triggerHandler("changeData"+r,a)}))},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){R.removeData(this,e)})}}),R.extend({_mark:function(e,t){e&&(t=(t||"fx")+"mark",R._data(e,t,(R._data(e,t)||0)+1))},_unmark:function(e,t,n){if(e!==!0&&(n=t,t=e,e=!1),t){n=n||"fx";var i=n+"mark",a=e?0:(R._data(t,i)||1)-1;a?R._data(t,i,a):(R.removeData(t,i,!0),r(t,n,"mark"))}},queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=R._data(e,t),n&&(!i||R.isArray(n)?i=R._data(e,t,R.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=R.queue(e,t),i=n.shift(),a={};"inprogress"===i&&(i=n.shift()),i&&("fx"===t&&n.unshift("inprogress"),R._data(e,t+".run",a),i.call(e,function(){R.dequeue(e,t)},a)),n.length||(R.removeData(e,t+"queue "+t+".run",!0),r(e,t,"queue"))}}),R.fn.extend({queue:function(e,n){var i=2;return"string"!=typeof e&&(n=e,e="fx",i--),arguments.length<i?R.queue(this[0],e):n===t?this:this.each(function(){var t=R.queue(this,e,n);"fx"===e&&"inprogress"!==t[0]&&R.dequeue(this,e)})},dequeue:function(e){return this.each(function(){R.dequeue(this,e)})},delay:function(e,t){return e=R.fx?R.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){function i(){--l||r.resolveWith(o,[o])}"string"!=typeof e&&(n=e,e=t),e=e||"fx";for(var a,r=R.Deferred(),o=this,s=o.length,l=1,d=e+"defer",c=e+"queue",u=e+"mark";s--;)(a=R.data(o[s],d,t,!0)||(R.data(o[s],c,t,!0)||R.data(o[s],u,t,!0))&&R.data(o[s],d,R.Callbacks("once memory"),!0))&&(l++,a.add(i));return i(),r.promise(n)}});var L,q,H,$=/[\n\t\r]/g,W=/\s+/,G=/\r/g,U=/^(?:button|input)$/i,K=/^(?:button|input|object|select|textarea)$/i,V=/^a(?:rea)?$/i,Y=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,X=R.support.getSetAttribute;R.fn.extend({attr:function(e,t){return R.access(this,R.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){R.removeAttr(this,e)})},prop:function(e,t){return R.access(this,R.prop,e,t,arguments.length>1)},removeProp:function(e){return e=R.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,i,a,r,o,s;if(R.isFunction(e))return this.each(function(t){R(this).addClass(e.call(this,t,this.className))});if(e&&"string"==typeof e)for(t=e.split(W),n=0,i=this.length;i>n;n++)if(a=this[n],1===a.nodeType)if(a.className||1!==t.length){for(r=" "+a.className+" ",o=0,s=t.length;s>o;o++)~r.indexOf(" "+t[o]+" ")||(r+=t[o]+" ");a.className=R.trim(r)}else a.className=e;return this},removeClass:function(e){var n,i,a,r,o,s,l;if(R.isFunction(e))return this.each(function(t){R(this).removeClass(e.call(this,t,this.className))});if(e&&"string"==typeof e||e===t)for(n=(e||"").split(W),i=0,a=this.length;a>i;i++)if(r=this[i],1===r.nodeType&&r.className)if(e){for(o=(" "+r.className+" ").replace($," "),s=0,l=n.length;l>s;s++)o=o.replace(" "+n[s]+" "," ");r.className=R.trim(o)}else r.className="";return this},toggleClass:function(e,t){var n=typeof e,i="boolean"==typeof t;return this.each(R.isFunction(e)?function(n){R(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var a,r=0,o=R(this),s=t,l=e.split(W);a=l[r++];)s=i?s:!o.hasClass(a),o[s?"addClass":"removeClass"](a);else("undefined"===n||"boolean"===n)&&(this.className&&R._data(this,"__className__",this.className),this.className=this.className||e===!1?"":R._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace($," ").indexOf(t)>-1)return!0;return!1},val:function(e){var n,i,a,r=this[0];{if(arguments.length)return a=R.isFunction(e),this.each(function(i){var r,o=R(this);1===this.nodeType&&(r=a?e.call(this,i,o.val()):e,null==r?r="":"number"==typeof r?r+="":R.isArray(r)&&(r=R.map(r,function(e){return null==e?"":e+""})),n=R.valHooks[this.type]||R.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,r,"value")!==t||(this.value=r))});if(r)return n=R.valHooks[r.type]||R.valHooks[r.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(r,"value"))!==t?i:(i=r.value,"string"==typeof i?i.replace(G,""):null==i?"":i)}}}),R.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,i,a,r=e.selectedIndex,o=[],s=e.options,l="select-one"===e.type;if(0>r)return null;for(n=l?r:0,i=l?r+1:s.length;i>n;n++)if(a=s[n],!(!a.selected||(R.support.optDisabled?a.disabled:null!==a.getAttribute("disabled"))||a.parentNode.disabled&&R.nodeName(a.parentNode,"optgroup"))){if(t=R(a).val(),l)return t;o.push(t)}return l&&!o.length&&s.length?R(s[r]).val():o},set:function(e,t){var n=R.makeArray(t);return R(e).find("option").each(function(){this.selected=R.inArray(R(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(e,n,i,a){var r,o,s,l=e.nodeType;if(e&&3!==l&&8!==l&&2!==l)return a&&n in R.attrFn?R(e)[n](i):"undefined"==typeof e.getAttribute?R.prop(e,n,i):(s=1!==l||!R.isXMLDoc(e),s&&(n=n.toLowerCase(),o=R.attrHooks[n]||(Y.test(n)?q:L)),i!==t?null===i?void R.removeAttr(e,n):o&&"set"in o&&s&&(r=o.set(e,i,n))!==t?r:(e.setAttribute(n,""+i),i):o&&"get"in o&&s&&null!==(r=o.get(e,n))?r:(r=e.getAttribute(n),null===r?t:r))},removeAttr:function(e,t){var n,i,a,r,o,s=0;if(t&&1===e.nodeType)for(i=t.toLowerCase().split(W),r=i.length;r>s;s++)a=i[s],a&&(n=R.propFix[a]||a,o=Y.test(a),o||R.attr(e,a,""),e.removeAttribute(X?a:n),o&&n in e&&(e[n]=!1))},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode)R.error("type property can't be changed");else if(!R.support.radioValue&&"radio"===t&&R.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return L&&R.nodeName(e,"button")?L.get(e,t):t in e?e.value:null},set:function(e,t,n){return L&&R.nodeName(e,"button")?L.set(e,t,n):void(e.value=t)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,i){var a,r,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return o=1!==s||!R.isXMLDoc(e),o&&(n=R.propFix[n]||n,r=R.propHooks[n]),i!==t?r&&"set"in r&&(a=r.set(e,i,n))!==t?a:e[n]=i:r&&"get"in r&&null!==(a=r.get(e,n))?a:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):K.test(e.nodeName)||V.test(e.nodeName)&&e.href?0:t}}}}),R.attrHooks.tabindex=R.propHooks.tabIndex,q={get:function(e,n){var i,a=R.prop(e,n);return a===!0||"boolean"!=typeof a&&(i=e.getAttributeNode(n))&&i.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var i;return t===!1?R.removeAttr(e,n):(i=R.propFix[n]||n,i in e&&(e[i]=!0),e.setAttribute(n,n.toLowerCase())),n}},X||(H={name:!0,id:!0,coords:!0},L=R.valHooks.button={get:function(e,n){var i;return i=e.getAttributeNode(n),i&&(H[n]?""!==i.nodeValue:i.specified)?i.nodeValue:t},set:function(e,t,n){var i=e.getAttributeNode(n);return i||(i=O.createAttribute(n),e.setAttributeNode(i)),i.nodeValue=t+""}},R.attrHooks.tabindex.set=L.set,R.each(["width","height"],function(e,t){R.attrHooks[t]=R.extend(R.attrHooks[t],{set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}})}),R.attrHooks.contenteditable={get:L.get,set:function(e,t,n){""===t&&(t="false"),L.set(e,t,n)}}),R.support.hrefNormalized||R.each(["href","src","width","height"],function(e,n){R.attrHooks[n]=R.extend(R.attrHooks[n],{get:function(e){var i=e.getAttribute(n,2);return null===i?t:i}})}),R.support.style||(R.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=""+t}}),R.support.optSelected||(R.propHooks.selected=R.extend(R.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),R.support.enctype||(R.propFix.enctype="encoding"),R.support.checkOn||R.each(["radio","checkbox"],function(){R.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),R.each(["radio","checkbox"],function(){R.valHooks[this]=R.extend(R.valHooks[this],{set:function(e,t){return R.isArray(t)?e.checked=R.inArray(R(e).val(),t)>=0:void 0}})});var Q=/^(?:textarea|input|select)$/i,J=/^([^\.]*)?(?:\.(.+))?$/,Z=/(?:^|\s)hover(\.\S+)?\b/,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,it=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,at=function(e){var t=it.exec(e);return t&&(t[1]=(t[1]||"").toLowerCase(),t[3]=t[3]&&new RegExp("(?:^|\\s)"+t[3]+"(?:\\s|$)")),t},rt=function(e,t){var n=e.attributes||{};return!(t[1]&&e.nodeName.toLowerCase()!==t[1]||t[2]&&(n.id||{}).value!==t[2]||t[3]&&!t[3].test((n["class"]||{}).value))},ot=function(e){return R.event.special.hover?e:e.replace(Z,"mouseenter$1 mouseleave$1")};R.event={add:function(e,n,i,a,r){var o,s,l,d,c,u,h,p,f,g,m;if(3!==e.nodeType&&8!==e.nodeType&&n&&i&&(o=R._data(e))){for(i.handler&&(f=i,i=f.handler,r=f.selector),i.guid||(i.guid=R.guid++),l=o.events,l||(o.events=l={}),s=o.handle,s||(o.handle=s=function(e){return"undefined"==typeof R||e&&R.event.triggered===e.type?t:R.event.dispatch.apply(s.elem,arguments)},s.elem=e),n=R.trim(ot(n)).split(" "),d=0;d<n.length;d++)c=J.exec(n[d])||[],u=c[1],h=(c[2]||"").split(".").sort(),m=R.event.special[u]||{},u=(r?m.delegateType:m.bindType)||u,m=R.event.special[u]||{},p=R.extend({type:u,origType:c[1],data:a,handler:i,guid:i.guid,selector:r,quick:r&&at(r),namespace:h.join(".")},f),g=l[u],g||(g=l[u]=[],g.delegateCount=0,m.setup&&m.setup.call(e,a,h,s)!==!1||(e.addEventListener?e.addEventListener(u,s,!1):e.attachEvent&&e.attachEvent("on"+u,s))),m.add&&(m.add.call(e,p),p.handler.guid||(p.handler.guid=i.guid)),r?g.splice(g.delegateCount++,0,p):g.push(p),R.event.global[u]=!0;e=null}},global:{},remove:function(e,t,n,i,a){var r,o,s,l,d,c,u,h,p,f,g,m,b=R.hasData(e)&&R._data(e);if(b&&(h=b.events)){for(t=R.trim(ot(t||"")).split(" "),r=0;r<t.length;r++)if(o=J.exec(t[r])||[],s=l=o[1],d=o[2],s){for(p=R.event.special[s]||{},s=(i?p.delegateType:p.bindType)||s,g=h[s]||[],c=g.length,d=d?new RegExp("(^|\\.)"+d.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,u=0;u<g.length;u++)m=g[u],!a&&l!==m.origType||n&&n.guid!==m.guid||d&&!d.test(m.namespace)||i&&i!==m.selector&&("**"!==i||!m.selector)||(g.splice(u--,1),m.selector&&g.delegateCount--,p.remove&&p.remove.call(e,m));0===g.length&&c!==g.length&&(p.teardown&&p.teardown.call(e,d)!==!1||R.removeEvent(e,s,b.handle),delete h[s])}else for(s in h)R.event.remove(e,s+t[r],n,i,!0);R.isEmptyObject(h)&&(f=b.handle,f&&(f.elem=null),R.removeData(e,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,i,a,r){if(!a||3!==a.nodeType&&8!==a.nodeType){var o,s,l,d,c,u,h,p,f,g,m=n.type||n,b=[];if(!nt.test(m+R.event.triggered)&&(m.indexOf("!")>=0&&(m=m.slice(0,-1),s=!0),m.indexOf(".")>=0&&(b=m.split("."),m=b.shift(),b.sort()),a&&!R.event.customEvent[m]||R.event.global[m]))if(n="object"==typeof n?n[R.expando]?n:new R.Event(m,n):new R.Event(m),n.type=m,n.isTrigger=!0,n.exclusive=s,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,u=m.indexOf(":")<0?"on"+m:"",a){if(n.result=t,n.target||(n.target=a),i=null!=i?R.makeArray(i):[],i.unshift(n),h=R.event.special[m]||{},!h.trigger||h.trigger.apply(a,i)!==!1){if(f=[[a,h.bindType||m]],!r&&!h.noBubble&&!R.isWindow(a)){for(g=h.delegateType||m,d=nt.test(g+m)?a:a.parentNode,c=null;d;d=d.parentNode)f.push([d,g]),c=d;c&&c===a.ownerDocument&&f.push([c.defaultView||c.parentWindow||e,g])}for(l=0;l<f.length&&!n.isPropagationStopped();l++)d=f[l][0],n.type=f[l][1],p=(R._data(d,"events")||{})[n.type]&&R._data(d,"handle"),p&&p.apply(d,i),p=u&&d[u],p&&R.acceptData(d)&&p.apply(d,i)===!1&&n.preventDefault();return n.type=m,r||n.isDefaultPrevented()||h._default&&h._default.apply(a.ownerDocument,i)!==!1||"click"===m&&R.nodeName(a,"a")||!R.acceptData(a)||u&&a[m]&&("focus"!==m&&"blur"!==m||0!==n.target.offsetWidth)&&!R.isWindow(a)&&(c=a[u],c&&(a[u]=null),R.event.triggered=m,a[m](),R.event.triggered=t,c&&(a[u]=c)),n.result}}else{o=R.cache;for(l in o)o[l].events&&o[l].events[m]&&R.event.trigger(n,i,o[l].handle.elem,!0)}}},dispatch:function(n){n=R.event.fix(n||e.event);var i,a,r,o,s,l,d,c,u,h,p=(R._data(this,"events")||{})[n.type]||[],f=p.delegateCount,g=[].slice.call(arguments,0),m=!n.exclusive&&!n.namespace,b=R.event.special[n.type]||{},v=[];if(g[0]=n,n.delegateTarget=this,!b.preDispatch||b.preDispatch.call(this,n)!==!1){if(f&&(!n.button||"click"!==n.type))for(o=R(this),o.context=this.ownerDocument||this,r=n.target;r!=this;r=r.parentNode||this)if(r.disabled!==!0){for(l={},c=[],o[0]=r,i=0;f>i;i++)u=p[i],h=u.selector,l[h]===t&&(l[h]=u.quick?rt(r,u.quick):o.is(h)),l[h]&&c.push(u);c.length&&v.push({elem:r,matches:c})}for(p.length>f&&v.push({elem:this,matches:p.slice(f)}),i=0;i<v.length&&!n.isPropagationStopped();i++)for(d=v[i],n.currentTarget=d.elem,a=0;a<d.matches.length&&!n.isImmediatePropagationStopped();a++)u=d.matches[a],(m||!n.namespace&&!u.namespace||n.namespace_re&&n.namespace_re.test(u.namespace))&&(n.data=u.data,n.handleObj=u,s=((R.event.special[u.origType]||{}).handle||u.handler).apply(d.elem,g),s!==t&&(n.result=s,s===!1&&(n.preventDefault(),n.stopPropagation())));return b.postDispatch&&b.postDispatch.call(this,n),n.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var i,a,r,o=n.button,s=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||O,a=i.documentElement,r=i.body,e.pageX=n.clientX+(a&&a.scrollLeft||r&&r.scrollLeft||0)-(a&&a.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(a&&a.scrollTop||r&&r.scrollTop||0)-(a&&a.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?n.toElement:s),e.which||o===t||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[R.expando])return e;var n,i,a=e,r=R.event.fixHooks[e.type]||{},o=r.props?this.props.concat(r.props):this.props;for(e=R.Event(a),n=o.length;n;)i=o[--n],e[i]=a[i];return e.target||(e.target=a.srcElement||O),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey===t&&(e.metaKey=e.ctrlKey),r.filter?r.filter(e,a):e},special:{ready:{setup:R.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){R.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,i){var a=R.extend(new R.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?R.event.trigger(a,null,t):R.event.dispatch.call(t,a),a.isDefaultPrevented()&&n.preventDefault()}},R.event.handle=R.event.dispatch,R.removeEvent=O.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent&&e.detachEvent("on"+t,n)},R.Event=function(e,t){return this instanceof R.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?s:o):this.type=e,t&&R.extend(this,t),this.timeStamp=e&&e.timeStamp||R.now(),void(this[R.expando]=!0)):new R.Event(e,t)},R.Event.prototype={preventDefault:function(){this.isDefaultPrevented=s;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=s;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=s,this.stopPropagation()},isDefaultPrevented:o,isPropagationStopped:o,isImmediatePropagationStopped:o},R.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){R.event.special[e]={delegateType:t,bindType:t,handle:function(e){{var n,i=this,a=e.relatedTarget,r=e.handleObj;r.selector}return(!a||a!==i&&!R.contains(i,a))&&(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),R.support.submitBubbles||(R.event.special.submit={setup:function(){return R.nodeName(this,"form")?!1:void R.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,i=R.nodeName(n,"input")||R.nodeName(n,"button")?n.form:t;i&&!i._submit_attached&&(R.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),i._submit_attached=!0)})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&R.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return R.nodeName(this,"form")?!1:void R.event.remove(this,"._submit")}}),R.support.changeBubbles||(R.event.special.change={setup:function(){return Q.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(R.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),R.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1,R.event.simulate("change",this,e,!0))})),!1):void R.event.add(this,"beforeactivate._change",function(e){var t=e.target;Q.test(t.nodeName)&&!t._change_attached&&(R.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||R.event.simulate("change",this.parentNode,e,!0)}),t._change_attached=!0)})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return R.event.remove(this,"._change"),Q.test(this.nodeName)}}),R.support.focusinBubbles||R.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,i=function(e){R.event.simulate(t,e.target,R.event.fix(e),!0)};R.event.special[t]={setup:function(){0===n++&&O.addEventListener(e,i,!0)},teardown:function(){0===--n&&O.removeEventListener(e,i,!0)}}}),R.fn.extend({on:function(e,n,i,a,r){var s,l;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=t);for(l in e)this.on(l,n,i,e[l],r);return this}if(null==i&&null==a?(a=n,i=n=t):null==a&&("string"==typeof n?(a=i,i=t):(a=i,i=n,n=t)),a===!1)a=o;else if(!a)return this;return 1===r&&(s=a,a=function(e){return R().off(e),s.apply(this,arguments)},a.guid=s.guid||(s.guid=R.guid++)),this.each(function(){R.event.add(this,e,a,i,n)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,n,i){if(e&&e.preventDefault&&e.handleObj){var a=e.handleObj;return R(e.delegateTarget).off(a.namespace?a.origType+"."+a.namespace:a.origType,a.selector,a.handler),this}if("object"==typeof e){for(var r in e)this.off(r,n,e[r]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=t),i===!1&&(i=o),this.each(function(){R.event.remove(this,e,i,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return R(this.context).on(e,this.selector,t,n),this},die:function(e,t){return R(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1==arguments.length?this.off(e,"**"):this.off(t,e,n)},trigger:function(e,t){return this.each(function(){R.event.trigger(e,t,this)})},triggerHandler:function(e,t){return this[0]?R.event.trigger(e,t,this[0],!0):void 0},toggle:function(e){var t=arguments,n=e.guid||R.guid++,i=0,a=function(n){var a=(R._data(this,"lastToggle"+e.guid)||0)%i;return R._data(this,"lastToggle"+e.guid,a+1),n.preventDefault(),t[a].apply(this,arguments)||!1};for(a.guid=n;i<t.length;)t[i++].guid=n;return this.click(a)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),R.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){R.fn[t]=function(e,n){return null==n&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},R.attrFn&&(R.attrFn[t]=!0),et.test(t)&&(R.event.fixHooks[t]=R.event.keyHooks),tt.test(t)&&(R.event.fixHooks[t]=R.event.mouseHooks)}),function(){function e(e,t,n,i,r,o){for(var s=0,l=i.length;l>s;s++){var d=i[s];if(d){var c=!1;for(d=d[e];d;){if(d[a]===n){c=i[d.sizset];break}if(1!==d.nodeType||o||(d[a]=n,d.sizset=s),d.nodeName.toLowerCase()===t){c=d;break}d=d[e]}i[s]=c}}}function n(e,t,n,i,r,o){for(var s=0,l=i.length;l>s;s++){var d=i[s];if(d){var c=!1;for(d=d[e];d;){if(d[a]===n){c=i[d.sizset];break}if(1===d.nodeType)if(o||(d[a]=n,d.sizset=s),"string"!=typeof t){if(d===t){c=!0;break}}else if(h.filter(t,[d]).length>0){c=d;break}d=d[e]}i[s]=c}}}var i=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,a="sizcache"+(Math.random()+"").replace(".",""),r=0,o=Object.prototype.toString,s=!1,l=!0,d=/\\/g,c=/\r\n/g,u=/\W/;[0,0].sort(function(){return l=!1,0});var h=function(e,t,n,a){n=n||[],t=t||O;var r=t;if(1!==t.nodeType&&9!==t.nodeType)return[];if(!e||"string"!=typeof e)return n;var s,l,d,c,u,p,m,b,y=!0,_=h.isXML(t),w=[],k=e;do if(i.exec(""),s=i.exec(k),s&&(k=s[3],w.push(s[1]),s[2])){c=s[3];break}while(s);if(w.length>1&&g.exec(e))if(2===w.length&&f.relative[w[0]])l=C(w[0]+w[1],t,a);else for(l=f.relative[w[0]]?[t]:h(w.shift(),t);w.length;)e=w.shift(),f.relative[e]&&(e+=w.shift()),l=C(e,l,a);else if(!a&&w.length>1&&9===t.nodeType&&!_&&f.match.ID.test(w[0])&&!f.match.ID.test(w[w.length-1])&&(u=h.find(w.shift(),t,_),t=u.expr?h.filter(u.expr,u.set)[0]:u.set[0]),t)for(u=a?{expr:w.pop(),set:v(a)}:h.find(w.pop(),1!==w.length||"~"!==w[0]&&"+"!==w[0]||!t.parentNode?t:t.parentNode,_),l=u.expr?h.filter(u.expr,u.set):u.set,w.length>0?d=v(l):y=!1;w.length;)p=w.pop(),m=p,f.relative[p]?m=w.pop():p="",null==m&&(m=t),f.relative[p](d,m,_);else d=w=[];if(d||(d=l),d||h.error(p||e),"[object Array]"===o.call(d))if(y)if(t&&1===t.nodeType)for(b=0;null!=d[b];b++)d[b]&&(d[b]===!0||1===d[b].nodeType&&h.contains(t,d[b]))&&n.push(l[b]);else for(b=0;null!=d[b];b++)d[b]&&1===d[b].nodeType&&n.push(l[b]);else n.push.apply(n,d);else v(d,n);return c&&(h(c,r,n,a),h.uniqueSort(n)),n};h.uniqueSort=function(e){if(_&&(s=l,e.sort(_),s))for(var t=1;t<e.length;t++)e[t]===e[t-1]&&e.splice(t--,1);return e},h.matches=function(e,t){return h(e,null,null,t)},h.matchesSelector=function(e,t){return h(t,null,null,[e]).length>0},h.find=function(e,t,n){var i,a,r,o,s,l;if(!e)return[];for(a=0,r=f.order.length;r>a;a++)if(s=f.order[a],(o=f.leftMatch[s].exec(e))&&(l=o[1],o.splice(1,1),"\\"!==l.substr(l.length-1)&&(o[1]=(o[1]||"").replace(d,""),i=f.find[s](o,t,n),null!=i))){e=e.replace(f.match[s],"");break}return i||(i="undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName("*"):[]),{set:i,expr:e}},h.filter=function(e,n,i,a){for(var r,o,s,l,d,c,u,p,g,m=e,b=[],v=n,y=n&&n[0]&&h.isXML(n[0]);e&&n.length;){for(s in f.filter)if(null!=(r=f.leftMatch[s].exec(e))&&r[2]){if(c=f.filter[s],u=r[1],o=!1,r.splice(1,1),"\\"===u.substr(u.length-1))continue;if(v===b&&(b=[]),f.preFilter[s])if(r=f.preFilter[s](r,v,i,b,a,y)){if(r===!0)continue}else o=l=!0;if(r)for(p=0;null!=(d=v[p]);p++)d&&(l=c(d,r,p,v),g=a^l,i&&null!=l?g?o=!0:v[p]=!1:g&&(b.push(d),o=!0));if(l!==t){if(i||(v=b),e=e.replace(f.match[s],""),!o)return[];break}}if(e===m){if(null!=o)break;h.error(e)}m=e}return v},h.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};var p=h.getText=function(e){var t,n,i=e.nodeType,a="";if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;if("string"==typeof e.innerText)return e.innerText.replace(c,"");for(e=e.firstChild;e;e=e.nextSibling)a+=p(e)}else if(3===i||4===i)return e.nodeValue}else for(t=0;n=e[t];t++)8!==n.nodeType&&(a+=p(n));return a},f=h.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")
},type:function(e){return e.getAttribute("type")}},relative:{"+":function(e,t){var n="string"==typeof t,i=n&&!u.test(t),a=n&&!i;i&&(t=t.toLowerCase());for(var r,o=0,s=e.length;s>o;o++)if(r=e[o]){for(;(r=r.previousSibling)&&1!==r.nodeType;);e[o]=a||r&&r.nodeName.toLowerCase()===t?r||!1:r===t}a&&h.filter(t,e,!0)},">":function(e,t){var n,i="string"==typeof t,a=0,r=e.length;if(i&&!u.test(t)){for(t=t.toLowerCase();r>a;a++)if(n=e[a]){var o=n.parentNode;e[a]=o.nodeName.toLowerCase()===t?o:!1}}else{for(;r>a;a++)n=e[a],n&&(e[a]=i?n.parentNode:n.parentNode===t);i&&h.filter(t,e,!0)}},"":function(t,i,a){var o,s=r++,l=n;"string"!=typeof i||u.test(i)||(i=i.toLowerCase(),o=i,l=e),l("parentNode",i,s,t,o,a)},"~":function(t,i,a){var o,s=r++,l=n;"string"!=typeof i||u.test(i)||(i=i.toLowerCase(),o=i,l=e),l("previousSibling",i,s,t,o,a)}},find:{ID:function(e,t,n){if("undefined"!=typeof t.getElementById&&!n){var i=t.getElementById(e[1]);return i&&i.parentNode?[i]:[]}},NAME:function(e,t){if("undefined"!=typeof t.getElementsByName){for(var n=[],i=t.getElementsByName(e[1]),a=0,r=i.length;r>a;a++)i[a].getAttribute("name")===e[1]&&n.push(i[a]);return 0===n.length?null:n}},TAG:function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e[1]):void 0}},preFilter:{CLASS:function(e,t,n,i,a,r){if(e=" "+e[1].replace(d,"")+" ",r)return e;for(var o,s=0;null!=(o=t[s]);s++)o&&(a^(o.className&&(" "+o.className+" ").replace(/[\t\n\r]/g," ").indexOf(e)>=0)?n||i.push(o):n&&(t[s]=!1));return!1},ID:function(e){return e[1].replace(d,"")},TAG:function(e){return e[1].replace(d,"").toLowerCase()},CHILD:function(e){if("nth"===e[1]){e[2]||h.error(e[0]),e[2]=e[2].replace(/^\+|\s*/g,"");var t=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even"===e[2]&&"2n"||"odd"===e[2]&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=t[1]+(t[2]||1)-0,e[3]=t[3]-0}else e[2]&&h.error(e[0]);return e[0]=r++,e},ATTR:function(e,t,n,i,a,r){var o=e[1]=e[1].replace(d,"");return!r&&f.attrMap[o]&&(e[1]=f.attrMap[o]),e[4]=(e[4]||e[5]||"").replace(d,""),"~="===e[2]&&(e[4]=" "+e[4]+" "),e},PSEUDO:function(e,t,n,a,r){if("not"===e[1]){if(!((i.exec(e[3])||"").length>1||/^\w/.test(e[3]))){var o=h.filter(e[3],t,n,!0^r);return n||a.push.apply(a,o),!1}e[3]=h(e[3],null,null,t)}else if(f.match.POS.test(e[0])||f.match.CHILD.test(e[0]))return!0;return e},POS:function(e){return e.unshift(!0),e}},filters:{enabled:function(e){return e.disabled===!1&&"hidden"!==e.type},disabled:function(e){return e.disabled===!0},checked:function(e){return e.checked===!0},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!!e.firstChild},empty:function(e){return!e.firstChild},has:function(e,t,n){return!!h(n[3],e).length},header:function(e){return/h\d/i.test(e.nodeName)},text:function(e){var t=e.getAttribute("type"),n=e.type;return"input"===e.nodeName.toLowerCase()&&"text"===n&&(t===n||null===t)},radio:function(e){return"input"===e.nodeName.toLowerCase()&&"radio"===e.type},checkbox:function(e){return"input"===e.nodeName.toLowerCase()&&"checkbox"===e.type},file:function(e){return"input"===e.nodeName.toLowerCase()&&"file"===e.type},password:function(e){return"input"===e.nodeName.toLowerCase()&&"password"===e.type},submit:function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&"submit"===e.type},image:function(e){return"input"===e.nodeName.toLowerCase()&&"image"===e.type},reset:function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&"reset"===e.type},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return/input|select|textarea|button/i.test(e.nodeName)},focus:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(e,t){return 0===t},last:function(e,t,n,i){return t===i.length-1},even:function(e,t){return t%2===0},odd:function(e,t){return t%2===1},lt:function(e,t,n){return t<n[3]-0},gt:function(e,t,n){return t>n[3]-0},nth:function(e,t,n){return n[3]-0===t},eq:function(e,t,n){return n[3]-0===t}},filter:{PSEUDO:function(e,t,n,i){var a=t[1],r=f.filters[a];if(r)return r(e,n,t,i);if("contains"===a)return(e.textContent||e.innerText||p([e])||"").indexOf(t[3])>=0;if("not"===a){for(var o=t[3],s=0,l=o.length;l>s;s++)if(o[s]===e)return!1;return!0}h.error(a)},CHILD:function(e,t){var n,i,r,o,s,l,d=t[1],c=e;switch(d){case"only":case"first":for(;c=c.previousSibling;)if(1===c.nodeType)return!1;if("first"===d)return!0;c=e;case"last":for(;c=c.nextSibling;)if(1===c.nodeType)return!1;return!0;case"nth":if(n=t[2],i=t[3],1===n&&0===i)return!0;if(r=t[0],o=e.parentNode,o&&(o[a]!==r||!e.nodeIndex)){for(s=0,c=o.firstChild;c;c=c.nextSibling)1===c.nodeType&&(c.nodeIndex=++s);o[a]=r}return l=e.nodeIndex-i,0===n?0===l:l%n===0&&l/n>=0}},ID:function(e,t){return 1===e.nodeType&&e.getAttribute("id")===t},TAG:function(e,t){return"*"===t&&1===e.nodeType||!!e.nodeName&&e.nodeName.toLowerCase()===t},CLASS:function(e,t){return(" "+(e.className||e.getAttribute("class"))+" ").indexOf(t)>-1},ATTR:function(e,t){var n=t[1],i=h.attr?h.attr(e,n):f.attrHandle[n]?f.attrHandle[n](e):null!=e[n]?e[n]:e.getAttribute(n),a=i+"",r=t[2],o=t[4];return null==i?"!="===r:!r&&h.attr?null!=i:"="===r?a===o:"*="===r?a.indexOf(o)>=0:"~="===r?(" "+a+" ").indexOf(o)>=0:o?"!="===r?a!==o:"^="===r?0===a.indexOf(o):"$="===r?a.substr(a.length-o.length)===o:"|="===r?a===o||a.substr(0,o.length+1)===o+"-":!1:a&&i!==!1},POS:function(e,t,n,i){var a=t[2],r=f.setFilters[a];return r?r(e,n,t,i):void 0}}},g=f.match.POS,m=function(e,t){return"\\"+(t-0+1)};for(var b in f.match)f.match[b]=new RegExp(f.match[b].source+/(?![^\[]*\])(?![^\(]*\))/.source),f.leftMatch[b]=new RegExp(/(^(?:.|\r|\n)*?)/.source+f.match[b].source.replace(/\\(\d+)/g,m));f.match.globalPOS=g;var v=function(e,t){return e=Array.prototype.slice.call(e,0),t?(t.push.apply(t,e),t):e};try{Array.prototype.slice.call(O.documentElement.childNodes,0)[0].nodeType}catch(y){v=function(e,t){var n=0,i=t||[];if("[object Array]"===o.call(e))Array.prototype.push.apply(i,e);else if("number"==typeof e.length)for(var a=e.length;a>n;n++)i.push(e[n]);else for(;e[n];n++)i.push(e[n]);return i}}var _,w;O.documentElement.compareDocumentPosition?_=function(e,t){return e===t?(s=!0,0):e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t)?-1:1:e.compareDocumentPosition?-1:1}:(_=function(e,t){if(e===t)return s=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,i,a=[],r=[],o=e.parentNode,l=t.parentNode,d=o;if(o===l)return w(e,t);if(!o)return-1;if(!l)return 1;for(;d;)a.unshift(d),d=d.parentNode;for(d=l;d;)r.unshift(d),d=d.parentNode;n=a.length,i=r.length;for(var c=0;n>c&&i>c;c++)if(a[c]!==r[c])return w(a[c],r[c]);return c===n?w(e,r[c],-1):w(a[c],t,1)},w=function(e,t,n){if(e===t)return n;for(var i=e.nextSibling;i;){if(i===t)return-1;i=i.nextSibling}return 1}),function(){var e=O.createElement("div"),n="script"+(new Date).getTime(),i=O.documentElement;e.innerHTML="<a name='"+n+"'/>",i.insertBefore(e,i.firstChild),O.getElementById(n)&&(f.find.ID=function(e,n,i){if("undefined"!=typeof n.getElementById&&!i){var a=n.getElementById(e[1]);return a?a.id===e[1]||"undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id").nodeValue===e[1]?[a]:t:[]}},f.filter.ID=function(e,t){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return 1===e.nodeType&&n&&n.nodeValue===t}),i.removeChild(e),i=e=null}(),function(){var e=O.createElement("div");e.appendChild(O.createComment("")),e.getElementsByTagName("*").length>0&&(f.find.TAG=function(e,t){var n=t.getElementsByTagName(e[1]);if("*"===e[1]){for(var i=[],a=0;n[a];a++)1===n[a].nodeType&&i.push(n[a]);n=i}return n}),e.innerHTML="<a href='#'></a>",e.firstChild&&"undefined"!=typeof e.firstChild.getAttribute&&"#"!==e.firstChild.getAttribute("href")&&(f.attrHandle.href=function(e){return e.getAttribute("href",2)}),e=null}(),O.querySelectorAll&&!function(){var e=h,t=O.createElement("div"),n="__sizzle__";if(t.innerHTML="<p class='TEST'></p>",!t.querySelectorAll||0!==t.querySelectorAll(".TEST").length){h=function(t,i,a,r){if(i=i||O,!r&&!h.isXML(i)){var o=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(t);if(o&&(1===i.nodeType||9===i.nodeType)){if(o[1])return v(i.getElementsByTagName(t),a);if(o[2]&&f.find.CLASS&&i.getElementsByClassName)return v(i.getElementsByClassName(o[2]),a)}if(9===i.nodeType){if("body"===t&&i.body)return v([i.body],a);if(o&&o[3]){var s=i.getElementById(o[3]);if(!s||!s.parentNode)return v([],a);if(s.id===o[3])return v([s],a)}try{return v(i.querySelectorAll(t),a)}catch(l){}}else if(1===i.nodeType&&"object"!==i.nodeName.toLowerCase()){var d=i,c=i.getAttribute("id"),u=c||n,p=i.parentNode,g=/^\s*[+~]/.test(t);c?u=u.replace(/'/g,"\\$&"):i.setAttribute("id",u),g&&p&&(i=i.parentNode);try{if(!g||p)return v(i.querySelectorAll("[id='"+u+"'] "+t),a)}catch(m){}finally{c||d.removeAttribute("id")}}}return e(t,i,a,r)};for(var i in e)h[i]=e[i];t=null}}(),function(){var e=O.documentElement,t=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.msMatchesSelector;if(t){var n=!t.call(O.createElement("div"),"div"),i=!1;try{t.call(O.documentElement,"[test!='']:sizzle")}catch(a){i=!0}h.matchesSelector=function(e,a){if(a=a.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!h.isXML(e))try{if(i||!f.match.PSEUDO.test(a)&&!/!=/.test(a)){var r=t.call(e,a);if(r||!n||e.document&&11!==e.document.nodeType)return r}}catch(o){}return h(a,null,null,[e]).length>0}}}(),function(){var e=O.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>",e.getElementsByClassName&&0!==e.getElementsByClassName("e").length&&(e.lastChild.className="e",1!==e.getElementsByClassName("e").length&&(f.order.splice(1,0,"CLASS"),f.find.CLASS=function(e,t,n){return"undefined"==typeof t.getElementsByClassName||n?void 0:t.getElementsByClassName(e[1])},e=null))}(),h.contains=O.documentElement.contains?function(e,t){return e!==t&&(e.contains?e.contains(t):!0)}:O.documentElement.compareDocumentPosition?function(e,t){return!!(16&e.compareDocumentPosition(t))}:function(){return!1},h.isXML=function(e){var t=(e?e.ownerDocument||e:0).documentElement;return t?"HTML"!==t.nodeName:!1};var C=function(e,t,n){for(var i,a=[],r="",o=t.nodeType?[t]:t;i=f.match.PSEUDO.exec(e);)r+=i[0],e=e.replace(f.match.PSEUDO,"");e=f.relative[e]?e+"*":e;for(var s=0,l=o.length;l>s;s++)h(e,o[s],a,n);return h.filter(r,a)};h.attr=R.attr,h.selectors.attrMap={},R.find=h,R.expr=h.selectors,R.expr[":"]=R.expr.filters,R.unique=h.uniqueSort,R.text=h.getText,R.isXMLDoc=h.isXML,R.contains=h.contains}();var st=/Until$/,lt=/^(?:parents|prevUntil|prevAll)/,dt=/,/,ct=/^.[^:#\[\.,]*$/,ut=Array.prototype.slice,ht=R.expr.match.globalPOS,pt={children:!0,contents:!0,next:!0,prev:!0};R.fn.extend({find:function(e){var t,n,i=this;if("string"!=typeof e)return R(e).filter(function(){for(t=0,n=i.length;n>t;t++)if(R.contains(i[t],this))return!0});var a,r,o,s=this.pushStack("","find",e);for(t=0,n=this.length;n>t;t++)if(a=s.length,R.find(e,this[t],s),t>0)for(r=a;r<s.length;r++)for(o=0;a>o;o++)if(s[o]===s[r]){s.splice(r--,1);break}return s},has:function(e){var t=R(e);return this.filter(function(){for(var e=0,n=t.length;n>e;e++)if(R.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(d(this,e,!1),"not",e)},filter:function(e){return this.pushStack(d(this,e,!0),"filter",e)},is:function(e){return!!e&&("string"==typeof e?ht.test(e)?R(e,this.context).index(this[0])>=0:R.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,i,a=[],r=this[0];if(R.isArray(e)){for(var o=1;r&&r.ownerDocument&&r!==t;){for(n=0;n<e.length;n++)R(r).is(e[n])&&a.push({selector:e[n],elem:r,level:o});r=r.parentNode,o++}return a}var s=ht.test(e)||"string"!=typeof e?R(e,t||this.context):0;for(n=0,i=this.length;i>n;n++)for(r=this[n];r;){if(s?s.index(r)>-1:R.find.matchesSelector(r,e)){a.push(r);break}if(r=r.parentNode,!r||!r.ownerDocument||r===t||11===r.nodeType)break}return a=a.length>1?R.unique(a):a,this.pushStack(a,"closest",e)},index:function(e){return e?"string"==typeof e?R.inArray(this[0],R(e)):R.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n="string"==typeof e?R(e,t):R.makeArray(e&&e.nodeType?[e]:e),i=R.merge(this.get(),n);return this.pushStack(l(n[0])||l(i[0])?i:R.unique(i))},andSelf:function(){return this.add(this.prevObject)}}),R.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return R.dir(e,"parentNode")},parentsUntil:function(e,t,n){return R.dir(e,"parentNode",n)},next:function(e){return R.nth(e,2,"nextSibling")},prev:function(e){return R.nth(e,2,"previousSibling")},nextAll:function(e){return R.dir(e,"nextSibling")},prevAll:function(e){return R.dir(e,"previousSibling")},nextUntil:function(e,t,n){return R.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return R.dir(e,"previousSibling",n)},siblings:function(e){return R.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return R.sibling(e.firstChild)},contents:function(e){return R.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:R.makeArray(e.childNodes)}},function(e,t){R.fn[e]=function(n,i){var a=R.map(this,t,n);return st.test(e)||(i=n),i&&"string"==typeof i&&(a=R.filter(i,a)),a=this.length>1&&!pt[e]?R.unique(a):a,(this.length>1||dt.test(i))&&lt.test(e)&&(a=a.reverse()),this.pushStack(a,e,ut.call(arguments).join(","))}}),R.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?R.find.matchesSelector(t[0],e)?[t[0]]:[]:R.find.matches(e,t)},dir:function(e,n,i){for(var a=[],r=e[n];r&&9!==r.nodeType&&(i===t||1!==r.nodeType||!R(r).is(i));)1===r.nodeType&&a.push(r),r=r[n];return a},nth:function(e,t,n){t=t||1;for(var i=0;e&&(1!==e.nodeType||++i!==t);e=e[n]);return e},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var ft="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:\d+|null)"/g,mt=/^\s+/,bt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,yt=/<tbody/i,_t=/<|&#?\w+;/,wt=/<(?:script|style)/i,Ct=/<(?:script|object|embed|option|style)/i,kt=new RegExp("<(?:"+ft+")[\\s/>]","i"),xt=/checked\s*(?:[^=]|=\s*.checked.)/i,St=/\/(java|ecma)script/i,jt=/^\s*<!(?:\[CDATA\[|\-\-)/,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Tt=c(O);Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,R.support.htmlSerialize||(Nt._default=[1,"div<div>","</div>"]),R.fn.extend({text:function(e){return R.access(this,function(e){return e===t?R.text(this):this.empty().append((this[0]&&this[0].ownerDocument||O).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(R.isFunction(e))return this.each(function(t){R(this).wrapAll(e.call(this,t))});if(this[0]){var t=R(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(R.isFunction(e)?function(t){R(this).wrapInner(e.call(this,t))}:function(){var t=R(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=R.isFunction(e);return this.each(function(n){R(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){R.nodeName(this,"body")||R(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){1===this.nodeType&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){1===this.nodeType&&this.insertBefore(e,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=R.clean(arguments);return e.push.apply(e,this.toArray()),this.pushStack(e,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=this.pushStack(this,"after",arguments);return e.push.apply(e,R.clean(arguments)),e}},remove:function(e,t){for(var n,i=0;null!=(n=this[i]);i++)(!e||R.filter(e,[n]).length)&&(t||1!==n.nodeType||(R.cleanData(n.getElementsByTagName("*")),R.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)for(1===e.nodeType&&R.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return R.clone(this,e,t)})},html:function(e){return R.access(this,function(e){var n=this[0]||{},i=0,a=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,""):null;if(!("string"!=typeof e||wt.test(e)||!R.support.leadingWhitespace&&mt.test(e)||Nt[(vt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(bt,"<$1></$2>");try{for(;a>i;i++)n=this[i]||{},1===n.nodeType&&(R.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(r){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return this[0]&&this[0].parentNode?R.isFunction(e)?this.each(function(t){var n=R(this),i=n.html();n.replaceWith(e.call(this,t,i))}):("string"!=typeof e&&(e=R(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;R(this).remove(),t?R(t).before(e):R(n).append(e)})):this.length?this.pushStack(R(R.isFunction(e)?e():e),"replaceWith",e):this},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,i){var a,r,o,s,l=e[0],d=[];if(!R.support.checkClone&&3===arguments.length&&"string"==typeof l&&xt.test(l))return this.each(function(){R(this).domManip(e,n,i,!0)});if(R.isFunction(l))return this.each(function(a){var r=R(this);e[0]=l.call(this,a,n?r.html():t),r.domManip(e,n,i)});if(this[0]){if(s=l&&l.parentNode,a=R.support.parentNode&&s&&11===s.nodeType&&s.childNodes.length===this.length?{fragment:s}:R.buildFragment(e,this,d),o=a.fragment,r=1===o.childNodes.length?o=o.firstChild:o.firstChild){n=n&&R.nodeName(r,"tr");for(var c=0,h=this.length,p=h-1;h>c;c++)i.call(n?u(this[c],r):this[c],a.cacheable||h>1&&p>c?R.clone(o,!0,!0):o)}d.length&&R.each(d,function(e,t){t.src?R.ajax({type:"GET",global:!1,url:t.src,async:!1,dataType:"script"}):R.globalEval((t.text||t.textContent||t.innerHTML||"").replace(jt,"/*$0*/")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),R.buildFragment=function(e,t,n){var i,a,r,o,s=e[0];return t&&t[0]&&(o=t[0].ownerDocument||t[0]),o.createDocumentFragment||(o=O),!(1===e.length&&"string"==typeof s&&s.length<512&&o===O&&"<"===s.charAt(0))||Ct.test(s)||!R.support.checkClone&&xt.test(s)||!R.support.html5Clone&&kt.test(s)||(a=!0,r=R.fragments[s],r&&1!==r&&(i=r)),i||(i=o.createDocumentFragment(),R.clean(e,o,i,n)),a&&(R.fragments[s]=r?i:1),{fragment:i,cacheable:a}},R.fragments={},R.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){R.fn[e]=function(n){var i=[],a=R(n),r=1===this.length&&this[0].parentNode;if(r&&11===r.nodeType&&1===r.childNodes.length&&1===a.length)return a[t](this[0]),this;for(var o=0,s=a.length;s>o;o++){var l=(o>0?this.clone(!0):this).get();R(a[o])[t](l),i=i.concat(l)}return this.pushStack(i,e,a.selector)}}),R.extend({clone:function(e,t,n){var i,a,r,o=R.support.html5Clone||R.isXMLDoc(e)||!kt.test("<"+e.nodeName+">")?e.cloneNode(!0):b(e);if(!(R.support.noCloneEvent&&R.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||R.isXMLDoc(e)))for(p(e,o),i=f(e),a=f(o),r=0;i[r];++r)a[r]&&p(i[r],a[r]);if(t&&(h(e,o),n))for(i=f(e),a=f(o),r=0;i[r];++r)h(i[r],a[r]);return i=a=null,o},clean:function(e,t,n,i){var a,r,o,s=[];t=t||O,"undefined"==typeof t.createElement&&(t=t.ownerDocument||t[0]&&t[0].ownerDocument||O);for(var l,d=0;null!=(l=e[d]);d++)if("number"==typeof l&&(l+=""),l){if("string"==typeof l)if(_t.test(l)){l=l.replace(bt,"<$1></$2>");var u,h=(vt.exec(l)||["",""])[1].toLowerCase(),p=Nt[h]||Nt._default,f=p[0],g=t.createElement("div"),b=Tt.childNodes;for(t===O?Tt.appendChild(g):c(t).appendChild(g),g.innerHTML=p[1]+l+p[2];f--;)g=g.lastChild;if(!R.support.tbody){var v=yt.test(l),y="table"!==h||v?"<table>"!==p[1]||v?[]:g.childNodes:g.firstChild&&g.firstChild.childNodes;for(o=y.length-1;o>=0;--o)R.nodeName(y[o],"tbody")&&!y[o].childNodes.length&&y[o].parentNode.removeChild(y[o])}!R.support.leadingWhitespace&&mt.test(l)&&g.insertBefore(t.createTextNode(mt.exec(l)[0]),g.firstChild),l=g.childNodes,g&&(g.parentNode.removeChild(g),b.length>0&&(u=b[b.length-1],u&&u.parentNode&&u.parentNode.removeChild(u)))}else l=t.createTextNode(l);var _;if(!R.support.appendChecked)if(l[0]&&"number"==typeof(_=l.length))for(o=0;_>o;o++)m(l[o]);else m(l);l.nodeType?s.push(l):s=R.merge(s,l)}if(n)for(a=function(e){return!e.type||St.test(e.type)},d=0;s[d];d++)if(r=s[d],i&&R.nodeName(r,"script")&&(!r.type||St.test(r.type)))i.push(r.parentNode?r.parentNode.removeChild(r):r);else{if(1===r.nodeType){var w=R.grep(r.getElementsByTagName("script"),a);s.splice.apply(s,[d+1,0].concat(w))}n.appendChild(r)}return s},cleanData:function(e){for(var t,n,i,a=R.cache,r=R.event.special,o=R.support.deleteExpando,s=0;null!=(i=e[s]);s++)if((!i.nodeName||!R.noData[i.nodeName.toLowerCase()])&&(n=i[R.expando])){if(t=a[n],t&&t.events){for(var l in t.events)r[l]?R.event.remove(i,l):R.removeEvent(i,l,t.handle);t.handle&&(t.handle.elem=null)}o?delete i[R.expando]:i.removeAttribute&&i.removeAttribute(R.expando),delete a[n]}}});var Et,At,Dt,Ot=/alpha\([^)]*\)/i,It=/opacity=([^)]*)/,Mt=/([A-Z]|^ms)/g,Rt=/^[\-+]?(?:\d*\.)?\d+$/i,Pt=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,Ft=/^([\-+])=([\-+.\de]+)/,zt=/^margin/,Bt={position:"absolute",visibility:"hidden",display:"block"},Lt=["Top","Right","Bottom","Left"];R.fn.css=function(e,n){return R.access(this,function(e,n,i){return i!==t?R.style(e,n,i):R.css(e,n)},e,n,arguments.length>1)},R.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Et(e,"opacity");return""===n?"1":n}return e.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":R.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,i,a){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,s=R.camelCase(n),l=e.style,d=R.cssHooks[s];if(n=R.cssProps[s]||s,i===t)return d&&"get"in d&&(r=d.get(e,!1,a))!==t?r:l[n];if(o=typeof i,"string"===o&&(r=Ft.exec(i))&&(i=+(r[1]+1)*+r[2]+parseFloat(R.css(e,n)),o="number"),!(null==i||"number"===o&&isNaN(i)||("number"!==o||R.cssNumber[s]||(i+="px"),d&&"set"in d&&(i=d.set(e,i))===t)))try{l[n]=i}catch(c){}}},css:function(e,n,i){var a,r;return n=R.camelCase(n),r=R.cssHooks[n],n=R.cssProps[n]||n,"cssFloat"===n&&(n="float"),r&&"get"in r&&(a=r.get(e,!0,i))!==t?a:Et?Et(e,n):void 0},swap:function(e,t,n){var i,a,r={};for(a in t)r[a]=e.style[a],e.style[a]=t[a];i=n.call(e);for(a in t)e.style[a]=r[a];return i}}),R.curCSS=R.css,O.defaultView&&O.defaultView.getComputedStyle&&(At=function(e,t){var n,i,a,r,o=e.style;return t=t.replace(Mt,"-$1").toLowerCase(),(i=e.ownerDocument.defaultView)&&(a=i.getComputedStyle(e,null))&&(n=a.getPropertyValue(t),""!==n||R.contains(e.ownerDocument.documentElement,e)||(n=R.style(e,t))),!R.support.pixelMargin&&a&&zt.test(t)&&Pt.test(n)&&(r=o.width,o.width=n,n=a.width,o.width=r),n}),O.documentElement.currentStyle&&(Dt=function(e,t){var n,i,a,r=e.currentStyle&&e.currentStyle[t],o=e.style;return null==r&&o&&(a=o[t])&&(r=a),Pt.test(r)&&(n=o.left,i=e.runtimeStyle&&e.runtimeStyle.left,i&&(e.runtimeStyle.left=e.currentStyle.left),o.left="fontSize"===t?"1em":r,r=o.pixelLeft+"px",o.left=n,i&&(e.runtimeStyle.left=i)),""===r?"auto":r}),Et=At||Dt,R.each(["height","width"],function(e,t){R.cssHooks[t]={get:function(e,n,i){return n?0!==e.offsetWidth?v(e,t,i):R.swap(e,Bt,function(){return v(e,t,i)}):void 0},set:function(e,t){return Rt.test(t)?t+"px":t}}}),R.support.opacity||(R.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,a=R.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=i&&i.filter||n.filter||"";n.zoom=1,t>=1&&""===R.trim(r.replace(Ot,""))&&(n.removeAttribute("filter"),i&&!i.filter)||(n.filter=Ot.test(r)?r.replace(Ot,a):r+" "+a)}}),R(function(){R.support.reliableMarginRight||(R.cssHooks.marginRight={get:function(e,t){return R.swap(e,{display:"inline-block"},function(){return t?Et(e,"margin-right"):e.style.marginRight})}})}),R.expr&&R.expr.filters&&(R.expr.filters.hidden=function(e){var t=e.offsetWidth,n=e.offsetHeight;return 0===t&&0===n||!R.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||R.css(e,"display"))},R.expr.filters.visible=function(e){return!R.expr.filters.hidden(e)}),R.each({margin:"",padding:"",border:"Width"},function(e,t){R.cssHooks[e+t]={expand:function(n){var i,a="string"==typeof n?n.split(" "):[n],r={};for(i=0;4>i;i++)r[e+Lt[i]+t]=a[i]||a[i-2]||a[0];return r}}});var qt,Ht,$t=/%20/g,Wt=/\[\]$/,Gt=/\r?\n/g,Ut=/#.*$/,Kt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Vt=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Yt=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,Xt=/^(?:GET|HEAD)$/,Qt=/^\/\//,Jt=/\?/,Zt=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,en=/^(?:select|textarea)/i,tn=/\s+/,nn=/([?&])_=[^&]*/,an=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,rn=R.fn.load,on={},sn={},ln=["*/"]+["*"];try{qt=M.href}catch(dn){qt=O.createElement("a"),qt.href="",qt=qt.href}Ht=an.exec(qt.toLowerCase())||[],R.fn.extend({load:function(e,n,i){if("string"!=typeof e&&rn)return rn.apply(this,arguments);if(!this.length)return this;var a=e.indexOf(" ");if(a>=0){var r=e.slice(a,e.length);e=e.slice(0,a)}var o="GET";n&&(R.isFunction(n)?(i=n,n=t):"object"==typeof n&&(n=R.param(n,R.ajaxSettings.traditional),o="POST"));var s=this;return R.ajax({url:e,type:o,dataType:"html",data:n,complete:function(e,t,n){n=e.responseText,e.isResolved()&&(e.done(function(e){n=e}),s.html(r?R("<div>").append(n.replace(Zt,"")).find(r):n)),i&&s.each(i,[n,t,e])}}),this},serialize:function(){return R.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?R.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||en.test(this.nodeName)||Vt.test(this.type))}).map(function(e,t){var n=R(this).val();return null==n?null:R.isArray(n)?R.map(n,function(e){return{name:t.name,value:e.replace(Gt,"\r\n")}}):{name:t.name,value:n.replace(Gt,"\r\n")}}).get()}}),R.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){R.fn[t]=function(e){return this.on(t,e)}}),R.each(["get","post"],function(e,n){R[n]=function(e,i,a,r){return R.isFunction(i)&&(r=r||a,a=i,i=t),R.ajax({type:n,url:e,data:i,success:a,dataType:r})}}),R.extend({getScript:function(e,n){return R.get(e,t,n,"script")},getJSON:function(e,t,n){return R.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?w(e,R.ajaxSettings):(t=e,e=R.ajaxSettings),w(e,t),e},ajaxSettings:{url:qt,isLocal:Yt.test(Ht[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":ln},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":R.parseJSON,"text xml":R.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:y(on),ajaxTransport:y(sn),ajax:function(e,n){function i(e,n,i,o){if(2!==w){w=2,l&&clearTimeout(l),s=t,r=o||"",C.readyState=e>0?4:0;var d,u,v,y,_,S=n,j=i?k(h,C,i):t;if(e>=200&&300>e||304===e)if(h.ifModified&&((y=C.getResponseHeader("Last-Modified"))&&(R.lastModified[a]=y),(_=C.getResponseHeader("Etag"))&&(R.etag[a]=_)),304===e)S="notmodified",d=!0;else try{u=x(h,j),S="success",d=!0}catch(N){S="parsererror",v=N}else v=S,(!S||e)&&(S="error",0>e&&(e=0));C.status=e,C.statusText=""+(n||S),d?g.resolveWith(p,[u,S,C]):g.rejectWith(p,[C,S,v]),C.statusCode(b),b=t,c&&f.trigger("ajax"+(d?"Success":"Error"),[C,h,d?u:v]),m.fireWith(p,[C,S]),c&&(f.trigger("ajaxComplete",[C,h]),--R.active||R.event.trigger("ajaxStop"))}}"object"==typeof e&&(n=e,e=t),n=n||{};var a,r,o,s,l,d,c,u,h=R.ajaxSetup({},n),p=h.context||h,f=p!==h&&(p.nodeType||p instanceof R)?R(p):R.event,g=R.Deferred(),m=R.Callbacks("once memory"),b=h.statusCode||{},v={},y={},w=0,C={readyState:0,setRequestHeader:function(e,t){if(!w){var n=e.toLowerCase();e=y[n]=y[n]||e,v[e]=t}return this},getAllResponseHeaders:function(){return 2===w?r:null},getResponseHeader:function(e){var n;if(2===w){if(!o)for(o={};n=Kt.exec(r);)o[n[1].toLowerCase()]=n[2];n=o[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return w||(h.mimeType=e),this},abort:function(e){return e=e||"abort",s&&s.abort(e),i(0,e),this}};if(g.promise(C),C.success=C.done,C.error=C.fail,C.complete=m.add,C.statusCode=function(e){if(e){var t;if(2>w)for(t in e)b[t]=[b[t],e[t]];else t=e[C.status],C.then(t,t)}return this},h.url=((e||h.url)+"").replace(Ut,"").replace(Qt,Ht[1]+"//"),h.dataTypes=R.trim(h.dataType||"*").toLowerCase().split(tn),null==h.crossDomain&&(d=an.exec(h.url.toLowerCase()),h.crossDomain=!(!d||d[1]==Ht[1]&&d[2]==Ht[2]&&(d[3]||("http:"===d[1]?80:443))==(Ht[3]||("http:"===Ht[1]?80:443)))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=R.param(h.data,h.traditional)),_(on,h,n,C),2===w)return!1;if(c=h.global,h.type=h.type.toUpperCase(),h.hasContent=!Xt.test(h.type),c&&0===R.active++&&R.event.trigger("ajaxStart"),!h.hasContent&&(h.data&&(h.url+=(Jt.test(h.url)?"&":"?")+h.data,delete h.data),a=h.url,h.cache===!1)){var S=R.now(),j=h.url.replace(nn,"$1_="+S);h.url=j+(j===h.url?(Jt.test(h.url)?"&":"?")+"_="+S:"")}(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",h.contentType),h.ifModified&&(a=a||h.url,R.lastModified[a]&&C.setRequestHeader("If-Modified-Since",R.lastModified[a]),R.etag[a]&&C.setRequestHeader("If-None-Match",R.etag[a])),C.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+ln+"; q=0.01":""):h.accepts["*"]);for(u in h.headers)C.setRequestHeader(u,h.headers[u]);if(h.beforeSend&&(h.beforeSend.call(p,C,h)===!1||2===w))return C.abort(),!1;for(u in{success:1,error:1,complete:1})C[u](h[u]);if(s=_(sn,h,n,C)){C.readyState=1,c&&f.trigger("ajaxSend",[C,h]),h.async&&h.timeout>0&&(l=setTimeout(function(){C.abort("timeout")},h.timeout));try{w=1,s.send(v,i)}catch(N){if(!(2>w))throw N;i(-1,N)}}else i(-1,"No Transport");return C},param:function(e,n){var i=[],a=function(e,t){t=R.isFunction(t)?t():t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=R.ajaxSettings.traditional),R.isArray(e)||e.jquery&&!R.isPlainObject(e))R.each(e,function(){a(this.name,this.value)});else for(var r in e)C(r,e[r],n,a);return i.join("&").replace($t,"+")}}),R.extend({active:0,lastModified:{},etag:{}});var cn=R.now(),un=/(\=)\?(&|$)|\?\?/i;R.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return R.expando+"_"+cn++}}),R.ajaxPrefilter("json jsonp",function(t,n,i){var a="string"==typeof t.data&&/^application\/x\-www\-form\-urlencoded/.test(t.contentType);if("jsonp"===t.dataTypes[0]||t.jsonp!==!1&&(un.test(t.url)||a&&un.test(t.data))){var r,o=t.jsonpCallback=R.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s=e[o],l=t.url,d=t.data,c="$1"+o+"$2";
return t.jsonp!==!1&&(l=l.replace(un,c),t.url===l&&(a&&(d=d.replace(un,c)),t.data===d&&(l+=(/\?/.test(l)?"&":"?")+t.jsonp+"="+o))),t.url=l,t.data=d,e[o]=function(e){r=[e]},i.always(function(){e[o]=s,r&&R.isFunction(s)&&e[o](r[0])}),t.converters["script json"]=function(){return r||R.error(o+" was not called"),r[0]},t.dataTypes[0]="json","script"}}),R.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return R.globalEval(e),e}}}),R.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),R.ajaxTransport("script",function(e){if(e.crossDomain){var n,i=O.head||O.getElementsByTagName("head")[0]||O.documentElement;return{send:function(a,r){n=O.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,a){(a||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),n=t,a||r(200,"success"))},i.insertBefore(n,i.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var hn,pn=e.ActiveXObject?function(){for(var e in hn)hn[e](0,1)}:!1,fn=0;R.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&S()||j()}:S,function(e){R.extend(R.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(R.ajaxSettings.xhr()),R.support.ajax&&R.ajaxTransport(function(n){if(!n.crossDomain||R.support.cors){var i;return{send:function(a,r){var o,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||a["X-Requested-With"]||(a["X-Requested-With"]="XMLHttpRequest");try{for(s in a)l.setRequestHeader(s,a[s])}catch(d){}l.send(n.hasContent&&n.data||null),i=function(e,a){var s,d,c,u,h;try{if(i&&(a||4===l.readyState))if(i=t,o&&(l.onreadystatechange=R.noop,pn&&delete hn[o]),a)4!==l.readyState&&l.abort();else{s=l.status,c=l.getAllResponseHeaders(),u={},h=l.responseXML,h&&h.documentElement&&(u.xml=h);try{u.text=l.responseText}catch(e){}try{d=l.statusText}catch(p){d=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=u.text?200:404}}catch(f){a||r(-1,f)}u&&r(s,d,u,c)},n.async&&4!==l.readyState?(o=++fn,pn&&(hn||(hn={},R(e).unload(pn)),hn[o]=i),l.onreadystatechange=i):i()},abort:function(){i&&i(0,1)}}}});var gn,mn,bn,vn,yn={},_n=/^(?:toggle|show|hide)$/,wn=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,Cn=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];R.fn.extend({show:function(e,t,n){var i,a;if(e||0===e)return this.animate(E("show",3),e,t,n);for(var r=0,o=this.length;o>r;r++)i=this[r],i.style&&(a=i.style.display,R._data(i,"olddisplay")||"none"!==a||(a=i.style.display=""),(""===a&&"none"===R.css(i,"display")||!R.contains(i.ownerDocument.documentElement,i))&&R._data(i,"olddisplay",A(i.nodeName)));for(r=0;o>r;r++)i=this[r],i.style&&(a=i.style.display,(""===a||"none"===a)&&(i.style.display=R._data(i,"olddisplay")||""));return this},hide:function(e,t,n){if(e||0===e)return this.animate(E("hide",3),e,t,n);for(var i,a,r=0,o=this.length;o>r;r++)i=this[r],i.style&&(a=R.css(i,"display"),"none"===a||R._data(i,"olddisplay")||R._data(i,"olddisplay",a));for(r=0;o>r;r++)this[r].style&&(this[r].style.display="none");return this},_toggle:R.fn.toggle,toggle:function(e,t,n){var i="boolean"==typeof e;return R.isFunction(e)&&R.isFunction(t)?this._toggle.apply(this,arguments):null==e||i?this.each(function(){var t=i?e:R(this).is(":hidden");R(this)[t?"show":"hide"]()}):this.animate(E("toggle",3),e,t,n),this},fadeTo:function(e,t,n,i){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){function a(){r.queue===!1&&R._mark(this);var t,n,i,a,o,s,l,d,c,u,h,p=R.extend({},r),f=1===this.nodeType,g=f&&R(this).is(":hidden");p.animatedProperties={};for(i in e)if(t=R.camelCase(i),i!==t&&(e[t]=e[i],delete e[i]),(o=R.cssHooks[t])&&"expand"in o){s=o.expand(e[t]),delete e[t];for(i in s)i in e||(e[i]=s[i])}for(t in e){if(n=e[t],R.isArray(n)?(p.animatedProperties[t]=n[1],n=e[t]=n[0]):p.animatedProperties[t]=p.specialEasing&&p.specialEasing[t]||p.easing||"swing","hide"===n&&g||"show"===n&&!g)return p.complete.call(this);!f||"height"!==t&&"width"!==t||(p.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===R.css(this,"display")&&"none"===R.css(this,"float")&&(R.support.inlineBlockNeedsLayout&&"inline"!==A(this.nodeName)?this.style.zoom=1:this.style.display="inline-block"))}null!=p.overflow&&(this.style.overflow="hidden");for(i in e)a=new R.fx(this,p,i),n=e[i],_n.test(n)?(h=R._data(this,"toggle"+i)||("toggle"===n?g?"show":"hide":0),h?(R._data(this,"toggle"+i,"show"===h?"hide":"show"),a[h]()):a[n]()):(l=wn.exec(n),d=a.cur(),l?(c=parseFloat(l[2]),u=l[3]||(R.cssNumber[i]?"":"px"),"px"!==u&&(R.style(this,i,(c||1)+u),d=(c||1)/a.cur()*d,R.style(this,i,d+u)),l[1]&&(c=("-="===l[1]?-1:1)*c+d),a.custom(d,c,u)):a.custom(d,n,""));return!0}var r=R.speed(t,n,i);return R.isEmptyObject(e)?this.each(r.complete,[!1]):(e=R.extend({},e),r.queue===!1?this.each(a):this.queue(r.queue,a))},stop:function(e,n,i){return"string"!=typeof e&&(i=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){function t(e,t,n){var a=t[n];R.removeData(e,n,!0),a.stop(i)}var n,a=!1,r=R.timers,o=R._data(this);if(i||R._unmark(!0,this),null==e)for(n in o)o[n]&&o[n].stop&&n.indexOf(".run")===n.length-4&&t(this,o,n);else o[n=e+".run"]&&o[n].stop&&t(this,o,n);for(n=r.length;n--;)r[n].elem!==this||null!=e&&r[n].queue!==e||(i?r[n](!0):r[n].saveState(),a=!0,r.splice(n,1));i&&a||R.dequeue(this,e)})}}),R.each({slideDown:E("show",1),slideUp:E("hide",1),slideToggle:E("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){R.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),R.extend({speed:function(e,t,n){var i=e&&"object"==typeof e?R.extend({},e):{complete:n||!n&&t||R.isFunction(e)&&e,duration:e,easing:n&&t||t&&!R.isFunction(t)&&t};return i.duration=R.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in R.fx.speeds?R.fx.speeds[i.duration]:R.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(e){R.isFunction(i.old)&&i.old.call(this),i.queue?R.dequeue(this,i.queue):e!==!1&&R._unmark(this)},i},easing:{linear:function(e){return e},swing:function(e){return-Math.cos(e*Math.PI)/2+.5}},timers:[],fx:function(e,t,n){this.options=t,this.elem=e,this.prop=n,t.orig=t.orig||{}}}),R.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(R.fx.step[this.prop]||R.fx.step._default)(this)},cur:function(){if(null!=this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];var e,t=R.css(this.elem,this.prop);return isNaN(e=parseFloat(t))?t&&"auto"!==t?t:0:e},custom:function(e,n,i){function a(e){return r.step(e)}var r=this,o=R.fx;this.startTime=vn||N(),this.end=n,this.now=this.start=e,this.pos=this.state=0,this.unit=i||this.unit||(R.cssNumber[this.prop]?"":"px"),a.queue=this.options.queue,a.elem=this.elem,a.saveState=function(){R._data(r.elem,"fxshow"+r.prop)===t&&(r.options.hide?R._data(r.elem,"fxshow"+r.prop,r.start):r.options.show&&R._data(r.elem,"fxshow"+r.prop,r.end))},a()&&R.timers.push(a)&&!bn&&(bn=setInterval(o.tick,o.interval))},show:function(){var e=R._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=e||R.style(this.elem,this.prop),this.options.show=!0,e!==t?this.custom(this.cur(),e):this.custom("width"===this.prop||"height"===this.prop?1:0,this.cur()),R(this.elem).show()},hide:function(){this.options.orig[this.prop]=R._data(this.elem,"fxshow"+this.prop)||R.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(e){var t,n,i,a=vn||N(),r=!0,o=this.elem,s=this.options;if(e||a>=s.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),s.animatedProperties[this.prop]=!0;for(t in s.animatedProperties)s.animatedProperties[t]!==!0&&(r=!1);if(r){if(null==s.overflow||R.support.shrinkWrapBlocks||R.each(["","X","Y"],function(e,t){o.style["overflow"+t]=s.overflow[e]}),s.hide&&R(o).hide(),s.hide||s.show)for(t in s.animatedProperties)R.style(o,t,s.orig[t]),R.removeData(o,"fxshow"+t,!0),R.removeData(o,"toggle"+t,!0);i=s.complete,i&&(s.complete=!1,i.call(o))}return!1}return 1/0==s.duration?this.now=a:(n=a-this.startTime,this.state=n/s.duration,this.pos=R.easing[s.animatedProperties[this.prop]](this.state,n,0,1,s.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},R.extend(R.fx,{tick:function(){for(var e,t=R.timers,n=0;n<t.length;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||R.fx.stop()},interval:13,stop:function(){clearInterval(bn),bn=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(e){R.style(e.elem,"opacity",e.now)},_default:function(e){e.elem.style&&null!=e.elem.style[e.prop]?e.elem.style[e.prop]=e.now+e.unit:e.elem[e.prop]=e.now}}}),R.each(Cn.concat.apply([],Cn),function(e,t){t.indexOf("margin")&&(R.fx.step[t]=function(e){R.style(e.elem,t,Math.max(0,e.now)+e.unit)})}),R.expr&&R.expr.filters&&(R.expr.filters.animated=function(e){return R.grep(R.timers,function(t){return e===t.elem}).length});var kn,xn=/^t(?:able|d|h)$/i,Sn=/^(?:body|html)$/i;kn="getBoundingClientRect"in O.documentElement?function(e,t,n,i){try{i=e.getBoundingClientRect()}catch(a){}if(!i||!R.contains(n,e))return i?{top:i.top,left:i.left}:{top:0,left:0};var r=t.body,o=D(t),s=n.clientTop||r.clientTop||0,l=n.clientLeft||r.clientLeft||0,d=o.pageYOffset||R.support.boxModel&&n.scrollTop||r.scrollTop,c=o.pageXOffset||R.support.boxModel&&n.scrollLeft||r.scrollLeft,u=i.top+d-s,h=i.left+c-l;return{top:u,left:h}}:function(e,t,n){for(var i,a=e.offsetParent,r=e,o=t.body,s=t.defaultView,l=s?s.getComputedStyle(e,null):e.currentStyle,d=e.offsetTop,c=e.offsetLeft;(e=e.parentNode)&&e!==o&&e!==n&&(!R.support.fixedPosition||"fixed"!==l.position);)i=s?s.getComputedStyle(e,null):e.currentStyle,d-=e.scrollTop,c-=e.scrollLeft,e===a&&(d+=e.offsetTop,c+=e.offsetLeft,!R.support.doesNotAddBorder||R.support.doesAddBorderForTableAndCells&&xn.test(e.nodeName)||(d+=parseFloat(i.borderTopWidth)||0,c+=parseFloat(i.borderLeftWidth)||0),r=a,a=e.offsetParent),R.support.subtractsBorderForOverflowNotVisible&&"visible"!==i.overflow&&(d+=parseFloat(i.borderTopWidth)||0,c+=parseFloat(i.borderLeftWidth)||0),l=i;return("relative"===l.position||"static"===l.position)&&(d+=o.offsetTop,c+=o.offsetLeft),R.support.fixedPosition&&"fixed"===l.position&&(d+=Math.max(n.scrollTop,o.scrollTop),c+=Math.max(n.scrollLeft,o.scrollLeft)),{top:d,left:c}},R.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){R.offset.setOffset(this,e,t)});var n=this[0],i=n&&n.ownerDocument;return i?n===i.body?R.offset.bodyOffset(n):kn(n,i,i.documentElement):null},R.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return R.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(R.css(e,"marginTop"))||0,n+=parseFloat(R.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var i=R.css(e,"position");"static"===i&&(e.style.position="relative");var a,r,o=R(e),s=o.offset(),l=R.css(e,"top"),d=R.css(e,"left"),c=("absolute"===i||"fixed"===i)&&R.inArray("auto",[l,d])>-1,u={},h={};c?(h=o.position(),a=h.top,r=h.left):(a=parseFloat(l)||0,r=parseFloat(d)||0),R.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(u.top=t.top-s.top+a),null!=t.left&&(u.left=t.left-s.left+r),"using"in t?t.using.call(e,u):o.css(u)}},R.fn.extend({position:function(){if(!this[0])return null;var e=this[0],t=this.offsetParent(),n=this.offset(),i=Sn.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(R.css(e,"marginTop"))||0,n.left-=parseFloat(R.css(e,"marginLeft"))||0,i.top+=parseFloat(R.css(t[0],"borderTopWidth"))||0,i.left+=parseFloat(R.css(t[0],"borderLeftWidth"))||0,{top:n.top-i.top,left:n.left-i.left}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||O.body;e&&!Sn.test(e.nodeName)&&"static"===R.css(e,"position");)e=e.offsetParent;return e})}}),R.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var i=/Y/.test(n);R.fn[e]=function(a){return R.access(this,function(e,a,r){var o=D(e);return r===t?o?n in o?o[n]:R.support.boxModel&&o.document.documentElement[a]||o.document.body[a]:e[a]:void(o?o.scrollTo(i?R(o).scrollLeft():r,i?r:R(o).scrollTop()):e[a]=r)},e,a,arguments.length,null)}}),R.each({Height:"height",Width:"width"},function(e,n){var i="client"+e,a="scroll"+e,r="offset"+e;R.fn["inner"+e]=function(){var e=this[0];return e?e.style?parseFloat(R.css(e,n,"padding")):this[n]():null},R.fn["outer"+e]=function(e){var t=this[0];return t?t.style?parseFloat(R.css(t,n,e?"margin":"border")):this[n]():null},R.fn[n]=function(e){return R.access(this,function(e,n,o){var s,l,d,c;return R.isWindow(e)?(s=e.document,l=s.documentElement[i],R.support.boxModel&&l||s.body&&s.body[i]||l):9===e.nodeType?(s=e.documentElement,s[i]>=s[a]?s[i]:Math.max(e.body[a],s[a],e.body[r],s[r])):o===t?(d=R.css(e,n),c=parseFloat(d),R.isNumeric(c)?c:d):void R(e).css(n,o)},n,e,arguments.length,null)}}),e.jQuery=e.$=R,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return R}),R.support.getSetAttribute||(R.removeAttr=function(e,t){"class"===t&&(t="className"),e.removeAttribute(t)})}(window),Aloha=window.Aloha||{},Aloha.settings=Aloha.settings||{},Aloha.settings.jQuery=Aloha.settings.jQuery||jQuery.noConflict(!0),function(){function Sanitize(){var e;e=arguments[0]||{},this.jQuery=arguments[1]||{},this.config={},this.config.elements=e.elements?e.elements:[],this.config.attributes=e.attributes?e.attributes:{},this.config.attributes[Sanitize.ALL]=this.config.attributes[Sanitize.ALL]?this.config.attributes[Sanitize.ALL]:[],this.config.allow_comments=e.allow_comments?e.allow_comments:!1,this.allowed_elements={},this.config.protocols=e.protocols?e.protocols:{},this.config.add_attributes=e.add_attributes?e.add_attributes:{},this.dom=e.dom?e.dom:document;for(var t=0,n=this.config.elements.length;n>t;t++)this.allowed_elements[this.config.elements[t]]=!0;if(this.config.remove_element_contents={},this.config.remove_all_contents=!1,e.remove_contents)if(e.remove_contents instanceof Array)for(var i=this.config.remove_element_contents,t=0,n=e.remove_contents.length;n>t;t++)i[e.remove_contents[t]]=!0;else this.config.remove_all_contents=!0;this.transformers=e.transformers?e.transformers:[],this.filters=e.filters?e.filters:[]}var JSON;JSON||(JSON={}),function(){function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,a,r,o,s=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,n=0;r>n;n+=1)o[n]=str(n,l)||"null";return a=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]",gap=s,a}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;r>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],a=str(i,l),a&&o.push(quote(i)+(gap?": ":":")+a));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(a=str(i,l),a&&o.push(quote(i)+(gap?": ":":")+a));return a=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}",gap=s,a}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,i,a=e[t];if(a&&"object"==typeof a)for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(i=walk(a,n),void 0!==i?a[n]=i:delete a[n]);return reviver.call(e,t,a)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("util/json2",[],function(){return JSON}),function(){var e=function(){function e(e,t){var n=typeof e[t];return n==u||!(n!=c||!e[t])||"unknown"==n}function t(e,t){return!(typeof e[t]!=c||!e[t])}function n(e,t){return typeof e[t]!=h}function i(e){return function(t,n){for(var i=n.length;i--;)if(!e(t,n[i]))return!1;return!0}}function a(e){return e&&b(e,m)&&y(e,g)}function r(e){window.alert("Rangy not supported in your browser. Reason: "+e),_.initialized=!0,_.supported=!1}function o(e){var t="Rangy warning: "+e;_.config.alertOnWarn?window.alert(t):typeof window.console!=h&&typeof window.console.log!=h&&window.console.log(t)}function s(){if(!_.initialized){var n,i=!1,o=!1;e(document,"createRange")&&(n=document.createRange(),b(n,f)&&y(n,p)&&(i=!0),n.detach());var s=t(document,"body")?document.body:document.getElementsByTagName("body")[0];s&&e(s,"createTextRange")&&(n=s.createTextRange(),a(n)&&(o=!0)),i||o||r("Neither Range nor TextRange are implemented"),_.initialized=!0,_.features={implementsDomRange:i,implementsTextRange:o};for(var l=C.concat(w),d=0,c=l.length;c>d;++d)try{l[d](_)}catch(u){t(window,"console")&&e(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",u)}}}function l(e){e=e||window,s();for(var t=0,n=k.length;n>t;++t)k[t](e)}function d(e){this.name=e,this.initialized=!1,this.supported=!1}var c="object",u="function",h="undefined",p=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],f=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],g=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],m=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"],b=i(e),v=i(t),y=i(n),_={version:"1.2.1",initialized:!1,supported:!0,util:{isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:b,areHostObjects:v,areHostProperties:y,isTextRange:a},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};_.fail=r,_.warn=o,{}.hasOwnProperty?_.util.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}:r("hasOwnProperty not supported");var w=[],C=[];_.init=s,_.addInitListener=function(e){_.initialized?e(_):w.push(e)};var k=[];_.addCreateMissingNativeApiListener=function(e){k.push(e)},_.createMissingNativeApi=l,d.prototype.fail=function(e){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+e)},d.prototype.warn=function(e){_.warn("Module "+this.name+": "+e)},d.prototype.createError=function(e){return new Error("Error in Rangy "+this.name+" module: "+e)},_.createModule=function(e,t){var n=new d(e);_.modules[e]=n,C.push(function(e){t(e,n),n.initialized=!0,n.supported=!0})},_.requireModules=function(e){for(var t,n,i=0,a=e.length;a>i;++i){if(n=e[i],t=_.modules[n],!(t&&t instanceof d))throw new Error("Module '"+n+"' not found");if(!t.supported)throw new Error("Module '"+n+"' not supported")}};var x=!1,S=function(){x||(x=!0,_.initialized||s())};return typeof window==h?void r("No window found"):typeof document==h?void r("No document found"):(e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",S,!1),e(window,"addEventListener")?window.addEventListener("load",S,!1):e(window,"attachEvent")?window.attachEvent("onload",S):r("Window does not have required addEventListener or attachEvent method"),_)}();e.createModule("DomUtil",function(e,t){function n(e){var t;return typeof e.namespaceURI==j||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function i(e){var t=e.parentNode;return 1==t.nodeType?t:null}function a(e){for(var t=0;e=e.previousSibling;)t++;return t}function r(e){var t;return d(e)?e.length:(t=e.childNodes)?t.length:0}function o(e,t){var n,i=[];for(n=e;n;n=n.parentNode)i.push(n);for(n=t;n;n=n.parentNode)if(A(i,n))return n;return null}function s(e,t,n){for(var i=n?t:t.parentNode;i;){if(i===e)return!0;i=i.parentNode}return!1}function l(e,t,n){for(var i,a=n?e:e.parentNode;a;){if(i=a.parentNode,i===t)return a;a=i}return null}function d(e){var t=e.nodeType;return 3==t||4==t||8==t}function c(e,t){var n=t.nextSibling,i=t.parentNode;return n?i.insertBefore(e,n):i.appendChild(e),e}function u(e,t){var n=e.cloneNode(!1);return n.deleteData(0,t),e.deleteData(t,e.length-t),c(n,e),n}function h(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=j)return e.ownerDocument;if(typeof e.document!=j)return e.document;if(e.parentNode)return h(e.parentNode);throw new Error("getDocument: no document found for node")}function p(e){var t=h(e);if(typeof t.defaultView!=j)return t.defaultView;if(typeof t.parentWindow!=j)return t.parentWindow;throw new Error("Cannot get a window object for node")}function f(e){if(typeof e.contentDocument!=j)return e.contentDocument;if(typeof e.contentWindow!=j)return e.contentWindow.document;throw new Error("getIframeWindow: No Document object found for iframe element")}function g(e){if(typeof e.contentWindow!=j)return e.contentWindow;if(typeof e.contentDocument!=j)return e.contentDocument.defaultView;throw new Error("getIframeWindow: No Window object found for iframe element")}function m(e){return N.isHostObject(e,"body")?e.body:e.getElementsByTagName("body")[0]}function b(e){for(var t;t=e.parentNode;)e=t;return e}function v(e){return e?e.previousSibling?e.previousSibling.nextSibling:e.nextSibling?e.nextSibling.previousSibling:e.parentNode?e.parentNode.firstChild:e:void 0}function y(e,t,n,i){e=v(e),n=v(n);var r,s,d,c,u;if(e==n)return t===i?0:i>t?-1:1;if(r=l(n,e,!0))return t<=a(r)?-1:1;if(r=l(e,n,!0))return a(r)<i?-1:1;if(s=o(e,n),d=e===s?s:l(e,s,!0),c=n===s?s:l(n,s,!0),d===c)throw new Error("comparePoints got to case 4 and childA and childB are the same!");for(u=s.firstChild;u;){if(u===d)return-1;if(u===c)return 1;u=u.nextSibling}throw new Error("Should not be here!")}function _(e){for(var t,n=h(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function w(e){if(!e)return"[No node]";if(d(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">["+e.childNodes.length+"]"}return e.nodeName}function C(e){this.root=e,this._next=e}function k(e){return new C(e)}function x(e,t){this.node=e,this.offset=t}function S(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var j="undefined",N=e.util;N.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),N.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var T=document.createElement("div");N.areHostMethods(T,["insertBefore","appendChild","cloneNode"]||!N.areHostObjects(T,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),N.isHostProperty(T,"innerHTML")||t.fail("Element is missing innerHTML property");var E=document.createTextNode("test");N.areHostMethods(E,["splitText","deleteData","insertData","appendData","cloneNode"]||!N.areHostObjects(T,["previousSibling","nextSibling","childNodes","parentNode"])||!N.areHostProperties(E,["data"]))||t.fail("Incomplete Text Node implementation");var A=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1};C.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},x.prototype={equals:function(e){return this.node===e.node&this.offset==e.offset},inspect:function(){return"[DomPosition("+w(this.node)+":"+this.offset+")]"}},S.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},S.prototype.toString=function(){return this.message},e.dom={arrayContains:A,isHtmlNamespace:n,parentElement:i,getNodeIndex:a,getNodeLength:r,getCommonAncestor:o,isAncestorOf:s,getClosestAncestorIn:l,isCharacterDataNode:d,insertAfter:c,splitDataNode:u,getDocument:h,getWindow:p,getIframeWindow:g,getIframeDocument:f,getBody:m,getRootContainer:b,comparePoints:y,inspectNode:w,fragmentFromNodeChildren:_,createIterator:k,DomPosition:x},e.DOMException=S}),e.createModule("DomRange",function(e){function t(e,t){return 3!=e.nodeType&&(P.isAncestorOf(e,t.startContainer,!0)||P.isAncestorOf(e,t.endContainer,!0))}function n(e){return P.getDocument(e.startContainer)}function i(e,t,n){var i=e._listeners[t];if(i)for(var a=0,r=i.length;r>a;++a)i[a].call(e,{target:e,args:n})}function a(e){return new F(e.parentNode,P.getNodeIndex(e))}function r(e){return new F(e.parentNode,P.getNodeIndex(e)+1)}function o(e,t,n){var i=11==e.nodeType?e.firstChild:e;return P.isCharacterDataNode(t)?n==t.length?P.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:P.splitDataNode(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),i}function s(e){for(var t,i,a,r=n(e.range).createDocumentFragment();i=e.next();){if(t=e.isPartiallySelectedSubtree(),i=i.cloneNode(!t),t&&(a=e.getSubtreeIterator(),i.appendChild(s(a)),a.detach(!0)),10==i.nodeType)throw new z("HIERARCHY_REQUEST_ERR");r.appendChild(i)}return r}function l(e,t,n){var i,a;n=n||{stop:!1};for(var r,o;r=e.next();)if(e.isPartiallySelectedSubtree()){if(t(r)===!1)return void(n.stop=!0);if(o=e.getSubtreeIterator(),l(o,t,n),o.detach(!0),n.stop)return}else for(i=P.createIterator(r);a=i.next();)if(t(a)===!1)return void(n.stop=!0)}function d(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),d(t),t.detach(!0)):e.remove()}function c(e){for(var t,i,a=n(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),i=e.getSubtreeIterator(),t.appendChild(c(i)),i.detach(!0)):e.remove(),10==t.nodeType)throw new z("HIERARCHY_REQUEST_ERR");a.appendChild(t)}return a}function u(e,t,n){var i,a=!(!t||!t.length),r=!!n;a&&(i=new RegExp("^("+t.join("|")+")$"));var o=[];return l(new p(e,!1),function(e){a&&!i.test(e.nodeType)||r&&!n(e)||o.push(e)}),o}function h(e){var t="undefined"==typeof e.getName?"Range":e.getName();return"["+t+"("+P.inspectNode(e.startContainer)+":"+e.startOffset+", "+P.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function p(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&P.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||P.isCharacterDataNode(this.sc)?P.getClosestAncestorIn(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||P.isCharacterDataNode(this.ec)?P.getClosestAncestorIn(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function f(e){this.code=this[e],this.codeName=e,this.message="RangeException: "+this.codeName}function g(e,t,n){this.nodes=u(e,t,n),this._next=this.nodes[0],this._position=0}function m(e){return function(t,n){for(var i,a=n?t:t.parentNode;a;){if(i=a.nodeType,P.arrayContains(e,i))return a;a=a.parentNode}return null}}function b(e,t){if(K(e,t))throw new f("INVALID_NODE_TYPE_ERR")}function v(e){if(!e.startContainer)throw new z("INVALID_STATE_ERR")}function y(e,t){if(!P.arrayContains(t,e.nodeType))throw new f("INVALID_NODE_TYPE_ERR")}function _(e,t){if(0>t||t>(P.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new z("INDEX_SIZE_ERR")}function w(e,t){if(G(e,!0)!==G(t,!0))throw new z("WRONG_DOCUMENT_ERR")}function C(e){if(U(e,!0))throw new z("NO_MODIFICATION_ALLOWED_ERR")}function k(e,t){if(!e)throw new z(t)}function x(e){return!P.arrayContains(L,e.nodeType)&&!G(e,!0)}function S(e,t){return t<=(P.isCharacterDataNode(e)?e.length:e.childNodes.length)}function j(e){if(v(e),x(e.startContainer)||x(e.endContainer)||!S(e.startContainer,e.startOffset)||!S(e.endContainer,e.endOffset))throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function N(){}function T(e){e.START_TO_START=Z,e.START_TO_END=et,e.END_TO_END=tt,e.END_TO_START=nt,e.NODE_BEFORE=it,e.NODE_AFTER=at,e.NODE_BEFORE_AND_AFTER=rt,e.NODE_INSIDE=ot}function E(e){T(e),T(e.prototype)}function A(e,t){return function(){j(this);var n,i,a=this.startContainer,o=this.startOffset,s=this.commonAncestorContainer,d=new p(this,!0);a!==s&&(n=P.getClosestAncestorIn(a,s,!0),i=r(n),a=i.node,o=i.offset),l(d,C),d.reset();var c=e(d);return d.detach(),t(this,a,o,a,o),c}}function D(n,i,o){function s(e,t){return function(n){v(this),y(n,B),y(W(n),L);var i=(e?a:r)(n);(t?l:u)(this,i.node,i.offset)}}function l(e,t,n){var a=e.endContainer,r=e.endOffset;(t!==e.startContainer||n!==this.startOffset)&&((W(t)!=W(a)||1==P.comparePoints(t,n,a,r))&&(a=t,r=n),i(e,t,n,a,r))}function u(e,t,n){var a=e.startContainer,r=e.startOffset;(t!==e.endContainer||n!==this.endOffset)&&((W(t)!=W(a)||-1==P.comparePoints(t,n,a,r))&&(a=t,r=n),i(e,a,r,t,n))}function h(e,t,n){(t!==e.startContainer||n!==this.startOffset||t!==e.endContainer||n!==this.endOffset)&&i(e,t,n,t,n)}n.prototype=new N,e.util.extend(n.prototype,{setStart:function(e,t){v(this),b(e,!0),_(e,t),l(this,e,t)},setEnd:function(e,t){v(this),b(e,!0),_(e,t),u(this,e,t)},setStartBefore:s(!0,!0),setStartAfter:s(!1,!0),setEndBefore:s(!0,!1),setEndAfter:s(!1,!1),collapse:function(e){j(this),e?i(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):i(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){v(this),b(e,!0),i(this,e,0,e,P.getNodeLength(e))},selectNode:function(e){v(this),b(e,!1),y(e,B);var t=a(e),n=r(e);i(this,t.node,t.offset,n.node,n.offset)},extractContents:A(c,i),deleteContents:A(d,i),canSurroundContents:function(){j(this),C(this.startContainer),C(this.endContainer);
var e=new p(this,!0),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);return e.detach(),!n},detach:function(){o(this)},splitBoundaries:function(){j(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,a=this.endOffset,r=e===n;P.isCharacterDataNode(n)&&a>0&&a<n.length&&P.splitDataNode(n,a),P.isCharacterDataNode(e)&&t>0&&t<e.length&&(e=P.splitDataNode(e,t),r?(a-=t,n=e):n==e.parentNode&&a>=P.getNodeIndex(e)&&a++,t=0),i(this,e,t,n,a)},normalizeBoundaries:function(){j(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,a=this.endOffset,r=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(n=e,a=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},o=function(i){var r=i.previousSibling;if(r&&r.nodeType==i.nodeType){e=i;var o=i.length;if(t=r.length,i.insertData(0,r.data),r.parentNode.removeChild(r),e==n)a+=t,n=e;else if(n==i.parentNode){var s=P.getNodeIndex(i);a==s?(n=i,a=o):a>s&&a--}}},s=!0;if(P.isCharacterDataNode(n))n.length==a&&r(n);else{if(a>0){var l=n.childNodes[a-1];l&&P.isCharacterDataNode(l)&&r(l)}s=!this.collapsed}if(s){if(P.isCharacterDataNode(e))0==t&&o(e);else if(t<e.childNodes.length){var d=e.childNodes[t];d&&P.isCharacterDataNode(d)&&o(d)}}else e=n,t=a;i(this,e,t,n,a)},collapseToPoint:function(e,t){v(this),b(e,!0),_(e,t),h(this,e,t)}}),E(n)}function O(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:P.getCommonAncestor(e.startContainer,e.endContainer)}function I(e,t,n,a,r){var o=e.startContainer!==t||e.startOffset!==n,s=e.endContainer!==a||e.endOffset!==r;e.startContainer=t,e.startOffset=n,e.endContainer=a,e.endOffset=r,O(e),i(e,"boundarychange",{startMoved:o,endMoved:s})}function M(e){v(e),e.startContainer=e.startOffset=e.endContainer=e.endOffset=null,e.collapsed=e.commonAncestorContainer=null,i(e,"detach",null),e._listeners=null}function R(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},O(this)}e.requireModules(["DomUtil"]);var P=e.dom,F=P.DomPosition,z=e.DOMException;p.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,P.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!P.isCharacterDataNode(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(e=n===this.sc?this.so:0,t=n===this.ec?this.eo:n.length,e!=t&&n.deleteData(e,t-e))},isPartiallySelectedSubtree:function(){var e=this._current;return t(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse();else{e=new R(n(this.range));var t=this._current,i=t,a=0,r=t,o=P.getNodeLength(t);P.isAncestorOf(t,this.sc,!0)&&(i=this.sc,a=this.so),P.isAncestorOf(t,this.ec,!0)&&(r=this.ec,o=this.eo),I(e,i,a,r,o)}return new p(e,this.clonePartiallySelectedTextNodes)},detach:function(e){e&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},f.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},f.prototype.toString=function(){return this.message},g.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var B=[1,3,4,5,7,8,10],L=[2,9,11],q=[5,6,10,12],H=[1,3,4,5,7,8,10,11],$=[1,3,4,5,7,8],W=P.getRootContainer,G=m([9,11]),U=m(q),K=m([6,10,12]),V=document.createElement("style"),Y=!1;try{V.innerHTML="<b>x</b>",Y=3==V.firstChild.nodeType}catch(X){}e.features.htmlParsingConforms=Y;var Q=Y?function(e){var t=this.startContainer,n=P.getDocument(t);if(!t)throw new z("INVALID_STATE_ERR");var i=null;return 1==t.nodeType?i=t:P.isCharacterDataNode(t)&&(i=P.parentElement(t)),i=null===i||"HTML"==i.nodeName&&P.isHtmlNamespace(P.getDocument(i).documentElement)&&P.isHtmlNamespace(i)?n.createElement("body"):i.cloneNode(!1),i.innerHTML=e,P.fragmentFromNodeChildren(i)}:function(e){v(this);var t=n(this),i=t.createElement("body");return i.innerHTML=e,P.fragmentFromNodeChildren(i)},J=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],Z=0,et=1,tt=2,nt=3,it=0,at=1,rt=2,ot=3;N.prototype={attachListener:function(e,t){this._listeners[e].push(t)},compareBoundaryPoints:function(e,t){j(this),w(this.startContainer,t.startContainer);var n,i,a,r,o=e==nt||e==Z?"start":"end",s=e==et||e==Z?"start":"end";return n=this[o+"Container"],i=this[o+"Offset"],a=t[s+"Container"],r=t[s+"Offset"],P.comparePoints(n,i,a,r)},insertNode:function(e){if(j(this),y(e,H),C(this.startContainer),P.isAncestorOf(e,this.startContainer,!0))throw new z("HIERARCHY_REQUEST_ERR");var t=o(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){j(this);var e,t;if(this.collapsed)return n(this).createDocumentFragment();if(this.startContainer===this.endContainer&&P.isCharacterDataNode(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=n(this).createDocumentFragment(),t.appendChild(e),t;var i=new p(this,!0);return e=s(i),i.detach(),e},canSurroundContents:function(){j(this),C(this.startContainer),C(this.endContainer);var e=new p(this,!0),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);return e.detach(),!n},surroundContents:function(e){if(y(e,$),!this.canSurroundContents())throw new f("BAD_BOUNDARYPOINTS_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);o(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){j(this);for(var e,t=new R(n(this)),i=J.length;i--;)e=J[i],t[e]=this[e];return t},toString:function(){j(this);var e=this.startContainer;if(e===this.endContainer&&P.isCharacterDataNode(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new p(this,!0);return l(n,function(e){(3==e.nodeType||4==e.nodeType)&&t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){j(this);var t=e.parentNode,n=P.getNodeIndex(e);if(!t)throw new z("NOT_FOUND_ERR");var i=this.comparePoint(t,n),a=this.comparePoint(t,n+1);return 0>i?a>0?rt:it:a>0?at:ot},comparePoint:function(e,t){return j(this),k(e,"HIERARCHY_REQUEST_ERR"),w(e,this.startContainer),P.comparePoints(e,t,this.startContainer,this.startOffset)<0?-1:P.comparePoints(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:Q,toHtml:function(){j(this);var e=n(this).createElement("div");return e.appendChild(this.cloneContents()),e.innerHTML},intersectsNode:function(e,t){if(j(this),k(e,"NOT_FOUND_ERR"),P.getDocument(e)!==n(this))return!1;var i=e.parentNode,a=P.getNodeIndex(e);k(i,"NOT_FOUND_ERR");var r=P.comparePoints(i,a,this.endContainer,this.endOffset),o=P.comparePoints(i,a+1,this.startContainer,this.startOffset);return t?0>=r&&o>=0:0>r&&o>0},isPointInRange:function(e,t){return j(this),k(e,"HIERARCHY_REQUEST_ERR"),w(e,this.startContainer),P.comparePoints(e,t,this.startContainer,this.startOffset)>=0&&P.comparePoints(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e,t){if(j(this),n(e)!=n(this))throw new z("WRONG_DOCUMENT_ERR");var i=P.comparePoints(this.startContainer,this.startOffset,e.endContainer,e.endOffset),a=P.comparePoints(this.endContainer,this.endOffset,e.startContainer,e.startOffset);return t?0>=i&&a>=0:0>i&&a>0},intersection:function(e){if(this.intersectsRange(e)){var t=P.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=P.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset),i=this.cloneRange();return-1==t&&i.setStart(e.startContainer,e.startOffset),1==n&&i.setEnd(e.endContainer,e.endOffset),i}return null},union:function(e){if(this.intersectsRange(e,!0)){var t=this.cloneRange();return-1==P.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==P.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new f("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ot},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,P.getNodeLength(e))<=0},containsRange:function(e){return this.intersection(e).equals(e)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var i=n.pop();t.setEnd(i,i.length);var a=this.containsRange(t);return t.detach(),a}return this.containsNodeContents(e)},createNodeIterator:function(e,t){return j(this),new g(this,e,t)},getNodes:function(e,t){return j(this),u(this,e,t)},getDocument:function(){return n(this)},collapseBefore:function(e){v(this),this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){v(this),this.setStartAfter(e),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(e){return R.rangesEqual(this,e)},inspect:function(){return h(this)}},D(R,I,M),e.rangePrototype=N.prototype,R.rangeProperties=J,R.RangeIterator=p,R.copyComparisonConstants=E,R.createPrototypeRange=D,R.inspect=h,R.getRangeDocument=n,R.rangesEqual=function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},e.DomRange=R,e.RangeException=f}),e.createModule("WrappedRange",function(e){function t(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var i=n.parentElement();n=e.duplicate(),n.collapse(!1);var a=n.parentElement(),r=i==a?i:o.getCommonAncestor(i,a);return r==t?r:o.getCommonAncestor(t,r)}function n(e){return 0==e.compareEndPoints("StartToEnd",e)}function i(e,t,n,i){var a=e.duplicate();a.collapse(n);var r=a.parentElement();if(o.isAncestorOf(t,r,!0)||(r=t),!r.canHaveHTML)return new s(r.parentNode,o.getNodeIndex(r));var l=o.getDocument(r).createElement("span");l.parentNode&&l.parentNode.removeChild(l);var d,c,u,h,p,f=n?"StartToStart":"StartToEnd";do r.insertBefore(l,l.previousSibling),a.moveToElementText(l);while((d=a.compareEndPoints(f,e))>0&&l.previousSibling);if(p=l.nextSibling,-1==d&&p&&o.isCharacterDataNode(p)){a.setEndPoint(n?"EndToStart":"EndToEnd",e);var g;if(/[\r\n]/.test(p.data)){var m=a.duplicate(),b=m.text.replace(/\r\n/g,"\r").length;for(g=m.moveStart("character",b);-1==(d=m.compareEndPoints("StartToEnd",m));)g++,m.moveStart("character",1)}else{var v=a.text.replace(/\u00a0/g," "),y=p.data.replace(/\u00a0/g," ");if(0!==y.indexOf(v)){for(;v.length>0&&0!==y.indexOf(v);)v=v.substr(1);g=v.length}else g=a.text.length}h=new s(p,g)}else c=(i||!n)&&l.previousSibling,u=(i||n)&&l.nextSibling,h=u&&o.isCharacterDataNode(u)?new s(u,0):c&&o.isCharacterDataNode(c)?new s(c,c.length):new s(r,o.getNodeIndex(l));return l.parentNode.removeChild(l),h}function a(e,t){var n,i,a,r,s=e.offset,l=o.getDocument(e.node),d=l.body.createTextRange(),c=o.isCharacterDataNode(e.node);c?(n=e.node,i=n.parentNode):(r=e.node.childNodes,n=s<r.length?r[s]:null,i=e.node),a=l.createElement("span"),a.innerHTML="&#feff;",n?i.insertBefore(a,n):i.appendChild(a);try{d.moveToElementText(a),d.collapse(!t)}catch(u){}return i.removeChild(a),c&&d[t?"moveStart":"moveEnd"]("character",s),d}e.requireModules(["DomUtil","DomRange"]);var r,o=e.dom,s=o.DomPosition,l=e.DomRange;if(!e.features.implementsDomRange||e.features.implementsTextRange&&e.config.preferTextRange){if(e.features.implementsTextRange){r=function(e){this.textRange=e,this.refresh()},r.prototype=new l(document),r.prototype.refresh=function(){var e,a,r=t(this.textRange);n(this.textRange)?a=e=i(this.textRange,r,!0,!0):(e=i(this.textRange,r,!0,!1),a=i(this.textRange,r,!1,!1)),this.setStart(e.node,e.offset),this.setEnd(a.node,a.offset)},l.copyComparisonConstants(r);var d=function(){return this}();"undefined"==typeof d.Range&&(d.Range=r),e.createNativeRange=function(e){return e=e||document,e.body.createTextRange()}}}else!function(){function t(e){for(var t,n=c.length;n--;)t=c[n],e[t]=e.nativeRange[t]}function n(e,t,n,i,a){var r=e.startContainer!==t||e.startOffset!=n,o=e.endContainer!==i||e.endOffset!=a;(r||o)&&(e.setEnd(i,a),e.setStart(t,n))}function i(e){e.nativeRange.detach(),e.detached=!0;for(var t,n=c.length;n--;)t=c[n],e[t]=null}var a,s,d,c=l.rangeProperties;r=function(e){if(!e)throw new Error("Range must be specified");this.nativeRange=e,t(this)},l.createPrototypeRange(r,n,i),a=r.prototype,a.selectNode=function(e){this.nativeRange.selectNode(e),t(this)},a.deleteContents=function(){this.nativeRange.deleteContents(),t(this)},a.extractContents=function(){var e=this.nativeRange.extractContents();return t(this),e},a.cloneContents=function(){return this.nativeRange.cloneContents()},a.surroundContents=function(e){this.nativeRange.surroundContents(e),t(this)},a.collapse=function(e){this.nativeRange.collapse(e),t(this)},a.cloneRange=function(){return new r(this.nativeRange.cloneRange())},a.refresh=function(){t(this)},a.toString=function(){return this.nativeRange.toString()};var u=document.createTextNode("test");o.getBody(document).appendChild(u);var h=document.createRange();h.setStart(u,0),h.setEnd(u,0);try{h.setStart(u,1),s=!0,a.setStart=function(e,n){this.nativeRange.setStart(e,n),t(this)},a.setEnd=function(e,n){this.nativeRange.setEnd(e,n),t(this)},d=function(e){return function(n){this.nativeRange[e](n),t(this)}}}catch(p){s=!1,a.setStart=function(e,n){try{this.nativeRange.setStart(e,n)}catch(i){this.nativeRange.setEnd(e,n),this.nativeRange.setStart(e,n)}t(this)},a.setEnd=function(e,n){try{this.nativeRange.setEnd(e,n)}catch(i){this.nativeRange.setStart(e,n),this.nativeRange.setEnd(e,n)}t(this)},d=function(e,n){return function(i){try{this.nativeRange[e](i)}catch(a){this.nativeRange[n](i),this.nativeRange[e](i)}t(this)}}}a.setStartBefore=d("setStartBefore","setEndBefore"),a.setStartAfter=d("setStartAfter","setEndAfter"),a.setEndBefore=d("setEndBefore","setStartBefore"),a.setEndAfter=d("setEndAfter","setStartAfter"),h.selectNodeContents(u),a.selectNodeContents=h.startContainer==u&&h.endContainer==u&&0==h.startOffset&&h.endOffset==u.length?function(e){this.nativeRange.selectNodeContents(e),t(this)}:function(e){this.setStart(e,0),this.setEnd(e,l.getEndOffset(e))},h.selectNodeContents(u),h.setEnd(u,3);var f=document.createRange();f.selectNodeContents(u),f.setEnd(u,4),f.setStart(u,2),a.compareBoundaryPoints=-1==h.compareBoundaryPoints(h.START_TO_END,f)&1==h.compareBoundaryPoints(h.END_TO_START,f)?function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)},e.util.isHostMethod(h,"createContextualFragment")&&(a.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),o.getBody(document).removeChild(u),h.detach(),f.detach()}(),e.createNativeRange=function(e){return e=e||document,e.createRange()};e.features.implementsTextRange&&(r.rangeToTextRange=function(e){if(e.collapsed){var t=a(new s(e.startContainer,e.startOffset),!0);return t}var n=a(new s(e.startContainer,e.startOffset),!0),i=a(new s(e.endContainer,e.endOffset),!1),r=o.getDocument(e.startContainer).body.createTextRange();return r.setEndPoint("StartToStart",n),r.setEndPoint("EndToEnd",i),r}),r.prototype.getName=function(){return"WrappedRange"},e.WrappedRange=r,e.createRange=function(t){return t=t||document,new r(e.createNativeRange(t))},e.createRangyRange=function(e){return e=e||document,new l(e)},e.createIframeRange=function(t){return e.createRange(o.getIframeDocument(t))},e.createIframeRangyRange=function(t){return e.createRangyRange(o.getIframeDocument(t))},e.addCreateMissingNativeApiListener(function(t){var n=t.document;"undefined"==typeof n.createRange&&(n.createRange=function(){return e.createRange(this)}),n=t=null})}),e.createModule("WrappedSelection",function(e,t){function n(e){return(e||window).getSelection()}function i(e){return(e||window).document.selection}function a(e,t,n){var i=n?"end":"start",a=n?"start":"end";e.anchorNode=t[i+"Container"],e.anchorOffset=t[i+"Offset"],e.focusNode=t[a+"Container"],e.focusOffset=t[a+"Offset"]}function r(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function o(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function s(t){var n;return t instanceof x?(n=t._selectionNativeRange,n||(n=e.createNativeRange(C.getDocument(t.startContainer)),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset),t._selectionNativeRange=n,t.attachListener("detach",function(){this._selectionNativeRange=null}))):t instanceof S?n=t.nativeRange:e.features.implementsDomRange&&t instanceof C.getWindow(t.startContainer).Range&&(n=t),n}function l(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;n>t;++t)if(!C.isAncestorOf(e[0],e[t]))return!1;return!0}function d(e){var t=e.getNodes();if(!l(t))throw new Error("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function c(e){return!!e&&"undefined"!=typeof e.text}function u(e,t){var n=new S(t);e._ranges=[n],a(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function h(t){if(t._ranges.length=0,"None"==t.docSelection.type)o(t);else{var n=t.docSelection.createRange();if(c(n))u(t,n);else{t.rangeCount=n.length;for(var i,r=C.getDocument(n.item(0)),s=0;s<t.rangeCount;++s)i=e.createRange(r),i.selectNode(n.item(s)),t._ranges.push(i);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,a(t,t._ranges[t.rangeCount-1],!1)}}}function p(e,t){for(var n=e.docSelection.createRange(),i=d(t),a=C.getDocument(n.item(0)),r=C.getBody(a).createControlRange(),o=0,s=n.length;s>o;++o)r.add(n.item(o));try{r.add(i)}catch(l){throw new Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}r.select(),h(e)}function f(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function g(e,t){for(var n,i=C.getDocument(t[0].startContainer),a=C.getBody(i).createControlRange(),r=0;rangeCount>r;++r){n=d(t[r]);try{a.add(n)}catch(o){throw new Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}a.select(),h(e)}function m(e,t){if(e.anchorNode&&C.getDocument(e.anchorNode)!==C.getDocument(t))throw new j("WRONG_DOCUMENT_ERR")}function b(e){var t=[],n=new N(e.anchorNode,e.anchorOffset),i=new N(e.focusNode,e.focusOffset),a="function"==typeof e.getName?e.getName():"Selection";if("undefined"!=typeof e.rangeCount)for(var r=0,o=e.rangeCount;o>r;++r)t[r]=x.inspect(e.getRangeAt(r));return"["+a+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+i.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]),e.config.checkSelectionRanges=!0;var v,y,_="boolean",w="_rangySelection",C=e.dom,k=e.util,x=e.DomRange,S=e.WrappedRange,j=e.DOMException,N=C.DomPosition,T="Control",E=e.util.isHostMethod(window,"getSelection"),A=e.util.isHostObject(document,"selection"),D=A&&(!E||e.config.preferTextRange);D?(v=i,e.isSelectionValid=function(e){var t=(e||window).document,n=t.selection;return"None"!=n.type||C.getDocument(n.createRange().parentElement())==t}):E?(v=n,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected."),e.getNativeSelection=v;var O=v(),I=e.createNativeRange(document),M=C.getBody(document),R=k.areHostObjects(O,["anchorNode","focusNode"]&&k.areHostProperties(O,["anchorOffset","focusOffset"]));e.features.selectionHasAnchorAndFocus=R;var P=k.isHostMethod(O,"extend");e.features.selectionHasExtend=P;var F="number"==typeof O.rangeCount;e.features.selectionHasRangeCount=F;var z=!1,B=!0;k.areHostMethods(O,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof O.rangeCount&&e.features.implementsDomRange&&!function(){var e=document.createElement("iframe");M.appendChild(e);var t=C.getIframeDocument(e);t.open(),t.write("<html><head></head><body>12</body></html>"),t.close();var n=C.getIframeWindow(e).getSelection(),i=t.documentElement,a=i.lastChild,r=a.firstChild,o=t.createRange();o.setStart(r,1),o.collapse(!0),n.addRange(o),B=1==n.rangeCount,n.removeAllRanges();var s=o.cloneRange();o.setStart(r,0),s.setEnd(r,2),n.addRange(o),n.addRange(s),z=2==n.rangeCount,o.detach(),s.detach(),M.removeChild(e)}(),e.features.selectionSupportsMultipleRanges=z,e.features.collapsedNonEditableSelectionsSupported=B;var L,q=!1;M&&k.isHostMethod(M,"createControlRange")&&(L=M.createControlRange(),k.areHostProperties(L,["item","add"])&&(q=!0)),e.features.implementsControlRange=q,y=R?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var H;k.isHostMethod(O,"getRangeAt")?H=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:R&&(H=function(t){var n=C.getDocument(t.anchorNode),i=e.createRange(n);return i.setStart(t.anchorNode,t.anchorOffset),i.setEnd(t.focusNode,t.focusOffset),i.collapsed!==this.isCollapsed&&(i.setStart(t.focusNode,t.focusOffset),i.setEnd(t.anchorNode,t.anchorOffset)),i}),e.getSelection=function(e){e=e||window;var t=e[w],n=v(e),a=A?i(e):null;return t?(t.nativeSelection=n,t.docSelection=a,t.refresh(e)):(t=new f(n,a,e),e[w]=t),t},e.getIframeSelection=function(t){return e.getSelection(C.getIframeWindow(t))};var $=f.prototype;if(!D&&R&&k.areHostMethods(O,["removeAllRanges","addRange"])){$.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),o(this)};var W=function(t,n){var i=x.getRangeDocument(n),a=e.createRange(i);a.collapseToPoint(n.endContainer,n.endOffset),t.nativeSelection.addRange(s(a)),t.nativeSelection.extend(n.startContainer,n.startOffset),t.refresh()};$.addRange=F?function(t,n){if(q&&A&&this.docSelection.type==T)p(this,t);else if(n&&P)W(this,t);else{var i;if(z?i=this.rangeCount:(this.removeAllRanges(),i=0),this.nativeSelection.addRange(s(t)),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==i+1){if(e.config.checkSelectionRanges){var r=H(this.nativeSelection,this.rangeCount-1);r&&!x.rangesEqual(r,t)&&(t=new S(r))}this._ranges[this.rangeCount-1]=t,a(this,t,K(this.nativeSelection)),this.isCollapsed=y(this)}else this.refresh()}}:function(e,t){t&&P?W(this,e):(this.nativeSelection.addRange(s(e)),this.refresh())},$.setRanges=function(e){if(q&&e.length>1)g(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;n>t;++t)this.addRange(e[t])}}}else{if(!(k.isHostMethod(O,"empty")&&k.isHostMethod(I,"select")&&q&&D))return t.fail("No means of selecting a Range or TextRange was found"),!1;$.removeAllRanges=function(){try{var e=Aloha.browser.msie&&Aloha.browser.version<8&&"undefined"==typeof document.documentMode;e||this.docSelection.empty(),"None"!=this.docSelection.type&&e&&this.docSelection.empty()}catch(t){}o(this)},$.addRange=function(e){if(this.docSelection.type==T)p(this,e);else try{S.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,a(this,e,!1)}catch(t){}},$.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?g(this,e):t&&this.addRange(e[0])}}$.getRangeAt=function(e){if(0>e||e>=this.rangeCount)throw new j("INDEX_SIZE_ERR");return this._ranges[e]};var G;if(D)G=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=C.getBody(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type==T?h(t):c(n)?u(t,n):o(t)};else if(k.isHostMethod(O,"getRangeAt")&&"number"==typeof O.rangeCount)G=function(t){if(q&&A&&t.docSelection.type==T)h(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,i=t.rangeCount;i>n;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));a(t,t._ranges[t.rangeCount-1],K(t.nativeSelection)),t.isCollapsed=y(t)}else o(t)};else{if(!R||typeof O.isCollapsed!=_||typeof I.collapsed!=_||!e.features.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;G=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=H(n,0),e._ranges=[t],e.rangeCount=1,r(e),e.isCollapsed=y(e)):o(e)}}$.refresh=function(e){var t=e?this._ranges.slice(0):null;if(G(this),e){var n=t.length;if(n!=this._ranges.length)return!1;for(;n--;)if(!x.rangesEqual(t[n],this._ranges[n]))return!1;return!0}};var U=function(e,t){var n=e.getAllRanges(),i=!1;e.removeAllRanges();for(var a=0,r=n.length;r>a;++a)i||t!==n[a]?e.addRange(n[a]):i=!0;e.rangeCount||o(e)};$.removeRange=q?function(e){if(this.docSelection.type==T){for(var t,n=this.docSelection.createRange(),i=d(e),a=C.getDocument(n.item(0)),r=C.getBody(a).createControlRange(),o=!1,s=0,l=n.length;l>s;++s)t=n.item(s),t!==i||o?r.add(n.item(s)):o=!0;r.select(),h(this)}else U(this,e)}:function(e){U(this,e)};var K;!D&&R&&e.features.implementsDomRange?(K=function(e){var t=!1;return e.anchorNode&&(t=1==C.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t},$.isBackwards=function(){return K(this)}):K=$.isBackwards=function(){return!1},$.toString=function(){for(var e=[],t=0,n=this.rangeCount;n>t;++t)e[t]=""+this._ranges[t];return e.join("")},$.collapse=function(t,n){m(this,t);var i=e.createRange(C.getDocument(t));i.collapseToPoint(t,n),this.removeAllRanges(),this.addRange(i),this.isCollapsed=!0},$.collapseToStart=function(){if(!this.rangeCount)throw new j("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},$.collapseToEnd=function(){if(!this.rangeCount)throw new j("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},$.selectAllChildren=function(t){m(this,t);var n=e.createRange(C.getDocument(t));n.selectNodeContents(t),this.removeAllRanges(),this.addRange(n)},$.deleteFromDocument=function(){if(q&&A&&this.docSelection.type==T){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),e.parentNode.removeChild(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();this.removeAllRanges();for(var i=0,a=n.length;a>i;++i)n[i].deleteContents();this.addRange(n[a-1])}},$.getAllRanges=function(){return this._ranges.slice(0)},$.setSingleRange=function(e){this.setRanges([e])},$.containsNode=function(e,t){for(var n=0,i=this._ranges.length;i>n;++n)if(this._ranges[n].containsNode(e,t))return!0;return!1},$.toHtml=function(){var e="";if(this.rangeCount){for(var t=x.getRangeDocument(this._ranges[0]).createElement("div"),n=0,i=this._ranges.length;i>n;++n)t.appendChild(this._ranges[n].cloneContents());e=t.innerHTML}return e},$.getName=function(){return"WrappedSelection"},$.inspect=function(){return b(this)},$.detach=function(){this.win[w]=null,this.win=this.anchorNode=this.focusNode=null},f.inspect=b,e.Selection=f,e.selectionPrototype=$,e.addCreateMissingNativeApiListener(function(t){"undefined"==typeof t.getSelection&&(t.getSelection=function(){return e.getSelection(this)}),t=null})}),window.rangy=e}(),define("vendor/rangy-core",function(){}),define("aloha/rangy-core",["jquery","vendor/rangy-core"],function(){return window.rangy}),define("util/class",[],function(){var e=!1,t=/xyz/.test(function(){})?/\b_super\b/:/.*/;return this.Class=function(){},Class.extend=function(){function n(){!e&&this._constructor&&this._constructor.apply(this,arguments)}var i=this.prototype;e=!0;var a=new this;e=!1;for(var r=0;r<arguments.length;r++){var o=arguments[r];for(var s in o)a[s]="function"==typeof o[s]&&"function"==typeof i[s]&&t.test(o[s])?function(e,t){return function(){var n=this._super;this._super=i[e];var a=t.apply(this,arguments);return this._super=n,a}}(s,o[s]):o[s]}return n.prototype=a,n.constructor=n,n.extend=arguments.callee,n},this.Class}),window.GENTICS=window.GENTICS||{},window.GENTICS.Utils=window.GENTICS.Utils||{},define("util/lang",[],function(){}),function(e){{var t=(e.alohaQuery||e.jQuery,e.GENTICS);e.Class,e.console}t.Utils.applyProperties=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},t.Utils.uniqeString4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},t.Utils.guid=function(){var e=t.Utils.uniqeString4;return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}(window),define("aloha/ecma5shims",[],function(){function e(e){var t=null;if(e)do t=e;while(null!=(e=e.parentNode));return t}function t(e,t){return(e.contains(t)&&16)+(t.contains(e)&&8)+(e.sourceIndex>=0&&t.sourceIndex>=0?(e.sourceIndex<t.sourceIndex&&4)+(e.sourceIndex>t.sourceIndex&&2):1)}function n(e){return null!=e.sourceIndex?e:e.parentNode.insertBefore(document.createComment(""),e)}var i,a={bind:function(e){var t=this.obj||this,n=Function.prototype.bind,i=Array.prototype.slice.call(arguments,1);return n?n.apply(t,arguments):function(){return t.apply(e,0===arguments.length?i:i.concat(Array.prototype.slice.call(arguments)))}},trim:function(){var e=this.obj||this,t=String.prototype.trim;return t?t.call(e):e.replace(/^\s+/,"").replace(/\s+$/,"")},indexOf:function(e,t){var n=this.obj||this,i=Array.prototype.indexOf;if(i)return i.call(n,e,t);void 0===t&&(t=0),0>t&&(t+=n.length),0>t&&(t=0);var a;for(a=n.length;a>t;t++)if(void 0!==n[t]&&n[t]===e)return t;return-1},forEach:function(e,t){var n=this.obj||this,i=Array.prototype.forEach;if(i)return i.call(n,e,t);var a,r;for(a=0,r=n.length;r>a;a++)void 0!==n[a]&&e.call(t,n[a],a,n)},map:function(e,t){var n=this.obj||this,a=Array.prototype.map,r="boolean"==typeof arguments[arguments.length-1]?Array.prototype.pop.call(arguments):!1,o=[];if(a)o=a.call(n,e,t);else{var s,l,d=[];for(s=0,l=n.length;l>s;s++)void 0!==n[s]&&(d[s]=e.call(t,n[s],s,n));o=d}return r?i(o):o},filter:function(e,t){var n=this.obj||this,a=Array.prototype.filter,r="boolean"==typeof arguments[arguments.length-1]?Array.prototype.pop.call(arguments):!1,o=[];if(a)o=a.call(n,e,t);else{var s,l,d,c=[];for(l=0,d=n.length;d>l;l++)void 0!==n[l]&&e.call(t,s=n[l],l,n)&&c.push(s);o=c}return r?i(o):o},every:function(e,t){var n=this.obj||this,i=Array.prototype.every;if(i)return i.call(n,e,t);var a,r;for(a=0,r=n.length;r>a;a++)if(void 0!==n[a]&&!e.call(t,n[a],a,n))return!1;return!0},some:function(e,t){var n=this.obj||this,i=Array.prototype.some;if(i)return i.call(n,e,t);var a,r;for(a=0,r=n.length;r>a;a++)if(void 0!==n[a]&&e.call(t,n[a],a,n))return!0;return!1},hasAttribute:function(e){var t=this.obj||this,n=t.hasAttribute;return n?t.hasAttribute(e):!!t.getAttribute(e)}};i=function(e){var t=function(){};t.prototype=a;var n=new t;return n.obj=e,n};var r;for(r in a)a.hasOwnProperty(r)&&(i[r]=a[r]);return i.Node="undefined"!=typeof window.Node?window.Node:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32},i.compareDocumentPosition=function(i,a){if(document.documentElement.compareDocumentPosition)return i.compareDocumentPosition(a);if(!document.documentElement.contains)throw"neither compareDocumentPosition nor contains is supported by this browser.";if(i==a)return 0;if(e(i)!=e(a))return 1;if(null!=i.sourceIndex&&null!=a.sourceIndex)return t(i,a);
if(i==document)return 20;if(a==document)return 10;var r=n(i),o=n(a),s=t(r,o);return i!=r&&r.parentNode.removeChild(r),a!=o&&o.parentNode.removeChild(o),s},i.getComputedStyle=function(e,t){return window.getComputedStyle?window.getComputedStyle(e,t):e.currentStyle?e.currentStyle:null},i}),window.GENTICS=window.GENTICS||{},window.GENTICS.Utils=window.GENTICS.Utils||{},define("util/dom",["jquery","util/class","aloha/ecma5shims"],function(e,t,n){function i(e){for(var t=0,n=e.firstChild;n;)t+=1,n=n.nextSibling;return t}function a(e){if(!e)return-1;var t,n=e.parentNode.childNodes,i=n.length;for(t=0;i>t;t++)if(n[t]===e)return t;return-1}function r(e){return 1===e.nodeType?i(e):3===e.nodeType?e.length:0}function o(e){return"aloha-editing-p"===e.className&&1===r(e)&&"BR"===e.children[0].nodeName&&"aloha-end-br"===e.children[0].className}function s(e,t){if(!e)return null;if(t(e))return e;var n=e.firstChild||e.nextSibling||e.parentNode&&!h.Utils.Dom.isEditingHost(e.parentNode)&&e.parentNode.nextSibling;return n?s(n,t):null}function l(e){if(!e)return!0;if("BR"===e.nodeName)return!1;if(e.nodeType===p.TEXT_NODE)return-1===e.data.search(/\S/)?!0:1===e.data.length&&e.data.charCodeAt(0)>=8192?!0:!1;var t=r(e);if(0===t)return!0;var n,i=e.childNodes;for(n=0;t>n;n++)if(!l(i[n]))return!1;return!0}function d(e){return!l(e)}function c(e){return l(e)||o(e)}function u(t,n){t.nodeType!==p.TEXT_NODE&&c(t)?e(t).replaceWith(n):e(t).after(n)}var h=window.GENTICS,p={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32},f={P:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,LI:!0},g=t.extend({getIndexInParent:a,wordRegex:/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,nonWordRegex:/[^\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,mergeableTags:["b","code","del","em","i","ins","strong","sub","sup","#text"],nonWordBoundaryTags:["a","b","code","del","em","i","ins","span","strong","sub","sup","#text"],nonEmptyTags:["br"],tags:{flow:["a","abbr","address","area","article","aside","audio","b","bdi","bdo","blockquote","br","button","canvas","cite","code","command","datalist","del","details","dfn","div","dl","em","embed","fieldset","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","menu","meter","nav","noscript","object","ol","output","p","pre","progress","q","ruby","s","samp","script","section","select","small","span","strong","style","sub","sup","svg","table","textarea","time","u","ul","var","video","wbr","#text"],phrasing:["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","command","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","samp","script","select","small","span","strong","sub","sup","svg","textarea","time","u","var","video","wbr","#text"]},children:{a:"phrasing",abbr:"phrasing",address:"flow",area:"empty",article:"flow",aside:"flow",audio:"source",b:"phrasing",base:"empty",bdo:"phrasing",blockquote:"phrasing",body:"flow",br:"empty",button:"phrasing",canvas:"phrasing",caption:"flow",cite:"phrasing",code:"phrasing",col:"empty",colgroup:"col",command:"empty",datalist:["phrasing","option"],dd:"flow",del:"phrasing",div:"flow",details:["summary","flow"],dfn:"flow",dl:["dt","dd"],dt:"phrasing",em:"phrasing",embed:"empty",fieldset:["legend","flow"],figcaption:"flow",figure:["figcaption","flow"],footer:"flow",form:"flow",h1:"phrasing",h2:"phrasing",h3:"phrasing",h4:"phrasing",h5:"phrasing",h6:"phrasing",header:"flow",hgroup:["h1","h2","h3","h4","h5","h6"],hr:"empty",i:"phrasing",iframe:"#text",img:"empty",input:"empty",ins:"phrasing",kbd:"phrasing",keygen:"empty",label:"phrasing",legend:"phrasing",li:"flow",link:"empty",map:"area",mark:"phrasing",menu:["li","flow"],meta:"empty",meter:"phrasing",nav:"flow",noscript:"phrasing",object:"param",ol:"li",optgroup:"option",option:"#text",output:"phrasing",p:"phrasing",param:"empty",pre:"phrasing",progress:"phrasing",q:"phrasing",rp:"phrasing",rt:"phrasing",ruby:["phrasing","rt","rp"],s:"phrasing",samp:"pharsing",script:"#script",section:"flow",select:["option","optgroup"],small:"phrasing",source:"empty",span:"phrasing",strong:"phrasing",style:"phrasing",sub:"phrasing",summary:"phrasing",sup:"phrasing",table:["caption","colgroup","thead","tbody","tfoot","tr"],tbody:"tr",td:"flow",textarea:"#text",tfoot:"tr",th:"phrasing",thead:"tr",time:"phrasing",title:"#text",tr:["th","td"],track:"empty",u:"phrasing",ul:"li","var":"phrasing",video:"source",wbr:"empty"},blockLevelElements:["p","h1","h2","h3","h4","h5","h6","blockquote","div","pre"],listElements:["li","ol","ul"],split:function(t,n,i){var a,r,o,s,l,d,c,u,h,p,f,g,m,b,v,y=e(t.startContainer),_=t.startOffset;if(i&&(y=e(t.endContainer),_=t.endOffset),n.length<1&&(n=e(document.body)),a=!t.isCollapsed()&&!i,o=y.parents().get(),o.unshift(y.get(0)),e.each(o,function(e,t){var i=n.filter(function(){return this==t}).length;return i?(e>0&&(r=o.slice(0,e)),!1):void 0}),!r)return!0;for(r=r.reverse(),c=0,u=r.length;u>c;++c)if(h=r[c],c===u-1)3===h.nodeType?(d=document.createTextNode(h.data.substring(_,h.data.length)),h.data=h.data.substring(0,_),this.isEmpty(d)&&0===e("br",s).length&&(d=e("<br/>").addClass("aloha-end-br"))):(p=e(h),f=p.contents(),g=p.clone(!1).empty(),d=g.append(f.slice(_,f.length)).get(0),e(d).addClass("aloha-editing-p"),1===d.childNodes.length&&"br"===d.childNodes.item(0).nodeName.toLowerCase()&&e(d.childNodes.item(0)).addClass("aloha-end-br")),a&&t.endContainer===h&&(t.endContainer=d,t.endOffset-=_,t.clearCaches()),l?l.prepend(d):e(h).after(d);else{for(g=e(h).clone(!1).empty(),s?l.prepend(g):s=g,l=g;;){if(m=r[c+1].nextSibling,!m)break;l.append(m)}if(a&&t.endContainer===h){for(t.endContainer=g.get(0),b=r[c+1],v=0;;){if(b=b.previousSibling,!b)break;v++}t.endOffset-=v,t.clearCaches()}}return e(r[0]).after(s),e([r[0],s?s.get(0):d])},allowsNesting:function(t,n){if(!(t&&t.nodeName&&n&&n.nodeName))return!1;var i=t.nodeName.toLowerCase(),a=n.nodeName.toLowerCase();return this.children[i]?this.children[i]==a?!0:e.isArray(this.children[i])&&e.inArray(a,this.children[i])>=0?!0:e.isArray(this.tags[this.children[i]])&&e.inArray(a,this.tags[this.children[i]])>=0?!0:!1:!1},addMarkup:function(t,n,i){3===t.startContainer.nodeType&&t.startOffset>0&&t.startOffset<t.startContainer.data.length&&this.split(t,e(t.startContainer).parent(),!1),3===t.endContainer.nodeType&&t.endOffset>0&&t.endOffset<t.endContainer.data.length&&this.split(t,e(t.endContainer).parent(),!0);var a=t.getRangeTree();this.recursiveAddMarkup(a,n,t,i),this.doCleanup({merge:!0,removeempty:!0},t)},recursiveAddMarkup:function(t,n,i,a){var r,o,s;for(r=0,s=t.length;s>r;++r)"full"==t[r].type&&this.allowsNesting(n.get(0),t[r].domobj)?!a&&t[r].domobj.nodeName==n.get(0).nodeName||3===t[r].domobj.nodeType&&0===e.trim(t[r].domobj.data).length||(e(t[r].domobj).wrap(n),a||3===t[r].domobj.nodeType||(o=new h.Utils.RangeObject,o.startContainer=o.endContainer=t[r].domobj.parentNode,o.startOffset=0,o.endOffset=o.endContainer.childNodes.length,this.removeMarkup(o,n,e(t[r].domobj.parentNode)))):(a||t[r].domobj&&t[r].domobj.nodeName!==n.get(0).nodeName)&&t[r].children&&t[r].children.length>0&&this.recursiveAddMarkup(t[r].children,n)},findHighestElement:function(e,t,n){t=t.toLowerCase();for(var i,a=e,r=n?function(){return n.filter(function(){return a==this}).length}:function(){return!1};!r()&&a;)a.nodeName.toLowerCase()===t&&(i=a),a=a.parentNode;return i},removeMarkup:function(t,n,i){var a,r,o,s=n.get(0).nodeName,l=this.findHighestElement(t.startContainer,s,i),d=this.findHighestElement(t.endContainer,s,i),c=!1;l&&t.startOffset>0&&(this.split(t,e(l).parent(),!1),c=!0),d&&(3===t.endContainer.nodeType&&t.endOffset<t.endContainer.data.length&&(this.split(t,e(d).parent(),!0),c=!0),1===t.endContainer.nodeType&&t.endOffset<t.endContainer.childNodes.length&&(this.split(t,e(d).parent(),!0),c=!0)),c&&t.correctRange(),a=this.findHighestElement(t.getCommonAncestorContainer(),s,i),r=a?a.parentNode:t.getCommonAncestorContainer(),r&&(o=t.getRangeTree(r),this.recursiveRemoveMarkup(o,n),this.doCleanup({merge:!0,removeempty:!0},t,r))},recursiveRemoveMarkup:function(t,n){var i,a,r;for(i=0,a=t.length;a>i;++i)"full"==t[i].type&&t[i].domobj.nodeName==n.get(0).nodeName&&(r=e(t[i].domobj).contents(),r.length>0?r.first().unwrap():e(t[i].domobj).remove()),t[i].children&&this.recursiveRemoveMarkup(t[i].children,n)},doCleanup:function(t,n,i){var r,o,s,l,d,c=this;return"undefined"==typeof t&&(t={}),"undefined"==typeof t.merge&&(t.merge=!1),"undefined"==typeof t.removeempty&&(t.removeempty=!1),"undefined"==typeof i&&n&&(i=n.getCommonAncestorContainer()),r=!1,o=!1,s=e(i),l=n.startOffset,d=n.endOffset,s.contents().each(function(){var i;try{i=this.nodeType}catch(u){return}switch(i){case 1:var p=this.nodeName;if(r&&r.nodeName===p)n.startContainer===s&&l>a(this)&&(n.startOffset-=1,o=!0),n.endContainer===s&&d>a(this)&&(n.endOffset-=1,o=!0),e(r).append(e(this).contents()),o|=c.doCleanup(t,n,r),e(this).remove();else{o|=c.doCleanup(t,n,this);var f=!1;t.removeempty&&(h.Utils.Dom.isBlockLevelElement(this)&&0===this.childNodes.length&&(f=!0),e.inArray(p.toLowerCase(),c.mergeableTags)>=0&&0===e(this).text().length&&0===this.childNodes.length&&(f=!0)),f?(n.startContainer===this.parentNode&&l>a(this)&&(n.startOffset=n.startOffset-1,o=!0),n.endContainer===this.parentNode&&d>a(this)&&(n.endOffset=n.endOffset-1,o=!0),e(this).remove()):r=(t.mergeable?t.mergeable(this):e.inArray(p.toLowerCase(),c.mergeableTags)>=0)?this:!1}break;case 3:if(r&&3===r.nodeType&&t.merge){var g=r.nodeValue,m=g.length;n.startContainer===this?(n.startContainer=r,n.startOffset+=m,o=!0):n.startContainer===r.parentNode&&n.startOffset===a(r)+1&&(n.startContainer=r,n.startOffset=m,o=!0),n.endContainer===this?(n.endContainer=r,n.endOffset+=m,o=!0):n.endContainer===r.parentNode&&n.endOffset===a(r)+1&&(n.endContainer=r,n.endOffset=m,o=!0),r.data+=this.data}else if(""!==this.nodeValue||!t.removeempty){r=this;break}n.startContainer===this.parentNode&&n.startOffset>a(this)&&(n.startOffset=n.startOffset-1,o=!0),n.endContainer===this.parentNode&&n.endOffset>a(this)&&(n.endOffset=n.endOffset-1,o=!0),e(this).remove();var b=r.nextSibling;if(r&&(!b||3!==b.nodeType)){var v,y=r.data,_=y.length;for(v=_-1;v>=0&&_>1;v--)"​"===y.charAt(v)&&(r.deleteData(v,1),n.startContainer===r&&n.startOffset>v&&(n.startOffset--,o=!0),n.endContainer===r&&n.endOffset>v&&(n.endOffset--,o=!0))}}}),o&&n.clearCaches(),o},isBlockLevelElement:function(t){return t&&1===t.nodeType&&e.inArray(t.nodeName.toLowerCase(),this.blockLevelElements)>=0?!0:!1},isLineBreakElement:function(e){return e?1===e.nodeType&&"br"==e.nodeName.toLowerCase():!1},isListElement:function(t){return t?1===t.nodeType&&e.inArray(t.nodeName.toLowerCase(),this.listElements)>=0:!1},isSplitObject:function(e){return 1===e.nodeType&&f.hasOwnProperty(e.nodeName)},searchAdjacentTextNode:function(t,n,i,a){if(!t||1!==t.nodeType||0>n||n>t.childNodes.length)return!1;"undefined"==typeof a&&(a={blocklevel:!0,list:!0,linebreak:!0}),"undefined"==typeof a.blocklevel&&(a.blocklevel=!0),"undefined"==typeof a.list&&(a.list=!0),"undefined"==typeof a.linebreak&&(a.linebreak=!0),"undefined"==typeof i&&(i=!0);var r,o=t;for(i&&n>0&&(r=t.childNodes[n-1]),!i&&n<t.childNodes.length&&(r=t.childNodes[n]);o;)if(r){if(3===r.nodeType&&e.trim(r.data).length>0)return r;if(a.blocklevel&&this.isBlockLevelElement(r))return!1;if(a.linebreak&&this.isLineBreakElement(r))return!1;if(a.list&&this.isListElement(r))return!1;3===r.nodeType?r=i?r.previousSibling:r.nextSibling:(o=r,r=i?r.lastChild:r.firstChild)}else{if(a.blocklevel&&this.isBlockLevelElement(o))return!1;if(a.list&&this.isListElement(o))return!1;r=i?o.previousSibling:o.nextSibling,o=o.parentNode}},insertIntoDOM:function(t,n,i,a,r){var o,l,h,p,f,g=n.getContainerParents(i,a),m=this;if(i||(i=e(document.body)),0===g.length?o=i.get(0):e.each(g,function(e,n){return m.allowsNesting(n,t.get(0))?(o=n,!1):void 0}),"undefined"==typeof o&&i.length>0&&(o=i.get(0)),!this.allowsNesting(o,t.get(0))&&!r)return!1;if("undefined"!=typeof o){if(p=this.split(n,e(o),a),p===!0)return l=n.startContainer,h=n.startOffset,a&&(l=n.endContainer,h=n.endOffset),0===h?(f=e(l).contents(),f.length>0?f.eq(0).before(t):e(l).append(t),!0):(e(l).contents().eq(h-1).after(t),!0);if(p){var b=p[0],v=p[1];if(u(b,t),c(v)){var y=v.nextSibling||v.parentNode&&v.parentNode.nextSibling;s(y,d)&&e(v).remove()}return!0}return!1}return!1},removeFromDOM:function(t,n,i){if(i){var r=a(t),o=e(t).contents().length,s=t.parentNode;n.startContainer==s&&n.startOffset>r?n.startOffset+=o-1:n.startContainer==t&&(n.startContainer=s,n.startOffset=r+n.startOffset),n.endContainer==s&&n.endOffset>r?n.endOffset+=o-1:n.endContainer==t&&(n.endContainer=s,n.endOffset=r+n.endOffset),e(t).contents().unwrap(),this.doCleanup({merge:!0},n,s)}},removeRange:function(t){if(!t)return!1;if(t.isCollapsed())return!1;3==t.startContainer.nodeType&&t.startOffset>0&&t.startOffset<t.startContainer.data.length&&this.split(t,e(t.startContainer).parent(),!1),3==t.endContainer.nodeType&&t.endOffset>0&&t.endOffset<t.endContainer.data.length&&this.split(t,e(t.endContainer).parent(),!0);var n=t.getRangeTree();t.endContainer=t.startContainer,t.endOffset=t.startOffset,this.recursiveRemoveRange(n,t),this.doCleanup({merge:!0},t),t.clearCaches()},recursiveRemoveRange:function(t,n){var i;for(i=0;i<t.length;++i)"full"==t[i].type?(e(n.startContainer).parents().andSelf().filter(t[i].domobj).length>0&&(n.startContainer=n.endContainer=t[i].domobj.parentNode,n.startOffset=n.endOffset=a(t[i].domobj)),e(t[i].domobj).remove()):"partial"==t[i].type&&t[i].children&&this.recursiveRemoveRange(t[i].children,n)},extendToWord:function(e,t){var n=this.searchWordBoundary(e.startContainer,e.startOffset,!0),i=this.searchWordBoundary(e.endContainer,e.endOffset,!1);if(!t){if(e.startContainer==n.container&&e.startOffset==n.offset)return;if(e.endContainer==i.container&&e.endOffset==i.offset)return}e.startContainer=n.container,e.startOffset=n.offset,e.endContainer=i.container,e.endOffset=i.offset,e.correctRange(),e.clearCaches()},isWordBoundaryElement:function(t){return t&&t.nodeName?-1==e.inArray(t.nodeName.toLowerCase(),this.nonWordBoundaryTags):!1},searchWordBoundary:function(e,t,n){"undefined"==typeof n&&(n=!0);for(var i,r,o,s=!1;!s;){var l=a(e);if(3===e.nodeType)if(n){for(i=e.data.substring(0,t).search(this.nonWordRegex),r=i;-1!=r;)i=r,r=e.data.substring(i+1,t).search(this.nonWordRegex),-1!=r&&(r=r+i+1);-1!=i?(t=i+1,s=!0):(t=l,e=e.parentNode)}else i=e.data.substring(t).search(this.nonWordRegex),-1!=i?(t+=i,s=!0):(t=l+1,e=e.parentNode);else 1===e.nodeType&&(n?t>0?this.isWordBoundaryElement(e.childNodes[t-1])?s=!0:(e=e.childNodes[t-1],t=3===e.nodeType?e.data.length:e.childNodes.length):this.isWordBoundaryElement(e)?s=!0:(t=l,e=e.parentNode):t<e.childNodes.length?this.isWordBoundaryElement(e.childNodes[t])?s=!0:(e=e.childNodes[t],t=0):this.isWordBoundaryElement(e)?s=!0:(t=l+1,e=e.parentNode))}return 3!==e.nodeType&&(o=this.searchAdjacentTextNode(e,t,!n),o&&(e=o,t=n?0:e.data.length)),{container:e,offset:t}},isEmpty:function(t){if(!t)return!0;if(-1!=e.inArray(t.nodeName.toLowerCase(),this.nonEmptyTags))return!1;if(3===t.nodeType)return-1==t.data.search(/\S/)?!0:1===t.data.length&&t.data.charCodeAt(0)>=8192?!0:!1;var n,i;for(n=0,i=t.childNodes.length;i>n;++n)if(!this.isEmpty(t.childNodes[n]))return!1;return!0},setCursorAfter:function(e){{var t,n,i=new h.Utils.RangeObject;a(e)}return 3==e.nodeType?(t=e,n=t.nodeValue.length):e.nextSibling&&3==e.nextSibling.nodeType?(t=e.nextSibling,n=0):(t=e.parentNode,n=a(e)+1),i.startContainer=i.endContainer=t,i.startOffset=i.endOffset=n,i.select(),i},selectDomNode:function(e){var t=new h.Utils.RangeObject;t.startContainer=t.endContainer=e.parentNode,t.startOffset=a(e),t.endOffset=t.startOffset+1,t.select()},setCursorInto:function(e){var t=new h.Utils.RangeObject;t.startContainer=t.endContainer=e,t.startOffset=t.endOffset=0,t.select()},isEditingHost:function(e){return e&&1==e.nodeType&&("true"==e.contentEditable||e.parentNode&&9==e.parentNode.nodeType&&"on"==e.parentNode.designMode)},isEditable:function(e){return e&&!this.isEditingHost(e)&&(1!=e.nodeType||"false"!=e.contentEditable)&&(this.isEditingHost(e.parentNode)||this.isEditable(e.parentNode))},getEditingHostOf:function(e){if(this.isEditingHost(e))return e;if(this.isEditable(e)){for(var t=e.parentNode;!this.isEditingHost(t);)t=t.parentNode;return t}return null},inSameEditingHost:function(e,t){return this.getEditingHostOf(e)&&this.getEditingHostOf(e)==this.getEditingHostOf(t)},isBlockNode:function(e){return e&&(e.nodeType==n.Node.ELEMENT_NODE&&-1==n(["inline","inline-block","inline-table","none"]).indexOf(n.getComputedStyle(e).display)||e.nodeType==n.Node.DOCUMENT_NODE||e.nodeType==n.Node.DOCUMENT_FRAGMENT_NODE)},getFirstVisibleChild:function(t,i){if(!t)return null;if(t.nodeType==n.Node.TEXT_NODE&&this.isEmpty(t)||t.nodeType==n.Node.ELEMENT_NODE&&0==t.offsetHeight&&-1===e.inArray(t.nodeName.toLowerCase(),this.nonEmptyTags))return null;if(t.nodeType==n.Node.TEXT_NODE||t.nodeType==n.Node.ELEMENT_NODE&&0==t.childNodes.length||!e(t).contentEditable())return i?t:null;var a;for(a=0;a<t.childNodes.length;++a){var r=this.getFirstVisibleChild(t.childNodes[a],!0);if(null!=r)return r}return null},getLastVisibleChild:function(t,i){if(!t)return null;if(t.nodeType==n.Node.TEXT_NODE&&this.isEmpty(t)||t.nodeType==n.Node.ELEMENT_NODE&&0==t.offsetHeight&&-1===e.inArray(t.nodeName.toLowerCase(),this.nonEmptyTags))return null;if(t.nodeType==n.Node.TEXT_NODE||t.nodeType==n.Node.ELEMENT_NODE&&0==t.childNodes.length||!e(t).contentEditable())return i?t:null;var a;for(a=t.childNodes.length-1;a>=0;--a){var r=this.getLastVisibleChild(t.childNodes[a],!0);if(null!=r)return r}return null}});return h.Utils.Dom=new g,h.Utils.Dom}),define("aloha/pluginmanager",["jquery","util/class"],function(e,t){function n(e,t){var n;for(n in t)t.hasOwnProperty(n)&&e[n]&&(e[n].settings=t[n]||{})}function i(e,t){var n,i,a=[];for(i=0;i<t.length;i++)n=e[t[i]],n&&a.push(n);return a}function a(e,t){if(0===e.length)return void(t&&t());var n,i,a,r=e.length,o=function(){0===--r&&t&&t()};for(n=0;n<e.length;n++)a=e[n],a.settings=a.settings||{},"undefined"==typeof a.settings.enabled&&(a.settings.enabled=!0),a.settings.enabled&&a.checkDependencies()?(i=a.init(),i&&"function"==typeof i.done?i.done(o):o()):o()}var r=window.Aloha;return new(t.extend({plugins:{},init:function(e,t){var o=this,s=o.plugins;n(s,r&&r.settings&&r.settings.plugins);var l;if(s&&0===t.length){t=[];for(l in s)s.hasOwnProperty(l)&&t.push(l)}a(i(s,t),e)},register:function(e){if(!e.name)throw new Error("Plugin does not have an name.");if(this.plugins[e.name])throw new Error('Already registered the plugin "'+e.name+'"!');this.plugins[e.name]=e},makeClean:function(e){var t;for(t in this.plugins)this.plugins.hasOwnProperty(t)&&(r.Log.isDebugEnabled()&&r.Log.debug(this,"Passing contents of HTML Element with id { "+e.attr("id")+" } for cleaning to plugin { "+t+" }"),this.plugins[t].makeClean(e))},toString:function(){return"pluginmanager"}}))}),define("aloha/core",["jquery","aloha/pluginmanager"],function(e,t){function n(){var e=d.browser,t=e.version;return!(e.chrome&&parseFloat(t)<21||e.webkit&&!e.chrome&&parseFloat(t)<532.5||e.mozilla&&parseFloat(t)<1.9||e.msie&&7>t||e.opera&&11>t)}function i(t){var n=e(t.target);return n.is(".aloha-dialog")||n.closest(".aloha").length}function a(){e("html").mousedown(function(e){!d.activeEditable||d.eventHandled||i(e)||d.deactivateEditable()}).mouseup(function(){d.eventHandled=!1})}function r(t,i){if(n())d.browser.webkit?e("html").addClass("aloha-webkit"):d.browser.opera?e("html").addClass("aloha-opera"):d.browser.msie?e("html").addClass("aloha-ie"+parseInt(d.browser.version,10)):d.browser.mozilla&&e("html").addClass("aloha-mozilla"),-1!==navigator.appVersion.indexOf("Win")?d.OSName="Win":-1!==navigator.appVersion.indexOf("Mac")?d.OSName="Mac":-1!==navigator.appVersion.indexOf("X11")?d.OSName="Unix":-1!==navigator.appVersion.indexOf("Linux")&&(d.OSName="Linux"),a(),d.settings.base=d.getAlohaUrl(),d.Log.init(),d.settings.errorhandling&&(window.onerror=function(e,t,n){return d.Log.error(d,"Error message: "+e+"\nURL: "+t+"\nLine Number: "+n),!0}),t(),i();else{var r=window.console;if(r){var o=r.error?"error":r.log?"log":null;o&&r[o]("This browser is not supported")}}}function o(e,t){d.RepositoryManager.init(),e(),t()}function s(e,n){if(0===d.loadedPlugins.length){var i,a=t.plugins;for(i in a)a.hasOwnProperty(i)&&d.loadedPlugins.push(i)}var r=!1;t.init(function(){r||(e(),r=!0),n()},d.loadedPlugins),r||(e(),r=!0)}function l(e,t){var n;for(n=0;n<d.editables.length;n++)d.editables[n].ready||d.editables[n].init();e(),t()}var d=window.Aloha,c=[{fn:null,event:null,deferred:null},{fn:r,event:null,deferred:null},{fn:o,event:null,deferred:null},{fn:s,event:"aloha-plugins-loaded",deferred:null},{fn:l,event:null,deferred:null},{fn:null,event:"aloha-ready",deferred:null}];return e.extend(!0,d,{version:"0.25.3",editables:[],activeEditable:null,settings:{},defaults:{},ui:{},OSName:"Unknown",loadedPlugins:[],_pluginBaseUrlByName:{},init:function(){d.initialize(c)},getLoadedPlugins:function(){return this.loadedPlugins},isPluginLoaded:function(t){var n=!1;return e.each(this.loadedPlugins,function(e,i){return t===i.toString()?(n=!0,!1):void 0}),n},activateEditable:function(e){var t,n=d.editables;for(t=0;t<n.length;t++)n[t]!==e&&n[t].isActive&&n[t].blur();d.activeEditable=e},getActiveEditable:function(){return d.activeEditable},deactivateEditable:function(){d.activeEditable&&(d.activeEditable.blur(),d.activeEditable=null)},getEditableById:function(t){var n=e("#"+t);n.length&&"textarea"===n[0].nodeName.toLowerCase()&&(t+="-aloha");var i;for(i=0;i<d.editables.length;i++)if(d.editables[i].getId()===t)return d.editables[i];return null},isEditable:function(e){var t,n;for(t=0,n=d.editables.length;n>t;t++)if(d.editables[t].originalObj.get(0)===e)return!0;return!1},getEditableHost:function(){var e=function(e){var t;for(t=0;t<d.editables.length;t++)if(d.editables[t].originalObj[0]===e)return d.editables[t];return null};return function(t){if(!t||0===t.length)return null;var n=e(t[0]);return n||t.parents().each(function(t,i){return n=e(i),n?!1:void 0}),n}}(),log:function(e,t,n){"undefined"!=typeof d.Log&&d.Log.log(e,t,n)},registerEditable:function(e){d.editables.push(e)},unregisterEditable:function(t){var n=e.inArray(t,d.editables);-1!==n&&d.editables.splice(n,1)},isModified:function(){var e;for(e=0;e<d.editables.length;e++)if(d.editables[e].isModified&&d.editables[e].isModified())return!0;return!1},getAlohaUrl:function(){return d.settings.baseUrl||""},getPluginUrl:function(e){if(!e)return null;var t=d.settings._pluginBaseUrlByName[e];return t&&(t.match("^(/|http[s]?:).*")||(t=d.getAlohaUrl()+"/"+t)),t},disableObjectResizing:function(){try{var e;try{e=document.queryCommandSupported("enableObjectResizing")}catch(t){e=!1,d.Log.log("enableObjectResizing is not supported.")}e&&(document.execCommand("enableObjectResizing",!1,!1),d.Log.log("enableObjectResizing disabled."))}catch(n){d.Log.error(n,"Could not disable enableObjectResizing")}},toString:function(){return"Aloha"},browser:function(){function e(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}var t=e(navigator.userAgent),n={};return t.browser&&(n[t.browser]=!0,n.version=t.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),n
}()}),d}),define("aloha/console",["aloha/core","util/class","jquery"],function(e,t){var n=t.extend({init:function(){"undefined"!=typeof e.settings.logLevels&&e.settings.logLevels||(e.settings.logLevels={error:!0,warn:!0}),"undefined"!=typeof e.settings.logHistory&&e.settings.logHistory||(e.settings.logHistory={}),e.settings.logHistory.maxEntries||(e.settings.logHistory.maxEntries=100),e.settings.logHistory.highWaterMark||(e.settings.logHistory.highWaterMark=90),e.settings.logHistory.levels||(e.settings.logHistory.levels={error:!0,warn:!0}),this.flushLogHistory(),e.trigger("aloha-logger-ready")},logHistory:[],highWaterMarkReached:!1,log:function(t,n,i){if("undefined"==typeof n&&(i=t),"string"!=typeof n&&n&&n.toString&&(n=n.toString()),"undefined"==typeof i&&(i=n,n=void 0),"undefined"!=typeof t&&t||(t="log"),t=t.toLowerCase(),"undefined"!=typeof e.settings.logLevels&&e.settings.logLevels[t]){n=n||"Unkown Aloha Component",this.addToLogHistory({level:t,component:n,message:i,date:new Date});var a=window.console;switch(t){case"error":window.console&&a.error&&a.error(n||i?n+": "+i:"Error occured without message and component");break;case"warn":window.console&&a.warn&&a.warn(n+": "+i);break;case"info":window.console&&a.info&&a.info(n+": "+i);break;case"debug":window.console&&a.log&&a.log(n+" ["+t+"]: "+i);break;default:window.console&&a.log&&a.log(n+" ["+t+"]: "+i)}}},error:function(e,t){this.log("error",e,t)},warn:function(e,t){this.log("warn",e,t)},info:function(e,t){this.log("info",e,t)},debug:function(e,t){this.log("debug",e,t)},deprecated:function(t,n){if(this.log("warn",t,n),e.settings.logLevels.deprecated)throw new Error(n)},isLogLevelEnabled:function(t){return e.settings&&e.settings.logLevels&&e.settings.logLevels[t]},isErrorEnabled:function(){return this.isLogLevelEnabled("error")},isWarnEnabled:function(){return this.isLogLevelEnabled("warn")},isInfoEnabled:function(){return this.isLogLevelEnabled("info")},isDebugEnabled:function(){return this.isLogLevelEnabled("debug")},addToLogHistory:function(t){if(e.settings.logHistory||this.init(),!(e.settings.logHistory.maxEntries<=0)&&e.settings.logHistory.levels[t.level])for(this.logHistory.push(t),this.highWaterMarkReached||this.logHistory.length>=e.settings.logHistory.maxEntries*e.settings.logHistory.highWaterMark/100&&(e.trigger("aloha-log-full"),this.highWaterMarkReached=!0);this.logHistory.length>e.settings.logHistory.maxEntries;)this.logHistory.shift()},getLogHistory:function(){return this.logHistory},flushLogHistory:function(){this.logHistory=[],this.highWaterMarkReached=!1}});return n=new n,e.Log=e.Console=n,n}),window.GENTICS=window.GENTICS||{},window.GENTICS.Utils=window.GENTICS.Utils||{},define("util/range",["jquery","util/dom","util/class","aloha/console","aloha/rangy-core"],function(e,t,n,i,a){function r(e,t){var n,i=[];for(n=1===e.nodeType?e:e.parentNode;n&&n!==t&&9!==n.nodeType;)1===n.nodeType&&i.push(n),n=n.parentNode;return i}function o(e,t,n){var i,a,r=e.length;for(a=0;r>a;a++)i=e[a],"none"!==i.type&&"collapsed"!==i.type&&(i.domobj.nodeName===t&&n.push(i.domobj),i.children.length>0&&o(i.children,t,n))}var s=window.GENTICS,l=window.Aloha;return s.Utils.RangeObject=n.extend({_constructor:function(e){"object"==typeof e?("undefined"!=typeof e.startContainer&&(this.startContainer=e.startContainer),"undefined"!=typeof e.startOffset&&(this.startOffset=e.startOffset),"undefined"!=typeof e.endContainer&&(this.endContainer=e.endContainer),"undefined"!=typeof e.endOffset&&(this.endOffset=e.endOffset)):e===!0&&this.initializeFromUserSelection()},startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0,deleteContents:function(){t.removeRange(this)},log:function(e){i.deprecated("Utils.RangeObject",'log() is deprecated. use console.log() from module "aloha/console" instead: '+e)},isCollapsed:function(){return!this.endContainer||this.startContainer===this.endContainer&&this.startOffset===this.endOffset},getCommonAncestorContainer:function(){return this.commonAncestorContainer?this.commonAncestorContainer:(this.updateCommonAncestorContainer(),this.commonAncestorContainer)},getContainerParents:function(t,n){var i=n?this.endContainer:this.startContainer;return i?e(r(i,t?t[0]:null)):!1},getStartContainerParents:function(e){return this.getContainerParents(e,!1)},getEndContainerParents:function(e){return this.getContainerParents(e,!0)},updateCommonAncestorContainer:function(e){if(e)this.commonAncestorContainer=e;else{var t,n=this.getStartContainerParents(),a=this.getEndContainerParents();if(!(n.length>0&&a.length>0))return i.warn("aloha/range","could not find commonAncestorContainer"),!1;for(t=0;t<n.length;t++)if(-1!=a.index(n[t])){this.commonAncestorContainer=n[t];break}}return i.debug(e?"commonAncestorContainer was set successfully":"commonAncestorContainer was calculated successfully"),!0},getCollapsedIERange:function(e,t){var n,i,a,r,o=document.body.createTextRange();return r=this.searchElementToLeft(e,t),r.element?(n=document.body.createTextRange(),n.moveToElementText(r.element),o.setEndPoint("StartToEnd",n),0!==r.characters?o.moveStart("character",r.characters):(o.moveStart("character",1),o.moveStart("character",-1))):(i=this.searchElementToRight(e,t),a=3==e.nodeType?e.parentNode:e,n=document.body.createTextRange(),n.moveToElementText(a),o.setEndPoint("StartToStart",n),0!==r.characters&&o.moveStart("character",r.characters)),o.collapse(),o},select:function(){var e,t;if("undefined"==typeof this.startContainer||"undefined"==typeof this.endContainer)return i.warn("can not select an empty range"),!1;e=a.createRange(),e.setStart(this.startContainer,this.startOffset),e.setEnd(this.endContainer,this.endOffset),t=a.getSelection();try{t.setSingleRange(e)}catch(n){i.warn(n)}},searchElementToLeft:function(e,t){var n,i=0;for(3===e.nodeType?(i=t,n=e.previousSibling):t>0&&(n=e.childNodes[t-1]);n&&3===n.nodeType;)i+=n.data.length,n=n.previousSibling;return{element:n,characters:i}},searchElementToRight:function(e,t){var n,i=0;for(3===e.nodeType?(i=e.data.length-t,n=e.nextSibling):t<e.childNodes.length&&(n=e.childNodes[t]);n&&3===n.nodeType;)i+=n.data.length,n=n.nextSibling;return{element:n,characters:i}},update:function(e){i.debug("now updating rangeObject"),this.initializeFromUserSelection(e),this.updateCommonAncestorContainer()},initializeFromUserSelection:function(){var e,t=a.getSelection();return t&&t.rangeCount&&(e=t.getRangeAt(0))?(this.startContainer=e.startContainer,this.endContainer=e.endContainer,this.startOffset=e.startOffset,this.endOffset=e.endOffset,void this.correctRange()):!1},correctRange:function(){var t,n,i,a,r;if(this.clearCaches(),this.isCollapsed()){if(1===this.startContainer.nodeType){if(this.startOffset>0&&3===this.startContainer.childNodes[this.startOffset-1].nodeType)return this.startContainer=this.startContainer.childNodes[this.startOffset-1],this.startOffset=this.startContainer.data.length,this.endContainer=this.startContainer,void(this.endOffset=this.startOffset);if(this.startOffset>0&&1===this.startContainer.childNodes[this.startOffset-1].nodeType){if(t=s.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!0))return this.startContainer=this.endContainer=t,void(this.startOffset=this.endOffset=t.data.length);if(t=s.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!1))return this.startContainer=this.endContainer=t,void(this.startOffset=this.endOffset=0)}if(this.startOffset<this.startContainer.childNodes.length&&3===this.startContainer.childNodes[this.startOffset].nodeType)return this.startContainer=this.startContainer.childNodes[this.startOffset],this.startOffset=0,this.endContainer=this.startContainer,void(this.endOffset=0)}3===this.startContainer.nodeType&&0===this.startOffset&&(t=s.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,s.Utils.Dom.getIndexInParent(this.startContainer),!0),t&&e(t).closest(l.activeEditable.obj).length>0&&(this.startContainer=this.endContainer=t,this.startOffset=this.endOffset=t.data.length))}else{if(1===this.startContainer.nodeType)if(this.startOffset<this.startContainer.childNodes.length&&3===this.startContainer.childNodes[this.startOffset].nodeType)this.startContainer=this.startContainer.childNodes[this.startOffset],this.startOffset=0;else if(this.startOffset<this.startContainer.childNodes.length&&1===this.startContainer.childNodes[this.startOffset].nodeType){for(n=!1,i=this.startContainer.childNodes[this.startOffset];n===!1&&i.childNodes&&i.childNodes.length>0;)i=i.childNodes[0],3===i.nodeType&&(n=i);n!==!1&&(this.startContainer=n,this.startOffset=0)}if(3===this.startContainer.nodeType&&this.startOffset===this.startContainer.data.length&&(t=s.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,s.Utils.Dom.getIndexInParent(this.startContainer)+1,!1),t&&(this.startContainer=t,this.startOffset=0)),3===this.endContainer.nodeType&&0===this.endOffset)if(this.endContainer.previousSibling&&3===this.endContainer.previousSibling.nodeType)this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length;else if(this.endContainer.previousSibling&&1===this.endContainer.previousSibling.nodeType&&this.endContainer.parentNode){for(a=this.endContainer.parentNode,r=0;r<a.childNodes.length;++r)if(a.childNodes[r]==this.endContainer){this.endOffset=r;break}this.endContainer=a}if(1==this.endContainer.nodeType&&0===this.endOffset&&this.endContainer.previousSibling&&(3===this.endContainer.previousSibling.nodeType?(this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length):1===this.endContainer.previousSibling.nodeType&&this.endContainer.previousSibling.childNodes&&this.endContainer.previousSibling.childNodes.length>0&&(this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.childNodes.length)),1==this.endContainer.nodeType)if(this.endOffset>0&&3===this.endContainer.childNodes[this.endOffset-1].nodeType)this.endContainer=this.endContainer.childNodes[this.endOffset-1],this.endOffset=this.endContainer.data.length;else if(this.endOffset>0&&1===this.endContainer.childNodes[this.endOffset-1].nodeType){for(n=!1,i=this.endContainer.childNodes[this.endOffset-1];n===!1&&i.childNodes&&i.childNodes.length>0;)i=i.childNodes[i.childNodes.length-1],3===i.nodeType&&(n=i);n!==!1&&(this.endContainer=n,this.endOffset=this.endContainer.data.length)}}},clearCaches:function(){this.commonAncestorContainer=void 0},getRangeTree:function(e){return"undefined"==typeof e&&(e=this.getCommonAncestorContainer()),this.inselection=!1,this.recursiveGetRangeTree(e)},recursiveGetRangeTree:function(t){var n=e(t),i=0,a=this,r=[];return n.contents().each(function(e){var n,o="none",l=!1,d=!1,c=!1,u=!1,h=!1,p=!1;if(a.isCollapsed()&&t===a.startContainer&&a.startOffset===e&&(r[i]=new s.Utils.RangeTree,r[i].type="collapsed",r[i].domobj=void 0,a.inselection=!1,c=!0,i++),!a.inselection&&!c)switch(this.nodeType){case 3:this===a.startContainer&&(a.inselection=!0,o=a.startOffset>0?"partial":"full",l=a.startOffset,d=this.length);break;case 1:this===a.startContainer&&0===a.startOffset&&(a.inselection=!0,o="full"),t===a.startContainer&&a.startOffset===e&&(a.inselection=!0,o="full")}if(a.inselection&&!c){switch("none"==o&&(o="full"),this.nodeType){case 3:this===a.endContainer&&(a.inselection=!1,a.endOffset<this.length&&(o="partial"),l===!1&&(l=0),d=a.endOffset);break;case 1:this===a.endContainer&&0===a.endOffset&&(a.inselection=!1)}t===a.endContainer&&a.endOffset<=e&&(a.inselection=!1,o="none")}if(r[i]=new s.Utils.RangeTree,r[i].domobj=this,r[i].type=o,"partial"==o&&(r[i].startOffset=l,r[i].endOffset=d),r[i].children=a.recursiveGetRangeTree(this),r[i].children.length>0){for(n=0;n<r[i].children.length;++n)switch(r[i].children[n].type){case"none":u=!0;break;case"full":p=!0;break;case"partial":h=!0}h||p&&u?r[i].type="partial":!p||h||u||(r[i].type="full")}i++}),this.isCollapsed()&&t===this.startContainer&&this.startOffset==t.childNodes.length&&(r[i]=new s.Utils.RangeTree,r[i].type="collapsed",r[i].domobj=void 0),r},findMarkup:function(e,t,n){var i,a,o,s=n?this.endContainer:this.startContainer;if(t=t?t[0]:null,s){for(i=r(s,t),a=0,o=i.length;o>a;a++)if(e.apply(i[a]))return i[a];return!1}},findAllMarkupByTagName:function(e,t){var n=t.getRangeTree(),i=[];return e=e.toUpperCase(),o(n,e,i),i},getText:function(){return this.isCollapsed()?"":this.recursiveGetText(this.getRangeTree())},recursiveGetText:function(t){if(!t)return"";var n=this,i="";return e.each(t,function(){"full"==this.type?i+=e(this.domobj).text():"partial"==this.type&&3===this.domobj.nodeType?i+=e(this.domobj).text().substring(this.startOffset,this.endOffset):"partial"==this.type&&1===this.domobj.nodeType&&this.children&&(i+=n.recursiveGetText(this.children))}),i}}),s.Utils.RangeTree=n.extend({domobj:{},type:null,children:[]}),s.Utils.RangeObject}),define("util/functions",[],function(){function e(e){return e}function t(){}function n(){return!0}function i(){return!1}function a(e){return function(){return!e.apply(this,arguments)}}return{identity:e,noop:t,returnTrue:n,returnFalse:i,complement:a}}),define("util/arrays",["util/functions"],function(e){function t(e,t){var n;if(t)for(e.sort(t),n=1;n<e.length;n++)0===t(e[n],e[n-1])&&e.splice(n--,1);else for(e.sort(),n=1;n<e.length;n++)e[n]==e[n-1]&&e.splice(n--,1);return e}function n(e,t,n){var i,a=e.length;if(a!==t.length)return!1;if(n){for(i=0;a>i;i++)if(!n(e[i],t[i]))return!1}else for(i=0;a>i;i++)if(e[i]!==t[i])return!1;return!0}function i(e,t){var n,i,a=[];for(n=0,i=e.length;i>n;n++)a.push(t(e[n]));return a}function a(e,t){return e.map(t)}function r(e,t){var n,i,a,r=[];for(n=0,i=e.length;i>n;n++)a=e[n],t(a)&&r.push(a);return r}function o(e,t){var n,i;for(n=0,i=e.length;i>n;n++)if(t===e[n])return n;return-1}function s(e,t,n){var i,a;for(i=0,a=e.length;a>i;i++)t=n(t,e[i]);return t}function l(e,t){return-1!==o(e,t)}function d(e,t){return null==e?null:t(e)}function c(e,t){var n,i;for(n=0,i=e.length;i>n;n++)t(e[n],n,e)}function u(e,t){var n,i;for(n=0,i=e.length;i>n;n++)if(t(e[n]))return!0;return!1}function h(t,n){return!u(t,e.complement(n))}function p(e,t){return r(e,function(e){return l(t,e)})}function f(e,t){return r(e,function(e){return!l(t,e)})}function g(e){return e.length?e[e.length-1]:null}function m(e){return e[1]}return{filter:r,indexOf:o,reduce:s,forEach:c,some:u,every:h,map:Array.prototype.map?a:i,contains:l,equal:n,applyNotNull:d,sortUnique:t,intersect:p,subtract:f,second:m,last:g}}),define("util/strings",["jquery"],function(){function e(e){var t=e.split(r);return t.length&&""===t[0]&&t.shift(),t.length&&""===t[t.length-1]&&t.pop(),t}function t(e){return e.replace(/[\-]([a-z])/gi,function(e,t){return t.toUpperCase()})}function n(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}function i(e,t){for(var n,i=[],a=0;null!=(n=t.exec(e));)a<n.index&&(i.push(e.substring(a,n.index)),a=n.index),a+=n[0].length,i.push(n[0]);return a<e.length&&i.push(e.substring(a,e.length)),i}function a(e){return""===e||null==e}var r=/\s+/;return{words:e,dashesToCamelCase:t,camelCaseToDashes:n,splitIncl:i,empty:a}}),define("util/maps",[],function(){function e(e){var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function t(e,t,n){for(var i=t.length;i--;)e[t[i]]=n;return e}function n(e,t){for(var n,i=t.length;i--;)n=t[i],e[n[0]]=n[1];return e}function i(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}function a(e,t){var n;for(n in e)e.hasOwnProperty(n)&&t(e[n],n,e)}return{isEmpty:e,fillTuples:n,fillKeys:t,keys:i,forEach:a}}),define("util/browser",["aloha/core"],function(e){return{mozilla:e.browser.mozilla,ie8:e.browser.msie&&parseInt(e.browser.version,10)<9,ie7:e.browser.msie&&parseInt(e.browser.version,10)<8,ie:e.browser.msie}}),define("util/dom2",["aloha/core","jquery","util/functions","util/maps","util/arrays","util/strings","util/browser","util/dom","util/range"],function(e,t,n,i,a,r,o,s,l){function d(e,t,n){for(;t;){var i=t.nextSibling;e.insertBefore(t,n),t=i}}function c(e){var t=e.outerHTML;if("undefined"!=typeof t)return t;try{return ut?ut.serializeToString(e):e.xml}catch(n){return e.xml}}function u(e){for(var t,n=[],i=c(e.cloneNode(!1));null!=(t=ct.exec(i));)n.push(t[1]);return n}function h(e){var n,i,a=[],r=u(e);for(n=0,i=r.length;i>n;n++){var o=r[n],s=t.attr(e,o);s=null==s?"":s.toString(),a.push([o,s])}return a}function p(e,t){var n,i,a,o,s,l,d,c={};for(l=0,s=e.length;s>l;l++)if(a=e[l],a.className)for(i=r.words(a.className),d=0;d<i.length;d++)o=i[d],t[o]&&(n=c[o],n?n.push(a):c[o]=[a]);return c}function f(e,n){var a;return a=o.ie7?e.getElementsByTagName("*"):t(e).find("."+i.keys(n).join(",.")),p(a,n)}function g(e,n){var i,a,r={};for(i=0,a=n.length;a>i;i++){var o=n[i];r[o]=t.makeArray(e.getElementsByTagName(o))}return r}function m(e){for(var t=0;e.previousSibling;)t++,e=e.previousSibling;return t}function b(e){for(var t=0,n=e.firstChild;n;)t+=1,n=n.nextSibling;return t}function v(e){return 1===e.nodeType?b(e):3===e.nodeType?e.length:0}function y(e,t){return 1===e.nodeType&&t>=b(e)||3===e.nodeType&&t===e.length&&!e.nextSibling}function _(e,t){return 1===e.nodeType&&t<b(e)?e=e.childNodes[t]:3===e.nodeType&&t===e.length&&(e=e.nextSibling||e.parentNode),e}function w(e){var t=e.parentNode;d(t,e.firstChild,e),t.removeChild(e)}function C(e,t){e.parentNode.replaceChild(t,e),t.appendChild(e)}function k(e,t,n){n?t.appendChild(e):t.parentNode.insertBefore(e,t)}function x(e,t){this.node=e,this.atEnd=t}function S(e,t){return new x(e,t)}function j(e,t){return S(_(e,t),y(e,t))}function N(e,t){for(var n=[],i=e.parentNode;i&&!t(i);)n.push(i),i=i.parentNode;return n}function T(e,t){var n=N(e,t),i=n.length?n[n.length-1]:e;return i.parentNode&&n.push(i.parentNode),n}function E(e,t){if(t(e))return[];var n=N(e,t);return n.unshift(e),n}function A(e,t){if(t(e))return[e];var n=T(e,t);return n.unshift(e),n}function D(e,t){return E(e,function(e){return e===t})}function O(e,t){return A(e,function(e){return e===t})}function I(e,t,n){for(;e&&!t(e,n);)e=e.nextSibling;return e}function M(e,t,n){for(;e&&!t(e,n);)e=e.parentNode;return e}function R(e){return 3===e.nodeType}function P(e,t){var n=e.parentNode,i=e.nodeValue;if(0===t||t>=i.length)return e;var a=document.createTextNode(i.substring(0,t)),r=document.createTextNode(i.substring(t,i.length));return n.insertBefore(a,e),n.insertBefore(r,e),n.removeChild(e),a}function F(e,t,n,i,a,r){if(t===a){var o=r.length;if(0===n)t=r.parentNode,n=m(r);else if(o>n)t=r;else if(n===o)t=r.parentNode,n=m(r)+1;else{var s=r.nextSibling;t=s,n-=o}e[i].call(e,t,n)}}function z(e,t,n){if(3===e.nodeType){var i=n.startContainer,a=n.startOffset,r=n.endContainer,o=n.endOffset,s=P(e,t);F(n,i,a,"setStart",e,s),F(n,r,o,"setEnd",e,s)}}function B(e){var t=e.startContainer,n=e.startOffset;z(t,n,e);var i=e.endContainer,a=e.endOffset;z(i,a,e)}function L(e,t,n,i){for(;e&&!n(e,i);){var a=e.nextSibling;t(e,i),e=a}}function q(e,t,i){L(e,t,n.returnFalse,i)}function H(e,t,n){1===e.nodeType&&q(e.firstChild,function(e){H(e,t,n)}),t(e,n)}function $(e,t,n,i){L(e,t,function(e){return e===n},i)}function W(e){e&&(this.startContainer=e.startContainer,this.startOffset=e.startOffset,this.endContainer=e.endContainer,this.endOffset=e.endOffset,this.commonAncestorContainer=e.commonAncestorContainer,this.collapsed=e.collapsed)}function G(e,t){t.atEnd?e.setStart(t.node,b(t.node)):e.setStart(t.node.parentNode,m(t.node))}function U(e,t){t.atEnd?e.setEnd(t.node,b(t.node)):e.setEnd(t.node.parentNode,m(t.node))}function K(e,t){e.setStart(t.startContainer,t.startOffset),e.setEnd(t.endContainer,t.endOffset)}function V(e){return new W(e)}function Y(e,t,n){if(!e.collapsed){for(var i=j(e.startContainer,e.startOffset),a=j(e.endContainer,e.endOffset),r=!1;!i.equals(a)&&t(i)&&i.next();)r=!0;n=n||t;var o=!1;for(3===e.endContainer.nodeType&&e.endOffset>0&&e.endOffset<e.endContainer.length&&a.next()&&n(a)&&a.prev();!a.equals(i)&&n(a)&&a.prev();)o=!0;r&&G(e,i),o&&U(e,a)}}function X(e,t,n){n=n||t,Y(e,function(e){return e.atEnd||t(e.node)},function(e){var t=e.atEnd?e.node.lastChild:e.node.previousSibling;return!t||n(t)})}function Q(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}function J(e,t){if(e.length){z(t.startContainer,t.startOffset,t);var n=_(t.startContainer,t.startOffset),i=y(t.startContainer,t.startOffset);if(!i&&3===n.nodeType)return n.insertData(0,e),t.setStart(n,0),void t.setEnd(n,e.length);var a;if(a=i?n.lastChild:n.previousSibling,a&&3===a.nodeType)return a.insertData(a.length,e),t.setStart(a,a.length-e.length),void t.setEnd(a,a.length);var r=document.createTextNode(e);k(r,n,i),t.setStart(r,0),t.setEnd(r,r.length)}}function Z(e){e.setStart(e.endContainer,e.endOffset)}function et(t){var n=e.createRange();return n.setStart(t.startContainer,t.startOffset),n.setEnd(t.endContainer,t.endOffset),n}function tt(e){var t=new l(e);s.extendToWord(t),K(e,t)}function nt(e){return e.cloneNode(!1)}function it(e,n,i){t(e).css(n,null==i?"":i)}function at(e,t){return t=r.dashesToCamelCase(t),1===e.nodeType?e.style[t]:null}function rt(e,t){if(e.currentStyle)return e.currentStyle[t];var n=e.ownerDocument;if(n.defaultView&&n.defaultView.getComputedStyle){var i=n.defaultView.getComputedStyle(e,null);if(i)return i[t]||i.getPropertyValue(t)}return null}function ot(e){if(e.firstChild)return e.firstChild;for(var t=e;t&&!t.nextSibling;)t=t.parentNode;return t&&t.nextSibling}function st(e){for(var t=e.previousSibling;t&&t.lastChild;)t=t.lastChild;return t||e.parentNode}function lt(e,t,n){for(;e&&!n(e);){if(t(e))return e;e=ot(e)}return null}function dt(e,t,n){for(;e&&!n(e);){if(t(e))return e;e=st(e)}return null}var ct=/\s([^\/<>\s=]+)(?:=(?:"[^"]*"|'[^']*'|[^>\/\s]+))?/g,ut=window.XMLSerializer&&new window.XMLSerializer;return x.prototype.next=function(){var e,t=this.node;if(this.atEnd||1!==t.nodeType){if(e=t.nextSibling)this.atEnd=!1;else{if(e=t.parentNode,!e)return!1;this.atEnd=!0}this.node=e}else e=t.firstChild,e?this.node=e:this.atEnd=!0;return!0},x.prototype.prev=function(){var e,t=this.node;if(this.atEnd)e=t.lastChild,e?this.node=e:this.atEnd=!1;else{if(e=t.previousSibling)1===t.nodeType&&(this.atEnd=!0);else if(e=t.parentNode,!e)return!1;this.node=e}return!0},x.prototype.equals=function(e){return e.node===this.node&&e.atEnd===this.atEnd},x.prototype.clone=function(e){return e(e.node,e.atEnd)},x.prototype.insert=function(e){return k(e,this.node,this.atEnd)},W.prototype.update=function(){if(this.startContainer&&this.endContainer){this.collapsed=this.startContainer===this.endContainer&&this.startOffset===this.endOffset;var e=E(this.startContainer,n.returnFalse),t=E(this.endContainer,n.returnFalse);this.commonAncestorContainer=a.intersect(e,t)[0]}},W.prototype.setStart=function(e,t){this.startContainer=e,this.startOffset=t,this.update()},W.prototype.setEnd=function(e,t){this.endContainer=e,this.endOffset=t,this.update()},{backward:st,forward:ot,findForward:lt,findBackward:dt,moveNextAll:d,attrNames:u,attrs:h,indexByClass:f,indexByName:g,indexByClassHaveList:p,outerHtml:c,removeShallow:w,wrap:C,insert:k,cursor:S,cursorFromBoundaryPoint:j,nodeAtOffset:_,isAtEnd:y,parentsUntil:N,parentsUntilIncl:T,childAndParentsUntil:E,childAndParentsUntilIncl:A,childAndParentsUntilNode:D,childAndParentsUntilInclNode:O,next:I,parent:M,isTextNode:R,nodeIndex:m,splitTextNode:P,splitTextContainers:B,walk:q,walkRec:H,walkUntil:L,walkUntilNode:$,stableRange:V,trimRange:Y,trimRangeClosingOpening:X,setRangeFromRef:K,setRangeStartFromCursor:G,setRangeEndFromCursor:U,splitTextNodeAdjustRange:z,insertSelectText:J,areRangesEq:Q,collapseToEnd:Z,extendToWord:tt,rangeFromRangeObject:et,cloneShallow:nt,setStyle:it,getStyle:at,getComputedStyle:rt,nodeLength:v}}),define("PubSub",[],function(){function e(e){return i[e]&&n[i[e].channel]}function t(e,t){if(!n[e])return 0;t?"object"!=typeof t&&(t={data:t}):t={},t.channel=e;var a,r=n[e].slice();for(a=0;a<r.length;++a)i[r[a]].callback(t);return a}var n={},i={},a=0,r={sub:function(e,t){if("function"!=typeof t)return-1;var r=n[e];return r||(r=n[e]=[]),r.push(++a),i[a]={channel:e,callback:t},a},unsub:function(t){if(-1===t||!i[t])return!1;var n=e(t);delete i[t];for(var a=n.length;a;)if(n[--a]===t)return n.splice(a,1),!0;return!1},pub:function(e,n){var i,a=e.split("."),r=a.length,o="",s=0;for(i=0;r>i;++i)o+=(0===i?"":".")+a[i],s+=t(o,n);return s}};return r}),define("util/html",["jquery","util/dom","util/maps","util/arrays"],function(e,t,n,i){function a(e){return x.test(e)||N.test(e)}function r(e){return 3===e.nodeType&&a(e.data)}function o(e){var t,n,i=e.childNodes;for(t=0,n=i.length;n>t;t++)if(!r(i[t]))return!1;return!0}function s(e){return A[e.nodeName]}function l(e){return 3===e.nodeType&&!e.length}function d(e){return b[e.nodeName]}function c(e){if(!A[e.nodeName])return!1;var t,n=!1,i=e.children,a=i.length;for(t=0;a>t;t++)if(n||"br"!==i[t].nodeName.toLowerCase()){if(!l(i[t]))return!1}else n=!0;return n}function u(e){return 1===e.nodeType&&"true"===e.contentEditable}function h(e,t){for(;e&&!t(e);)e=e.previousSibling;return e}function p(e,t){for(;e&&!t(e);)e=e.nextSibling;return e}function f(n){return n.obj[0]&&t.allowsNesting(n.obj[0],e("<p>")[0])?!0:!1}function g(e){return e.replace(S,"").replace(j,"").replace(T,"").replace(E,"")}function m(e){return 3===e.nodeType&&0===e.data.length?!0:e===e.parentNode.lastChild&&s(e.parentNode)&&"BR"===e.nodeName?!0:r(e)}var b={A:!0,B:!0,EM:!0,FONT:!0,I:!0,S:!0,SPAN:!0,STRIKE:!0,STRONG:!0,SUB:!0,SUP:!0,U:!0},v=["address","article","aside","audio","blockquote","canvas","dd","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","noscript","ol","output","p","pre","section","table","tfoot","ul","video"],y=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],_=["a","abbr","b","bdi","bdo","cite","code","del","dfn","em","i","ins","kbd","mark","q","rp","rt","ruby","s","samp","small","strong","sub","sup","time","u","var"],w=["\\u200B","\\u200C","\\u200D","\\uFEFF"],C=["\\u0009","\\u000A","\\u000B","\\u000C","\\u000D","\\u0020","\\u0085","\\u00A0","\\u1680","\\u180E","\\u2000","\\u2001","\\u2002","\\u2003","\\u2004","\\u2005","\\u2006","\\u2007","\\u2008","\\u2009","\\u200A","\\u2028","\\u2029","\\u202F","\\u205F","\\u3000"],k=C.join(""),x=new RegExp("^["+k+"]+$"),S=new RegExp("^["+k+"]+"),j=new RegExp("["+k+"]+$"),N=new RegExp("["+w.join("")+"]+"),T=new RegExp("^["+w.join("")+"]+"),E=new RegExp("["+w.join("")+"]+$"),A={};return n.fillKeys(A,v,!0),n.fillKeys(A,i.map(v,function(e){return e.toUpperCase()}),!0),{BLOCKLEVEL_ELEMENTS:v,VOID_ELEMENTS:y,TEXT_LEVEL_SEMANTIC_ELEMENTS:_,isBlock:s,isIgnorableWhitespace:l,isInlineFormattable:d,isProppedBlock:c,isEditingHost:u,findNodeLeft:p,findNodeRight:h,allowNestedParagraph:f,trimWhitespaceCharacters:g,isWSPorZWSPNode:r,isWSPorZWSPText:a,isUnrenderedNode:m,hasOnlyWhiteSpaceChildren:o}}),define("aloha/engine",["aloha/core","aloha/ecma5shims","util/maps","util/html","util/dom","jquery"],function(e,t,n,i,a,r){function o(e,t){var n=e.hasAttribute;return n?e.hasAttribute(t):"undefined"!=typeof e.attributes[t]}function s(e,t){var n=t.nextSibling,i=t.parentNode;return n?i.insertBefore(e,n):i.appendChild(e),e}function l(e,t){var n=e.cloneNode(!1);return n.deleteData(0,t),e.deleteData(t,e.length-t),s(n,e),n}function d(e){return null===e||!e||e===Tn}function c(e,n){return"string"==typeof n&&(n=[n]),"object"==typeof n&&(n=t(n).map(function(e){return e.toUpperCase()})),e&&1==e.nodeType&&d(e.namespaceURI)&&("undefined"==typeof n||-1!=t(n).indexOf(e.tagName))}function u(e){return e&&1==e.nodeType&&d(e.namespaceURI)}function h(e,t){return e&&1==e.nodeType&&d(e.namespaceURI)&&t.toUpperCase()===e.nodeName}function p(e,t){var n,i;for(t=t.toUpperCase(),n=0,i=e.length;i>n;n++)if(e[n].toUpperCase()===t)return!0;return!1}function f(e,t){return e&&1==e.nodeType&&d(e.namespaceURI)&&p(t,e.nodeName)}function g(e,t){return e&&1==e.nodeType&&d(e.namespaceURI)&&t[e.nodeName]}function m(e){var t,n=0;if(!e)return 0;if(!e.style)return 0;if("undefined"!=typeof e.style.length)return e.style.length;for(t in e.style)e.style[t]&&0!==e.style[t]&&"false"!==e.style[t]&&n++;return n}function b(e){if(!e)return null;var t,n=[],i=e.length;for(t=i>>>0;t--;)n[t]=e[t];return n}function v(e){for(;e&&!e.nextSibling;)e=e.parentNode;return e?e.nextSibling:null}function y(e){return e.hasChildNodes()?e.firstChild:v(e)}function _(e){if(e.previousSibling){for(e=e.previousSibling;e.hasChildNodes();)e=e.lastChild;return e}return e.parentNode&&e.parentNode.nodeType==t.Node.ELEMENT_NODE?e.parentNode:null}function w(e,n){return e&&n&&Boolean(t.compareDocumentPosition(e,n)&t.Node.DOCUMENT_POSITION_CONTAINED_BY)}function C(e,t){return(e||t)&&(e==t||w(e,t))}function k(e,n){return n&&e&&Boolean(t.compareDocumentPosition(n,e)&t.Node.DOCUMENT_POSITION_CONTAINED_BY)}function x(e,n){return Boolean(t.compareDocumentPosition(e,n)&t.Node.DOCUMENT_POSITION_FOLLOWING)}function S(e){for(var t=[];e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t}function j(e){for(var t=[],n=v(e);null!=(e=y(e))&&e!=n;)t.push(e);return t}function N(e){return{"xx-small":1,small:2,medium:3,large:4,"x-large":5,"xx-large":6,"xxx-large":7}[e]}function T(e){return"ltr"==e.dir?"ltr":"rtl"==e.dir?"rtl":u(e.parentNode)?T(e.parentNode):"ltr"}function E(e){switch(e.nodeType){case t.Node.PROCESSING_INSTRUCTION_NODE:case t.Node.DOCUMENT_TYPE_NODE:return 0;case t.Node.TEXT_NODE:case t.Node.COMMENT_NODE:return e.length;default:return e.childNodes.length}}function A(e,n,i,r){if(e==i){if(n==r)return"equal";if(r>n)return"before";if(n>r)return"after"}var o=t.compareDocumentPosition(i,e);if(o&t.Node.DOCUMENT_POSITION_FOLLOWING){var s=A(i,r,e,n);if("before"==s)return"after";if("after"==s)return"before"}if(o&t.Node.DOCUMENT_POSITION_CONTAINS){for(var l=i;l.parentNode!=e;)l=l.parentNode;if(a.getIndexInParent(l)<n)return"after"}return"before"}function D(e){for(var t=e;null!=t.parentNode;)t=t.parentNode;return t}function O(e,t){var n=A(e,0,t.startContainer,t.startOffset);if("after"!==n)return!1;var i=A(e,E(e),t.endContainer,t.endOffset);return"before"!==i?!1:D(e)==D(t.startContainer)}function I(e,t){"undefined"==typeof t&&(t=function(){return!0});var n=e.startContainer;n=n.hasChildNodes()&&e.startOffset<n.childNodes.length?n.childNodes[e.startOffset]:e.startOffset==E(n)?v(n):y(n);var i=e.endContainer;i=i.hasChildNodes()&&e.endOffset<i.childNodes.length?i.childNodes[e.endOffset]:v(i);for(var a=[];x(n,i);)O(n,e)&&t(n)?(a.push(n),n=v(n)):n=y(n);return a}function M(e,t){"undefined"==typeof t&&(t=function(){return!0});var n=e.startContainer;n=n.hasChildNodes()&&e.startOffset<n.childNodes.length?n.childNodes[e.startOffset]:e.startOffset==E(n)?v(n):y(n);var i=e.endContainer;i=i.hasChildNodes()&&e.endOffset<i.childNodes.length?i.childNodes[e.endOffset]:v(i);for(var a=[];x(n,i);)O(n,e)&&t(n)&&a.push(n),n=y(n);return a}function R(e){if("currentcolor"==e.toLowerCase())return null;var n=document.createElement("span");document.body.appendChild(n),n.style.color="black";var i=document.createElement("span");return n.appendChild(i),i.style.color=e,e=t.getComputedStyle(i).color,"rgb(0, 0, 0)"==e&&(n.color="white",e=t.getComputedStyle(i).color,"rgb(0, 0, 0)"!=e)?null:(document.body.removeChild(n),/^rgba\([0-9]+, [0-9]+, [0-9]+, 1\)$/.test(e)?e.replace("rgba","rgb").replace(", 1)",")"):"transparent"==e?"rgba(0, 0, 0, 0)":e)}function P(e){if(e=e.toLowerCase(),-1!=t(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"]).indexOf(e))return e;
e=R(e);var n=/^rgb\(([0-9]+), ([0-9]+), ([0-9]+)\)$/.exec(e);return n?"#"+parseInt(n[1],10).toString(16).replace(/^.$/,"0$&")+parseInt(n[2],10).toString(16).replace(/^.$/,"0$&")+parseInt(n[3],10).toString(16).replace(/^.$/,"0$&"):/^#[abcdef0123456789]+$/i.exec(e)?e:null}function F(e){if(e=t(e).trim(),/^[\-+]?[0-9]+(\.[0-9]+)?([eE][\-+]?[0-9]+)?$/.test(e)){var n;"+"==e[0]?(e=e.slice(1),n="relative-plus"):"-"==e[0]?(e=e.slice(1),n="relative-minus"):n="absolute";var i=parseInt(e,10);"relative-plus"==n&&(i+=3),"relative-minus"==n&&(i=3-i),1>i&&(i=1),i>7&&(i=7),e={1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[i]}return e}function z(e){if(e=F(e),-1==r.inArray(e,["xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large"])&&!/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc|px)$/.test(e))return null;var n=document.createElement("font");document.body.appendChild(n),"xxx-large"==e?n.size=7:n.style.fontSize=e;var i=parseInt(t.getComputedStyle(n).fontSize,10);document.body.removeChild(n);for(var a=1;7>a;){n=document.createElement("font"),n.size=a,document.body.appendChild(n);var o=parseInt(t.getComputedStyle(n).fontSize,10);n.size=1+a;var s=parseInt(t.getComputedStyle(n).fontSize,10);document.body.removeChild(n);var l=(s+o)/2;if(l>i)return String(a);a++}return"7"}function B(e,t,n,i){var a;0===On&&(An=n),On++;try{a=i()}catch(r){throw On--,r}return On--,a}function L(e,t){return e=e.toLowerCase(),B(e,"action",t,function(e){return function(){return-1!=r.inArray(e,["copy","cut","paste","selectall","stylewithcss","usecss"])||null!==t}}(e))}function q(e){var t=new window.GENTICS.Utils.RangeObject;t.startContainer=e.startContainer,t.startOffset=e.startOffset,t.endContainer=e.endContainer,t.endOffset=e.endOffset,t.select()}function H(e,t,n,i){var a=e.toLowerCase(),r=t,o=n;return(1==arguments.length||arguments.length>=4&&"undefined"==typeof r)&&(r=!1),(arguments.length<=2||arguments.length>=4&&"undefined"==typeof o)&&(o=""),B(a,"action",i,function(e,t,n){return function(){return L(e)?(Dn[e].action(n,i),q(i),!0):!1}}(a,r,o))}function $(e,t){return e=e.toLowerCase(),B(e,"indeterm",t,function(e){return function(){return L(e,t)?Dn[e].indeterm(t):!1}}(e))}function W(e,t){return e=e.toLowerCase(),B(e,"state",t,function(e){return function(){return L(e,t)?"undefined"!=typeof wn(e,t)?wn(e,t):Dn[e].state(t):!1}}(e))}function G(e){return e=e.toLowerCase(),Dn.hasOwnProperty(e)}function U(e,t){return e=e.toLowerCase(),B(e,"value",t,function(){return Dn.hasOwnProperty(e)&&Dn[e].hasOwnProperty("value")?"fontsize"==e&&void 0!==Sn("fontsize",t)?z(Sn("fontsize",t)):"undefined"!=typeof Sn(e,t)?Sn(e,t):Dn[e].value(t):""})}function K(e){return g(e,In)}function V(e){return e&&(e.nodeType==t.Node.ELEMENT_NODE&&!Mn[t.getComputedStyle(e).display]||e.nodeType==t.Node.DOCUMENT_NODE||e.nodeType==t.Node.DOCUMENT_FRAGMENT_NODE)}function Y(e){return e&&!V(e)}function X(e){return e&&e.nodeType==t.Node.ELEMENT_NODE&&("true"==e.contentEditable||e.parentNode&&e.parentNode.nodeType==t.Node.DOCUMENT_NODE&&"on"==e.parentNode.designMode)}function Q(e){return e&&!X(e)&&(e.nodeType!=t.Node.ELEMENT_NODE||"false"!=e.contentEditable||r(e).hasClass("aloha-table-wrapper"))&&(X(e.parentNode)||Q(e.parentNode))}function J(e){var t;for(t=0;t<e.childNodes.length;t++)if(Q(e.childNodes[t])||J(e.childNodes[t]))return!0;return!1}function Z(e){if(X(e))return e;if(Q(e)){for(var t=e.parentNode;!X(t);)t=t.parentNode;return t}return null}function et(e,t){return Z(e)&&Z(e)==Z(t)}function tt(n){if(!h(n,"br"))return!1;for(var i=n.parentNode;"inline"==t.getComputedStyle(i).display;)i=i.parentNode;var a={height:i.style.height,maxHeight:i.style.maxHeight,minHeight:i.style.minHeight};i.style.height="auto",i.style.maxHeight="none",e.browser.msie&&e.browser.version<8||(i.style.minHeight="0");var r=document.createTextNode("​"),o=i.offsetHeight;if(0==o)throw"isCollapsedLineBreak: original height is zero, bug?";n.parentNode.insertBefore(r,n.nextSibling);var s=i.offsetHeight;return r.parentNode.removeChild(r),i.style.height=a.height,i.style.maxHeight=a.maxHeight,e.browser.msie&&e.browser.version<8||(i.style.minHeight=a.minHeight),s-5>o}function nt(n){if(!h(n,"br"))return!1;if(h(n.parentNode,"li")&&1==n.parentNode.childNodes.length)return!1;for(var i=n.parentNode;"inline"==t.getComputedStyle(i).display;)i=i.parentNode;var a={height:i.style.height,maxHeight:i.style.maxHeight,minHeight:i.style.minHeight,contentEditable:i.contentEditable};i.style.height="auto",i.style.maxHeight="none",i.style.minHeight="0",e.browser.msie&&e.browser.version<=7&&(i.contentEditable="false");var r=i.offsetHeight;if(0==r)throw"isExtraneousLineBreak: original height is zero, bug?";var o=n.style.display;n.style.display="none";var s=i.offsetHeight;return i.style.height=a.height,i.style.maxHeight=a.maxHeight,i.style.minHeight=a.minHeight,e.browser.msie&&e.browser.version<=7&&(i.contentEditable=a.contentEditable),n.style.display=o,r==s}function it(e){var n=t.Node;if(e&&e.nodeType===n.TEXT_NODE){var i=e.parentNode,a=e.data;if(0===r.trim(a).length)return!0;if(i&&/^[\t\n\r ]+$/.test(a))if(i.nodeType===n.ELEMENT_NODE){if(-1!==r.inArray(t.getComputedStyle(i).whiteSpace,["normal","nowrap"]))return!0;if("pre-line"===t.getComputedStyle(i).whiteSpace)return!0}else if(i.nodeType===n.DOCUMENT_FRAGMENT_NODE)return!0}return!1}function at(e){if(!it(e))return!1;if(""==e.data)return!0;var n=e.parentNode;if(!n)return!0;if(t(S(e)).some(function(e){return e.nodeType==t.Node.ELEMENT_NODE&&"none"==t.getComputedStyle(e).display}))return!0;for(;!V(n)&&n.parentNode;)n=n.parentNode;for(var i=e;i!=n;){if(i=_(i),V(i)||h(i,"br"))return!0;if(i.nodeType==t.Node.TEXT_NODE&&!it(i)||h(i,"img"))break}i=e;for(var a=v(n);i!=a;){if(i=y(i),V(i)||h(i,"br"))return!0;if(i&&i.nodeType==t.Node.TEXT_NODE&&!it(i)||h(i,"img"))break}return!1}function rt(e){var n;if(!e)return!1;if(t(S(e).concat(e)).filter(function(e){return e.nodeType==t.Node.ELEMENT_NODE},!0).some(function(e){return"none"==t.getComputedStyle(e).display}))return!1;if(V(e)||e.nodeType==t.Node.TEXT_NODE&&!at(e)||h(e,"img")||h(e,"br")&&!nt(e))return!0;for(n=0;n<e.childNodes.length;n++)if(rt(e.childNodes[n]))return!0;return!1}function ot(e){return e&&!rt(e)}function st(e){var n;if(tt(e)&&!nt(e))return!0;if(!Y(e)||e.nodeType!=t.Node.ELEMENT_NODE)return!1;var i=!1;for(n=0;n<e.childNodes.length;n++){if(!ot(e.childNodes[n])&&!st(e.childNodes[n]))return!1;st(e.childNodes[n])&&(i=!0)}return i}function lt(e){if(e&&e.nodeType!==t.Node.TEXT_NODE)return!1;for(var n=0,i=e.data,a=i.length;a>n&&"​"===i.charAt(n);)n++;return n===a}function dt(e){return!lt(e)}function ct(e){if(!i.isBlock(e))return!1;var t=i.findNodeRight(e.lastChild,rt);return t&&"br"===t.nodeName.toLowerCase()&&!i.findNodeRight(t.previousSibling,rt)}function ut(e){return!e.hasChildNodes()||ct(e)||!i.findNodeRight(e.lastChild,dt)}function ht(e){return e&&ut(e)&&X(e.parentNode)&&!e.previousSibling&&!e.nextSibling}function pt(e){var t=e.parentNode,n=a.getIndexInParent(e);return t.removeChild(e),{node:t,offset:n}}function ft(){var n;if(An)n=An;else{if(!e.getSelection().rangeCount)return null;n=e.getSelection().getRangeAt(0)}if(!(-1!=r.inArray(n.startContainer.nodeType,[t.Node.TEXT_NODE,t.Node.ELEMENT_NODE])&&-1!=r.inArray(n.endContainer.nodeType,[t.Node.TEXT_NODE,t.Node.ELEMENT_NODE])&&n.startContainer.ownerDocument&&n.endContainer.ownerDocument&&k(n.startContainer,n.startContainer.ownerDocument)&&k(n.endContainer,n.endContainer.ownerDocument)))throw"Invalid active range; test bug?";return n}function gt(n,i,r,o){-1==r&&(r=i.childNodes.length);var s,l=n.parentNode,d=a.getIndexInParent(n),c=[o];for(s=0;s<e.getSelection().rangeCount;s++)c.push(e.getSelection().getRangeAt(s));var u=[];t(c).forEach(function(e){u.push([e.startContainer,e.startOffset]),u.push([e.endContainer,e.endOffset])}),t(u).forEach(function(e){e[0]==i&&e[1]>r&&e[1]++,e[0]!=l||e[1]!=d&&e[1]!=d+1||(e[0]=i,e[1]+=r-d),e[0]==l&&e[1]>d+1&&e[1]--}),i.childNodes.length==r?i.appendChild(n):i.insertBefore(n,i.childNodes[r]);var h=null;if(u[0][1]>u[0][0].childNodes.length&&u[1][1]>u[1][0].childNodes.length)o.setStart(n,0),o.setEnd(n,0);else{for(o.setStart(u[0][0],u[0][1]),o.setEnd(u[1][0],u[1][1]),e.getSelection().removeAllRanges(),s=1;s<c.length;s++)h=e.createRange(),h.setStart(u[2*s][0],u[2*s][1]),h.setEnd(u[2*s+1][0],u[2*s+1][1]),e.getSelection().addRange(h);h&&(o=h)}}function mt(t,n){e.browser.msie&&e.browser.version>=7&&"undefined"!=typeof t.attributes[r.expando]&&r(t).removeAttr(r.expando);var i,a=t.attributes;for(i=0;i<a.length;i++){var o=a[i];("undefined"==typeof o.specified||o.specified)&&("function"==typeof n.setAttributeNS?n.setAttributeNS(o.namespaceURI,o.name,o.value):n.setAttribute(o.name,o.value))}}function bt(e,t,n){if(h(e,t))return e;if(!e.parentNode)return e;var i=e.ownerDocument.createElement(t);for(e.parentNode.insertBefore(i,e),mt(e,i);e.childNodes.length;)gt(e.firstChild,i,i.childNodes.length,n);return e.parentNode.removeChild(e),n.startContainer===e&&(n.startContainer=i),n.endContainer===e&&(n.endContainer=i),i}function vt(e){var t=e.previousSibling;if(t){for(;t.hasChildNodes();)t=t.lastChild;for(;ot(t)&&!nt(t)&&t!=e.parentNode;)t=_(t);Q(t)&&nt(t)&&t.parentNode.removeChild(t)}}function yt(e){for(var t=e;t.hasChildNodes();)t=t.lastChild;for(;ot(t)&&!nt(t)&&t!=e;)t=_(t);Q(t)&&nt(t)&&t.parentNode.removeChild(t)}function _t(e){vt(e),yt(e)}function wt(e,t,n,i){var r;if("undefined"==typeof t&&(t=function(){return!1}),"undefined"==typeof n&&(n=function(){return null}),!e.length||!Q(e[0]))return null;Y(e[e.length-1])&&!h(e[e.length-1],"br")&&h(e[e.length-1].nextSibling,"br")&&e.push(e[e.length-1].nextSibling);var o;if(o=Q(e[0].previousSibling)&&t(e[0].previousSibling)?e[0].previousSibling:Q(e[e.length-1].nextSibling)&&t(e[e.length-1].nextSibling)?e[e.length-1].nextSibling:n(),!o)return null;if(!o.parentNode){e[0].parentNode.insertBefore(o,e[0]);var s=i.startContainer,l=i.startOffset,d=i.endContainer,c=i.endOffset,u=a.getIndexInParent(o);l>=u&&s==o.parentNode&&i.setStart(s,l+1),c>=u&&d==o.parentNode&&i.setEnd(d,c+1),An&&An!==i&&(s=An.startContainer,l=An.startOffset,d=An.endContainer,c=An.endOffset,s==o.parentNode&&l>=u&&An.setStart(s,l+1),d==o.parentNode&&c>=u&&An.setEnd(d,c+1))}var p=e[0].parentNode;if(x(o,e[0]))for(!Y(o)&&Y(o.lastChild)&&Y(e[0])&&!h(o.lastChild,"BR")&&o.appendChild(o.ownerDocument.createElement("br")),r=0;r<e.length;r++)gt(e[r],o,-1,i);else for(!Y(o)&&Y(o.firstChild)&&Y(e[e.length-1])&&!h(e[e.length-1],"BR")&&o.insertBefore(o.ownerDocument.createElement("br"),o.firstChild),r=e.length-1;r>=0;r--)gt(e[r],o,0,i);if(Q(p)&&!p.hasChildNodes()&&p.parentNode.removeChild(p),Q(o.nextSibling)&&t(o.nextSibling)){for(!Y(o)&&Y(o.lastChild)&&Y(o.nextSibling.firstChild)&&!h(o.lastChild,"BR")&&o.appendChild(o.ownerDocument.createElement("br"));o.nextSibling.hasChildNodes();)gt(o.nextSibling.firstChild,o,-1,i);o.parentNode.removeChild(o.nextSibling)}return _t(o),o}function Ct(e){return g(e,Rn)}function kt(e,n){if((Pn[n]||f(n,["colgroup","table","tbody","tfoot","thead","tr"]))&&"object"==typeof e&&e.nodeType==t.Node.TEXT_NODE&&!/^[ \t\n\f\r]*$/.test(e.data))return!1;if((Fn[n]||f(n,["script","style","plaintext","xmp"]))&&("object"!=typeof e||e.nodeType!=t.Node.TEXT_NODE))return!1;if("object"==typeof e&&(e.nodeType==t.Node.DOCUMENT_NODE||e.nodeType==t.Node.DOCUMENT_FRAGMENT_NODE||e.nodeType==t.Node.DOCUMENT_TYPE_NODE))return!1;if(u(e)&&(e=e.tagName.toLowerCase()),"string"!=typeof e)return!0;if(u(n)){for(var i=n;i;){if("a"==e&&h(i,"a"))return!1;if(In[e.toUpperCase()]&&Ct(i))return!1;if(/^h[1-6]$/.test(e)&&u(i)&&/^H[1-6]$/.test(i.tagName))return!1;i=i.parentNode}n=n.tagName.toLowerCase()}if("object"==typeof n&&(n.nodeType==t.Node.ELEMENT_NODE||n.nodeType==t.Node.DOCUMENT_FRAGMENT_NODE))return!0;if("string"!=typeof n)return!1;switch(n){case"colgroup":return"col"==e;case"table":return-1!=r.inArray(e,["caption","col","colgroup","tbody","td","tfoot","th","thead","tr"]);case"tbody":case"thead":case"tfoot":return-1!=r.inArray(e,["td","th","tr"]);case"tr":return-1!=r.inArray(e,["td","th"]);case"dl":return-1!=r.inArray(e,["dt","dd"]);case"dir":case"ol":case"ul":return-1!=r.inArray(e,["dir","li","ol","ul"]);case"hgroup":return/^h[1-6]$/.test(e)}if(-1!=r.inArray(e,["body","caption","col","colgroup","frame","frameset","head","html","tbody","td","tfoot","th","thead","tr"]))return!1;if(-1!=r.inArray(e,["dd","dt"])&&"dl"!=n)return!1;if("li"==e&&"ol"!=n&&"ul"!=n)return!1;var a=qn[n.toUpperCase()];if(a){var o=a[e.toUpperCase()];if(o)return!1}return!0}function xt(e,n){return n.collapsed?!1:O(e,n)?!0:e==n.startContainer&&e.nodeType==t.Node.TEXT_NODE&&E(e)!=n.startOffset?!0:e==n.endContainer&&e.nodeType==t.Node.TEXT_NODE&&0!=n.endOffset?!0:!e.hasChildNodes()||!t(e.childNodes).every(function(e){return xt(e,n)})||k(n.startContainer,e)&&n.startContainer.nodeType==t.Node.TEXT_NODE&&0!=n.startOffset||k(n.endContainer,e)&&n.endContainer.nodeType==t.Node.TEXT_NODE&&n.endOffset!=E(n.endContainer)?!1:!0}function St(e,t){"undefined"==typeof t&&(t=function(){return!0});for(var n=e.startContainer;xt(n.parentNode,e);)n=n.parentNode;for(var i=v(e.endContainer),a=[];x(n,i);)xt(n,e)&&t(n)&&a.push(n),n=y(n);return a}function jt(e){if(!u(e))return!1;if(-1!=r.inArray(e.tagName,["B","EM","I","S","SPAN","STRIKE","STRONG","SUB","SUP","U"])){if(0==e.attributes.length)return!0;if(1==e.attributes.length&&o(e,"style"))return!0}if("FONT"==e.tagName||"A"==e.tagName){var t=e.attributes.length;if(o(e,"style")&&t--,"FONT"==e.tagName&&(o(e,"color")&&t--,o(e,"face")&&t--,o(e,"size")&&t--),"A"==e.tagName&&o(e,"href")&&t--,0==t)return!0}return!1}function Nt(e){return u(e)?-1==r.inArray(e.tagName,["A","B","EM","FONT","I","S","SPAN","STRIKE","STRONG","SUB","SUP","U"])?!1:0==e.attributes.length?!0:e.attributes.length>1?!1:o(e,"style")&&0==m(e)?!0:"A"==e.tagName&&o(e,"href")?!0:"FONT"==e.tagName&&(o(e,"color")||o(e,"face")||o(e,"size"))?!0:!(("B"==e.tagName||"STRONG"==e.tagName)&&o(e,"style")&&1==m(e)&&""!=e.style.fontWeight||("I"==e.tagName||"EM"==e.tagName)&&o(e,"style")&&1==m(e)&&""!=e.style.fontStyle||("A"==e.tagName||"FONT"==e.tagName||"SPAN"==e.tagName)&&o(e,"style")&&1==m(e)&&""==e.style.textDecoration||-1!=r.inArray(e.tagName,["A","FONT","S","SPAN","STRIKE","U"])&&o(e,"style")&&1==m(e)&&("line-through"==e.style.textDecoration||"underline"==e.style.textDecoration||"overline"==e.style.textDecoration||"none"==e.style.textDecoration))?!1:!0:!1}function Tt(e,t,n){return null===t&&null===n?!0:"string"!=typeof t||"string"!=typeof n||t!=n||Dn[e].hasOwnProperty("equivalentValues")?"string"==typeof t&&"string"==typeof n&&Dn[e].hasOwnProperty("equivalentValues")&&Dn[e].equivalentValues(t,n)?!0:!1:!0}function Et(e,n,i){if(Tt(e,n,i))return!0;if("fontsize"!=e||"string"!=typeof n||"string"!=typeof i)return!1;var a=Et;if(void 0===a.sizeMap){a.sizeMap={};var r=document.createElement("font");document.body.appendChild(r),t(["xx-small","small","medium","large","x-large","xx-large","xxx-large"]).forEach(function(e){r.size=N(e),a.sizeMap[e]=t.getComputedStyle(r).fontSize}),document.body.removeChild(r)}return n===a.sizeMap[i]||i===a.sizeMap[n]}function At(e,n){if(e.nodeType!=t.Node.ELEMENT_NODE&&(!e.parentNode||e.parentNode.nodeType!=t.Node.ELEMENT_NODE))return null;if(e.nodeType!=t.Node.ELEMENT_NODE)return At(e.parentNode,n);if("createlink"==n||"unlink"==n){for(;e&&(!u(e)||"A"!=e.tagName||!o(e,"href"));)e=e.parentNode;return e?e.getAttribute("href"):null}if("backcolor"==n||"hilitecolor"==n){for(;("rgba(0, 0, 0, 0)"==t.getComputedStyle(e).backgroundColor||""===t.getComputedStyle(e).backgroundColor||"transparent"==t.getComputedStyle(e).backgroundColor)&&e.parentNode&&e.parentNode.nodeType==t.Node.ELEMENT_NODE;)e=e.parentNode;return"rgba(0, 0, 0, 0)"==t.getComputedStyle(e).backgroundColor||""===t.getComputedStyle(e).backgroundColor||"transparent"==t.getComputedStyle(e).backgroundColor?"rgb(255, 255, 255)":t.getComputedStyle(e).backgroundColor}if("subscript"==n||"superscript"==n){for(var i=!1,a=!1;Y(e);){{t.getComputedStyle(e).verticalAlign}h(e,"sub")?i=!0:h(e,"sup")&&(a=!0),e=e.parentNode}return i&&a?"mixed":i?"subscript":a?"superscript":null}if("strikethrough"==n){do{if(-1!=t.getComputedStyle(e).textDecoration.indexOf("line-through"))return"line-through";e=e.parentNode}while(e&&e.nodeType==t.Node.ELEMENT_NODE);return null}if("underline"==n){do{if(-1!=t.getComputedStyle(e).textDecoration.indexOf("underline"))return"underline";e=e.parentNode}while(e&&e.nodeType==t.Node.ELEMENT_NODE);return null}if(!Dn[n].hasOwnProperty("relevantCssProperty"))throw"Bug: no relevantCssProperty for "+n+" in getEffectiveCommandValue";return t.getComputedStyle(e)[Dn[n].relevantCssProperty].toString()}function Dt(e,n){if(("backcolor"==n||"hilitecolor"==n)&&"inline"!=t.getComputedStyle(e).display)return null;if("createlink"==n||"unlink"==n)return u(e)&&"A"==e.tagName&&o(e,"href")?e.getAttribute("href"):null;if("subscript"==n||"superscript"==n)return h(e,"sup")?"superscript":h(e,"sub")?"subscript":null;if("strikethrough"==n&&""!=e.style.textDecoration)return-1!=e.style.textDecoration.indexOf("line-through")?"line-through":null;if("strikethrough"==n&&f(e,["S","STRIKE"]))return"line-through";if("underline"==n&&""!=e.style.textDecoration)return-1!=e.style.textDecoration.indexOf("underline")?"underline":null;if("underline"==n&&h(e,"U"))return"underline";var i=Dn[n].relevantCssProperty;if(null===i)return null;if(""!=e.style[i])return e.style[i];if(d(e.namespaceURI)&&"FONT"==e.tagName){if("color"==i&&o(e,"color"))return e.color;if("fontFamily"==i&&o(e,"face"))return e.face;if("fontSize"==i&&o(e,"size")){var a=parseInt(e.size,10);return 1>a&&(a=1),a>7&&(a=7),{1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[a]}}return"fontWeight"!=i||"B"!=e.tagName&&"STRONG"!=e.tagName?"fontStyle"!=i||"I"!=e.tagName&&"EM"!=e.tagName?null:"italic":"bold"}function Ot(e,t,n,i){for(var r=e;jt(r)&&1==r.childNodes.length&&jt(r.firstChild)&&(!Nt(r)||!Tt(t,Dt(r,t),n));)r=r.firstChild;if(r!=e&&Nt(r)&&Tt(t,Dt(r,t),n)&&Et(t,At(r,t),n)){for(;r.hasChildNodes();)gt(r.firstChild,r.parentNode,a.getIndexInParent(r),i);e.parentNode.insertBefore(r,e.nextSibling),gt(e,r,-1,i)}}function It(e){var t,n,i,a,o,s,l=[],d=r.makeArray(e);for(t=0;t<d.length;t++)for(i=d[t],n=0;n<Hn.length;n++){for(a=Hn[n],o=i,1!=o.nodeType&&(o=o.parentNode),s=null;o&&1==o.nodeType&&null===(s=Dt(o,a));)o=o.parentNode;l.push([i,a,s])}return l}function Mt(e,t,n){if(!Q(e))return[];if(null===Dt(e,t))return[];if(Nt(e)){var i,r=Array.prototype.slice.call(b(e.childNodes));for(i=0;i<r.length;i++)gt(r[i],e.parentNode,a.getIndexInParent(e),n);return e.parentNode.removeChild(e),r}return"strikethrough"==t&&-1!=e.style.textDecoration.indexOf("line-through")&&(e.style.textDecoration="line-through"==e.style.textDecoration?"":e.style.textDecoration.replace("line-through",""),""==e.getAttribute("style")&&e.removeAttribute("style")),"underline"==t&&-1!=e.style.textDecoration.indexOf("underline")&&(e.style.textDecoration="underline"==e.style.textDecoration?"":e.style.textDecoration.replace("underline",""),""==e.getAttribute("style")&&e.removeAttribute("style")),null!==Dn[t].relevantCssProperty&&(e.style[Dn[t].relevantCssProperty]="",""==e.getAttribute("style")&&e.removeAttribute("style")),d(e.namespaceURI)&&"FONT"==e.tagName&&("forecolor"==t&&e.removeAttribute("color"),"fontname"==t&&e.removeAttribute("face"),"fontsize"==t&&e.removeAttribute("size")),!h(e,"A")||"createlink"!=t&&"unlink"!=t||e.removeAttribute("href"),null===Dt(e,t)?[]:[bt(e,"span",n)]}function Rt(e,n,i,o){var s,l,d=[];if(e.parentNode&&null!==i&&(kt(e,"span")&&(Ot(e.previousSibling,n,i,o),Ot(e.nextSibling,n,i,o),wt([e],function(e){return Nt(e)&&Tt(n,Dt(e,n),i)&&Et(n,At(e,n),i)},function(){return null},o)),!Et(n,At(e,n),i)))if(kt(e,"span")){if(!Et(n,At(e,n),i)){var c=null;if(En||("bold"!=n||"bold"!=i&&"700"!=i||(c=e.ownerDocument.createElement("b")),"italic"==n&&"italic"==i&&(c=e.ownerDocument.createElement("i")),"strikethrough"==n&&"line-through"==i&&(c=e.ownerDocument.createElement("s")),"underline"==n&&"underline"==i&&(c=e.ownerDocument.createElement("u")),"forecolor"==n&&P(i)&&(c=e.ownerDocument.createElement("span"),r(c).css("color",P(i))),"fontname"==n&&(c=e.ownerDocument.createElement("font"),c.face=i)),"createlink"==n||"unlink"==n){c=e.ownerDocument.createElement("a"),c.setAttribute("href",i);for(var u=e.parentNode;u;)h(u,"A")&&(u=bt(u,"span",o)),u=u.parentNode}"fontsize"!=n||-1==r.inArray(i,["xx-small","small","medium","large","x-large","xx-large","xxx-large"])||En&&"xxx-large"!=i||(c=e.ownerDocument.createElement("font"),c.size=N(i)),"subscript"!=n&&"superscript"!=n||"subscript"!=i||(c=e.ownerDocument.createElement("sub")),"subscript"!=n&&"superscript"!=n||"superscript"!=i||(c=e.ownerDocument.createElement("sup")),c||(c=e.ownerDocument.createElement("span")),e.parentNode.insertBefore(c,e);var p=Dn[n].relevantCssProperty;if(null===p||Et(n,At(c,n),i)||(c.style[p]=i),"strikethrough"==n&&"line-through"==i&&"line-through"!=At(c,"strikethrough")&&(c.style.textDecoration="line-through"),"underline"==n&&"underline"==i&&"underline"!=At(c,"underline")&&(c.style.textDecoration="underline"),gt(e,c,c.childNodes.length,o),e.nodeType==t.Node.ELEMENT_NODE&&!Tt(n,At(e,n),i)){for(gt(e,c.parentNode,a.getIndexInParent(c),o),c.parentNode.removeChild(c),d=[],s=0;s<e.childNodes.length;s++)(e.childNodes[s].nodeType!=t.Node.ELEMENT_NODE||(l=Dt(e.childNodes[s],n),null===l||Tt(n,i,l)))&&d.push(e.childNodes[s]);for(s=0;s<d.length;s++)Rt(d[s],n,i,o)}}}else{for(s=0;s<e.childNodes.length;s++)(e.childNodes[s].nodeType!=t.Node.ELEMENT_NODE||(l=Dt(e.childNodes[s],n),null===l||Tt(n,i,l)))&&d.push(e.childNodes[s]);for(s=0;s<d.length;s++)Rt(d[s],n,i,o)}}function Pt(e,n,i,a){if(e.parentNode&&e.parentNode.nodeType==t.Node.ELEMENT_NODE&&!Et(n,At(e,n),i)){for(var r=e.parentNode,o=[];Q(r)&&r.nodeType==t.Node.ELEMENT_NODE&&!Et(n,At(r,n),i);)o.push(r),r=r.parentNode;if(o.length){var s=Dt(o[o.length-1],n);if((null!==s||s==i)&&(null===i||Et(n,At(o[o.length-1].parentNode,n),i)))for(;o.length;){r=o.pop(),null!==Dt(r,n)&&(s=Dt(r,n));var l=Array.prototype.slice.call(b(r.childNodes));null!==Dt(r,n)&&Mt(r,n,a);var d;for(d=0;d<l.length;d++){var c=l[d];c!=e&&(c.nodeType!=t.Node.ELEMENT_NODE||null===Dt(c,n)||Tt(n,s,Dt(c,n)))&&c!=o[o.length-1]&&Rt(c,n,s,a)}}}}}function Ft(e,n){t(e).forEach(function(e){var i=e[0],a=e[1],r=e[2],o=i;for(o&&o.nodeType==t.Node.ELEMENT_NODE||(o=o.parentNode);o&&o.nodeType==t.Node.ELEMENT_NODE&&null===Dt(o,a);)o=o.parentNode;null===r&&o&&o.nodeType==t.Node.ELEMENT_NODE?Pt(i,a,null,n):(o&&o.nodeType==t.Node.ELEMENT_NODE&&!Tt(a,Dt(o,a),r)||(!o||o.nodeType!=t.Node.ELEMENT_NODE)&&null!==r)&&Rt(i,a,r,n)})}function zt(n,i,a){if(a=a||ft(),!t(St(a)).filter(function(e){return e.nodeType==t.Node.TEXT_NODE},!0).some(Q))return Dn[n].hasOwnProperty("inlineCommandActivatedValues")&&Cn(n,-1!=t(Dn[n].inlineCommandActivatedValues).indexOf(i),a),"subscript"==n&&xn("superscript",a),"superscript"==n&&xn("subscript",a),void(null===i?Nn(n,a):Dn[n].hasOwnProperty("value")&&jn(n,i,a));if(Q(a.startContainer)&&a.startContainer.nodeType==t.Node.TEXT_NODE&&0!=a.startOffset&&a.startOffset!=E(a.startContainer)){var r=l(a.startContainer,a.startOffset),o=e.createRange();if(a.startContainer==a.endContainer){var s=a.endOffset-a.startOffset;o.setEnd(r,s),a.setEnd(r,s)}o.setStart(r,0),e.getSelection().removeAllRanges(),e.getSelection().addRange(o),a.setStart(r,0)}if(Q(a.endContainer)&&a.endContainer.nodeType==t.Node.TEXT_NODE&&0!=a.endOffset&&a.endOffset!=E(a.endContainer)){var d=a,c=[d.startContainer,d.startOffset],u=[d.endContainer,d.endOffset];l(d.endContainer,d.endOffset),d.setStart(c[0],c[1]),d.setEnd(u[0],u[1]),e.getSelection().removeAllRanges(),e.getSelection().addRange(d)}t(St(ft(),function(e){return Q(e)&&e.nodeType==t.Node.ELEMENT_NODE})).forEach(function(e){Mt(e,n,a)}),t(St(a,Q)).forEach(function(e){Pt(e,n,i,a),Rt(e,n,i,a)})}function Bt(e,n){var i;if(e.nodeType===t.Node.TEXT_NODE&&n<e.length)for(i=n;i<e.length;i++)if("	"!==e.data.charAt(i)&&"\r"!==e.data.charAt(i)&&"\n"!==e.data.charAt(i)||160===e.data.charCodeAt(i))return!1;return e.nextSibling&&e.nextSibling.className&&e.nextSibling.className.indexOf("aloha-table-wrapper")>=0?e.nextSibling:e.parentNode&&e.parentNode.nextSibling&&e.parentNode.nextSibling.className&&e.parentNode.nextSibling.className.indexOf("aloha-table-wrapper")>=0?e.parentNode.nextSibling:e.parentNode&&e.parentNode.nextSibling&&it(e.parentNode.nextSibling)&&e.parentNode.nextSibling.nextSibling&&e.parentNode.nextSibling.nextSibling.className&&e.parentNode.nextSibling.nextSibling.className.indexOf("aloha-table-wrapper")>=0?e.parentNode.nextSibling.nextSibling:void 0}function Lt(e,n){var i;if(e.nodeType===t.Node.TEXT_NODE&&n>0)for(i=n-1;i>=0;i--)if("	"!==e.data.charAt(i)&&"\r"!==e.data.charAt(i)&&"\n"!==e.data.charAt(i)||160===e.data.charCodeAt(i))return!1;return e.previousSibling&&e.previousSibling.className&&e.previousSibling.className.indexOf("aloha-table-wrapper")>=0?e.previousSibling:e.parentNode&&e.parentNode.previousSibling&&e.parentNode.previousSibling.className&&e.parentNode.previousSibling.className.indexOf("aloha-table-wrapper")>=0?e.parentNode.previousSibling:e.parentNode&&e.parentNode.previousSibling&&it(e.parentNode.previousSibling)&&e.parentNode.previousSibling.previousSibling&&e.parentNode.previousSibling.previousSibling.className&&e.parentNode.previousSibling.previousSibling.className.indexOf("aloha-table-wrapper")>=0?e.parentNode.previousSibling.previousSibling:!1}function qt(e,t){return!e.parentNode&&0==t||t-1>=0&&t-1<e.childNodes.length&&rt(e.childNodes[t-1])&&(V(e.childNodes[t-1])||h(e.childNodes[t-1],"br"))}function Ht(e,t){return!e.parentNode&&t==E(e)||t<e.childNodes.length&&rt(e.childNodes[t])&&V(e.childNodes[t])}function $t(e,t){return qt(e,t)||Ht(e,t)}function Wt(e){for(var t=0;!$t(e,t);){if(t-1>=0&&t-1<e.childNodes.length&&rt(e.childNodes[t-1]))return!1;0!=t&&e.hasChildNodes()?(e=e.childNodes[t-1],t=E(e)):(t=a.getIndexInParent(e),e=e.parentNode)}return!0}function Gt(e){for(var t=E(e);!$t(e,t);){if(t<e.childNodes.length&&rt(e.childNodes[t]))return!1;t!=E(e)&&e.hasChildNodes()?(e=e.childNodes[t],t=0):(t=1+a.getIndexInParent(e),e=e.parentNode)}return!0}function Ut(e,t){var n,i=e[0].parentNode;if(Q(i)&&i.parentNode){-1!=r.inArray(i.firstChild,e)&&vt(i);var o=-1!=r.inArray(i.firstChild,e),s=-1!=r.inArray(i.lastChild,e),l=o&&Wt(i),d=s&&Gt(i);if(!o&&s){for(n=e.length-1;n>=0;n--)gt(e[n],i.parentNode,1+a.getIndexInParent(i),t);return d&&!Gt(e[e.length-1])&&e[e.length-1].parentNode.insertBefore(document.createElement("br"),e[e.length-1].nextSibling),void yt(i)}if(!o){var c=i.cloneNode(!1);for(i.removeAttribute("id"),i.parentNode.insertBefore(c,i);e[0].previousSibling;)gt(i.firstChild,c,c.childNodes.length,t)}for(n=0;n<e.length;n++)gt(e[n],i.parentNode,a.getIndexInParent(i),t);l&&!Wt(e[0])&&e[0].parentNode.insertBefore(document.createElement("br"),e[0]),Y(e[e.length-1])&&!h(e[e.length-1],"br")&&h(i.firstChild,"br")&&!Y(i)&&i.removeChild(i.firstChild),i.hasChildNodes()?vt(i):(i.parentNode===t.startContainer&&i.parentNode===t.endContainer&&t.startContainer===t.endContainer&&t.startOffset===t.endOffset&&i.parentNode.childNodes.length===t.startOffset&&(t.startOffset=i.parentNode.childNodes.length-1,t.endOffset=t.startOffset),i.parentNode.removeChild(i),d&&!Gt(e[e.length-1])&&e[e.length-1].parentNode.insertBefore(document.createElement("br"),e[e.length-1].nextSibling)),!e[e.length-1].nextSibling&&e[e.length-1].parentNode&&yt(e[e.length-1].parentNode)}}function Kt(){return!1}function Vt(e){if(!Kt(e))return!1;if("BLOCKQUOTE"!=e.tagName&&"DIV"!=e.tagName)return!1;var t;for(t=0;t<e.attributes.length;t++)if(!d(e.attributes[t].namespaceURI)||-1==r.inArray(e.attributes[t].name,["style","class","dir"]))return!1;if("undefined"!=typeof e.style.length){for(t=0;t<e.style.length;t++)if(!/^(-[a-z]+-)?(margin|border|padding)/.test(e.style[t]))return!1}else{var n;for(n in e.style)if(!/^(-[a-z]+-)?(margin|border|padding)/.test(n)&&e.style[n]&&0!==e.style[n]&&"false"!==e.style[n])return!1}return!0}function Yt(e){return f(e,["address","div","h1","h2","h3","h4","h5","h6","listing","p","pre","xmp"])}function Xt(e){return Yt(e)||f(e,["li","dt","dd"])}function Qt(e){return h(e,"br")&&e.parentNode.lastChild===e}function Jt(){return document.createElement("br")}function Zt(n){n&&(X(n)||h(n.lastChild,"br")||t(n.childNodes).some(rt)||(e.browser.msie?e.browser.msie&&e.browser.version<=7&&f(n,["p","h1","h2","h3","h4","h5","h6","pre","blockquote"])&&(n.firstChild||n.appendChild(document.createTextNode("​"))):n.appendChild(Jt())))}function en(e){return-1===r.inArray(e.nodeName,Wn)}function tn(e,n){var i;if(Q(e))if(!t(S(e)).every(function(t){return!et(e,t)||!kt(e,t)})||c(e,$n)){for(var o,s,l=It([e]);!kt(e,e.parentNode);){for(i=e.parentNode.childNodes.length-1;i>=0;--i)3==e.parentNode.childNodes[i].nodeType&&0==e.parentNode.childNodes[i].data.length&&(e.parentNode.removeChild(e.parentNode.childNodes[i]),n.startContainer==e.parentNode&&n.startOffset>i&&n.startOffset--,n.endContainer==e.parentNode&&n.endOffset>i&&n.endOffset--);if(1==e.parentNode.childNodes.length&&en(e)){o=n.startOffset,s=n.endOffset,n.startContainer===e.parentNode&&n.startOffset>a.getIndexInParent(e)&&(o=n.startOffset+(r(e).contents().length-1)),n.endContainer===e.parentNode&&n.endOffset>a.getIndexInParent(e)&&(s=n.endOffset+(r(e).contents().length-1)),r(e).contents().unwrap(),n.startOffset=o,n.endOffset=s;break}var d=e.parentNode;if(Ut([e],n),d===e.parentNode){o=n.startOffset,s=n.endOffset,n.startContainer===e.parentNode&&n.startOffset>a.getIndexInParent(e)&&(o=n.startOffset+(r(e).contents().length-1)),n.endContainer===e.parentNode&&n.endOffset>a.getIndexInParent(e)&&(s=n.endOffset+(r(e).contents().length-1)),r(e).contents().unwrap(),n.startOffset=o,n.endOffset=s;break}}Ft(l,n)}else{if(f(e,["dd","dt"]))return void wt([e],function(e){return h(e,"dl")&&!e.attributes.length},function(){return document.createElement("dl")},n);if(!K(e))return;e=bt(e,$n,n),Zt(e),tn(e,n);var u=j(e);for(i=0;i<u.length;i++)tn(u[i],n)}}function nn(e,n){function i(e){return f(e,["OL","UL"])}if(h(e,"LI")&&Q(e)&&Q(e.parentNode))for(var r=null;t(e.childNodes).some(i);){var o=e.lastChild;f(o,["OL","UL"])||!r&&o.nodeType==t.Node.TEXT_NODE&&/^[ \t\n\f\r]*$/.test(o.data)?(r=null,gt(o,e.parentNode,1+a.getIndexInParent(e),n)):(r||(r=e.ownerDocument.createElement("li"),e.parentNode.insertBefore(r,e.nextSibling)),gt(o,r,0,n))}}function an(e,t){if(f(e,["OL","UL"])&&Q(e)){var n=r(e);n.children("ol,ul").each(function(e,n){h(n.previousSibling,"LI")&&gt(n,n.previousSibling,n.previousSibling.childNodes.length,t)})}}function rn(n){var i=n.startContainer,r=n.startOffset,o=n.endContainer,s=n.endOffset,l=t(S(i).concat(i)).filter(function(e){return h(e,"li")}).slice(-1);if(l.length&&(r=a.getIndexInParent(l[0]),i=l[0].parentNode),!qt(i,r))do 0==r?(r=a.getIndexInParent(i),i=i.parentNode):r--;while(!$t(i,r));for(;0==r&&i.parentNode;)r=a.getIndexInParent(i),i=i.parentNode;if(l=t(S(o).concat(o)).filter(function(e){return h(e,"li")}).slice(-1),l.length&&(s=1+a.getIndexInParent(l[0]),o=l[0].parentNode),!Ht(o,s))do s==E(o)?(s=1+a.getIndexInParent(o),o=o.parentNode):s++;while(!$t(o,s));for(;s==E(o)&&o.parentNode;)s=1+a.getIndexInParent(o),o=o.parentNode;var d=e.createRange();return d.setStart(i,r),d.setEnd(o,s),d}function on(){var e=rn(ft()),n=I(e,function(e){return Q(e)&&!Kt(e)&&(f(e,["ol","ul"])||f(e.parentNode,["ol","ul"])||kt(e,"li"))});if(!n.length)return"none";if(t(n).every(function(e){return h(e,"ol")||h(e.parentNode,"ol")||h(e.parentNode,"li")&&h(e.parentNode.parentNode,"ol")})&&!t(n).some(function(e){return h(e,"ul")||e.querySelector&&e.querySelector("ul")}))return"ol";if(t(n).every(function(e){return h(e,"ul")||h(e.parentNode,"ul")||h(e.parentNode,"li")&&h(e.parentNode.parentNode,"ul")})&&!t(n).some(function(e){return h(e,"ol")||e.querySelector&&e.querySelector("ol")}))return"ul";var i=t(n).some(function(e){return h(e,"ol")||h(e.parentNode,"ol")||e.querySelector&&e.querySelector("ol")||h(e.parentNode,"li")&&h(e.parentNode.parentNode,"ol")
}),a=t(n).some(function(e){return h(e,"ul")||h(e.parentNode,"ul")||e.querySelector&&e.querySelector("ul")||h(e.parentNode,"li")&&h(e.parentNode.parentNode,"ul")});return i&&a?"mixed":i?"mixed ol":a?"mixed ul":"none"}function sn(e){for(;e&&e.nodeType!=t.Node.ELEMENT_NODE||e.nodeType==t.Node.ELEMENT_NODE&&-1!=r.inArray(t.getComputedStyle(e).display,["inline","none"]);)e=e.parentNode;if(!e||e.nodeType!=t.Node.ELEMENT_NODE)return"left";var n=t.getComputedStyle(e).textAlign.replace(/^-(moz|webkit)-/,"").replace(/^auto$/,"start");return"start"==n?"ltr"==T(e)?"left":"right":"end"==n?"ltr"==T(e)?"right":"left":-1!=r.inArray(n,["center","justify","left","right"])?n:"left"}function ln(e){var n=[];return void 0!==Sn("createlink",e)&&n.push(["createlink",Sn("createlink",e)]),t(["bold","italic","strikethrough","subscript","superscript","underline"]).forEach(function(t){void 0!==wn(t,e)&&n.push([t,wn(t,e)])}),t(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(t){void 0!==Sn(t,e)&&n.push([t,Sn(t,e)])}),n}function dn(e){var n=[],i=t(St(e)).filter(function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE})[0];return i?(n.push(["createlink",Dn.createlink.value(e)]),t(["bold","italic","strikethrough","subscript","superscript","underline"]).forEach(function(e){n.push(-1!=t(Dn[e].inlineCommandActivatedValues).indexOf(At(i,e))?[e,!0]:[e,!1])}),t(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(t){n.push([t,Dn[t].value(e)])}),n.push(["fontsize",At(i,"fontsize")]),n):n}function cn(e,n){function i(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE}var a,r,o,s=t(St(n)).filter(function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE})[0];if(s)for(a=0;a<e.length;a++){if(r=e[a][0],o=e[a][1],"boolean"==typeof o&&W(r,n)!=o)H(r,!1,o,n);else if("string"!=typeof o||"fontsize"==r||Tt(r,U(r,n),o)){if("string"!=typeof o||"fontsize"!=r||!(void 0!==Sn("fontsize",n)&&Sn("fontsize",n)!==o||void 0===Sn("fontsize",n)&&!Et(r,At(s,"fontsize"),o)))continue;H("fontsize",!1,o,n)}else H(r,!1,o,n);s=t(St(n)).filter(i)[0]||s}else for(a=0;a<e.length;a++)r=e[a][0],o=e[a][1],"boolean"==typeof o&&Cn(r,o,n),"string"==typeof o&&jn(r,o,n)}function un(e,t,n){if(0==e)return"";if(1==e&&!t&&!n)return" ";if(1==e)return" ";var i,a="";for(i=t?"  ":"  ";e>3;)a+=i,e-=2;return a+=3==e?t||n?t&&!n?"   ":!t&&n?"   ":t&&n?"   ":"impossible":"   ":t||n?t&&!n?"  ":!t&&n?"  ":t&&n?"  ":"impossible":"  "}function hn(e,n){if(Q(e)||X(e)){for(var i=e,o=n;;)if(o-1>=0&&et(i,i.childNodes[o-1]))i=i.childNodes[o-1],o=E(i);else if(0==o&&!Wt(i)&&et(i,i.parentNode))o=a.getIndexInParent(i),i=i.parentNode;else{if(i.nodeType!=t.Node.TEXT_NODE||-1!=r.inArray(t.getComputedStyle(i.parentNode).whiteSpace,["pre","pre-wrap"])||0==o||!/[ \xa0]/.test(i.data[o-1]))break;o--}for(var s=i,l=o,d=0,c=!1;;)if(l<s.childNodes.length&&et(s,s.childNodes[l]))s=s.childNodes[l],l=0;else if(l==E(s)&&!Gt(s)&&et(s,s.parentNode))l=1+a.getIndexInParent(s),s=s.parentNode;else{if(s.nodeType!=t.Node.TEXT_NODE||-1!=r.inArray(t.getComputedStyle(s.parentNode).whiteSpace,["pre","pre-wrap"])||l==E(s)||!/[ \xa0]/.test(s.data[l]))break;if(c&&" "==s.data[l]){s.deleteData(l,1);continue}c=" "==s.data[l],l++,d++}for(var u=un(d,0==o&&Wt(i),l==E(s)&&Gt(s));"before"==A(i,o,s,l);)if(o<i.childNodes.length)i=i.childNodes[o],o=0;else if(i.nodeType!=t.Node.TEXT_NODE||o==E(i))o=1+a.getIndexInParent(i),i=i.parentNode;else{var h=u[0];u=u.slice(1),h!=i.data[o]&&(i.insertData(o,h),i.deleteData(o+1,1)),o++}}}function pn(n,i,r,o,s){var l,d,c={};arguments.length<3?l=n:(l=e.createRange(),l.setStart(n,i),l.setEnd(r,o)),2==arguments.length&&(c=i),5==arguments.length&&(c=s);var u=null!=c.blockMerging?!!c.blockMerging:!0,p=null!=c.stripWrappers?!!c.stripWrappers:!0;if(l){for(var g,m=l.startContainer,v=l.startOffset,y=l.endContainer,_=l.endOffset;m.hasChildNodes();)if(v==E(m)&&et(m,m.parentNode)&&Y(m))v=1+a.getIndexInParent(m),m=m.parentNode;else{if(v==E(m))break;if(g=m.childNodes[v],V(g)||g.nodeType==t.Node.ELEMENT_NODE&&!g.hasChildNodes()||g.nodeType!=t.Node.ELEMENT_NODE&&g.nodeType!=t.Node.TEXT_NODE)break;m=g,v=0}for(;y.hasChildNodes();)if(0==_&&et(y,y.parentNode)&&Y(y))_=a.getIndexInParent(y),y=y.parentNode;else{if(0==_)break;if(g=y.childNodes[_-1],V(g)||g.nodeType==t.Node.ELEMENT_NODE&&!g.hasChildNodes()||g.nodeType!=t.Node.ELEMENT_NODE&&g.nodeType!=t.Node.TEXT_NODE)break;y=g,_=E(g)}if("after"!==A(y,_,m,v))return l.setEnd(l.startContainer,l.startOffset),l;y.nodeType==t.Node.TEXT_NODE&&_==E(y)&&m!=y&&(_=1+a.getIndexInParent(y),y=y.parentNode),l.setStart(m,v),l.setEnd(y,_);for(var C=l.startContainer;et(C,C.parentNode)&&Y(C);)C=C.parentNode;(!V(C)&&!X(C)||!kt("span",C)||f(C,["td","th"]))&&(C=null);for(var x=l.endContainer;et(x,x.parentNode)&&Y(x);)x=x.parentNode;(!V(x)&&!X(x)||!kt("span",x)||f(x,["td","th"]))&&(x=null);var S,j=dn(l);if(m==y&&Q(m)&&m.nodeType==t.Node.TEXT_NODE)return S=m.parentNode,m.deleteData(v,_-v),v>0&&" "===m.data.substr(v-1,1)&&v<m.data.length&&" "===m.data.substr(v,1)&&m.replaceData(v-1,1," "),hn(m,v),l.setStart(l.startContainer,l.startOffset),l.setEnd(l.startContainer,l.startOffset),cn(j,l),!Q(S)&&!X(S)||Y(S)||Zt(S),l;Q(m)&&m.nodeType==t.Node.TEXT_NODE&&m.deleteData(v,E(m)-v);var N=I(l,function(e){return Q(e)&&!f(e,["thead","tbody","tfoot","tr","th","td"])});for(d=0;d<N.length;d++){var T=N[d];if(S=T.parentNode,S.removeChild(T),p||!w(S,m)&&S!=m)for(;Q(S)&&Y(S)&&0==E(S);){var D=S.parentNode;D.removeChild(S),S=D}!Q(S)&&!X(S)||Y(S)||Zt(S)}Q(y)&&y.nodeType==t.Node.TEXT_NODE&&y.deleteData(0,_),hn(l.startContainer,l.startOffset),hn(l.endContainer,l.endOffset);var O;if(!(u&&C&&x&&et(C,x)&&C!=x)){l.setEnd(l.startContainer,l.startOffset);var M=C||x;return ht(M)&&(O=pt(M),l.setStart(O.node,O.offset),l.setEnd(O.node,O.offset)),cn(j,l),l}1==C.children.length&&st(C.firstChild)&&C.removeChild(C.firstChild),1==x.children.length&&st(x.firstChild)&&x.removeChild(x.firstChild);var R;if(w(C,x)){for(g=x;g.parentNode!=C;)g=g.parentNode;if(l.setStart(C,a.getIndexInParent(g)),l.setEnd(C,a.getIndexInParent(g)),!x.hasChildNodes()){for(;Q(x)&&1==x.parentNode.childNodes.length&&x.parentNode!=C;)S=x,S.removeChild(x),x=S;return Q(x)&&!Y(x)&&Y(x.previousSibling)&&Y(x.nextSibling)&&x.parentNode.insertBefore(document.createElement("br"),x.nextSibling),Q(x)&&x.parentNode.removeChild(x),cn(j,l),l}if(!Y(x.firstChild))return cn(j,l),l;var P=[];for(P.push(x.firstChild);!h(P[P.length-1],"br")&&Y(P[P.length-1].nextSibling);)P.push(P[P.length-1].nextSibling);for(R=It(P);P[0].parentNode!=C;)Ut(P,l);Q(P[0].previousSibling)&&h(P[0].previousSibling,"br")&&P[0].parentNode.removeChild(P[0].previousSibling)}else if(k(C,x)){for(l.setStart(C,E(C)),l.setEnd(C,E(C)),g=C;g.parentNode!=x;)g=g.parentNode;Y(g.nextSibling)&&h(C.lastChild,"br")&&C.removeChild(C.lastChild);var F=[];!g.nextSibling||h(g.nextSibling,"br")||V(g.nextSibling)||F.push(g.nextSibling),F.length&&F[F.length-1].nextSibling&&!h(F[F.length-1].nextSibling,"br")&&!V(F[F.length-1].nextSibling)&&F.push(F[F.length-1].nextSibling),R=It(F),t(F).forEach(function(e){gt(e,C,-1,l)}),h(g.nextSibling,"br")&&g.parentNode.removeChild(g.nextSibling)}else{for(l.setStart(C,E(C)),l.setEnd(C,E(C)),Y(x.firstChild)&&h(C.lastChild,"br")&&C.removeChild(C.lastChild),R=It([].slice.call(b(x.childNodes)));x.hasChildNodes();)gt(x.firstChild,C,-1,l);for(;!x.hasChildNodes();)S=x.parentNode,S.removeChild(x),x=S}return Ft(R,l),ht(C)&&(O=pt(C),l.setStart(O.node,O.offset),l.setEnd(O.node,O.offset),C=O.node),Zt(C),cn(j,l),l}}function fn(e,t){e.hasChildNodes()?Ut([].slice.call(b(e.childNodes)),t):e.parentNode.removeChild(e)}function gn(e,t){e&&r(e).find("ul,ol,li").each(function(){r(this).contents().each(function(){if(it(this)){var e=a.getIndexInParent(this);t.startContainer===this.parentNode&&t.startOffset>e?t.startOffset--:t.startContainer===this&&(t.startContainer=this.parentNode,t.startOffset=e),t.endContainer===this.parentNode&&t.endOffset>e?t.endOffset--:t.endContainer===this&&(t.endContainer=this.parentNode,t.endOffset=e),r(this).remove()}})})}function mn(e,t){if(e.length){var n=e[0];if(f(n.parentNode,["OL","UL"])){var i=n.parentNode.tagName;return void wt(e,function(e){return c(e,i)},function(){return n.ownerDocument.createElement(i)},t)}var a=wt(e,function(e){return Vt(e)},function(){return n.ownerDocument.createElement("blockquote")},t);tn(a,t)}}function bn(e,n){if(Q(e)){if(Vt(e))return void fn(e,n);if(Kt(e))return e.removeAttribute("class"),e.removeAttribute("dir"),e.style.margin="",e.style.padding="",e.style.border="",""==e.getAttribute("style")&&e.removeAttribute("style"),void bt(e,"div",n);for(var i=e.parentNode,r=[];Q(i)&&i.nodeType==t.Node.ELEMENT_NODE&&!Vt(i)&&!f(i,["ol","ul"]);)r.push(i),i=i.parentNode;if(!Q(i)||!Vt(i))for(i=e.parentNode,r=[];Q(i)&&i.nodeType==t.Node.ELEMENT_NODE&&!Kt(i)&&!f(i,["ol","ul"]);)r.push(i),i=i.parentNode;if(!f(e,["OL","UL"])||Q(i)&&Kt(i)){if(Q(i)&&Kt(i)){r.push(i);for(var o=i;r.length;){i=r.pop();var s=e.parentNode==i?e:r[r.length-1];Y(s)&&!h(s,"BR")&&h(s.nextSibling,"BR")&&s.parentNode.removeChild(s.nextSibling);var l=[].slice.call(b(i.childNodes),0,a.getIndexInParent(s)),d=[].slice.call(b(i.childNodes),1+a.getIndexInParent(s));mn(l,n),mn(d,n)}bn(o,n)}}else{e.removeAttribute("reversed"),e.removeAttribute("start"),e.removeAttribute("type");var c=[].slice.call(b(e.childNodes));if(e.attributes.length&&!f(e.parentNode,["OL","UL"]))bt(e,"div",n);else{var u=It([].slice.call(b(e.childNodes)));fn(e,n),Ft(u,n)}var p;for(p=0;p<c.length;p++)tn(c[p],n)}}}function vn(e,n){function i(){return document.createElement("li")}function a(e){return f(e,["ol","ul"])}function r(e){return function(t){return c(t,e)}}function o(e){return function(){return document.createElement(e)}}function s(e,t,n){return function(){if(!(Q(t[0].parentNode)&&Vt(t[0].parentNode)&&Q(t[0].parentNode.previousSibling)&&c(t[0].parentNode.previousSibling,e)))return document.createElement(e);var i=t[0].parentNode.previousSibling;return nn(i.lastChild,n),Q(i.lastChild)&&c(i.lastChild,e)||i.appendChild(document.createElement(e)),i.lastChild}}var l=on()==e?"disable":"enable";e=e.toUpperCase();var d="OL"==e?"UL":"OL",u=[];!function(){var e;for(e=n.endContainer;e!=n.commonAncestorContainer;e=e.parentNode)h(e,"li")&&u.unshift(e);for(e=n.startContainer;e;e=e.parentNode)h(e,"li")&&u.unshift(e)}(),t(u).forEach(function(e){nn(e,n)});var p=rn(n);"enable"==l&&t(M(p,function(e){return Q(e)&&c(e,d)})).forEach(function(t){if(Q(t.previousSibling)&&c(t.previousSibling,e)||Q(t.nextSibling)&&c(t.nextSibling,e)){var i=[].slice.call(b(t.childNodes)),a=It(i);Ut(i,n),wt(i,function(t){return c(t,e)},function(){return null},n),Ft(a,n)}else bt(t,e,n)});var g=I(p,function(e){return Q(e)&&!Kt(e)&&(f(e,["OL","UL"])||f(e.parentNode,["OL","UL"])||kt(e,"li"))});"enable"==l&&(g=t(g).filter(function(e){return!f(e,["ol","ul"])||f(e.parentNode,["ol","ul"])}));var m,v;if("disable"==l)for(;g.length;)if(m=[],m.push(g.shift()),c(m[0],e))bn(m[0],n);else{for(;g.length&&g[0]==m[m.length-1].nextSibling&&!c(g[0],e);)m.push(g.shift());v=It(m),Ut(m,n);var y;for(y=0;y<m.length;y++)tn(m[y],n);Ft(v,n)}else for(;g.length;){for(m=[];!m.length||g.length&&g[0]==m[m.length-1].nextSibling;)if(f(g[0],["p","div"]))m.push(bt(g[0],"li",n)),g.shift();else if(f(g[0],["li","ol","ul"]))m.push(g.shift());else{for(var _=[];!_.length||g.length&&g[0]==_[_.length-1].nextSibling&&Y(g[0])&&Y(_[_.length-1])&&!h(_[_.length-1],"br");)_.push(g.shift());m.push(wt(_,void 0,i,n))}c(m[0].parentNode,e)||t(m).every(a)||(c(m[0].parentNode,d)?(v=It(m),Ut(m,n),wt(m,r(e),o(e),n),Ft(v,n)):tn(wt(m,r(e),s(e,m,n),n),n))}}function yn(e,n){function i(e){return function(n){return h(n,"div")&&t(n.attributes).every(function(t){return"align"==t.name&&t.value.toLowerCase()==e||"style"==t.name&&1==m(n)&&n.style.textAlign==e})}}function a(e){return function(){var t=document.createElement("div");return t.setAttribute("style","text-align: "+e),t}}var r,s=rn(n),l=M(s,function(e){return e.nodeType==t.Node.ELEMENT_NODE&&Q(e)&&(o(e,"align")||""!=e.style.textAlign||h(e,"center"))});for(r=0;r<l.length;r++){var d=l[r];d.removeAttribute("align"),d.style.textAlign="",""==d.getAttribute("style")&&d.removeAttribute("style"),f(d,["div","span","center"])&&!d.attributes.length&&fn(d,n),h(d,"center")&&d.attributes.length&&bt(d,"div",n)}s=rn(An);var c=[];for(c=I(s,function(t){return Q(t)&&kt(t,"div")&&sn(t)!=e});c.length;){var u=[];for(u.push(c.shift());c.length&&c[0]==u[u.length-1].nextSibling;)u.push(c.shift());wt(u,i(e),a(e),n)}}function _n(e,n){var i;if(e.collapsed){if(i=e.startOffset,n){if(e.startContainer&&e.startContainer.nodeType===t.Node.TEXT_NODE)for(;i<e.startContainer.data.length&&"​"===e.startContainer.data.charAt(i);)i++}else if(e.startContainer&&e.startContainer.nodeType===t.Node.TEXT_NODE)for(;i>0&&"​"===e.startContainer.data.charAt(i-1);)i--;i!==e.startOffset&&(e.setStart(e.startContainer,i),e.setEnd(e.startContainer,i))}}var wn,Cn,kn,xn,Sn,jn,Nn,Tn="http://www.w3.org/1999/xhtml",En=!1,An=null,Dn={},On=0,In={ADDRESS:!0,ARTICLE:!0,ASIDE:!0,BLOCKQUOTE:!0,CAPTION:!0,CENTER:!0,COL:!0,COLGROUP:!0,DD:!0,DETAILS:!0,DIR:!0,DIV:!0,DL:!0,DT:!0,FIELDSET:!0,FIGCAPTION:!0,FIGURE:!0,FOOTER:!0,FORM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,HEADER:!0,HGROUP:!0,HR:!0,LI:!0,LISTING:!0,MENU:!0,NAV:!0,OL:!0,P:!0,PLAINTEXT:!0,PRE:!0,SECTION:!0,SUMMARY:!0,TABLE:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0,UL:!0,XMP:!0},Mn={inline:!0,"inline-block":!0,"inline-table":!0,none:!0};!function(){var e={},t={},i=null;kn=function(a){return i&&i.startContainer==a.startContainer&&i.endContainer==a.endContainer&&i.startOffset==a.startOffset&&i.endOffset==a.endOffset||(i={startContainer:a.startContainer,endContainer:a.endContainer,startOffset:a.startOffset,endOffset:a.endOffset},n.isEmpty(e)&&n.isEmpty(t))?!1:(e={},t={},!0)},wn=function(t,n){return kn(n),e[t]},Cn=function(t,n,i){kn(i),e[t]=n},xn=function(t,n){kn(n),delete e[t]},Sn=function(e,n){return kn(n),t[e]},jn=function(e,n,i){kn(i),t[e]=n,"backcolor"==e?t.hilitecolor=n:"hilitecolor"==e&&(t.backcolor=n)},Nn=function(e,n){kn(n),delete t[e],"backcolor"==e?delete t.hilitecolor:"hilitecolor"==e&&delete t.backcolor}}();var Rn={A:!0,ABBR:!0,B:!0,BDI:!0,BDO:!0,CITE:!0,CODE:!0,DFN:!0,EM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,I:!0,KBD:!0,MARK:!0,P:!0,PRE:!0,Q:!0,RP:!0,RT:!0,RUBY:!0,S:!0,SAMP:!0,SMALL:!0,SPAN:!0,STRONG:!0,SUB:!0,SUP:!0,U:!0,VAR:!0,ACRONYM:!0,LISTING:!0,STRIKE:!0,XMP:!0,BIG:!0,BLINK:!0,FONT:!0,MARQUEE:!0,NOBR:!0,TT:!0},Pn={colgroup:!0,table:!0,tbody:!0,tfoot:!0,thead:!0,tr:!0},Fn={script:!0,style:!0,plaintext:!0,xmp:!0},zn=r.extend({H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0},In),Bn={CAPTION:!0,COL:!0,COLGROUP:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0},Ln={DD:!0,DT:!0},qn={A:r.extend({A:!0},In),DD:Ln,DT:Ln,LI:{LI:!0},NOBR:r.extend({NOBR:!0},In),H1:zn,H2:zn,H3:zn,H4:zn,H5:zn,H6:zn,TD:Bn,TH:Bn,ABBR:In,B:In,BDI:In,BDO:In,CITE:In,CODE:In,DFN:In,EM:In,I:In,KBD:In,MARK:In,P:In,PRE:In,Q:In,RP:In,RT:In,RUBY:In,S:In,SAMP:In,SMALL:In,SPAN:In,STRONG:In,SUB:In,SUP:In,U:In,VAR:In,ACRONYM:In,LISTING:In,STRIKE:In,XMP:In,BIG:In,BLINK:In,FONT:In,MARQUEE:In,TT:In},Hn=["subscript","bold","fontname","fontsize","forecolor","hilitecolor","italic","strikethrough","underline"];Dn.backcolor={action:function(e,t){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e),(/^(rgba?|hsla?)\(.*\)$/.test(e)||P(e)||"transparent"==e.toLowerCase())&&zt("backcolor",e,t)},standardInlineValueCommand:!0,relevantCssProperty:"backgroundColor",equivalentValues:function(e,t){return R(e)===R(t)}},Dn.bold={action:function(e,t){W("bold",t)?zt("bold","normal",t):zt("bold","bold",t)},inlineCommandActivatedValues:["bold","600","700","800","900"],relevantCssProperty:"fontWeight",equivalentValues:function(e,t){return e==t||"bold"==e&&"700"==t||"700"==e&&"bold"==t||"normal"==e&&"400"==t||"400"==e&&"normal"==t}},Dn.createlink={action:function(e,n){""!==e&&(t(St(ft())).forEach(function(n){t(S(n)).forEach(function(t){Q(t)&&h(t,"a")&&o(t,"href")&&t.setAttribute("href",e)})}),zt("createlink",e,n))},standardInlineValueCommand:!0},Dn.fontname={action:function(e,t){zt("fontname",e,t)},standardInlineValueCommand:!0,relevantCssProperty:"fontFamily"},Dn.fontsize={action:function(e,t){""!==e&&(e=F(e),(-1!=r.inArray(e,["xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large"])||/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc)$/.test(e))&&zt("fontsize",e,t))},indeterm:function(){return t(St(ft(),function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE})).map(function(e){return At(e,"fontsize")},!0).filter(function(e,n,i){return-1==t(i.slice(0,n)).indexOf(e)}).length>=2},value:function(e){var n=St(e,function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE})[0];void 0===n&&(n=e.startContainer);var i=At(n,"fontsize");return z(i)},relevantCssProperty:"fontSize"},Dn.forecolor={action:function(e,t){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e),(/^(rgba?|hsla?)\(.*\)$/.test(e)||P(e)||"transparent"==e.toLowerCase())&&zt("forecolor",e,t)},standardInlineValueCommand:!0,relevantCssProperty:"color",equivalentValues:function(e,t){return R(e)===R(t)}},Dn.hilitecolor={action:function(e,t){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e),(/^(rgba?|hsla?)\(.*\)$/.test(e)||P(e)||"transparent"==e.toLowerCase())&&zt("hilitecolor",e,t)},indeterm:function(){return t(St(ft(),function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE})).map(function(e){return At(e,"hilitecolor")},!0).filter(function(e,n,i){return-1==t(i.slice(0,n)).indexOf(e)}).length>=2},standardInlineValueCommand:!0,relevantCssProperty:"backgroundColor",equivalentValues:function(e,t){return R(e)===R(t)}},Dn.italic={action:function(e,t){W("italic",t)?zt("italic","normal",t):zt("italic","italic",t)},inlineCommandActivatedValues:["italic","oblique"],relevantCssProperty:"fontStyle"},Dn.removeformat={action:function(e,n){function i(e){return Q(e)&&f(e,["abbr","acronym","b","bdi","bdo","big","blink","cite","code","dfn","em","font","i","ins","kbd","mark","nobr","q","s","samp","small","span","strike","strong","sub","sup","tt","u","var"])}var r,o,s,d=St(ft(),i);t(d).forEach(function(e){for(;e.hasChildNodes();)gt(e.firstChild,e.parentNode,a.getIndexInParent(e),ft());e.parentNode.removeChild(e)}),Q(ft().startContainer)&&ft().startContainer.nodeType==t.Node.TEXT_NODE&&0!=ft().startOffset&&ft().startOffset!=E(ft().startContainer)&&(ft().startContainer==ft().endContainer?(r=ft().endOffset-ft().startOffset,s=l(ft().startContainer,ft().startOffset),ft().setStart(s,0),ft().setEnd(s,r)):ft().setStart(l(ft().startContainer,ft().startOffset),0)),Q(ft().endContainer)&&ft().endContainer.nodeType==t.Node.TEXT_NODE&&0!=ft().endOffset&&ft().endOffset!=E(ft().endContainer)&&(o=[ft().startContainer,ft().startOffset],r=[ft().endContainer,ft().endOffset],ft().setEnd(document.documentElement,0),l(r[0],r[1]),ft().setStart(o[0],o[1]),ft().setEnd(r[0],r[1])),t(St(ft(),Q)).forEach(function(e){for(;i(e.parentNode)&&et(e.parentNode,e);)Ut([e],ft())}),t(["subscript","bold","fontname","fontsize","forecolor","hilitecolor","italic","strikethrough","underline"]).forEach(function(e){zt(e,null,n)})}},Dn.strikethrough={action:function(e,t){W("strikethrough",t)?zt("strikethrough",null,t):zt("strikethrough","line-through",t)},inlineCommandActivatedValues:["line-through"]},Dn.subscript={action:function(e,t){var n=W("subscript",t);zt("subscript",null,t),n||zt("subscript","subscript",t)},indeterm:function(){var e=St(ft(),function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE});return t(e).some(function(e){return"subscript"==At(e,"subscript")})&&t(e).some(function(e){return"subscript"!=At(e,"subscript")})||t(e).some(function(e){return"mixed"==At(e,"subscript")})},inlineCommandActivatedValues:["subscript"]},Dn.superscript={action:function(e,t){var n=W("superscript",t);zt("superscript",null,t),n||zt("superscript","superscript",t)},indeterm:function(){var e=St(ft(),function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE});return t(e).some(function(e){return"superscript"==At(e,"superscript")})&&t(e).some(function(e){return"superscript"!=At(e,"superscript")})||t(e).some(function(e){return"mixed"==At(e,"superscript")})},inlineCommandActivatedValues:["superscript"]},Dn.underline={action:function(e,t){W("underline",t)?zt("underline",null,t):zt("underline","underline",t)},inlineCommandActivatedValues:["underline"]},Dn.unlink={action:function(){var e,t=ft(),n=[];for(e=t.startContainer;e;e=e.parentNode)h(e,"A")&&o(e,"href")&&n.unshift(e);for(e=t.startContainer;e!=v(t.endContainer);e=y(e))h(e,"A")&&o(e,"href")&&(O(e,t)||w(e,t.endContainer)||e==t.endContainer)&&n.push(e);var i;for(i=0;i<n.length;i++)Mt(n[i],"unlink",t)},standardInlineValueCommand:!0};var $n="p",Wn=["TABLE","OL","UL","DL"];Dn["delete"]={action:function(n,i){var r;if(e.browser.msie&&e.browser.version<=7&&_n(i,!1),!i.collapsed)return void pn(i);hn(i.startContainer,i.startOffset);for(var o=i.startContainer,s=i.startOffset,l=!1,d=!1;;)if(s>0&&(l=h(o.childNodes[s-1],"br")||!1,d=h(o.childNodes[s-1],"hr")||!1),0==s&&Q(o.previousSibling)&&ot(o.previousSibling))o.parentNode.removeChild(o.previousSibling);else if(s-1>=0&&s-1<o.childNodes.length&&Q(o.childNodes[s-1])&&(ot(o.childNodes[s-1])||l||d)){if(o.removeChild(o.childNodes[s-1]),s--,l||d)return i.setStart(o,s),void i.setEnd(o,s)}else if(0==s&&Y(o)||ot(o))s=a.getIndexInParent(o),o=o.parentNode;else{if(s-1>=0&&s-1<o.childNodes.length&&Q(o.childNodes[s-1])&&h(o.childNodes[s-1],"a"))return void fn(o.childNodes[s-1],i);if(s-1>=0&&s-1<o.childNodes.length&&!V(o.childNodes[s-1])&&!f(o.childNodes[s-1],["br","img"]))o=o.childNodes[s-1],s=E(o);else{var c=!0;if(c)break}}var u=Lt(o,s);if(u)return void u.parentNode.removeChild(u);if(o.nodeType==t.Node.TEXT_NODE&&0!=s)return i.setStart(o,s-1),i.setEnd(o,s-1),void pn(o,s-1,o,s);if(o.nodeType==t.Node.TEXT_NODE&&0==s&&e.browser.msie)return s=1,i.setStart(o,s),i.setEnd(o,s),i.startOffset=0,void pn(i);if(!Y(o)){if(s-1>=0&&s-1<o.childNodes.length&&f(o.childNodes[s-1],["br","hr","img"]))return i.setStart(o,s),i.setEnd(o,s),void pn(i);if(f(o,["li","dt","dd"])&&o==o.parentNode.firstChild&&0==s){var p,g=[];for(p=o.parentNode;p;p=p.parentNode)h(p,"li")&&g.unshift(p);for(r=0;r<g.length;r++)nn(g[r],i);var m=It([o]);for(Ut([o],i),Ft(m,i),f(o,["dd","dt"])&&t(S(o)).every(function(e){return!et(o,e)||!kt(o,e)})&&(o=bt(o,$n,i)),tn(o,i),r=0;r<g.length;r++)an(g[r].parentNode,i)}else{for(var b=o,v=s;;)if(0==v)v=a.getIndexInParent(b),b=b.parentNode;else{if(!(v-1>=0&&v-1<b.childNodes.length&&Q(b.childNodes[v-1])&&ot(b.childNodes[v-1])))break;b.removeChild(b.childNodes[v-1]),v--}if(0==s&&t(S(o).concat(o)).filter(function(e){return Q(e)&&et(e,o)&&Kt(e)}).length){var y=e.createRange();y.setStart(o,0),y.setEnd(o,0),y=rn(y);var _=I(y,function(e){return Q(e)&&!J(e)});for(r=0;r<_.length;r++)bn(_[r],i)}else if(!h(b.childNodes[v],"table")){if(v-1>=0&&v-1<b.childNodes.length&&h(b.childNodes[v-1],"table"))return i.setStart(b,v-1),void i.setEnd(b,v);if(0==s&&(h(b.childNodes[v-1],"hr")||h(b.childNodes[v-1],"br")&&(h(b.childNodes[v-1].previousSibling,"br")||!Y(b.childNodes[v-1].previousSibling))))return i.setStart(o,s),i.setEnd(o,s),void pn(b,v-1,b,v);if(f(b.childNodes[v],["li","dt","dd"])&&Y(b.childNodes[v].firstChild)&&0!=v){var w=b.childNodes[v-1];Y(w.lastChild)&&!h(w.lastChild,"br")&&w.appendChild(document.createElement("br")),Y(w.lastChild)&&w.appendChild(document.createElement("br"))}if(f(b.childNodes[v],["li","dt","dd"])&&f(b.childNodes[v-1],["li","dt","dd"]))b=b.childNodes[v-1],v=E(b),o=b.nextSibling,s=0;else for(;v-1>=0&&v-1<b.childNodes.length;)Q(b.childNodes[v-1])&&ot(b.childNodes[v-1])?(b.removeChild(b.childNodes[v-1]),v--):(b=b.childNodes[v-1],v=E(b));var k=e.createRange();k.setStart(b,v),k.setEnd(o,s),pn(k),C(document.body,i.startContainer)||(k.startContainer.hasChildNodes()||k.startContainer.nodeType==t.Node.TEXT_NODE||X(k.startContainer)?(i.setStart(k.startContainer,k.startOffset),i.setEnd(k.startContainer,k.startOffset)):(i.setStart(k.startContainer.parentNode,a.getIndexInParent(k.startContainer)),i.setEnd(k.startContainer.parentNode,a.getIndexInParent(k.startContainer))))}}}}};var Gn=["address","dd","div","dt","h1","h2","h3","h4","h5","h6","p","pre"];Dn.formatblock={action:function(e){function n(e){return function(n){return Q(n)&&et(n,e)&&c(n,Gn)&&!t(j(n)).some(K)}}function i(e){return function(t){return c(t,e)&&!t.attributes.length}}function a(){return!1}function o(e){return function(){return document.createElement(e)}}var s;if(/^<.*>$/.test(e)&&(e=e.slice(1,-1)),e=e.toLowerCase(),-1!=t(Gn).indexOf(e)){var l=rn(ft()),d=I(l,function(e){return Q(e)&&(Yt(e)||kt(e,"p")||f(e,["dd","dt"]))&&!t(j(e)).some(K)}),u=It(d);for(s=0;s<d.length;s++)for(var p=d[s];t(S(p)).some(n(p));)Ut([p],l);for(Ft(u,l);d.length;){var g;if(Xt(d[0]))g=[].slice.call(b(d[0].childNodes)),u=It(g),fn(d[0],l),Ft(u,l),d.shift();else for(g=[],g.push(d.shift());d.length&&d[0]==g[g.length-1].nextSibling&&!Xt(d[0])&&!h(g[g.length-1],"BR");)g.push(d.shift());tn(wt(g,-1==r.inArray(e,["div","p"])?i(e):a,o(e),l),l)}}},indeterm:function(){var e=rn(ft()),n=M(e,function(e){return rt(e)&&Q(e)&&!e.hasChildNodes()});if(!n.length)return!1;var i,a=null;for(i=0;i<n.length;i++){for(var r=n[i];Q(r.parentNode)&&et(r,r.parentNode)&&!c(r,Gn);)r=r.parentNode;var o="";if(Q(r)&&c(r,Gn)&&!t(j(r)).some(K)&&(o=r.tagName),null===a)a=o;else if(a!=o)return!0}return!1},value:function(){var e=rn(ft()),n=M(e,function(e){return rt(e)&&Q(e)&&!e.hasChildNodes()});if(!n.length)return"";for(var i=n[0];Q(i.parentNode)&&et(i,i.parentNode)&&!c(i,Gn);)i=i.parentNode;return Q(i)&&c(i,Gn)&&!t(j(i)).some(K)?i.tagName.toLowerCase():""}},Dn.forwarddelete={action:function(n,i){if(e.browser.msie&&e.browser.version<=7&&_n(i,!0),!i.collapsed)return void pn(i);hn(i.startContainer,i.startOffset);for(var r=i.startContainer,o=i.startOffset,s=!1,l=!1;;)if(o==E(r)&&Q(r.nextSibling)&&ot(r.nextSibling))r.parentNode.removeChild(r.nextSibling);else if(o<r.childNodes.length&&Q(r.childNodes[o])&&(ot(r.childNodes[o])||s||l)){if(r.removeChild(r.childNodes[o]),s||l)return Zt(r),i.setStart(r,o),void i.setEnd(r,o)}else if(o<r.childNodes.length&&st(r.childNodes[o]))o++;else if(o==E(r)&&Y(r)||ot(r))o=1+a.getIndexInParent(r),r=r.parentNode;else{if(!(o<r.childNodes.length)||V(r.childNodes[o])||f(r.childNodes[o],["br","img"]))break;r=r.childNodes[o],o=0}hn(i.startContainer,i.startOffset);var d=Bt(r,o);if(d)return void d.parentNode.removeChild(d);var c;if(r.nodeType==t.Node.TEXT_NODE&&o!=E(r)){for(i.setStart(r,o),i.setEnd(r,o),c=o+1;c!=r.length&&/^[\u0300-\u036f\u0591-\u05bd\u05c1\u05c2]$/.test(r.data[c]);)c++;return void pn(r,o,r,c)}if(!Y(r)){if(o<r.childNodes.length&&f(r.childNodes[o],["br","hr","img"]))return i.setStart(r,o),i.setEnd(r,o),void pn(r,o,r,o+1);var u=r;for(c=o;;)if(c==E(u))c=1+a.getIndexInParent(u),u=u.parentNode;else{if(!(c<u.childNodes.length&&Q(u.childNodes[c])&&ot(u.childNodes[c])))break;u.removeChild(u.childNodes[c])}if(!h(u.childNodes[c-1],"table")){if(h(u.childNodes[c],"table"))return i.setStart(u,c),void i.setEnd(u,c+1);if(o==E(r)&&f(u.childNodes[c],["br","hr"]))return i.setStart(r,o),i.setEnd(r,o),void pn(u,c,u,c+1);for(;c<u.childNodes.length;)Q(u.childNodes[c])&&ot(u.childNodes[c])?u.removeChild(u.childNodes[c]):(u=u.childNodes[c],c=0);var p=pn(r,o,u,c);i.setStart(p.startContainer,p.startOffset),i.setEnd(p.endContainer,p.endOffset)}}}},Dn.indent={action:function(){var e,t=[];for(e=ft().endContainer;e!=ft().commonAncestorContainer;e=e.parentNode)h(e,"LI")&&t.unshift(e);for(e=ft().startContainer;e!=ft().commonAncestorContainer;e=e.parentNode)h(e,"LI")&&t.unshift(e);for(e=ft().commonAncestorContainer;e;e=e.parentNode)h(e,"LI")&&t.unshift(e);var n;for(n=0;n<t.length;n++)nn(t[n],ft());var i=rn(ft()),a=[];for(a=I(i,function(e){return Q(e)&&(kt(e,"div")||kt(e,"ol"))}),a.length&&h(a[0],"LI")&&f(a[0].parentNode,["OL","UL"])&&h(a[0].previousSibling,"LI")&&nn(a[0].previousSibling,i);a.length;){var r=[];for(r.push(a.shift());a.length&&a[0]==r[r.length-1].nextSibling;)r.push(a.shift());mn(r,i)}}},Dn.inserthorizontalrule={action:function(n,i){for(;0==i.startOffset&&i.startContainer.parentNode;)i.setStart(i.startContainer.parentNode,a.getIndexInParent(i.startContainer));for(;i.endOffset==E(i.endContainer)&&i.endContainer.parentNode;)i.setEnd(i.endContainer.parentNode,1+a.getIndexInParent(i.endContainer));if(pn(i,{blockMerging:!1}),Q(ft().startContainer)||X(ft().startContainer)){ft().startContainer.nodeType==t.Node.TEXT_NODE&&0==ft().startOffset&&(ft().setStart(ft().startContainer.parentNode,a.getIndexInParent(ft().startContainer)),ft().collapse(!0)),ft().startContainer.nodeType==t.Node.TEXT_NODE&&ft().startOffset==E(ft().startContainer)&&(ft().setStart(ft().startContainer.parentNode,1+a.getIndexInParent(ft().startContainer)),ft().collapse(!0));var r=document.createElement("hr");i.insertNode(r),tn(r,i),i.setStart(r.parentNode,1+a.getIndexInParent(r)),i.setEnd(r.parentNode,1+a.getIndexInParent(r)),e.getSelection().removeAllRanges(),e.getSelection().addRange(i)}}},Dn.inserthtml={action:function(e,n){if(pn(n),Q(n.startContainer)||X(n.startContainer)){var i=n.createContextualFragment(e),r=i.lastChild;if(r){{j(i)}return V(n.startContainer)&&t(n.startContainer.childNodes).filter(function(e,t){return Q(e)&&st(e)&&a.getIndexInParent(e)>=t.startOffset},!0).forEach(function(e){e.parentNode.removeChild(e)}),n.insertNode(i),V(n.startContainer)&&Zt(n.startContainer),n.setStart(r.parentNode,1+a.getIndexInParent(r)),void n.setEnd(r.parentNode,1+a.getIndexInParent(r))}}}},Dn.insertimage={action:function(t){if(""!==t){var n=ft();if(pn(n,{stripWrappers:!1}),Q(ft().startContainer)||X(ft().startContainer)){V(n.startContainer)&&1==n.startContainer.childNodes.length&&h(n.startContainer.firstChild,"br")&&0==n.startOffset&&n.startContainer.removeChild(n.startContainer.firstChild);var i=document.createElement("img");i.setAttribute("src",t),n.insertNode(i),n.setStart(i.parentNode,1+a.getIndexInParent(i)),n.setEnd(i.parentNode,1+a.getIndexInParent(i)),e.getSelection().removeAllRanges(),e.getSelection().addRange(n),i.removeAttribute("width"),i.removeAttribute("height")}}}},Dn.insertlinebreak={action:function(n,i){if(pn(i,{stripWrappers:!1}),(Q(i.startContainer)||X(i.startContainer))&&(i.startContainer.nodeType!=t.Node.ELEMENT_NODE||kt("br",i.startContainer))&&(i.startContainer.nodeType==t.Node.ELEMENT_NODE||kt("br",i.startContainer.parentNode))){var r,o;i.startContainer.nodeType==t.Node.TEXT_NODE&&0==i.startOffset&&(r=i.startContainer.parentNode,o=a.getIndexInParent(i.startContainer),e.getSelection().collapse(r,o),i.setStart(r,o),i.setEnd(r,o)),i.startContainer.nodeType==t.Node.TEXT_NODE&&i.startOffset==E(i.startContainer)&&(r=i.startContainer.parentNode,o=1+a.getIndexInParent(i.startContainer),e.getSelection().collapse(r,o),i.setStart(r,o),i.setEnd(r,o));var s=document.createElement("br");i.insertNode(s),e.getSelection().collapse(s.parentNode,1+a.getIndexInParent(s)),i.setStart(s.parentNode,1+a.getIndexInParent(s)),i.setEnd(s.parentNode,1+a.getIndexInParent(s)),tt(s)&&(i.insertNode(Jt()),e.getSelection().collapse(s.parentNode,1+a.getIndexInParent(s)),i.setStart(s.parentNode,1+a.getIndexInParent(s)),i.setEnd(s.parentNode,1+a.getIndexInParent(s))),e.browser.msie&&e.browser.version<8&&s.parentNode.removeAttribute("style")}}},Dn.insertorderedlist={action:function(e,t){vn("ol",t)},indeterm:function(){return/^mixed( ol)?$/.test(on())},state:function(){return"ol"==on()}};var Un={LI:!0,DT:!0,DD:!0};return Dn.insertparagraph={action:function(n,i){var o;if(pn(i),gn(Z(i.startContainer),i),Q(i.startContainer)||X(i.startContainer)){var s=i.startContainer,d=i.startOffset;s.nodeType==t.Node.TEXT_NODE&&0!=d&&d!=E(s)&&l(s,d),s.nodeType==t.Node.TEXT_NODE&&d==E(s)&&(d=1+a.getIndexInParent(s),s=s.parentNode),(s.nodeType==t.Node.TEXT_NODE||s.nodeType==t.Node.COMMENT_NODE)&&(d=a.getIndexInParent(s),s=s.parentNode),e.getSelection().collapse(s,d),i.setStart(s,d),i.setEnd(s,d);for(var c=s;!Xt(c)&&Q(c.parentNode)&&et(s,c.parentNode);)c=c.parentNode;if(!Q(c)||!et(c,s)||!Xt(c)){var u=$n,p=rn(i),g=I(p,function(e){return kt(e,"p")}).slice(0,1);if(!g.length){if(!kt(u,i.startContainer))return;return c=document.createElement(u),i.insertNode(c),c.appendChild(Jt()),e.getSelection().collapse(c,0),i.setStart(c,0),void i.setEnd(c,0)
}for(;g[g.length-1].nextSibling&&kt(g[g.length-1].nextSibling,"p");)g.push(g[g.length-1].nextSibling);c=wt(g,function(){return!1},function(){return document.createElement(u)},i)}if(c){var m,b;if("ADDRESS"==c.tagName||"LISTING"==c.tagName||"PRE"==c.tagName){var v=document.createElement("br");return m=c.offsetHeight,i.insertNode(v),b=c.offsetHeight,e.getSelection().collapse(s,d+1),i.setStart(s,d+1),i.setEnd(s,d+1),void(m!=b||k(y(v),c)||(i.insertNode(Jt()),e.getSelection().collapse(s,d+1),i.setEnd(s,d+1)))}if(Un[c.tagName]&&(!c.hasChildNodes()||1==c.childNodes.length&&h(c.firstChild,"br"))){if(Ut([c],i),f(c,["dd","dt"])&&t(S(c)).every(function(e){return!et(c,e)||!kt(c,e)})&&(c=bt(c,$n,i)),tn(c,i),h(c,"li")&&h(c.nextSibling,"li")&&f(c.nextSibling.firstChild,["ol","ul"])){var _=c.nextSibling,w=c.nextSibling.childNodes.length;for(o=0;w>o;o++)c.appendChild(_.childNodes[0]);_.parentNode.removeChild(_)}}else{if(h(c,"p")&&h(c.parentNode,"blockquote")&&!c.nextSibling&&(!c.hasChildNodes()||1===c.childNodes.length&&h(c.firstChild,"br")))return void r(c.parentNode).after(c);var C=e.createRange();for(C.setStart(i.startContainer,i.startOffset),C.setEnd(c,E(c));0==C.startOffset&&C.startContainer!=c;)C.setStart(C.startContainer.parentNode,a.getIndexInParent(C.startContainer));for(;C.startOffset==E(C.startContainer)&&C.startContainer!=c;)C.setStart(C.startContainer.parentNode,1+a.getIndexInParent(C.startContainer));var x,N=I(C),T=!N.length||1==N.length&&h(N[0],"br");x=/^H[1-6]$/.test(c.tagName)&&T?$n:"DT"==c.tagName&&T?"dd":"DD"==c.tagName&&T?"dt":c.tagName.toLowerCase();var A=document.createElement(x);mt(c,A),A.removeAttribute("id"),c.parentNode.insertBefore(A,c.nextSibling);var D=M(C),O=C.extractContents(),R=j(O);for(o=0;o<R.length;o++)R[o].nodeType==t.Node.ELEMENT_NODE&&-1==t(D).indexOf(R[o])&&R[o].removeAttribute("id");var P=[],F=O.firstChild;if(F)do it(F)||P.push(F);while(null!=(F=F.nextSibling));if(h(A,"li")&&P.length&&f(P[0],["ul","ol"])){m=A.offsetHeight;var z=Jt();A.appendChild(z),b=A.offsetHeight,m!==b&&A.removeChild(z)}A.appendChild(O),Zt(c),Zt(A),e.getSelection().collapse(A,0),i.setStart(A,0),i.setEnd(A,0)}}}}},Dn.inserttext={action:function(n,i){var a;if(pn(i,{stripWrappers:!1}),Q(i.startContainer)||X(i.startContainer))if(n.length>1)for(a=0;a<n.length;a++)Dn.inserttext.action(n[a],i);else if(""!=n){if("\n"==n)return void Dn.insertparagraph.action("",i);var o=i.startContainer,s=i.startOffset;s-1>=0&&s-1<o.childNodes.length&&o.childNodes[s-1].nodeType==t.Node.TEXT_NODE&&(o=o.childNodes[s-1],s=E(o)),s>=0&&s<o.childNodes.length&&o.childNodes[s].nodeType==t.Node.TEXT_NODE&&(o=o.childNodes[s],s=0);var l=o.nodeType==t.Node.ELEMENT_NODE?o:o.parentNode;" "==n&&l.nodeType==t.Node.ELEMENT_NODE&&-1==r.inArray(t.getComputedStyle(l).whiteSpace,["pre","pre-wrap"])&&(n=" ");var d=ln(i);if(o.nodeType==t.Node.TEXT_NODE)o.insertData(s,n),e.getSelection().collapse(o,s),i.setStart(o,s),e.getSelection().extend(o,s+1),i.setEnd(o,s+1);else{1==o.childNodes.length&&tt(o.firstChild)&&o.removeChild(o.firstChild);var c=document.createTextNode(n);i.insertNode(c),e.getSelection().collapse(c,0),i.setStart(c,0),e.getSelection().extend(c,1),i.setEnd(c,1)}cn(d,i),hn(i.startContainer,i.startOffset),hn(i.endContainer,i.endOffset),e.getSelection().collapseToEnd(),i.collapse(!1)}}},Dn.insertunorderedlist={action:function(e,t){vn("ul",t)},indeterm:function(){return/^mixed( ul)?$/.test(on())},state:function(){return"ul"==on()}},Dn.justifycenter={action:function(e,t){yn("center",t)},indeterm:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return t(e).some(function(e){return"center"==sn(e)})&&t(e).some(function(e){return"center"!=sn(e)})},state:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return e.length&&t(e).every(function(e){return"center"==sn(e)})},value:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return e.length?sn(e[0]):"left"}},Dn.justifyfull={action:function(e,t){yn("justify",t)},indeterm:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return t(e).some(function(e){return"justify"==sn(e)})&&t(e).some(function(e){return"justify"!=sn(e)})},state:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return e.length&&t(e).every(function(e){return"justify"==sn(e)})},value:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return e.length?sn(e[0]):"left"}},Dn.justifyleft={action:function(e,t){yn("left",t)},indeterm:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return t(e).some(function(e){return"left"==sn(e)})&&t(e).some(function(e){return"left"!=sn(e)})},state:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return e.length&&t(e).every(function(e){return"left"==sn(e)})},value:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return e.length?sn(e[0]):"left"}},Dn.justifyright={action:function(e,t){yn("right",t)},indeterm:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return t(e).some(function(e){return"right"==sn(e)})&&t(e).some(function(e){return"right"!=sn(e)})},state:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return e.length&&t(e).every(function(e){return"right"==sn(e)})},value:function(){var e=M(rn(ft()),function(e){return Q(e)&&rt(e)&&!e.hasChildNodes()});return e.length?sn(e[0]):"left"}},Dn.outdent={action:function(){var e=[];!function(){var t;for(t=ft().endContainer;t!=ft().commonAncestorContainer;t=t.parentNode)h(t,"li")&&e.unshift(t);for(t=ft().startContainer;t;t=t.parentNode)h(t,"li")&&e.unshift(t)}(),t(e).forEach(function(e){nn(e,ft())});for(var n=rn(ft()),i=I(n,function(e){return Q(e)&&(!t(j(e)).some(Q)||f(e,["ol","ul"])||h(e,"li")&&f(e.parentNode,["ol","ul"]))});i.length;){for(;i.length&&(f(i[0],["OL","UL"])||!f(i[0].parentNode,["OL","UL"]));)bn(i.shift(),n);if(!i.length)break;var a=[];for(a.push(i.shift());i.length&&i[0]==a[a.length-1].nextSibling&&!f(i[0],["OL","UL"]);)a.push(i.shift());var r=It(a);Ut(a,n),t(a).forEach(tn),Ft(r,n)}}},Dn.selectall={action:function(){var t=document.body;t||(t=document.documentElement),t?e.getSelection().selectAllChildren(t):e.getSelection().removeAllRanges()}},Dn.stylewithcss={action:function(e){En="false"!=String(e).toLowerCase()},state:function(){return En}},Dn.usecss={action:function(e){En="false"==String(e).toLowerCase()}},function(){var e,n=[];for(e in Dn)Dn.hasOwnProperty(e)&&n.push(e);t(n).forEach(function(e){null==Dn[e].relevantCssProperty&&(Dn[e].relevantCssProperty=null),null!=Dn[e].inlineCommandActivatedValues&&null==Dn[e].indeterm&&(Dn[e].indeterm=function(n){var i=t(St(n,function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE})).map(function(t){return At(t,e)}),a=t(i).filter(function(n){return-1!=t(Dn[e].inlineCommandActivatedValues).indexOf(n)});return a.length>=1&&i.length-a.length>=1}),null!=Dn[e].inlineCommandActivatedValues&&(Dn[e].state=function(n){var i=St(n,function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE});return 0==i.length?-1!=t(Dn[e].inlineCommandActivatedValues).indexOf(At(n.startContainer,e)):t(i).every(function(n){return-1!=t(Dn[e].inlineCommandActivatedValues).indexOf(At(n,e))})}),null!=Dn[e].standardInlineValueCommand&&(Dn[e].indeterm=function(){var n,i=t(St(ft())).filter(function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE},!0).map(function(t){return At(t,e)});for(n=1;n<i.length;n++)if(i[n]!=i[n-1])return!0;return!1},Dn[e].value=function(n){var i=St(n,function(e){return Q(e)&&e.nodeType==t.Node.TEXT_NODE})[0];return"undefined"==typeof i&&(i=n.startContainer),At(i,e)})})}(),{commands:Dn,execCommand:H,queryCommandIndeterm:$,queryCommandState:W,queryCommandValue:U,queryCommandEnabled:L,queryCommandSupported:G,copyAttributes:mt,createEndBreak:Jt,isEndBreak:Qt,ensureContainerEditable:Zt,isEditingHost:X,isEditable:Q,getStateOverride:wn,setStateOverride:Cn,resetOverrides:kn,unsetStateOverride:xn}}),define("aloha/selection",["aloha/core","jquery","util/class","util/range","util/arrays","util/strings","util/dom","util/dom2","aloha/console","PubSub","aloha/engine","aloha/ecma5shims","aloha/rangy-core"],function(e,t,n,i,a,r,o,s,l,d,c,u){function h(e){var t;return e.startContainer!==e.endContainer?!1:1!=e.startContainer.nodeType?!1:(t=e.startContainer.firstChild,!t||!t.nextSibling&&"BR"==t.nodeName)}function p(e){return e.startContainer!==e.endContainer?!1:1!=e.startContainer.nodeType?!1:c.isEndBreak(e.startContainer)}function f(e,t){var n,i,a,r=[];for(r.push(1===e.nodeType&&"BODY"!==e.nodeName&&"HTML"!==e.nodeName?e.cloneNode(!1).outerHTML:"#"+e.nodeType),a=0,i=t.length;i>a&&(n=t[a],"BODY"!==n.nodeName&&"HTML"!==n.nodeName);a++)r.push(n.cloneNode(!1).outerHTML);return r.join("")}function g(n,i){var r=e.activeEditable?e.activeEditable.obj.parent()[0]:null,o=t(n).parentsUntil(r).get(),s=f(n,o),l=i&&n===i.node&&a.equal(i.parents,o)&&s===i.html;return l?null:{node:n,parents:o,html:s}}function m(e,t){var n=e.startContainer,i=e.endContainer;if(!n||!i)return void l.warn("aloha/selection","encountered range object without start or end container");var a=g(n,_),r=g(i,w);(a||r)&&(_=a,w=r,d.pub("aloha.selection.context-change",{range:e,event:t}))}function b(t){var n;e.browser.msie&&t.startContainer===t.endContainer&&t.startOffset===t.endOffset&&3==t.startContainer.nodeType&&t.startOffset==t.startContainer.data.length&&t.startContainer.nextSibling&&(n=t.startContainer.nextSibling,("OL"===n.nodeName||"UL"===n.nodeName)&&(" "==t.startContainer.data[t.startContainer.data.length-1]?t.startOffset=t.endOffset=t.startOffset-1:t.startContainer.data=t.startContainer.data+" "))}function v(e){return b(e),e}var y=window.GENTICS,_=null,w=null,C=n.extend({_constructor:function(){this.rangeObject={},this.preventSelectionChangedFlag=!1,this.correctSelectionFlag=!1,this.tagHierarchy={textNode:{},abbr:{textNode:!0},b:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0,strong:!0},pre:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0},blockquote:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0,p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0},ins:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,u:!0,p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0},ul:{li:!0},ol:{li:!0},dl:{dt:!0,dd:!0},dt:{textNode:!0},dd:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,ul:!0,ol:!0,dt:!0,table:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,del:!0,ins:!0,u:!0,p:!0,div:!0,pre:!0,blockquote:!0,a:!0},li:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,ul:!0,ol:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,del:!0,ins:!0,u:!0,a:!0},tr:{td:!0,th:!0},table:{tr:!0},div:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,ul:!0,ol:!0,dt:!0,table:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,del:!0,ins:!0,u:!0,p:!0,div:!0,pre:!0,blockquote:!0,a:!0},h1:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0}},this.tagHierarchy={textNode:this.tagHierarchy.textNode,abbr:this.tagHierarchy.abbr,br:this.tagHierarchy.textNode,img:this.tagHierarchy.textNode,b:this.tagHierarchy.b,strong:this.tagHierarchy.b,code:this.tagHierarchy.b,q:this.tagHierarchy.b,blockquote:this.tagHierarchy.blockquote,cite:this.tagHierarchy.b,i:this.tagHierarchy.b,em:this.tagHierarchy.b,sup:this.tagHierarchy.b,sub:this.tagHierarchy.b,span:this.tagHierarchy.b,del:this.tagHierarchy.del,ins:this.tagHierarchy.ins,u:this.tagHierarchy.b,p:this.tagHierarchy.b,pre:this.tagHierarchy.pre,a:this.tagHierarchy.b,ul:this.tagHierarchy.ul,ol:this.tagHierarchy.ol,dl:this.tagHierarchy.dl,li:this.tagHierarchy.li,div:this.tagHierarchy.div,h1:this.tagHierarchy.h1,h2:this.tagHierarchy.h1,h3:this.tagHierarchy.h1,h4:this.tagHierarchy.h1,h5:this.tagHierarchy.h1,h6:this.tagHierarchy.h1,table:this.tagHierarchy.div,tr:this.tagHierarchy.div,th:this.tagHierarchy.div,td:this.tagHierarchy.div},this.replacingElements={h1:{p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,pre:!0,blockquote:!0}},this.replacingElements={h1:this.replacingElements.h1,h2:this.replacingElements.h1,h3:this.replacingElements.h1,h4:this.replacingElements.h1,h5:this.replacingElements.h1,h6:this.replacingElements.h1,pre:this.replacingElements.h1,p:this.replacingElements.h1,blockquote:this.replacingElements.h1},this.allowedToStealElements={h1:{textNode:!0}},this.allowedToStealElements={h1:this.allowedToStealElements.h1,h2:this.allowedToStealElements.h1,h3:this.allowedToStealElements.h1,h4:this.allowedToStealElements.h1,h5:this.allowedToStealElements.h1,h6:this.allowedToStealElements.h1,p:this.tagHierarchy.b}},SelectionTree:function(){this.domobj={},this.selection=void 0,this.children=[]},onChange:function(t,n,i,a){this.updateSelectionTimeout&&window.clearTimeout(this.updateSelectionTimeout);var r=this;this.updateSelectionTimeout=window.setTimeout(function(){var o=new e.Selection.SelectionRange(!0);return o.startContainer&&"HTML"!==o.startContainer.nodeName&&"BODY"!==o.startContainer.nodeName?(e.browser.msie&&a&&o.select(),void e.Selection._updateSelection(n,o)):void(this.updateSelectionTimeout||r.onChange(t,n,10+2*(i||5)))},i||5)},preventSelectionChanged:function(){this.preventSelectionChangedFlag=!0},isSelectionChangedPrevented:function(){var e=this.preventSelectionChangedFlag;return this.preventSelectionChangedFlag=!1,e},isSelectionEditable:function(){return this.rangeObject.commonAncestorContainer&&t(this.rangeObject.commonAncestorContainer).contentEditable()},isFloatingMenuVisible:function(){var n=t(e.Selection.rangeObject.commonAncestorContainer).attr("data-aloha-floatingmenu-visible");return"undefined"!==n&&"true"===n?!0:!1},updateSelection:function(e){return this._updateSelection(e,null)},_updateSelection:function(n,i){if(n&&n.originalEvent&&!0===n.originalEvent.stopSelectionUpdate)return!1;if("undefined"==typeof i)return!1;if(this.rangeObject=i=i||new e.Selection.SelectionRange(!0),i&&i.startContainer&&"HR"===i.startContainer.nodeName&&i.endContainer&&"HR"===i.endContainer.nodeName)return e.getSelection().removeAllRanges(),!0;if(i.update(),i&&i.startContainer&&i.endContainer&&!this.correctSelectionFlag){var a=t(i.commonAncestorContainer).closest(".aloha-editable").length>0;if(a){var r,o=this._validEditablePosition(i.startContainer),s=this._validEditablePosition(i.endContainer),l=n&&40===n.keyCode;o||(r=this._getNearestEditablePosition(i.startContainer,l),r&&(i.startContainer=r.container,i.startOffset=r.offset)),s||(r=this._getNearestEditablePosition(i.endContainer,l),r&&(i.endContainer=r.container,i.endOffset=r.offset)),o&&s||(this.correctSelectionFlag=!0,i.correctRange(),i.select())}}return this.correctSelectionFlag=!1,this.isSelectionChangedPrevented()?!0:(e.trigger("aloha-selection-changed-before",[this.rangeObject,n]),e.trigger("aloha-selection-changed",[this.rangeObject,n]),m(this.rangeObject,n),e.trigger("aloha-selection-changed-after",[this.rangeObject,n]),!0)},_validEditablePosition:function(e){if(!e)return!1;switch(e.nodeType){case 1:return t(e).contentEditable();case 3:return t(e.parentNode).contentEditable();default:return!1}},_getNearestEditablePosition:function(e,n){for(var i=e,a=i.parentNode;null!==a&&!t(a).contentEditable();)i=a,a=a.parentNode;return null===i?!1:n?o.isBlockLevelElement(i.nextSibling)&&t(i.nextSibling).contentEditable()?{container:i.nextSibling,offset:0}:{container:a,offset:o.getIndexInParent(i)+1}:o.isBlockLevelElement(i.previousSibling)&&t(i.previousSibling).contentEditable()?{container:i.previousSibling,offset:i.previousSibling.childNodes.length}:{container:a,offset:o.getIndexInParent(i)}},getSelectionTree:function(t){return t?t.commonAncestorContainer?(this.inselection=!1,y.Utils.Dom.doCleanup({merge:!0},t)&&(t.update(),t.select()),this.recursiveGetSelectionTree(t,t.commonAncestorContainer)):(e.Log.error(this,"the rangeObject is missing the commonAncestorContainer"),!1):this.rangeObject.getSelectionTree()},recursiveGetSelectionTree:function(n,i){var a=t(i),r=0,o=this,s=[];return a.contents().each(function(t){var a,l,d="none",c=!1,u=!1,h=!1,p=!1,f=!1,g=!1;if(n.isCollapsed()&&i===n.startContainer&&n.startOffset==t&&(s[r]=new e.Selection.SelectionTree,s[r].selection="collapsed",s[r].domobj=void 0,o.inselection=!1,h=!0,r++),!o.inselection&&!h){var m;try{m=this.nodeType}catch(b){return}switch(m){case 3:this===n.startContainer&&(o.inselection=!0,d=n.startOffset>0?"partial":"full",c=n.startOffset,u=this.length);break;case 1:this===n.startContainer&&0===n.startOffset&&(o.inselection=!0,d="full"),i===n.startContainer&&n.startOffset===t&&(o.inselection=!0,d="full")}}if(o.inselection&&!h){switch("none"==d&&(d="full"),this.nodeType){case 3:this===n.endContainer&&(o.inselection=!1,n.endOffset<this.length&&(d="partial"),c===!1&&(c=0),u=n.endOffset);break;case 1:this===n.endContainer&&0===n.endOffset&&(o.inselection=!1)}i===n.endContainer&&n.endOffset<=t&&(o.inselection=!1,d="none")}if(s[r]=new e.Selection.SelectionTree,s[r].domobj=this,s[r].selection=d,"partial"==d&&(s[r].startOffset=c,s[r].endOffset=u),s[r].children=o.recursiveGetSelectionTree(n,this),l=s[r].children.length,l>0){for(a=0;l>a;++a)switch(s[r].children[a].selection){case"none":p=!0;break;case"full":g=!0;break;case"partial":f=!0}f||g&&p?s[r].selection="partial":!g||f||p||(s[r].selection="full")}r++}),n.isCollapsed()&&i===n.startContainer&&n.startOffset==i.childNodes.length&&(s[r]=new e.Selection.SelectionTree,s[r].selection="collapsed",s[r].domobj=void 0),s},getRangeObject:function(){return this.rangeObject},isRangeObjectWithinMarkup:function(n,i,a,r,o){var s=i?n.endContainer:n.startContainer,l=this,d=t(s).parents(),c=!1,u=-1;return"undefined"!=typeof r&&"function"!=typeof r&&e.Log.error(this,"parameter tagComparator is not a function"),"undefined"==typeof r&&(r=function(e,t){return l.standardTextLevelSemanticsComparator(e,t)}),d.length>0&&d.each(function(){return this===o?(e.Log.debug(l,"reached limit dom obj"),!1):r(this,a)?(c===!1&&(c=[]),e.Log.debug(l,"reached object equal to markup"),u++,c[u]=this,!0):void 0}),c},standardSectionsAndGroupingContentComparator:function(t,n){if(1!==t.nodeType)return e.Log.debug(this,"only element nodes (nodeType == 1) can be compared"),!1;if(!n[0].nodeName)return!1;var i=e.Selection.replacingElements[t.nodeName.toLowerCase()];return i&&i[n[0].nodeName.toLowerCase()]},standardTagNameComparator:function(t,n){return 1===t.nodeType?t.nodeName!=n[0].nodeName?!1:!0:(e.Log.debug(this,"only element nodes (nodeType == 1) can be compared"),!1)},standardTextLevelSemanticsComparator:function(t,n){return 1===t.nodeType?t.nodeName!=n[0].nodeName?!1:this.standardAttributesComparator(t,n)?!0:!1:(e.Log.debug(this,"only element nodes (nodeType == 1) can be compared"),!1)},standardAttributesComparator:function(e,t){var n=r.words(e&&e.className||""),i=r.words(t.length&&t[0].className||"");return a.sortUnique(n),a.sortUnique(i),a.equal(n,i)},changeMarkup:function(n,i,a){var r,o,s,l,d,f,g,m,b,v=i[0].tagName.toLowerCase(),y=this.isRangeObjectWithinMarkup(n,!1,i,a,o),_=this.isRangeObjectWithinMarkup(n,!0,i,a,o);if(this.replacingElements[v])s=n,n=new this.SelectionRange(n),r=e.activeEditable?e.activeEditable.obj.get(0):t("body"),n.update(r),i.isReplacingElement=!0;else if(n.isCollapsed())return e.Log.debug(this,"early returning from applying markup because nothing is currently selected"),!1;if(o=e.activeEditable?e.activeEditable.obj[0]:t("body"),i.isReplacingElement||0!==n.startOffset||null!=(f=this.getTextNodeSibling(!1,n.commonAncestorContainer.parentNode,n.startContainer))&&(g=this.isRangeObjectWithinMarkup({startContainer:f,startOffset:0},!1,i,a,o)),i.isReplacingElement||n.endOffset!==n.endContainer.length||null!=(l=this.getTextNodeSibling(!0,n.commonAncestorContainer.parentNode,n.endContainer))&&(d=this.isRangeObjectWithinMarkup({startContainer:l,startOffset:0},!1,i,a,o)),i.isReplacingElement||!y||_){if(!i.isReplacingElement&&y&&_)e.Log.info(this,"markup 2 markup"),this.prepareForRemoval(n.getSelectionTree(),i,a),this.splitRelevantMarkupObject(y,_,n,a);else if(!i.isReplacingElement&&(!y&&_||d||g))e.Log.info(this,"non-markup 2 markup OR with next2markup"),g&&d?(m=new e.Selection.SelectionRange(n),m.startContainer=t(g[g.length-1]).textNodes()[0],m.startOffset=0,m.endContainer=t(d[d.length-1]).textNodes().last()[0],m.endOffset=m.endContainer.length,m.update(),this.applyMarkup(m.getSelectionTree(),n,i,a),e.Log.info(this,"double extending previous markup(previous and after selection), actually wrapping it ...")):!g||d||_?g&&!d&&_?(m=new e.Selection.SelectionRange(n),m.startContainer=t(g[g.length-1]).textNodes()[0],m.startOffset=0,m.endContainer=t(_[_.length-1]).textNodes().last()[0],m.endOffset=m.endContainer.length,m.update(),this.applyMarkup(m.getSelectionTree(),n,i,a),e.Log.info(this,"double extending previous markup(previous and relevant at the end), actually wrapping it ...")):!g&&d?(this.extendExistingMarkupWithSelection(d,n,!0,a),e.Log.info(this,"extending following markup backwards")):this.extendExistingMarkupWithSelection(_,n,!0,a):(this.extendExistingMarkupWithSelection(g,n,!1,a),e.Log.info(this,"extending previous markup"));else if(i.isReplacingElement||!y&&!_&&!g&&!d){if(e.Log.info(this,"non-markup 2 non-markup"),h(n)){var w=i.clone();return p(n)&&w[0].appendChild(c.createEndBreak()),e.activeEditable&&e.browser.mozilla&&e.activeEditable.obj.focus(),c.isEditable(n.startContainer)?(c.copyAttributes(n.startContainer,w[0]),t(n.startContainer).after(w[0]).remove()):c.isEditingHost(n.startContainer)&&(t(n.startContainer).append(w[0]),c.ensureContainerEditable(w[0])),s.startContainer=w[0],s.endContainer=w[0],s.startOffset=0,void(s.endOffset=0)}this.applyMarkup(n.getSelectionTree(),n,i,a,{setRangeObject2NewMarkup:!0}),s.startContainer=n.startContainer,s.endContainer=n.endContainer,s.startOffset=n.startOffset,s.endOffset=n.endOffset}}else e.Log.info(this,"markup 2 non-markup"),this.prepareForRemoval(n.getSelectionTree(),i,a),t(y).addClass("preparedForRemoval"),this.insertCroppedMarkups(y,n,!1,a);i.isReplacingElement&&(s&&s.startContainer.className&&s.startContainer.className.indexOf("preparedForRemoval")>-1&&(b=t(s.startContainer).parents(i[0].tagName).get(0),s.startContainer=b,n.startContainer=b),s&&s.endContainer.className&&s.endContainer.className.indexOf("preparedForRemoval")>-1&&(b=t(s.endContainer).parents(i[0].tagName).get(0),s.endContainer=b,n.endContainer=b)),t(".preparedForRemoval").zap(),i.isReplacingElement?(u.Node.ELEMENT_NODE===s.startContainer.nodeType&&s.startContainer.childNodes&&s.startContainer.childNodes.length<s.startOffset&&(s.startOffset=s.startContainer.childNodes.length,n.startOffset=s.startContainer.childNodes.length),u.Node.ELEMENT_NODE===s.endContainer.nodeType&&s.endContainer.childNodes&&s.endContainer.childNodes.length<s.endOffset&&(s.endOffset=s.endContainer.childNodes.length,n.endOffset=s.endContainer.childNodes.length),n.endContainer=s.endContainer,n.endOffset=s.endOffset,n.startContainer=s.startContainer,n.startOffset=s.startOffset,s.update(),s.select()):(n.update(),n.select())},areMarkupObjectsAsLongAsRangeObject:function(e,n,i){var a,r,o,s,l;if(0!==i.startOffset)return!1;for(a=0,l=e.length;l>a;a++)if(r=t(e[a]),r.textNodes().first()[0]!==i.startContainer)return!1;for(a=0,s=n.length;s>a;a++)if(r=t(n[a]),o=r.textNodes().last()[0],o!==i.endContainer||o.length!=i.endOffset)return!1;return!0},splitRelevantMarkupObject:function(e,n,i,a){if(t(e).addClass("preparedForRemoval"),t(n).addClass("preparedForRemoval"),this.areMarkupObjectsAsLongAsRangeObject(e,n,i))return!0;var r=this.intersectRelevantMarkupObjects(e,n);return r?(this.insertCroppedMarkups([r],i,!1,a),this.insertCroppedMarkups([r],i,!0,a)):(this.insertCroppedMarkups(e,i,!1,a),this.insertCroppedMarkups(n,i,!0,a)),!0},intersectRelevantMarkupObjects:function(e,t){var n,i,a,r,o,s,l=!1;if(!e||!t)return l;for(o=e.length,s=t.length,n=0;o>n;n++)for(i=e[n],a=0;s>a;a++)r=t[a],i===r&&(l=i);return l},extendExistingMarkupWithSelection:function(e,n,i,a){var r,o,s,l,d,c,u,h;for(i||(r=!0),i&&(o=!0),s=[],l=0,d=e.length;d>l;l++)s[l]=new this.SelectionRange,c=e[l],o&&!r&&(s[l].startContainer=n.startContainer,s[l].startOffset=n.startOffset,u=t(c).textNodes(!0),h=u.length-1,s[l].endContainer=u[h],s[l].endOffset=u[h].length,s[l].update(),this.applyMarkup(s[l].getSelectionTree(),n,this.getClonedMarkup4Wrapping(c),a,{setRangeObject2NewMarkup:!0})),!o&&r&&(u=t(c).textNodes(!0),s[l].startContainer=u[0],s[l].startOffset=0,s[l].endContainer=n.endContainer,s[l].endOffset=n.endOffset,s[l].update(),this.applyMarkup(s[l].getSelectionTree(),n,this.getClonedMarkup4Wrapping(c),a,{setRangeObject2NewMarkup:!0}));return!0},getClonedMarkup4Wrapping:function(e){var n=t(e.outerHTML).removeClass("preparedForRemoval").empty();return 0===n.attr("class").length&&n.removeAttr("class"),n},insertCroppedMarkups:function(e,n,i,a){var r,o,s,l,d,c,u;for(i?o=!0:r=!0,l=[],d=0;d<e.length;d++){if(l[d]=new this.SelectionRange,c=e[d],r&&!o){if(u=t(c).textNodes(!0),l[d].startContainer=u[0],l[d].startOffset=0,l[d].startContainer===n.startContainer&&l[d].startOffset===n.startOffset)continue;0===n.startOffset?(l[d].endContainer=this.getTextNodeSibling(!1,c,n.startContainer),l[d].endOffset=l[d].endContainer.length):(l[d].endContainer=n.startContainer,l[d].endOffset=n.startOffset),l[d].update(),this.applyMarkup(l[d].getSelectionTree(),n,this.getClonedMarkup4Wrapping(c),a,{setRangeObject2NextSibling:!0})}!r&&o&&(l[d].startContainer=n.endContainer,l[d].startOffset=n.endOffset,s=t(c).textNodes(!0),l[d].endContainer=s[s.length-1],l[d].endOffset=s[s.length-1].length,l[d].update(),this.applyMarkup(l[d].getSelectionTree(),n,this.getClonedMarkup4Wrapping(c),a,{setRangeObject2PreviousSibling:!0}))}return!0},changeMarkupOnSelection:function(e){var t=this.getRangeObject();this.changeMarkup(t,e,this.getStandardTagComparator(e)),y.Utils.Dom.doCleanup({merge:!0},t),t.update(),t.select(),this.rangeObject=t},applyMarkup:function(t,n,i,a,r){var o,s,l,d;for(r=r||{},this.prepareForRemoval(t,i,a),o=this.optimizeSelectionTree4Markup(t,i,a),d=!0,s=0;s<o.length;s++)l=o[s],l.wrappable?this.wrapMarkupAroundSelectionTree(l.elements,n,i,a,r):(e.Log.debug(this,"dive further into non-wrappable object"),this.applyMarkup(l.element.children,n,i,a,r))},getMarkupType:function(n){var i=t(n)[0].nodeName.toLowerCase();return n.outerHtml&&e.Log.debug(this,"Node name detected: "+i+" for: "+n.outerHtml()),"#text"==i?"textNode":this.replacingElements[i]?"sectionOrGroupingContent":this.tagHierarchy[i]?"textLevelSemantics":void e.Log.warn(this,"unknown markup passed to this.getMarkupType(...): "+n.outerHtml())},getStandardTagComparator:function(e){var t,n=this;switch(this.getMarkupType(e)){case"textNode":t=function(){return!1};break;case"sectionOrGroupingContent":t=function(e,t){return n.standardSectionsAndGroupingContentComparator(e,t)};break;default:t=function(e,t){return n.standardTextLevelSemanticsComparator(e,t)}}return t},prepareForRemoval:function(n,i,a){var r,o;for("undefined"!=typeof a&&"function"!=typeof a&&e.Log.error(this,"parameter tagComparator is not a function"),"undefined"==typeof a&&(a=this.getStandardTagComparator(i)),r=0;r<n.length;r++)o=n[r],o.domobj&&("full"==o.selection||"partial"==o.selection&&i.isReplacingElement)&&1===o.domobj.nodeType&&a(o.domobj,i)&&(e.Log.debug(this,"Marking for removal: "+o.domobj.nodeName),t(o.domobj).addClass("preparedForRemoval")),"none"!=o.selection&&o.children.length>0&&this.prepareForRemoval(o.children,i,a)},wrapMarkupAroundSelectionTree:function(n,i,a,r,o){var s,l,d,c,u,h,p,f=[],g=-1,m=!0,b="",v="";for(e.Log.debug(this,"The formatting <"+a[0].tagName+"> will be wrapped around the selection"),u=0;u<n.length;u++)if(h=n[u],!h.domobj||this.canTag1WrapTag2(h.domobj.parentNode.tagName.toLowerCase(),a[0].tagName.toLowerCase())){if(!h.domobj||3!==h.domobj.nodeType||0!==t.trim(h.domobj.nodeValue).length){if(h.domobj&&"partial"==h.selection&&!a.isReplacingElement)if(void 0!==h.startOffset&&void 0===h.endOffset)g++,b+=h.domobj.data.substr(0,h.startOffset),h.domobj.data=h.domobj.data.substr(h.startOffset,h.domobj.data.length-h.startOffset),f[g]=h.domobj;else if(void 0!==h.endOffset&&void 0===h.startOffset)g++,v+=h.domobj.data.substr(h.endOffset,h.domobj.data.length-h.endOffset),h.domobj.data=h.domobj.data.substr(0,h.endOffset),f[g]=h.domobj;else if(void 0!==h.endOffset&&void 0!==h.startOffset){if(h.startOffset==h.endOffset){e.Log.debug(this,"skipping empty selection");continue}g++,b+=h.domobj.data.substr(0,h.startOffset),p=h.domobj.data.substr(h.startOffset,h.endOffset-h.startOffset),v+=h.domobj.data.substr(h.endOffset,h.domobj.data.length-h.endOffset),h.domobj.data=p,f[g]=h.domobj}else e.Log.debug(this,"diving into object"),this.applyMarkup(h.children,i,a,r,o);h.domobj&&("full"==h.selection||"partial"==h.selection&&a.isReplacingElement)&&(g++,f[g]=h.domobj)}}else e.Log.info(this,"Skipping the wrapping of <"+a[0].tagName.toLowerCase()+"> because this tag is not allowed inside <"+h.domobj.parentNode.tagName.toLowerCase()+">");f.length>0&&(f=t(f),t.each(f,function(n,i){e.browser.msie&&3==i.nodeType&&!i.nextSibling&&!i.previousSibling&&i.parentNode&&"li"==i.parentNode.nodeName.toLowerCase()&&(i.data=t.trim(i.data))}),c=f.wrapAll(a).parent(),c.before(b).after(v),o.setRangeObject2NewMarkup&&(d=f.textNodes(),-1!=d.index(i.startContainer)&&(i.startOffset=0),-1!=d.index(i.endContainer)&&(i.endOffset=i.endContainer.length),m=!0),o.setRangeObject2NextSibling&&(s=!0,l=c.textNodes(!0).last()[0],-1!=f.index(i.startContainer)&&(i.startContainer=this.getTextNodeSibling(s,c.parent(),l),i.startOffset=0),-1!=f.index(i.endContainer)&&(i.endContainer=this.getTextNodeSibling(s,c.parent(),l),i.endOffset=i.endOffset-l.length)),o.setRangeObject2PreviousSibling&&(s=!1,l=c.textNodes(!0).first()[0],-1!=f.index(i.startContainer)&&(i.startContainer=this.getTextNodeSibling(s,c.parent(),l),i.startOffset=0),-1!=f.index(i.endContainer)&&(i.endContainer=this.getTextNodeSibling(s,c.parent(),l),i.endOffset=i.endContainer.length)))},getTextNodeSibling:function(e,n,i){var a,r,o=t(n).textNodes(!0);return r=o.index(i),-1==r?!1:(a=r+(e?1:-1),o[a]||!1)},optimizeSelectionTree4Markup:function(e,n,i){var a,r,o,s,l=[],d=0,c=0,u=this;for("undefined"==typeof i&&(i=function(e,t){return u.standardTextLevelSemanticsComparator(t)}),a=0;a<e.length;a++)if(e[a].domobj&&"none"!=e[a].selection)if(n.isReplacingElement&&i(n[0],t(e[a].domobj)))void 0!==l[d]&&d++,l[d]={},l[d].wrappable=!0,l[d].elements=[],l[d].elements[c]=e[a],d++;else if(this.canMarkupBeApplied2ElementAsWhole([e[a]],n))if(void 0===l[d]&&(l[d]={},l[d].wrappable=!0,l[d].elements=[]),n.isReplacingElement){for(s=a,r=a-1;r>=0&&(this.canMarkupBeApplied2ElementAsWhole([e[r]],n)&&this.isMarkupAllowedToStealSelectionTreeElement(e[r],n));r--)s=r;for(o=a,r=a+1;r<e.length&&(this.canMarkupBeApplied2ElementAsWhole([e[r]],n)&&this.isMarkupAllowedToStealSelectionTreeElement(e[r],n));r++)o=r;for(c=0,r=s;o>=r;r++)l[d].elements[c]=e[r],l[d].elements[c].selection="full",c++;c=0}else l[d].elements[c]=e[a],c++;else void 0!==l[d]&&d++,l[d]={},l[d].wrappable=!1,l[d].element=e[a],c=0,d++;return l},isMarkupAllowedToStealSelectionTreeElement:function(e,t){if(!e.domobj)return!1;var n=e.domobj.nodeName.toLowerCase(),i="#text"==n?"textNode":n,a=t[0].nodeName.toLowerCase(),r=this.allowedToStealElements[a];return r&&r[i]},canMarkupBeApplied2ElementAsWhole:function(e,t){var n,i,a,r;for(t.jquery&&(n=t[0].tagName),t.tagName&&(n=t.tagName),r=!0,i=0;i<e.length;i++)if(a=e[i],a.domobj&&("none"!=a.selection||t.isReplacingElement)){if(!this.canTag1WrapTag2(n,a.domobj.nodeName))return!1;if(a.children.length>0&&!this.canMarkupBeApplied2ElementAsWhole(a.children,t))return!1}return r},canTag1WrapTag2:function(e,t){e="#text"==e?"textNode":e.toLowerCase(),t="#text"==t?"textNode":t.toLowerCase();var n=this.tagHierarchy[e];return n&&this.tagHierarchy[t]?n[t]:!0
},mayInsertTag:function(t){var n;if("object"==typeof this.rangeObject.unmodifiableMarkupAtStart){for(n=0;n<this.rangeObject.unmodifiableMarkupAtStart.length;++n)if(!this.canTag1WrapTag2(this.rangeObject.unmodifiableMarkupAtStart[n].nodeName,t))return!1;return!0}return e.Log.warn(this,"Unable to determine whether tag "+t+" may be inserted"),!0},toString:function(){return"Aloha.Selection"},SelectionRange:y.Utils.RangeObject.extend({_constructor:function(e){this._super(e),e&&(e.commonAncestorContainer&&(this.commonAncestorContainer=e.commonAncestorContainer),e.selectionTree&&(this.selectionTree=e.selectionTree),e.limitObject&&(this.limitObject=e.limitObject),e.markupEffectiveAtStart&&(this.markupEffectiveAtStart=e.markupEffectiveAtStart),e.unmodifiableMarkupAtStart&&(this.unmodifiableMarkupAtStart=e.unmodifiableMarkupAtStart),e.splitObject&&(this.splitObject=e.splitObject))},commonAncestorContainer:void 0,selectionTree:void 0,markupEffectiveAtStart:[],unmodifiableMarkupAtStart:[],limitObject:void 0,splitObject:void 0,select:function(){this._super(),e.Selection.updateSelection()},update:function(e){this.updatelimitObject(),this.updateMarkupEffectiveAtStart(),this.updateCommonAncestorContainer(e),this.selectionTree=void 0},getSelectionTree:function(){return this.selectionTree||(this.selectionTree=e.Selection.getSelectionTree(this)),this.selectionTree},getSelectedSiblings:function(e){var t=this.getSelectionTree();return this.recursionGetSelectedSiblings(e,t)},recursionGetSelectedSiblings:function(e,t){var n,i=!1,a=!1;for(n=0;n<t.length;++n)if(t[n].domobj===e)a=!0,i=[];else if(!a&&t[n].children){if(i=this.recursionGetSelectedSiblings(e,t[n].children),i!==!1)break}else if(a&&t[n].domobj&&"collapsed"!=t[n].selection&&"none"!=t[n].selection)i.push(t[n].domobj);else if(a&&"none"==t[n].selection)break;return i},updateMarkupEffectiveAtStart:function(){this.markupEffectiveAtStart=[],this.unmodifiableMarkupAtStart=[];var e,t,n,i=this.getStartContainerParents(),a=!1;for(t=0;t<i.length;t++)n=i[t],a||n===this.limitObject?(a=!0,this.unmodifiableMarkupAtStart.push(n)):(this.markupEffectiveAtStart[t]=n,!e&&y.Utils.Dom.isSplitObject(n)&&(e=!0,this.splitObject=n));e||(this.splitObject=!1)},updatelimitObject:function(){if(e.editables&&e.editables.length>0){var n,i,a,r,o=this.getStartContainerParents(),s=e.editables;for(n=0;n<o.length;n++)for(i=o[n],a=0;a<s.length;a++)if(r=s[a].obj[0],i===r)return this.limitObject=i,!0}return this.limitObject=t("body"),!0},toString:function(e){return e?"Aloha.Selection.SelectionRange {start ["+this.startContainer.nodeValue+"] offset "+this.startOffset+", end ["+this.endContainer.nodeValue+"] offset "+this.endOffset+"}":"Aloha.Selection.SelectionRange"}})}),k=n.extend({_constructor:function(e){this._nativeSelection=e,this.ranges=[],this.preventChange=!1},anchorNode:null,anchorOffset:0,focusNode:null,focusOffset:0,isCollapsed:!1,rangeCount:0,collapse:function(e,t){this._nativeSelection.collapse(e,t)},collapseToStart:function(){throw"NOT_IMPLEMENTED"},extend:function(){},modify:function(){},collapseToEnd:function(){this._nativeSelection.collapseToEnd()},selectAllChildren:function(){throw"NOT_IMPLEMENTED"},deleteFromDocument:function(){throw"NOT_IMPLEMENTED"},getRangeAt:function(e){return v(this._nativeSelection.getRangeAt(e))},addRange:function(t){this._nativeSelection.addRange(t),this._nativeSelection._ranges[0]=v(t),e.Selection.updateSelection()},removeRange:function(){this._nativeSelection.removeRange()},removeAllRanges:function(){this._nativeSelection.removeAllRanges()},refresh:function(){},toString:function(){return"Aloha.Selection"},getRangeCount:function(){return this._nativeSelection.rangeCount}});e.getSelection=function(e){return e=e!==document||e!==window?window:e,new k(window.rangy.getSelection(e))},e.createRange=function(e){return window.rangy.createRange(e)};var x=new C;return e.Selection=x,x}),define("aloha/block-jump",["aloha/core","jquery","aloha/console"],function(e,t,n){function i(e,n){e.deleteData(0,e.length),""!==n&&(e.nextSibling&&3===e.nextSibling.nodeType?e.nextSibling.insertData(0,n):e.previousSibling&&3===e.previousSibling.nodeType?e.previousSibling.insertData(e.previousSibling.length,n):e.insertData(0,n)),setTimeout(function(){0===e.length&&t(e).remove()},0)}function a(){if(o){var e=o.nodeValue.replace(/\u200b/,"");e===o.nodeValue&&n.warn("Expected to remove the zero width text node fix, but couldn't find it"),i(o,e),o=null}}function r(n,i){return a(),o=document.createTextNode("​"),i?t(n).after(o):t(n).before(o),e.bind("aloha-selection-changed",function(t){a(),e.unbind(t)}),o}var o=null;return{removeZeroWidthTextNodeFix:a,insertZeroWidthTextNodeFix:r}}),define("aloha/markup",["aloha/core","util/class","util/html","jquery","aloha/ecma5shims","aloha/console","aloha/block-jump"],function(e,t,n,i,a,r,o){function s(e){return"BR"===e.nodeName}function l(e){return"false"===i(e).attr("contenteditable")}function d(e){return e&&3===e.nodeType}function c(e){return e?d(e)?e.length:e.childNodes.length:0}function u(e){return 0<e.data.replace(/\s+/g,"").length}function h(e){return e?e.nextSibling?d(e.nextSibling)&&!u(e.nextSibling)?h(e.nextSibling):s(e.nextSibling)&&e.nextSibling===e.parentNode.lastChild?h(e.nextSibling):""!==e.nextSibling.innerHTML||l(e.nextSibling)?e.nextSibling:h(e.nextSibling):e.parentNode?h(e.parentNode):null:null}function p(e){return e?e.previousSibling?d(e.previousSibling)&&!u(e.previousSibling)?p(e.previousSibling):""!==e.previousSibling.innerHTML||l(e.previousSibling)?e.previousSibling:p(e.previouSibling):e.parentNode?p(e.parentNode):null:null}function f(e,t){return d(e)&&t<=e.data.length-e.data.replace(/^\s+/,"").length?!0:0===t}function g(e){return e.parent().hasClass("aloha-editable")}function m(e,t){var n=c(e);if(n===t)return!0;var i=d(e);return i&&e.data.replace(/\s+$/,"").length===t?!0:1!==n||i?!1:s(e.childNodes[0])}function b(e,t){return x?16&a.compareDocumentPosition(e,t):0<i(e).find(t).length}function v(e){var t=e.startContainer,n=e.endContainer,i=window.$_alohaPlaceholder;return i.is(t)||i.is(n)||b(i[0],t)||b(i[0],n)}function y(e){window.$_alohaPlaceholder&&!v(e)&&(0===window.$_alohaPlaceholder.html().replace(/^(&nbsp;)*$/,"").length&&window.$_alohaPlaceholder.remove(),window.$_alohaPlaceholder=null)}function _(t,n,a){var r=new k.Utils.RangeObject,s=n?p(t):h(t);if(!s||l(s)){var d=i("<div>&nbsp;</div>");n?i(t).before(d):i(t).after(d),r.startContainer=r.endContainer=d[0],r.startOffset=r.endOffset=0,y(r),window.$_alohaPlaceholder=d}else{var u=3===a.startContainer.nodeType&&a.startContainer===a.endContainer&&""!==a.startContainer.nodeValue&&(n?1===a.startOffset:a.endOffset+1===a.endContainer.length)||1===a.startContainer.nodeType&&(!a.startOffset||a.startContainer.childNodes[a.startOffset]&&1===a.startContainer.childNodes[a.startOffset].nodeType);if(u){var f=o.insertZeroWidthTextNodeFix(t,n);r.startContainer=r.endContainer=f,r.startOffset=r.endOffset=n?1:0}else r.startContainer=r.endContainer=s,r.startOffset=r.endOffset=n?c(s):0,n||o.insertZeroWidthTextNodeFix(t,!0);y(r)}r.select(),e.trigger("aloha-block-selected",t),e.Selection.preventSelectionChanged()}function w(e,t){var n;if(e.parentNode){for(n=0;n<t.length;n++)if(t[n]===e.parentNode.nodeName)return!0;return w(e.parentNode,t)}return!1}function C(e,t){if(!e.parentNode)return!0;var n=3===e.nodeType&&e.parentNode.firstChild===e||e.parentNode.children[0]===e,i="TR"===e.nodeName&&-1!==e.parentNode.children[0].className.indexOf("aloha-table-selectcolumn"),a="TD"===e.nodeName&&-1!==e.parentNode.children[0].className.indexOf("aloha-table-selectrow"),r=(a||i)&&e.parentNode.children[1]===e;return n||r?e.parentNode.nodeName===t?!0:C(e.parentNode,t):!1}var k=window.GENTICS,x=!!(e.browser.msie&&9>parseInt(e.browser.version,10)),S=function(){function e(e){var t,n;for(n=e.childNodes.length-1;n>-1;n--)if(t=e.childNodes[n],"CAPTION"!==t.nodeName&&(3!==t.nodeType||!/^[\t\n\r ]+$/.test(t.data)))return t;return e.lastChild}return function(t,n){return t.parentNode?e(t.parentNode)===t?t.parentNode.nodeName===n?!0:S(t.parentNode,n):!1:!0}}();return e.Markup=t.extend({keyHandlers:{},addKeyHandler:function(e,t){this.keyHandlers[e]||(this.keyHandlers[e]=[]),this.keyHandlers[e].push(t)},removeKeyHandler:function(e){this.keyHandlers[e]&&(this.keyHandlers[e]=null)},insertBreak:function(){var t,n,a,r=e.Selection.rangeObject;r.isCollapsed()||this.removeSelectedMarkup(),a=i("<br/>"),k.Utils.Dom.insertIntoDOM(a,r,e.activeEditable.obj),n=k.Utils.Dom.searchAdjacentTextNode(a.parent().get(0),k.Utils.Dom.getIndexInParent(a.get(0))+1,!1),n&&(t=n.data.search(/\S/),t>0&&(n.data=n.data.substring(t))),r.startContainer=r.endContainer=a.get(0).parentNode,r.startOffset=r.endOffset=k.Utils.Dom.getIndexInParent(a.get(0))+1,r.correctRange(),r.clearCaches(),r.select()},preProcessKeyStrokes:function(t){if("keydown"!==t.type)return!1;var i,a,r;if(this.keyHandlers[t.keyCode])for(a=this.keyHandlers[t.keyCode],r=0;r<a.length;++r)if(!a[r](t))return!1;return 37===t.keyCode||39===t.keyCode?e.getSelection().getRangeCount()&&(i=e.getSelection().getRangeAt(0),this.processCursor(i,t.keyCode))?(y(e.Selection.rangeObject),!0):!1:38===t.keyCode||40===t.keyCode?e.getSelection().getRangeCount()&&(i=e.getSelection().getRangeAt(0),this.processCursorUpDown(i,t.keyCode))?!1:!0:8===t.keyCode?(t.preventDefault(),e.execCommand("delete",!1),!1):46===t.keyCode?(e.execCommand("forwarddelete",!1),!1):13===t.keyCode?!t.shiftKey&&n.allowNestedParagraph(e.activeEditable)?(e.execCommand("insertparagraph",!1),!1):(e.execCommand("insertlinebreak",!1),!1):!0},processCursorUpDown:function(t,n){if(!t.collapsed)return!1;var a,r,o=t.startContainer;if(38===n&&f(o,t.startOffset)&&w(o,["TD","TH"])&&C(o,"TABLE")){if(a=i(o).parents("div.aloha-table-wrapper").get(0),!a)return!1;for(r=a.previousElementSibling?a.previousElementSibling:a.previousSibling;3!==r.nodeType;)if(r=r.lastChild,null===r)return!1;return e.Selection.rangeObject.startContainer=r,e.Selection.rangeObject.endContainer=r,e.Selection.rangeObject.startOffset=r.length,e.Selection.rangeObject.endOffset=r.length,e.Selection.rangeObject.select(),e.activeEditable&&i.browser.mozilla&&e.activeEditable.obj.focus(),!0}if(40===n&&m(o,t.startOffset)&&w(o,["TD","TH"])&&S(o,"TABLE")){if(a=i(o).parents("div.aloha-table-wrapper").get(0),!a)return!1;for(r=a.nextElementSibling?a.nextElementSibling:a.nextSibling;3!==r.nodeType;)if(r=r.firstChild,null===r)return!1;return e.Selection.rangeObject.startContainer=r,e.Selection.rangeObject.endContainer=r,e.Selection.rangeObject.startOffset=0,e.Selection.rangeObject.endOffset=0,e.Selection.rangeObject.select(),e.activeEditable&&i.browser.mozilla&&e.activeEditable.obj.focus(),!0}return!1},processCursor:function(t,n){if(!t.collapsed)return!0;o.removeZeroWidthTextNodeFix();var a=t.startContainer,r=e.getSelection();if(!a)return!0;var s,u;if(e.browser.msie&&parseInt(e.browser.version,10)<=7&&d(a))if(37==n){for(u=t.startOffset;u>0&&"​"===a.data.charAt(u-1);)u--;u!=t.startOffset&&(t.setStart(t.startContainer,u),t.setEnd(t.startContainer,u),r=e.getSelection(),r.removeAllRanges(),r.addRange(t))}else if(39==n){for(u=t.startOffset;u<a.data.length&&"​"===a.data.charAt(u);)u++;u!=t.startOffset&&(t.setStart(t.startContainer,u),t.setEnd(t.startContainer,u),r.removeAllRanges(),r.addRange(t))}if(x&&!i(a).contentEditable()){var b=i(a).parents("[contenteditable=false]"),v=b.length>0;if(v){if(!g(b))return!0;s=b[0]}}var y;if(!s){if(y=37===n||38===n,u=t.startOffset,d(a)){if(y){var w=1===u;if(!w&&!f(a,u))return!0}else if(!m(a,u))return!0}else a=a.childNodes[u===c(a)?u-1:u];s=y?p(a):h(a)}return l(s)?(_(s,y,t),!1):!0},processShiftEnter:function(e){this.insertHTMLBreak(e.getSelectionTree(),e)},processEnter:function(e){e.splitObject?this.splitRangeObject(e):this.insertHTMLBreak(e.getSelectionTree(),e)},insertHTMLCode:function(t){var n=e.Selection.rangeObject;this.insertHTMLBreak(n.getSelectionTree(),n,i(t))},insertHTMLBreak:function(t,n,a){var r,o,s,l,d,c,u,h,p;for(a=a||i("<br/>"),r=0,o=t.length;o>r;++r)if(s=t[r],l=s.domobj?i(s.domobj):void 0,"none"!==s.selection)if("collapsed"==s.selection)r>0?(d=i(t[r-1].domobj),d.after(a)):(c=i(t[1].domobj),c.before(a)),n.startContainer=n.endContainer=a[0].parentNode,n.startOffset=n.endOffset=k.Utils.Dom.getIndexInParent(a[0])+1,n.correctRange();else if(s.domobj&&3===s.domobj.nodeType){if(s.domobj.nextSibling&&1==s.domobj.nextSibling.nodeType&&e.Selection.replacingElements[s.domobj.nextSibling.nodeName.toLowerCase()]&&l.after("<br/>"),this.needEndingBreak()){for(p=s.domobj;p;)if(p.nextSibling)p=!1;else{if(p=p.parentNode,k.Utils.Dom.isBlockLevelElement(p)||k.Utils.Dom.isListElement(p))break;p===n.limitObject&&(p=!1)}p&&i(p).append('<br class="aloha-cleanme" />')}for(l.between(a,s.startOffset),h=0,u=a[0];u;)u=u.previousSibling,++h;n.startContainer=a[0].parentNode,n.endContainer=a[0].parentNode,n.startOffset=h,n.endOffset=h,n.correctRange()}else s.domobj&&1===s.domobj.nodeType&&(0===l.parent().find("br.aloha-ephemera").length&&(i(n.limitObject).find("br.aloha-ephemera").remove(),i(n.commonAncestorContainer).append(this.getFillUpElement(n.splitObject))),l.after(a),n.startContainer=n.commonAncestorContainer,n.endContainer=n.startContainer,n.startOffset=r+2,n.endOffset=r+2,n.update());n.select()},needEndingBreak:function(){return!e.browser.msie},getSelectedText:function(){var t=e.Selection.rangeObject;return t.isCollapsed()?!1:this.getFromSelectionTree(t.getSelectionTree(),!0)},getFromSelectionTree:function(e,t){var n,a,r,o,s="";for(n=0,a=e.length;a>n;n++)r=e[n],"partial"==r.selection?3===r.domobj.nodeType?s+=r.domobj.data.substring(r.startOffset,r.endOffset):1===r.domobj.nodeType&&r.children&&(t?s+=this.getFromSelectionTree(r.children,t):(o=i(r.domobj.outerHTML).empty(),o.html(this.getFromSelectionTree(r.children,t)),s+=o.outerHTML())):"full"==r.selection&&(3===r.domobj.nodeType?s+=i(r.domobj).text():1===r.domobj.nodeType&&r.children&&(s+=t?i(r.domobj).text():i(r.domobj).outerHTML()));return s},getSelectedMarkup:function(){var t=e.Selection.rangeObject;return t.isCollapsed()?null:this.getFromSelectionTree(t.getSelectionTree(),!1)},removeSelectedMarkup:function(){var t,n=e.Selection.rangeObject;n.isCollapsed()||(t=new e.Selection.SelectionRange,this.removeFromSelectionTree(n.getSelectionTree(),t),t.update(),k.Utils.Dom.doCleanup({merge:!0,removeempty:!0},e.Selection.rangeObject),e.Selection.rangeObject=t,t.correctRange(),t.update(),t.select(),e.Selection.updateSelection())},removeFromSelectionTree:function(e,t){var n,a,r,o,s,l;for(r=0,l=e.length;l>r;r++)o=e[r],"partial"==o.selection?3===o.domobj.nodeType?(a="",o.startOffset>0&&(a+=o.domobj.data.substring(0,o.startOffset)),o.endOffset<o.domobj.data.length&&(a+=o.domobj.data.substring(o.endOffset,o.domobj.data.length)),o.domobj.data=a,t.startContainer||(t.startContainer=t.endContainer=o.domobj,t.startOffset=t.endOffset=o.startOffset)):1===o.domobj.nodeType&&o.children&&(this.removeFromSelectionTree(o.children,t),n?n.nodeName==o.domobj.nodeName&&(i(n).append(i(o.domobj).contents()),i(o.domobj).remove()):n=o.domobj):"full"==o.selection&&(t.startContainer||(s=k.Utils.Dom.searchAdjacentTextNode(o.domobj.parentNode,k.Utils.Dom.getIndexInParent(o.domobj)+1,!1,{blocklevel:!1}),s?(t.startContainer=t.endContainer=s,t.startOffset=t.endOffset=0):(t.startContainer=t.endContainer=o.domobj.parentNode,t.startOffset=t.endOffset=k.Utils.Dom.getIndexInParent(o.domobj)+1)),i(o.domobj).remove())},splitRangeObject:function(t){{var n,a,r;i(t.splitObject)}t.update(t.splitObject),n=t.getSelectionTree(),r=this.getSplitFollowUpContainer(t),this.splitRangeObjectHelper(n,t,r),r.hasClass("preparedForRemoval")&&r.removeClass("preparedForRemoval"),a=this.getInsertAfterObject(t,r),i(r).insertAfter(a),"li"!==t.splitObject.nodeName.toLowerCase()||e.Selection.standardTextLevelSemanticsComparator(t.splitObject,r)||i(t.splitObject).remove(),t.startContainer=null;var o=r.contents();o.length>0&&1==o.get(0).nodeType&&"br"===o.get(0).nodeName.toLowerCase()&&(t.startContainer=r.get(0)),t.startContainer||(t.startContainer=r.textNodes(!0,!0).first().get(0)),t.startContainer||(t.startContainer=r.textNodes(!1).first().parent().get(0)),t.startContainer?(t.endContainer=t.startContainer,t.startOffset=0,t.endOffset=0):(t.startContainer=t.endContainer=r.parent().get(0),t.startOffset=t.endOffset=k.Utils.Dom.getIndexInParent(r.get(0))),t.update(),t.select()},getInsertAfterObject:function(t,n){var a,r,o;for(r=0;r<t.markupEffectiveAtStart.length;r++)if(o=t.markupEffectiveAtStart[r],o===t.splitObject&&(a=!0),a&&e.Selection.canTag1WrapTag2(i(o).parent()[0].nodeName,n[0].nodeName))return o;return!1},getFillUpElement:function(){return e.browser.msie?!1:i('<br class="aloha-cleanme"/>')},removeElementContentWhitespaceObj:function(e){var t,n,i,a=0,r=[];for(t=0;t<e.length;++t)n=e[t],n.isElementContentWhitespace&&(r[r.length]=t);for(t=0;t<r.length;++t)i=r[t],e.splice(i-a,1),++a},splitRangeObjectHelper:function(t,n,a,r){a||e.Log.warn(this,"no followUpContainer, no inBetweenMarkup, nothing to do...");var o,s,l,d,c,u,h,p=this.getFillUpElement(n.splitObject),f=i(n.splitObject),g=!1;if(t.length>0)for(c=a.contents(),c.length!==t.length&&this.removeElementContentWhitespaceObj(c),s=0,h=t.length;h>s;++s)o=t[s],"none"===o.selection&&g===!1||o.domobj&&3===o.domobj.nodeType&&o===t[t.length-1]&&o.startOffset===o.domobj.data.length?a.textNodes().length>1||1===o.domobj.nodeType&&0===o.children.length?c.eq(s).remove():k.Utils.Dom.isSplitObject(a[0])?p?a.html(p):a.empty():(a.empty(),a.addClass("preparedForRemoval")):"none"!==o.selection?(o.domobj&&3===o.domobj.nodeType&&void 0!==o.startOffset&&(l=o.domobj.data,o.startOffset>0?o.domobj.data=l.substr(0,o.startOffset):t.length>1?i(o.domobj).remove():(u=i(o.domobj).parent(),k.Utils.Dom.isSplitObject(u[0])?p?u.html(p):u.empty():u.remove()),l.length-o.startOffset>0?c[s].data=l.substr(o.startOffset,l.length):c.length>1?c.eq(s).remove():k.Utils.Dom.isBlockLevelElement(a[0])?p?a.html(p):a.empty():(a.empty(),a.addClass("preparedForRemoval"))),g=!0,o.children.length>0&&this.splitRangeObjectHelper(o.children,n,c.eq(s),r)):"none"===o.selection&&g===!0&&(d=i(o.domobj).remove());else e.Log.error(this,"can not split splitObject due to an empty selection tree");f.find("br.aloha-ephemera:gt(0)").remove(),a.find("br.aloha-ephemera:gt(0)").remove(),f.find(".preparedForRemoval").remove(),a.find(".preparedForRemoval").remove(),0===f.contents().length&&k.Utils.Dom.isSplitObject(f[0])&&p&&f.html(p),0===a.contents().length&&k.Utils.Dom.isSplitObject(a[0])&&p&&a.html(p)},getSplitFollowUpContainer:function(e){var t,n,a,r=e.splitObject.nodeName.toLowerCase();switch(r){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":if(a=i(e.splitObject).textNodes(":not(.aloha-cleanme)").last()[0],a&&e.startContainer===a&&e.startOffset===a.length)return t=i("<p></p>"),n=i(e.splitObject.outerHTML).contents(),t.append(n),t;break;case"li":if("br"===e.startContainer.nodeName.toLowerCase()&&i(e.startContainer).hasClass("aloha-ephemera"))return t=i("<p></p>"),n=i(e.splitObject.outerHTML).contents(),t.append(n),t;if(!e.splitObject.nextSibling&&0===i.trim(i(e.splitObject).text()).length)return t=i("<p></p>")}return i(e.splitObject.outerHTML)},transformDomObject:function(e,t,n){var a,r=i(e),o=i("<"+t+">"),s=r[0].cloneNode(!1).attributes;if(s)for(a=0;a<s.length;++a)("undefined"==typeof s[a].specified||s[a].specified)&&o.attr(s[a].nodeName,s[a].nodeValue);return r[0].style&&r[0].style.cssText&&(o[0].style.cssText=r[0].style.cssText),r.contents().appendTo(o),r.replaceWith(o),n&&(n.startContainer==e&&(n.startContainer=o.get(0)),n.endContainer==e&&(n.endContainer=o.get(0))),o},toString:function(){return"Aloha.Markup"}}),e.Markup=new e.Markup,e.Markup}),define("aloha/observable",["jquery"],function(e){var t=e;return{_eventHandlers:null,bind:function(e,t,n){this._eventHandlers=this._eventHandlers||{},this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push({handler:t,scope:n||window})},unbind:function(e,n){this._eventHandlers=this._eventHandlers||{},this._eventHandlers[e]&&(this._eventHandlers[e]=n?t.grep(this._eventHandlers[e],function(e){return e.handler===n?!1:!0}):[])},trigger:function(e){if(this._eventHandlers=this._eventHandlers||{},this._eventHandlers[e]){var n=[];t.each(arguments,function(e,t){e>0&&n.push(t)}),t.each(this._eventHandlers[e],function(e,t){t.handler.apply(t.scope,n)})}},unbindAll:function(){this._eventHandlers=null}}}),define("aloha/registry",["jquery","aloha/observable","util/class"],function(e,t,n){return n.extend(t,{_entries:null,_ids:null,_constructor:function(){this._entries={},this._ids=[]},register:function(e,t){this._entries[e]=t,this._ids.push(e),this.trigger("register",t,e)},unregister:function(e){var t,n=this._entries[e];delete this._entries[e];for(t in this._ids)if(this._ids.hasOwnProperty(t)&&this._ids[t]===e){this._ids.splice(t,1);break}this.trigger("unregister",n,e)},get:function(e){return this._entries[e]},has:function(e){return this._entries[e]?!0:!1},getEntries:function(){return e.extend({},this._entries)},getIds:function(){return e.extend([],this._ids)}})}),define("aloha/contenthandlermanager",["aloha/core","aloha/registry","util/class"],function(e,t,n){var i=t.extend({createHandler:function(e){if("function"!=typeof e.handleContent)throw"ContentHandler has no function handleContent().";var t=n.extend({handleContent:function(){}},e);return new t},handleContent:function(t,n,i){var a=this,r=n?n.contenthandler:a.getIds();if(!r)return t;var o,s;for(o=0;o<r.length&&(s=a.get(r[o]),s&&(t=s.handleContent(t,n,i||e.activeEditable)),null!==t);o++);return t}});return new i}),define("util/trees",["jquery"],function(e){function t(t,n,i){var a,r,o,s,l,d,c=e.type(t);if("array"===c){for(r=i?t:[],o=0,l=0,s=t.length;s>l;l++)a=n(t[l]),a.length&&(r[o++]=a[0]);o!==r.length&&(r=r.slice(0,o))}else if("object"===c){r=i?t:{};for(d in t)t.hasOwnProperty(d)&&(a=n(t[d]),a.length?r[d]=a[0]:delete r[d])}else r=t;return r}function n(e,n){return t(e,n,!0)}function i(e,t){var n,i,a;if(1===e.nodeType)for(i=e.firstChild;i;)n=t(i),a=i.nextSibling,n.length?n[0]!==i&&e.replaceChild(n[0],i):e.removeChild(i),i=a;return e}function a(e,t,n,i){return[n(t(i),e)]}function r(e,t,n,i){return[t(n(i,e))]}function o(e,t,n,i){return t(i)?[]:[n(i,e)]}function s(e,t,n,i){var a=n(i,e);return t(a)?[]:[a]}function l(e,t,n,i){function a(i){return e(a,t,n,i)}return a(i)[0]}function d(e,i,r){return l(a,i,r?n:t,e)}function c(e,i,a){return l(r,i,a?n:t,e)}function u(e,i,a){return l(o,i,a?n:t,e)}function h(e,i,a){return l(s,i,a?n:t,e)}function p(e,t,n){return l(a,t,i,n?e:e.cloneNode(!0))}function f(e,t,n){return l(r,t,i,n?e:e.cloneNode(!0))}function g(e,t,n){return l(o,t,i,n?e:e.cloneNode(!0))}function m(e,t,n){return l(s,t,i,n?e:e.cloneNode(!0))}function b(t){var n=e.type(t);return"object"!==n&&"array"!==n}function v(e,t,n){return[t(n,e)]}function y(e,i,a){function r(e){return b(e)?[i(e)]:v(r,o,e)}var o=a?n:t;return r(e)[0]}function _(e){function n(e){return v(n,t,e)}return n(e)[0]}function w(e){var t=!0,n=[];return y(e,function(e){return n.push(e),e},t),n}return{prewalk:d,postwalk:c,preprune:u,postprune:h,prewalkDom:p,postwalkDom:f,prepruneDom:g,postpruneDom:m,isLeaf:b,leaves:y,clone:_,flatten:w,walk:t,walkInplace:n,walkDomInplace:i}}),define("util/misc",[],function(){function e(e,t){var n,i;for(n=0,i=e.length;i>n;n++)if(e[n].test(t))return!0;return!1}return{anyRx:e}}),define("aloha/ephemera",["jquery","aloha/core","aloha/console","util/strings","util/trees","util/arrays","util/maps","util/dom2","util/functions","util/html","util/misc","util/browser","PubSub"],function(e,t,n,i,a,r,o,s,l,d,c,u,h){function p(e){var t,i;for(t=0,i=e.length;i>t;t++)-1===e[t].indexOf(E)&&(n.warn('Class "'+e[t]+'" was set to be ephemeral,which hurts peformance. Add the common substring "'+E+'" to the class to fix this problem.'),E="")}function f(){var e=Array.prototype.slice.call(arguments);o.fillKeys(T.classMap,e,!0),p(e),h.pub("aloha.ephemera.classes",{ephemera:T,newClasses:e})}function g(){var e=Array.prototype.slice.call(arguments);o.fillKeys(T.attrMap,e,!0),h.pub("aloha.ephemera.attributes",{ephemera:T,newAttributes:e})}function m(e){return e&&(T=e),h.pub("aloha.ephemera",{ephemera:T}),T}function b(t){e(t).addClass("aloha-ephemera")}function v(t,n){t=e(t);var a=t.attr("data-aloha-ephemera-attr");null==a||""===a?a=n:-1===r.indexOf(i.words(a),n)&&(a+=" "+n),t.attr("data-aloha-ephemera-attr",a),t.addClass("aloha-ephemera-attr")}function y(t){e(t).addClass("aloha-ephemera-wrapper")}function _(t){e(t).addClass("aloha-ephemera-empty-wrapper")}function w(t){e(t).addClass("aloha-ephemera-filler")}function C(t){var n,a,r=e(t),o=r.attr("data-aloha-ephemera-attr");if(u.ie7||r.removeAttr("data-aloha-ephemera-attr"),"string"==typeof o)for(a=i.words(o),n=0;n<a.length;n++)r.removeAttr(a[n])}function k(e,t,n,i){var a=n[t];if(a){if(!0===a)return!0;if(-1!==r.indexOf(a,e.nodeName))return!0}return c.anyRx(i,t)}function x(t,n){var i,a,r,o=null,l=s.attrNames(t);for(a=0,r=l.length;r>a;a++)i=l[a],k(t,i,n.attrMap,n.attrRxs)&&(o=o||e(t),o.removeAttr(i))}function S(t,n){var a=t.className;if(a&&-1!==a.indexOf(E)){var o=i.words(a);if(-1!==r.indexOf(o,"aloha-cleanme")||-1!==r.indexOf(o,"aloha-ephemera"))return e.removeData(t),!1;if(-1!==r.indexOf(o,"aloha-ephemera-wrapper")||-1!==r.indexOf(o,"aloha-ephemera-filler"))return s.moveNextAll(t.parentNode,t.firstChild,t.nextSibling),e.removeData(t),!1;if(-1!==r.indexOf(o,"aloha-ephemera-empty-wrapper"))return d.hasOnlyWhiteSpaceChildren(t)||s.moveNextAll(t.parentNode,t.firstChild,t.nextSibling),e.removeData(t),!1;-1!==r.indexOf(o,"aloha-ephemera-attr")&&C(t);var l=r.filter(o,function(e){return!n.classMap[e]});l.length!==o.length&&(0===l.length?e(t).removeAttr("class"):t.className=l.join(" "))}return x(t,n),!0}function j(e,t,n){if(1===n.nodeType){if(!S(n,e))return[];n=a.walkDomInplace(n,t)}return n=r.reduce(e.pruneFns,n,r.applyNotNull),n?[n]:[]}function N(e,t){function n(e){return j(t,n,e)}return t=t||T,n(e)[0]}var T={classMap:{"aloha-ephemera-wrapper":!0,"aloha-ephemera-filler":!0,"aloha-ephemera-attr":!0,"aloha-ephemera":!0,"aloha-cleanme":!0},attrMap:{hidefocus:!0,hideFocus:!0,tabindex:!0,tabIndex:!0,contenteditable:["TABLE"],contentEditable:["TABLE"]},attrRxs:[/^(?:nodeIndex|sizcache|sizset|jquery)[\w\d]*$/i],pruneFns:[]},E="aloha-";return{ephemera:m,classes:f,attributes:g,markElement:b,markAttr:v,markWrapper:y,markWhiteSpaceWrapper:_,markFiller:w,prune:N,isAttrEphemeral:k}}),define("aloha/copypaste",["jquery","aloha/core"],function(e,t){function n(n){if(!n||!n.commonAncestorContainer)return null;var i=e(n.commonAncestorContainer);return i.length?t.getEditableHost(i):null}function i(){var e=t.getSelection();return e.getRangeCount()?e.getRangeAt(0):null}function a(e){var n=t.createRange(),i=t.getSelection();n.setStart(e.startContainer,e.startOffset),n.setEnd(e.endContainer,e.endOffset),i.removeAllRanges(),i.addRange(n)}function r(t){a({startContainer:t,endContainer:t,startOffset:0,endOffset:t.childNodes?t.childNodes.length:t.length}),e(t).focus()}return{getEditableAt:n,getRange:i,selectAllOf:r,setSelectionAt:a}}),define("aloha/command",["aloha/core","aloha/registry","aloha/engine","util/dom","aloha/contenthandlermanager"],function(e,t,n,i,a){var r={execCommand:function(t,r,o,s){var l={commandId:t,preventDefault:!1};if(e.trigger("aloha-command-will-execute",l),l.preventDefault!==!0){var d=e.getSelection();if(!s){if(!d.getRangeCount())return;s=d.getRangeAt(0)}if("inserthtml"===t.toLowerCase()&&(o=a.handleContent(o,{contenthandler:e.settings.contentHandler.insertHtml,command:"insertHtml"})),n.execCommand(t,r,o,s),"insertparagraph"!==t.toLowerCase()&&d.getRangeCount()){s=d.getRangeAt(0);var c=s.commonAncestorContainer;c.parentNode&&(c=c.parentNode);var u=new window.GENTICS.Utils.RangeObject;u.startContainer=s.startContainer,u.startOffset=s.startOffset,u.endContainer=s.endContainer,u.endOffset=s.endOffset,i.doCleanup({merge:!0,removeempty:!1},u,c),u.select()}e.trigger("aloha-command-executed",t)}},queryCommandEnabled:function(t,i){if(!i){if(!e.getSelection().getRangeCount())return;i=e.getSelection().getRangeAt(0)}return n.queryCommandEnabled(t,i)},queryCommandIndeterm:function(t,i){if(!i){if(!e.getSelection().getRangeCount())return;i=e.getSelection().getRangeAt(0)}return n.queryCommandIndeterm(t,i)},queryCommandState:function(t,i){if(!i){if(!e.getSelection().getRangeCount())return;i=e.getSelection().getRangeAt(0)}return n.queryCommandState(t,i)},queryCommandSupported:function(e){return n.queryCommandSupported(e)},queryCommandValue:function(t,i){if(!i){if(!e.getSelection().getRangeCount())return;i=e.getSelection().getRangeAt(0)}return n.queryCommandValue(t,i)},querySupportedCommands:function(){var e,t=[];for(e in n.commands)n.commands.hasOwnProperty(e)&&t.push(e);return t},getStateOverride:n.getStateOverride,setStateOverride:n.setStateOverride,resetOverrides:n.resetOverrides,unsetStateOverride:n.unsetStateOverride};return r=new(t.extend(r)),e.execCommand=r.execCommand,e.queryCommandEnabled=r.queryCommandEnabled,e.queryCommandIndeterm=r.queryCommandIndeterm,e.queryCommandState=r.queryCommandState,e.queryCommandSupported=r.queryCommandSupported,e.queryCommandValue=r.queryCommandValue,e.querySupportedCommands=r.querySupportedCommands,r}),define("aloha/state-override",["aloha/core","jquery","aloha/command","util/dom2","util/maps","util/range","PubSub"],function(e,t,n,i,a,r,o){function s(e){return new r(e)}function l(){g=null,f=null}function d(t){if(f&&!t.altKey&&!t.ctrlKey&&t.which){var n=e.getSelection();if(n.getRangeCount()){var r=String.fromCharCode(t.which),o=n.getRangeAt(0);i.insertSelectText(r,o),a.forEach(f,function(e,t){e(t,o)}),i.collapseToEnd(o),n.removeAllRanges(),n.addRange(o),t.preventDefault()}}}function c(e,t,n){p&&(g=t,f=f||{},f[e]=n)}function u(e,t,n){p&&(c(e,i.rangeFromRangeObject(t),function(e,t){var a=s(t);n(e,a),i.setRangeFromRef(t,a)}),t.select())}function h(e){return null!=e&&(p=e),p}var p=e.settings.stateOverride!==!1,f=null,g=null;return e.bind("aloha-selection-changed",function(e,t){g&&!i.areRangesEq(g,t)&&(l(),o.pub("aloha.selection.context-change",{range:t,event:e}))}),{enabled:h,keyPressHandler:d,setWithRangeObject:u,set:c,clear:l}}),define("aloha/editable",["aloha/core","util/class","jquery","aloha/pluginmanager","aloha/selection","aloha/markup","aloha/contenthandlermanager","aloha/console","aloha/block-jump","aloha/ephemera","util/dom2","PubSub","aloha/copypaste","aloha/command","aloha/state-override"],function(e,t,n,i,a,r,o,s,l,d,c,u,h,p,f){function g(t){return o.handleContent(t.getContents(),{contenthandler:e.settings.contentHandler.smartContentChange},t)}function m(e){return e.altKey?"alt":e.ctrlKey?"ctrl":e.shiftKey?"shift":null}function b(t){if(e.activeEditable){var n=j[t.which];if(n){var i=m(t),a=(i?i+"+":"")+n;if(N[a])return N[a](t)}}}function v(t){var n=t.obj;n.mousedown(function(i){return e.eventHandled?void 0:(e.eventHandled=!0,(null==e.activeEditable||"undefined"==typeof e.activeEditable||n[0]!==e.activeEditable.obj[0])&&(e.mouseEventChangedEditable=!0),t.activate(i))}),n.mouseup(function(){e.eventHandled=!1}),n.focus(function(e){return t.activate(e)}),n.keydown(function(e){var n=r.preProcessKeyStrokes(e);return t.keyCode=e.which,n||t.smartContentChange(e),n}),n.keypress(f.keyPressHandler),n.keypress(function(t){e.activeEditable.smartContentChange(t)}),n.keyup(function(t){return 27===t.keyCode?(e.deactivateEditable(),!1):void 0}),n.contentEditableSelectionChange(function(t){return a.onChange(n,t,0,e.mouseEventChangedEditable),e.mouseEventChangedEditable&&(e.mouseEventChangedEditable=!1),n})}var y=n,_=window.unescape,w=window.GENTICS,C=!1,k={};e.defaults.contentHandler={},e.defaults.contentHandler.initEditable=["blockelement","sanitize"],e.defaults.contentHandler.getContents=["blockelement","sanitize","basic"],"undefined"==typeof e.settings.contentHandler&&(e.settings.contentHandler={});var x=function(e){return y(e).html()},S=x,j={65:"a"},N={"ctrl+a":function(){var e=h.getEditableAt(h.getRange());
return e?(h.selectAllOf(e.obj[0]),!1):void 0}};n(document).keydown(b),e.Editable=t.extend({_constructor:function(t){t.attr("id")||t.attr("id",w.Utils.guid()),this.obj=t,this.originalObj=t,this.ready=!1,this.sccDelimiters=[":",";",".","!","?",",",_("%u0009"),_("%u0020"),_("%u0008"),_("%u007F"),"Enter"],this.sccIdle=5e3,this.sccDelay=500,this.sccTimerIdle=!1,this.sccTimerDelay=!1,this.keyCodeMap={93:"Apps",18:"Alt",20:"CapsLock",17:"Control",40:"Down",35:"End",13:"Enter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",36:"Home",45:"Insert",37:"Left",224:"Meta",34:"PageDown",33:"PageUp",19:"Pause",44:"PrintScreen",39:"Right",145:"Scroll",16:"Shift",38:"Up",91:"Win",92:"Win"},this.placeholderClass="aloha-placeholder",e.registerEditable(this)},init:function(){var t=this;if(this.settings=e.settings,e.settings&&e.settings.smartContentChange&&(e.settings.smartContentChange.delimiters&&(this.sccDelimiters=e.settings.smartContentChange.delimiters),e.settings.smartContentChange.idle&&(this.sccIdle=e.settings.smartContentChange.idle),e.settings.smartContentChange.delay&&(this.sccDelay=e.settings.smartContentChange.delay)),!this.check(this.obj))return void this.destroy();"undefined"==typeof e.settings.contentHandler.getContents&&(e.settings.contentHandler.getContents=e.defaults.contentHandler.getContents),"undefined"==typeof e.settings.contentHandler.initEditable&&(e.settings.contentHandler.initEditable=e.defaults.contentHandler.initEditable);var n=t.obj.html();n=o.handleContent(n,{contenthandler:e.settings.contentHandler.initEditable,command:"initEditable"},t),t.obj.html(n),e.bind("aloha-plugins-loaded",function(){t.obj.addClass("aloha-editable").contentEditable(!0),v(t),t.setUnmodified(),t.snapshotContent=t.getContents(),t.initPlaceholder(),t.ready=!0,window.setTimeout(function(){e.disableObjectResizing()},20),e.trigger("aloha-editable-created",[t]),u.pub("aloha.editable.created",{data:t})})},isActive:!1,originalContent:null,range:void 0,check:function(){var e,t,n=this,i=this.obj,a=i.get(0),r=a.nodeName.toLowerCase(),o=["a","abbr","address","article","aside","b","bdo","blockquote","cite","code","command","del","details","dfn","div","dl","em","footer","h1","h2","h3","h4","h5","h6","header","i","ins","menu","nav","p","pre","q","ruby","section","small","span","strong","sub","sup","var"];for(e=0;e<o.length;++e)if(r===o[e])return!0;switch(r){case"label":case"button":break;case"textarea":case"input":return t=y('<div id="'+this.getId()+'-aloha" class="aloha-'+r+'" />').insertAfter(i),t.height(i.height()).width(i.width()).html(i.val()),i.hide(),i.parents("form:first").submit(function(){i.val(n.getContents())}),this.obj=t,!0}return!1},initPlaceholder:function(){e.settings.placeholder&&this.isEmpty()&&this.addPlaceholder()},isEmpty:function(){var e=y.trim(this.getContents()),t="<br>"===e?!0:!1;return 0===e.length||t},addPlaceholder:function(){var t,n=y("<div>"),i=y("<span>"),a=this.obj;t=w.Utils.Dom.allowsNesting(a[0],n[0])?n:i,0===y("."+this.placeholderClass,a).length&&(y.each(e.settings.placeholder,function(e,n){a.is(e)&&t.html(n)}),t.is(":empty")||(t.addClass(this.placeholderClass).addClass("aloha-ephemera"),y(a).append(t)),y("br",a).remove())},removePlaceholder:function(e,t){var n,i=this.placeholderClass;0!==y("."+this.placeholderClass,e).length&&(t===!0?window.setTimeout(function(){n=new a.SelectionRange,n.startContainer=n.endContainer=e.get(0),n.startOffset=n.endOffset=0,y("."+i,e).remove(),n.select()},100):y("."+i,e).remove())},destroy:function(){switch(this===e.getActiveEditable()&&this.blur(),this.originalObj.get(0).nodeName.toLowerCase()){case"label":case"button":break;case"textarea":case"input":this.originalObj.val(this.getContents()),this.obj.remove(),this.originalObj.show()}this.ready=!1,this.removePlaceholder(this.obj),this.obj.removeClass("aloha-editable").contentEditable(!1).unbind("mousedown click dblclick focus keydown keypress keyup"),e.trigger("aloha-editable-destroyed",[this]),u.pub("aloha.editable.destroyed",{data:this}),e.unregisterEditable(this)},setUnmodified:function(){this.originalContent=this.getContents()},isModified:function(){return this.originalContent!==this.getContents()},toString:function(){return"Aloha.Editable"},isDisabled:function(){return!this.obj.contentEditable()||"false"===this.obj.contentEditable()},disable:function(){return this.isDisabled()||this.obj.contentEditable(!1)},enable:function(){return this.isDisabled()&&this.obj.contentEditable(!0)},activate:function(t){var n=e.getActiveEditable();return C?void(C=!1):void(t&&"focus"===t.type&&null!==n&&n.obj.parent().get(0)===t.currentTarget||this.isActive||this.isDisabled()||(this.obj.addClass("aloha-editable-active"),e.activateEditable(this),C=!0,this.removePlaceholder(this.obj,!0),C=!1,this.isActive=!0,e.trigger("aloha-editable-activated",{oldActive:n,editable:this}),u.pub("aloha.editable.activated",{data:{old:n,editable:this}})))},blur:function(){this.obj.blur(),this.isActive=!1,this.initPlaceholder(),this.obj.removeClass("aloha-editable-active"),e.trigger("aloha-editable-deactivated",{editable:this}),u.pub("aloha.editable.deactivated",{data:{editable:this}}),e.activeEditable.smartContentChange({type:"blur"},null)},empty:function(e){return null===e||""===y.trim(e)||"<br/>"===e},getContents:function(t){var n=this.obj.html(),a=k[this.getId()];if(!a||n!==a.raw){l.removeZeroWidthTextNodeFix();var r=this.obj.clone(!1);this.removePlaceholder(r),r=y(d.prune(r[0])),i.makeClean(r),r=y("<div>"+o.handleContent(r.html(),{contenthandler:e.settings.contentHandler.getContents,command:"getContents"},this)+"</div>"),a=k[this.getId()]={},a.raw=n,a.element=r}return t?a.element.clone().contents():(null==a.serialized&&(a.serialized=S(a.element[0])),a.serialized)},setContents:function(t,n){var i=null;return e.getActiveEditable()===this&&(e.deactivateEditable(),i=this),this.obj.html(t),null!==i&&i.activate(),this.smartContentChange({type:"set-contents"}),n?this.obj.contents():S(this.obj[0])},getId:function(){return this.obj.attr("id")},smartContentChange:function(t){function n(){return null==l&&(l=r.getSnapshotContent()),l}var i,a,r=this,o=null;if(t&&(t.metaKey||t.crtlKey||t.altKey))return!1;t&&t.originalEvent&&(i=new RegExp("U\\+(\\w{4})"),a=i.exec(t.originalEvent.keyIdentifier),o=this.keyCodeMap[this.keyCode]||String.fromCharCode(t.which)||"unknown");var l=null;y.inArray(o,this.sccDelimiters)>=0?(clearTimeout(this.sccTimerIdle),clearTimeout(this.sccTimerDelay),this.sccTimerDelay=window.setTimeout(function(){e.trigger("aloha-smart-content-changed",{editable:r,keyIdentifier:t.originalEvent.keyIdentifier,keyCode:t.keyCode,"char":o,triggerType:"keypress",getSnapshotContent:n}),g(r),s.debug("Aloha.Editable","smartContentChanged: event type keypress triggered")},this.sccDelay)):t&&"paste"===t.type?(e.trigger("aloha-smart-content-changed",{editable:r,keyIdentifier:null,keyCode:null,"char":null,triggerType:"paste",getSnapshotContent:n}),g(r)):t&&"blur"===t.type?(e.trigger("aloha-smart-content-changed",{editable:r,keyIdentifier:null,keyCode:null,"char":null,triggerType:"blur",getSnapshotContent:n}),g(r)):t&&"block-change"===t.type?(e.trigger("aloha-smart-content-changed",{editable:r,keyIdentifier:null,keyCode:null,"char":null,triggerType:"block-change",getSnapshotContent:n}),g(r)):null!==o&&(clearTimeout(this.sccTimerDelay),clearTimeout(this.sccTimerIdle),this.sccTimerIdle=window.setTimeout(function(){e.trigger("aloha-smart-content-changed",{editable:r,keyIdentifier:null,keyCode:null,"char":null,triggerType:"idle",getSnapshotContent:n}),g(r)},this.sccIdle))},getSnapshotContent:function(){var e=this.snapshotContent;return this.snapshotContent=this.getContents(),e}}),e.Editable.setContentSerializer=function(e){S=e},e.Editable.getContentSerializer=function(){return S},e.Editable.registerEvents=v}),define("aloha/plugin",["aloha/core","jquery","util/class","aloha/pluginmanager","aloha/console"],function(e,t,n,i,a){var r=n.extend({name:null,defaults:{},settings:{},dependencies:[],_constructor:function(e){"string"!=typeof e?a.error("Cannot initialise unnamed plugin, skipping"):this.name=e},checkDependencies:function(){var n=this,i=!0;return t.each(n.dependencies,function(t,r){return e.isPluginLoaded(r.toString())?void 0:(i=!1,a.error("plugin."+n.name,'Required plugin "'+r+'" not found.'),!1)}),i},init:function(){},getEditableConfig:function(e){var n=null,i=!1,a=this;return this.settings.editables&&t.each(this.settings.editables,function(r,o){var s;if(e.is(r))if(i=!0,o instanceof Array)n=[],n=t.merge(n,o);else if("object"==typeof o){n={},n["aloha-editable-selector"]=r;for(s in o)o.hasOwnProperty(s)&&(o[s]instanceof Array?n[s]=o[s]:"object"==typeof o[s]?(n[s]={},n[s]=t.extend(!0,n[s],a.config[s],o[s])):n[s]=o[s])}else n=o}),i||(n="undefined"!=typeof this.settings.config&&this.settings.config?this.settings.config:this.config),n},makeClean:function(){},getUID:function(){return a.deprecated("plugin","getUID() is deprecated. Use plugin.name instead."),this.name},toString:function(){return this.name},log:function(e,t){a.deprecated("plugin","log() is deprecated. Use Aloha.console instead."),a.log(e,this,t)}});return r.create=function(n,a){var o=new(r.extend(a))(n);return o.settings=t.extendObjects(!0,o.defaults,e.settings[n]),i.register(o),o},r}),define("aloha/jquery.aloha",["aloha/core","aloha/selection","jquery","aloha/console"],function(e,t,n,i){function a(e,t,n,i){return t===i.target||!/textarea|input|select/i.test(i.target.nodeName)&&"text"!==i.target.type?e.apply(t,n):void 0}function r(e){var t,i,r,o;if("string"==typeof e.data){for(t=e.handler,i=e.data.toLowerCase().split(" "),r={},o=0;o<i.length;o++)r[i[o]]=!0;e.handler=function(e){if(this===e.target){var i,o="keypress"!==e.type&&n.hotkeys.specialKeys[e.which],s="";if(e.altKey&&"alt"!==o&&(s+="alt+"),e.ctrlKey&&"ctrl"!==o&&(s+="ctrl+"),e.metaKey&&!e.ctrlKey&&"meta"!==o&&(s+="meta+"),e.shiftKey&&"shift"!==o&&(s+="shift+"),o){if(r[s+o])return a(t,this,arguments,e)}else{if(i=String.fromCharCode(e.which).toLowerCase(),r[s+i])return a(t,this,arguments,e);if(r[s+n.hotkeys.shiftNums[i]])return a(t,this,arguments,e);if("shift+"===s&&r[n.hotkeys.shiftNums[i]])return a(t,this,arguments,e)}}}}}var o=window.XMLSerializer;n.fn.between=function(e,t){var n,i;3!==this[0].nodeType?(n=this.children().size(),t>n&&(t=n),0>=t?this.prepend(e):this.children().eq(t-1).after(e)):0>=t?this.before(e):t>=this[0].length?this.after(e):(i=this[0].data,this[0].data=i.substring(0,t),this.after(i.substring(t,i.length)),this.after(e))},n.fn.contentEditable=function(t){var a=n(this),r="contenteditable";return e.browser.msie&&7==parseInt(e.browser.version,10)&&(r="contentEditable"),"undefined"==typeof t?"undefined"==typeof a[0]?void i.warn("The jquery object did not contain any valid elements."):"undefined"==typeof a[0].isContentEditable?(i.warn("Could not determine whether the is editable or not. I assume it is."),!0):a[0].isContentEditable:(""===t?a.removeAttr(r):(t=t&&"false"!==t?"true":"false",a.attr(r,t)),a)},n.fn.aloha=function(){var t=this;return e.bind("aloha-plugins-loaded",function(){t.each(function(t,i){e.isEditable(i)||new e.Editable(n(i)).init()})}),t},n.fn.mahalo=function(){return this.each(function(){e.isEditable(this)&&e.getEditableById(n(this).attr("id")).destroy()})},n.fn.alohaText=function(){return this.each(function(){e.isEditable(this)&&e.getEditableById(n(this).attr("id")).getContents()})},n.fn.contentEditableSelectionChange=function(e){var i=this;return this.keyup(function(n){t.getRangeObject();e(n)}),this.dblclick(function(t){e(t)}),this.mousedown(function(){i.selectionStarted=!0}),n(document).mouseup(function(n){t.eventOriginalTarget=i,i.selectionStarted&&e(n),t.eventOriginalTarget=!1,i.selectionStarted=!1}),this},n.fn.outerHtml=n.fn.outerHtml||function(){var e=n(this),t=e.get(0);if("undefined"!=typeof t.outerHTML)return t.outerHTML;try{return(new o).serializeToString(t)}catch(i){try{return t.xml}catch(a){}}},n.fn.zap=function(){return this.each(function(){n(this.childNodes).insertBefore(this)}).remove()},n.fn.textNodes=function(e,t){var i=[],a=function(r){var o,s;if(3===r.nodeType&&n.trim(r.data)&&!t||3===r.nodeType&&t||"BR"==r.nodeName&&!e)i.push(r);else for(o=0,s=r.childNodes.length;s>o;++o)a(r.childNodes[o])};return a(this[0]),n(i)},n.extendObjects=n.fn.extendObjects=function(e,t){var i,a,r,o,s,l,d,c=1,u=e||{},h=arguments.length,p=!1;for("boolean"==typeof u&&(p=u,u=t||{},c=2),"object"==typeof u||n.isFunction(u)||(u={}),h===c&&(u=this,--c),d=c;h>d;d++)if(null!=(i=arguments[d]))for(a in i)if(i.hasOwnProperty(a)){if(r=u[a],o=i[a],u===o)continue;p&&o&&(n.isPlainObject(o)||!0===(s=n.isArray(o)))?(s?(s=!1,l=r&&n.isArray(r)?r:[]):l=r&&n.isPlainObject(r)?r:{},u[a]=n.isArray(o)?o:n.extendObjects(p,l,o)):void 0!==o&&(u[a]=o)}return u},n.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},n.each(["keydown","keyup","keypress"],function(){n.event.special[this]={add:r}})}),define("aloha/sidebar",["aloha/core","jquery","aloha/selection","PubSub"],function(e,t,n,i){var a=+new Date;t.easing.easeOutExpo||t.extend(t.easing,{easeOutExpo:function(e,t,n,i,a){return t==a?n+i:i*(-Math.pow(2,-10*t/a)+1)+n},easeOutElastic:function(e,t,n,i,a){var r=Math,o=1.70158,s=0,l=i;return t?1==(t/=a)?n+i:(s||(s=.3*a),l<r.abs(i)?(l=i,o=s/4):o=s/(2*r.PI)*r.asin(i/l),l*r.pow(2,-10*t)*r.sin(2*(t*a-o)*r.PI/s)+i+n):n}});var r=function(e){this.id=null,this.folds={},this.button=null,this.title=t('<div class="aloha-sidebar-panel-title"><span class="aloha-sidebar-panel-title-arrow"></span><span class="aloha-sidebar-panel-title-text">Untitled</span></div>'),this.content=t('<div class="aloha-sidebar-panel-content"><div class="aloha-sidebar-panel-content-inner"><div class="aloha-sidebar-panel-content-inner-text"></div></div></div>'),this.element=null,this.effectiveElement=null,this.expanded=!1,this.isActive=!0,this.init(e)},o=function(n){var i=this;this.id="aloha-sidebar-"+ ++a,this.panels={},this.container=t('<div class="aloha-ui aloha-sidebar-bar"><div class="aloha-sidebar-handle"><span class="aloha-sidebar-handle-icon"></span></div><div class="aloha-sidebar-inner"><ul class="aloha-sidebar-panels"></ul></div></div>'),this.width=300,this.opened=!1,this.isOpen=!1,this.isCompletelyOpen=!1,this.settings={rotateIcons:!e.browser.msie,overlayPage:!0},t(function(){"undefined"!=typeof e.settings.sidebar&&e.settings.sidebar.disabled||i.init(n)})},s=null,l=null;t.extend(o.prototype,{init:function(e){var n,i=this;"object"==typeof e&&(n=e.panels,delete e.panels),t.extend(this,e),"object"==typeof n&&t.each(n,function(){i.addPanel(this,!0)});var a=this.container;"right"===this.position&&a.addClass("aloha-sidebar-right"),a.hide().appendTo(t("body")).click(function(){i.barClicked.apply(i,arguments)}).find(".aloha-sidebar-panels").width(this.width),a.width(this.width),this.width=a.width(),this.updateHeight(),this.initToggler(),this.container.css("right"===this.position?"marginRight":"marginLeft",-this.width),this.opened&&this.open(0),this.toggleHandleIcon(this.isOpen),this.subscribeToEvents(),t(window).resize(function(){i.updateHeight(),i.correctHeight()}),this.correctHeight()},show:function(){return this.container.css("display","block"),this},hide:function(){return this.container.css("display","none"),this},checkActivePanels:function(e){var n=[];if("undefined"!=typeof e&&"undefined"!=typeof e.markupEffectiveAtStart){var i,a=e.markupEffectiveAtStart.length;for(i=0;a>i;++i)n.push(t(e.markupEffectiveAtStart[i]))}var r=this;t.each(this.panels,function(){r.showActivePanel(this,n)}),this.correctHeight()},subscribeToEvents:function(){var t=this;i.sub("aloha.selection.context-change",function(e){t.isOpen&&t.checkActivePanels(e.range),t.lastRange=e.range}),e.bind("aloha-editable-deactivated",function(){t.isOpen&&t.checkActivePanels(),t.lastRange=null}),this.container.mousedown(function(t){t.originalEvent.stopSelectionUpdate=!0,e.eventHandled=!0}),this.container.mouseup(function(t){t.originalEvent.stopSelectionUpdate=!0,e.eventHandled=!1})},correctHeight:function(){if(this.isOpen){if(!this.isCompletelyOpen)return void(this.correctHeightWhenCompletelyOpen=!0);var e,n=t(window).height(),i=[],a=[];for(e in this.panels)this.panels.hasOwnProperty(e)&&this.panels[e].isActive&&(a.push(this.panels[e]),i.push(e));if(0!==a.length&&(i=i.sort().join(","),l!==i||s!==n)){s=n,l=i;for(var r,o,d,c,u,h,p=this.container.find(".aloha-sidebar-inner").height(),f=p-(a[0].title.outerHeight()+10)*a.length,g=0,m=Math;a.length>0&&f>0;){for(f+=g,g=0,u=[],h=a.length-1;h>=0;--h)r=a[h],d=r.content.find(".aloha-sidebar-panel-content-inner"),o=m.min(d.height("auto").height(),m.floor(f/(h+1))),d.height(o),f-=o,c=d.find(".aloha-sidebar-panel-content-inner-text"),c.height()>o?(u.push(r),g+=o,d.css({"overflow-x":"hidden","overflow-y":"scroll"})):d.css("overflow-y","hidden"),r.expanded&&r.expand();a=u}}}},showActivePanel:function(e,n){n.push(null);var i,a=(e.content.parent("li"),e.activeOn),r=t(),o=0,s=n.length;for(i=0;s>i;++i)a(n[i])&&(++o,n[i]&&t.merge(r,n[i]));o?e.activate(r):e.deactivate()},initToggler:function(){var n,i=this,a=this.container,r=a.find(".aloha-sidebar-handle-icon"),o="aloha-sidebar-toggled",s="right"===this.position;this.opened&&this.rotateHandleArrow(s?0:180,0),t(function(){"undefined"!=typeof e.settings.sidebar&&e.settings.sidebar.handle&&e.settings.sidebar.handle.top&&(t(a.find(".aloha-sidebar-handle"))[0].style.top=e.settings.sidebar.handle.top)}),a.find(".aloha-sidebar-handle").click(function(){n&&clearInterval(n),r.stop().css("marginLeft",4),i.isOpen?(t(this).removeClass(o),i.close(),i.isOpen=!1):(t(this).addClass(o),i.open(),i.isOpen=!0)}).hover(function(){var e=i.isOpen?-1:1;n&&clearInterval(n),r.stop(),t(this).stop().animate(s?{marginLeft:"-="+5*e}:{marginRight:"-="+5*e},200),n=setInterval(function(){e*=-1,r.animate(s?{left:"-="+4*e}:{right:"-="+4*e},300)},300)},function(){n&&clearInterval(n),r.stop().css(s?"left":"right",5),t(this).stop().animate(s?{marginLeft:0}:{marginRight:0},600,"easeOutElastic")})},roundCorners:function(){var e=this.container,t=e.find(".aloha-sidebar-panels>li:not(.aloha-sidebar-deactivated)"),n="aloha-sidebar-panel-top",i="aloha-sidebar-panel-bottom";e.find(".aloha-sidebar-panel-top, .aloha-sidebar-panel-bottom").removeClass(n).removeClass(i),t.first().find(".aloha-sidebar-panel-title").addClass(n),t.last().find(".aloha-sidebar-panel-content").addClass(i)},updateHeight:function(){var e=t(window).height();this.container.height(e).find(".aloha-sidebar-inner").height(e)},barClicked:function(e){this.handleBarclick(t(e.target))},handleBarclick:function(e){e.hasClass("aloha-sidebar-panel-title")?this.togglePanel(e):e.hasClass("aloha-sidebar-panel-content")||e.hasClass("aloha-sidebar-handle")||e.hasClass("aloha-sidebar-bar")||this.handleBarclick(e.parent())},getPanelById:function(e){return this.panels[e]},getPanelByElement:function(e){var t="LI"===e[0].tagName?e:e.parent("li");return this.getPanelById(t[0].id)},togglePanel:function(e){this.getPanelByElement(e).toggle()},rotateHandleIcon:function(e,t){var n=this.container.find(".aloha-sidebar-handle-icon");n.animate({angle:e},{duration:"number"==typeof t||"string"==typeof t?t:500,easing:"easeOutExpo",step:function(e){n.css({"-o-transform":"rotate("+e+"deg)","-webkit-transform":"rotate("+e+"deg)","-moz-transform":"rotate("+e+"deg)","-ms-transform":"rotate("+e+"deg)"})}})},toggleHandleIcon:function(e){var t="right"===this.position^e;if(this.settings.rotateIcons)this.rotateHandleIcon(t?180:0,0);else{var n=this.container.find(".aloha-sidebar-handle-icon");t?n.addClass("aloha-sidebar-handle-icon-left"):n.removeClass("aloha-sidebar-handle-icon-left")}},open:function(e){if(this.isOpen)return this;var n="right"===this.position,i=n?{marginRight:0}:{marginLeft:0},a=this;return this.toggleHandleIcon(!0),this.container.animate(i,"number"==typeof e||"string"==typeof e?e:500,"easeOutExpo"),this.settings.overlayPage||t("body").animate(n?{marginRight:"+="+this.width}:{marginLeft:"+="+this.width},500,"easeOutExpo",function(){a.isCompletelyOpen=!0,a.correctHeightWhenCompletelyOpen&&a.correctHeight()}),this.isOpen=!0,this.correctHeight(),this.lastRange&&this.checkActivePanels(this.lastRange),t("body").trigger("aloha-sidebar-opened",this),this},close:function(e){if(!this.isOpen)return this;var n="right"===this.position,i=n?{marginRight:-this.width}:{marginLeft:-this.width};return this.toggleHandleIcon(!1),this.container.animate(i,"number"==typeof e||"string"==typeof e?e:500,"easeOutExpo"),this.settings.overlayPage||t("body").animate(n?{marginRight:"-="+this.width}:{marginLeft:"-="+this.width},500,"easeOutExpo"),this.isOpen=!1,this.isCompletelyOpen=!1,this},activatePanel:function(e,t){return"string"==typeof e&&(e=this.getPanelById(e)),e&&e.activate(t),this.roundCorners(),this},expandPanel:function(e,t){return"string"==typeof e&&(e=this.getPanelById(e)),e&&e.expand(t),this},collapsePanel:function(e,t){return"string"==typeof e&&(e=this.getPanelById(e)),e&&e.collapse(t),this},addPanel:function(e){return e instanceof r||(e.width||(e.width=this.width),e.sidebar=this,e=new r(e)),this.panels[e.id]=e,this.container.find(".aloha-sidebar-panels").append(e.element),this.checkActivePanels(n.getRangeObject()),e}}),t.extend(r.prototype,{init:function(e){this.setTitle(e.title).setContent(e.content),delete e.title,delete e.content,t.extend(this,e),this.id||(this.id="aloha-sidebar-"+ ++a);this.element=t('<li id="'+this.id+'">').append(this.title,this.content);this.expanded&&this.content.height("auto"),this.toggleTitleIcon(this.expanded),this.coerceActiveOn(),this.title.attr("unselectable","on").css("-moz-user-select","none").each(function(){this.onselectstart=function(){return!1}}),"function"==typeof this.onInit&&this.onInit.apply(this)},toggleTitleIcon:function(e){if(this.sidebar.settings.rotateIcons)this.rotateTitleIcon(e?90:0);else{var t=this.title.find(".aloha-sidebar-panel-title-arrow");e?t.addClass("aloha-sidebar-panel-title-arrow-down"):t.removeClass("aloha-sidebar-panel-title-arrow-down")}},coerceActiveOn:function(){if("function"!=typeof this.activeOn){var e=this.activeOn;this.activeOn=function(){var t,n=typeof e;return t="boolean"===n?function(){return e}:"undefined"===n?function(){return!0}:"string"===n?function(t){return t?t.is(e):!1}:function(){return!1}}()}},activate:function(e){this.isActive=!0,this.content.parent("li").show().removeClass("aloha-sidebar-deactivated"),this.effectiveElement=e,"function"==typeof this.onActivate&&this.onActivate.call(this,e)},deactivate:function(){this.isActive&&(this.isActive=!1,this.content.parent("li").hide().addClass("aloha-sidebar-deactivated"),this.effectiveElement=null)},toggle:function(){this.expanded?this.collapse():this.expand()},expand:function(e){var t=this,n=this.content,i=n.height(),a=n.height("auto").height();return n.height(i).stop().animate({height:a},500,"easeOutExpo",function(){"function"==typeof e&&e.call(t)}),this.element.removeClass("collapsed"),this.toggleTitleIcon(!0),this.expanded=!0,this},collapse:function(e,t){var n=this;return this.element.addClass("collapsed"),this.content.stop().animate({height:3},250,"easeOutExpo",function(){"function"==typeof t&&t.call(n)}),this.toggleTitleIcon(!1),this.expanded=!1,this},setTitle:function(e){return this.title.find(".aloha-sidebar-panel-title-text").html(e),this},setContent:function(e){return e&&""!==e||(e="&nbsp;"),this.content.find(".aloha-sidebar-panel-content-inner-text").html(e),this},rotateTitleIcon:function(e,t){var n=this.title.find(".aloha-sidebar-panel-title-arrow");n.animate({angle:e},{duration:"number"==typeof t?t:500,easing:"easeOutExpo",step:function(e){n.css({"-o-transform":"rotate("+e+"deg)","-webkit-transform":"rotate("+e+"deg)","-moz-transform":"rotate("+e+"deg)","-ms-transform":"rotate("+e+"deg)"})}})},renderEffectiveParents:function(e,n){for(var i,a,r=e.first(),o=[],s=[],l=this.activeOn;r.length>0&&!r.is(".aloha-editable");){if(l(r)){for(s.push("<span>"+r[0].tagName.toLowerCase()+"</span>"),i=s.length,a=[];i--;)a.push(s[i]);o.push('<div class="aloha-sidebar-panel-parent"><div class="aloha-sidebar-panel-parent-path">'+a.join("")+'</div><div class="aloha-sidebar-panel-parent-contentaloha-sidebar-opened">'+("function"==typeof n?n(r):"----")+"</div></div>")}r=r.parent()}this.setContent(o.join("")),t(".aloha-sidebar-panel-parent-path").click(function(){var e=t(this).parent().find(".aloha-sidebar-panel-parent-content");e.hasClass("aloha-sidebar-opened")?e.hide().removeClass("aloha-sidebar-opened"):e.show().addClass("aloha-sidebar-opened")}),this.content.height("auto").find(".aloha-sidebar-panel-content-inner").height("auto")}});var d=new o({position:"left",width:250}),c=new o({position:"right",width:250});return e.Sidebar={left:d,right:c},e.Sidebar}),window.GENTICS=window.GENTICS||{},window.GENTICS.Utils=window.GENTICS.Utils||{},define("util/position",["jquery"],function(e){{var t=window.GENTICS;window.Class,window.console}t.Utils.Position={},t.Utils.Position.w=e(window),t.Utils.Position.Scroll={top:0,left:0,isScrolling:!1},t.Utils.Position.ScrollCorrection={top:100,left:50},t.Utils.Position.Mouse={x:0,y:0,oldX:0,oldY:0,isMoving:!1,triggeredMouseStop:!0},t.Utils.Position.mouseStopCallbacks=[],t.Utils.Position.mouseMoveCallbacks=[],t.Utils.Position.update=function(){var e,t=this.w.scrollTop(),n=this.w.scrollLeft();if(this.Scroll.isScrolling?this.Scroll.top==t&&this.Scroll.left==n&&(this.Scroll.isScrolling=!1):(this.Scroll.top!=t||this.Scroll.left!=n)&&(this.Scroll.isScrolling=!0),this.Scroll.top=t,this.Scroll.left=n,this.Mouse.x==this.Mouse.oldX&&this.Mouse.y==this.Mouse.oldY){if(this.Mouse.isMoving=!1,!this.Mouse.triggeredMouseStop)for(this.Mouse.triggeredMouseStop=!0,e=0;e<this.mouseStopCallbacks.length;e++)this.mouseStopCallbacks[e].call()}else for(this.Mouse.isMoving=!0,this.Mouse.triggeredMouseStop=!1,e=0;e<this.mouseMoveCallbacks.length;e++)this.mouseMoveCallbacks[e].call();this.Mouse.oldX=this.Mouse.x,this.Mouse.oldY=this.Mouse.y},t.Utils.Position.addMouseStopCallback=function(e){return this.mouseStopCallbacks.push(e),this.mouseStopCallbacks.length-1},t.Utils.Position.addMouseMoveCallback=function(e){return this.mouseMoveCallbacks.push(e),this.mouseMoveCallbacks.length-1},e(function(){window.setInterval(function(){t.Utils.Position.update()},500)}),e("html").mousemove(function(e){t.Utils.Position.Mouse.x=e.pageX,t.Utils.Position.Mouse.y=e.pageY})}),define("aloha/repositoryobjects",["aloha/core","util/class"],function(e,t){var n=window.GENTICS;e.RepositoryObject=function(){},e.RepositoryDocument=t.extend({_constructor:function(e){var t=e;this.type="document",t.id&&t.name&&t.repositoryId&&(n.Utils.applyProperties(this,e),this.baseType="document")}}),e.RepositoryFolder=t.extend({_constructor:function(e){var t=e;this.type="folder",t.id&&t.name&&t.repositoryId&&(n.Utils.applyProperties(this,e),this.baseType="folder")}})}),define("aloha/repositorymanager",["jquery","util/class","aloha/core","aloha/console","aloha/repositoryobjects"],function(e,t,n,i){function a(e,t){var n={items:e,results:e.length};return t&&(n.numItems=t.numItems,n.hasMoreItems=t.hasMoreItems,n.timeout=t.timeout),n}function r(e,t){e(t)}var o=function(e){return e?function(e,t){return e.filter(t)}:function(e,t){var n,i=[],a=e.length;for(n=0;a>n;n++)t(e[n])&&i.push(e[n]);return i}}(Array.prototype.hasOwnProperty("filter")),s={query:function(e){return"function"==typeof e.query},getChildren:function(e){return"function"==typeof e.getChildren},getSelectedFolder:function(e){return"function"==typeof e.getSelectedFolder}},l=t.extend({repositories:[],settings:n.settings&&n.settings.repositories||{},initialized:!1,init:function(){var e=this;"undefined"==typeof e.settings.timeout&&(e.settings.timeout=5e3);var t;for(t=0;t<e.repositories.length;t++)e.initRepository(e.repositories[t]);e.initialized=!0},register:function(e){var t=this;t.getRepository(e.repositoryId)?i.warn(t,'A repository with name "'+e.repositoryId+'" already registerd. Ignoring this.'):(t.repositories.push(e),t.initialized&&t.initRepository(e))},initRepository:function(t){var n=this;t.settings||(t.settings={}),n.settings[t.repositoryId]&&e.extend(t.settings,n.settings[t.repositoryId]),t.init()},getRepository:function(e){var t,n=this;for(t=0;t<n.repositories.length;t++)if(n.repositories[t].repositoryId===e)return n.repositories[t];return null},query:function(t,n){var l,d,c=this,u=[],h={numItems:0,hasMoreItems:!1},p=t.timeout&&parseInt(t.timeout,10)||c.settings.timeout,f=window.setTimeout(function(){h=h||{},h.timeout=!0,d>0&&(i.warn(c,d+" repositories did not return before the configured timeout of "+p+"ms."),d=0),clearTimeout(f),r(n,a(u,h))},p),g=function(t,o){var s=this;if(0!==d){if(t&&t.length){if(!t[0].repositoryId){var l,p=s.repositoryId;for(l=0;l<t.length;l++)t[l].repositoryId=p}e.merge(u,t)}o&&h?(h.numItems=e.isNumeric(o.numItems)&&e.isNumeric(h.numItems)?h.numItems+o.numItems:void 0,h.hasMoreItems="boolean"==typeof o.hasMoreItems&&"boolean"==typeof h.hasMoreItems?h.hasMoreItems||o.hasMoreItems:void 0,o.timeout&&(h.timeout=!0)):h=void 0,i.debug(c,"The repository "+s.repositoryId+"returned with "+t.length+" results."),0===--d&&(clearTimeout(f),r(n,a(u,h)))}},m=t.repositoryId?[c.getRepository(t.repositoryId)]:c.repositories,b=o(m,s.query);if(0===b.length)return clearTimeout(f),void r(n,a(u,h));var v=function(e){return function(){g.apply(e,arguments)}};for(d=b.length,l=0;l<b.length;l++)b[l].query(t,v(b[l]))},getChildren:function(t,a){var l,d=this,c=[],u=0,h=t.timeout&&parseInt(t.timeout,10)||d.settings.timeout,p=window.setTimeout(function(){u>0&&(i.warn(d,u+" repositories did not respond before the configured timeout of "+h+"ms."),u=0),clearTimeout(p),r(a,c)},h),f=function(t){0!==u&&(t&&e.merge(c,t),0===--u&&(clearTimeout(p),r(a,c)))},g=t.repositoryId?[d.getRepository(t.repositoryId)]:d.repositories;if(t.repositoryFilter&&t.repositoryFilter.length&&(g=o(g,function(n){return-1<e.inArray(n.repositoryId,t.repositoryFilter)})),"aloha"===t.inFolderId){{t.repositoryFilter&&0<t.repositoryFilter.length}for(l=0;l<g.length;l++)c.push(new n.RepositoryFolder({id:g[l].repositoryId,name:g[l].repositoryName,repositoryId:g[l].repositoryId,type:"repository",hasMoreItems:!0}));return clearTimeout(p),void r(a,c)}var m=o(g,s.getChildren);if(0===m.length)return clearTimeout(p),void r(a,c);for(u=m.length,l=0;l<m.length;l++)m[l].getChildren(t,f)},makeClean:function(e){var t=this,n={},a=0,r=t.repositories.length;e.find("[data-gentics-aloha-repository="+this.prefix+"]").each(function(){for(;r>a;)n.makeClean(e),a+=1;i.debug(t,"Passing contents of HTML Element with id { "+this.attr("id")+" } for cleaning to repository { "+n.repositoryId+" }"),n.makeClean(this)})},markObject:function(t,n){if(t){var a=this,r=e(t);if(n){var o=a.getRepository(n.repositoryId);o?(r.attr("data-gentics-aloha-repository")!==n.repositoryId||r.attr("data-gentics-aloha-object-id")!==n.id)&&(r.attr({"data-gentics-aloha-repository":n.repositoryId,"data-gentics-aloha-object-id":n.id}),o.markObject(t,n)):i.error(a,'Trying to apply a repository "'+n.name+'" to an object, but item has no repositoryId.')}else r.removeAttr("data-gentics-aloha-repository").removeAttr("data-gentics-aloha-object-id")}},getObject:function(t,n){var i=this,a=e(t),r=a.attr("data-gentics-aloha-object-id"),o=a.attr("data-gentics-aloha-repository"),s=i.getRepository(o);if(s&&r){i.itemCache||(i.itemCache=[]);var l=i.itemCache[o];
l||(l=i.itemCache[o]=[]),l[r]?n([l[r]]):s.getObjectById(r,function(e){l[r]=e[0],n(e)})}},folderOpened:function(e){var t=this.getRepository(e.repositoryId);"function"==typeof t.folderOpened&&t.folderOpened(e)},folderClosed:function(e){var t=this.getRepository(e.repositoryId);"function"==typeof t.folderClosed&&t.folderClosed(e)},folderSelected:function(e){var t=this.getRepository(e.repositoryId);"function"==typeof t.folderSelected&&t.folderSelected(e)},getSelectedFolder:function(){var e,t,n=o(this.repositories,s.getSelectedFolder);for(e=0;e<n.length;e++)if(t=n[e].getSelectedFolder())return t;return null},toString:function(){return"repositorymanager"}});return n.RepositoryManager=new l,n.RepositoryManager}),define("aloha/repository",["aloha/core","util/class","aloha/repositorymanager"],function(e,t,n){var i=t.extend({_constructor:function(e,t){this.repositoryId=e,this.settings={},this.repositoryName=t||e,n.register(this)},init:function(){},query:null,getChildren:null,makeClean:function(){},markObject:function(){},setTemplate:function(e){this.template=e?e:null},hasTemplate:function(){return this.template?!0:!1},getTemplate:function(){return this.template},getObjectById:function(){return!0}});return e.AbstractRepository=i,i}),function(e){function t(){var e,t,n,i,a=Aloha.settings.plugins&&Aloha.settings.plugins.load,r=Aloha.settings.baseUrl,o=/\/aloha.js(\?\S*)?$/,s=/\/[^\/]*\.js$/;if(!a||!r)for(e=document.getElementsByTagName("script"),i=0;i<e.length;i++){if(t=e[i],n=t.getAttribute("data-aloha-plugins"),null!=n){a||(a=n),r||(r=t.src.replace(s,""));break}!r&&o.test(t.src)&&(r=t.src.replace(o,""))}return"string"==typeof a&&""!==a&&(a=a.replace(/\s+/g,"").split(",")),{baseUrl:r,plugins:a||[]}}function n(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var n=e[t].getAttribute("data-aloha-defer-init");if("true"===n)return!0}return!1}function i(e,t,n){var i,a,r=["nls","css","vendor","res"];for(e[n]=t+"/"+n+"/lib",a=0;a<r.length;a++){var i=r[a];e[n+"/"+i]=t+"/"+n+"/"+i}}function a(e){var t,n,a,r,o,s={},l=[],d=[],c={},u={},h=Aloha.settings.basePath||"",p=Aloha.settings.bundles||{};for(o=0;o<e.length;o++)t=e[o].split("/"),n=t[0],a=t[1],r=p[n]?h+p[n]:h+"../plugins/"+n,i(s,r,a),c[a]=r+"/"+a,l.push(a+"/"+a+"-plugin"),u[a]={jquery:"aloha/jquery"};return{paths:s,entryPoints:l,baseUrlByName:c,names:d,map:u}}function r(){var e,t,n,i={},a=Array.prototype.slice.call(arguments);for(t=0;t<a.length;t++){n=a[t];for(e in n)n.hasOwnProperty(e)&&(i[e]=a[t][e])}return i}function o(e,t){define(e,function(){return t})}function s(){Aloha.features={},Aloha.defaults={},Aloha.settings=Aloha.settings||{},Aloha.initialize=l.start;var e=t(),n=a(e.plugins);Aloha.settings.baseUrl=e.baseUrl,Aloha.settings.loadedPlugins=n.names,Aloha.settings._pluginBaseUrlByName=n.baseUrlByName;var i={aloha:{jquery:"aloha/jquery"},"aloha/jquery":{jquery:"jquery"},jqueryui:{jquery:"aloha/jquery"},vendor:{jquery:"aloha/jquery"},util:{jquery:"aloha/jquery"},RepositoryBrowser:{jquery:"aloha/jquery"},jstree:{jquery:"aloha/jquery"},jqgrid:{jquery:"aloha/jquery"},"jqgrid-locale-en":{jquery:"aloha/jquery"},"jqgrid-locale-de":{jquery:"aloha/jquery"},"jquery-layout":{jquery:"aloha/jquery"}},s=r(i,n.map),d={context:"aloha",config:{i18n:{locale:Aloha.settings.locale||"en"}},baseUrl:Aloha.settings.baseUrl,map:s},c={jquery:"vendor/jquery-1.7.2",jqueryui:"vendor/jquery-ui-1.9.0.custom-aloha"},u={PubSub:"vendor/pubsub/js/pubsub-unminified",Class:"vendor/class",RepositoryBrowser:"vendor/repository-browser/js/repository-browser-unminified",jstree:"vendor/jquery.jstree",jqgrid:"vendor/jquery.jqgrid","jquery-layout":"vendor/jquery.layout-1.3.0-rc30.7","jqgrid-locale-en":"vendor/grid.locale.en","jqgrid-locale-de":"vendor/grid.locale.de","repository-browser-i18n-de":"vendor/repository-browser/js/repository-browser-unminified","repository-browser-i18n-en":"vendor/repository-browser/js/repository-browser-unminified"},h=r(d,Aloha.settings.requireConfig);h.paths=r(c,u,n.paths,h.paths);var p=Aloha.settings.predefinedModules||{};Aloha.settings.jQuery&&(p.jquery=Aloha.settings.jQuery);var f;for(f in p)p.hasOwnProperty(f)&&(o(f,p[f]),delete h.paths[f]);var g=require.config(h);Aloha.require=function(e){return 1===arguments.length&&"function"==typeof e?g(["aloha"],e):g.apply(this,arguments)},Aloha.bind=function(e,t){return Aloha.require(["aloha/jquery"],function(n){Aloha.bind=function(e,t){switch(l.getReadiness(e)){case"deferred":var i=l.getPhaseByEvent(e);i.deferred||(i.deferred=n.Deferred()),i.deferred.done(t);break;case"immediate":t();break;case"normal":n(Aloha,"body").bind(e,t);break;default:throw"Unknown readiness"}return this},Aloha.bind(e,t)}),this},Aloha.trigger=function(e,t){return Aloha.require(["aloha/jquery"],function(n){Aloha.trigger=function(e,t){var i=l.getPhaseByEvent(e);return i&&i.deferred&&(n(i.deferred.resolve),i.deferred=null),n(Aloha,"body").trigger(e,t),this},Aloha.trigger(e,t)}),this},Aloha.unbind=function(e){Aloha.require(["aloha/jquery"],function(t){Aloha.unbind=function(e){t(Aloha,"body").unbind(e)},Aloha.unbind(e)})},Aloha.ready=function(e){return this.bind("aloha-ready",e),this};var m=Aloha.settings.jQuery;define("aloha/jquery",["jquery"],function(e){return m||e}),Aloha.jQuery=m,define("aloha",["aloha/jquery","util/json2","aloha/rangy-core","util/class","util/lang","util/range","util/dom","aloha/core","aloha/editable","aloha/console","aloha/markup","aloha/plugin","aloha/selection","aloha/command","aloha/jquery.aloha","aloha/sidebar","util/position","aloha/repositorymanager","aloha/repository","aloha/repositoryobjects","aloha/contenthandlermanager"],function(e){return Aloha.features.jquery=!0,Aloha.jQuery=e,Aloha.settings=e.extendObjects(!0,{},Aloha.defaults,Aloha.settings),Aloha}),require(h,["aloha","aloha/jquery"],function(e,t){require(h,n.entryPoints,function(){t(function(){window.rangy.init(),e.init()})})})}var l={phases:[],completed:[],start:function(e,t){l.phases=l.phases.concat(e),l.proceed(0,e,t)},proceed:function(e,t,n){if(e<t.length){var i=t[e],a=function(){l.proceed(++e,t,n)},r=function(){l.completed.push(i),i.event&&Aloha.trigger(i.event)};i.fn?i.fn(r,a):(r(),a())}else n&&n()},getPhaseByEvent:function(e){var t;for(t=0;t<l.phases.length;t++)if(e===l.phases[t].event)return l.phases[t];return null},getReadiness:function(e){var t;for(t=0;t<l.completed.length;t++)if(e===l.completed[t].event)return"immediate";return l.getPhaseByEvent(e)?"deferred":"normal"}};e.Aloha=e.Aloha||{},e.Aloha.settings=e.Aloha.settings||{},e.__DEPS__=e.__DEPS__||{},e.__DEPS__.lang=e.Aloha.settings.locale||"en",e.Aloha.deferInit||n()?e.Aloha.deferInit=s:Aloha._load=s}(window),define("ui/context",["aloha","jquery","util/class"],function(e,t,n){var i,a="aloha-ui-context",r="#"+a;i=t(r),i.length||(i=t("<div>",{"class":"aloha",id:a}),t(function(){i.appendTo("body")}));var o=n.extend({surfaces:[],containers:[]});return t.extend(o,{selector:r,element:i}),o}),define("ui/scopes",["jquery","PubSub","util/maps"],function(e,t,n){function i(e,t){if(a.hasOwnProperty(t))for(var n=a[t],r=0;r<n.length;r++){var o=n[r];e.push(o),i(e,o)}}var a={"Aloha.empty":[],"Aloha.global":["Aloha.empty"],"Aloha.continuoustext":["Aloha.global"]},r=[],o={},s=!1;Aloha.bind("aloha-selection-changed-before",function(){s=!1}),Aloha.bind("aloha-selection-changed-after",function(e,t,n){"undefined"==typeof n||s||l.setScope("Aloha.continuoustext")});var l={enterScope:function(e,n){n=n||"_globalCounter";var i=o[e];i||(i=o[e]={});var a=i[n]||0;i[n]=a+1,a||t.pub("aloha.ui.scope.change")},leaveScope:function(e,i,a){i=i||"_globalCounter";var r=o[e];if(r){var s=r[i];s&&(s-=1,s&&!a?r[i]=s:(delete r[i],n.isEmpty(r)&&delete o[e],t.pub("aloha.ui.scope.change")))}},isActiveScope:function(t){if(o[t])return!0;var n=-1!==e.inArray(t,r);return n?!0:!1},getPrimaryScope:function(){return r[0]},setScope:function(e){s=!0,r[0]!=e&&(r=[e],i(r,e),t.pub("aloha.ui.scope.change"))},createScope:function(e,t){t?"string"==typeof t&&(t=[t]):t=["Aloha.empty"],a[e]=t}};return l}),define("ui/container",["jquery","util/class","ui/scopes"],function(e,t,n){function i(e){return e.showOnId||(e.showOnId=++o),e.showOnId}function a(e,t){var n,i=t?"show":"hide";for(n=0;n<e.length;n++)e[n][i]()}function r(t,i){switch(e.type(i)){case"function":return i;case"object":if(i.scope)return s[i.scope]?s[i.scope]:s[i.scope]=function(){return n.isActiveScope(i.scope)};throw"Invalid showOn configuration";default:return l}}var o=0,s={},l=function(){return!0},d=t.extend({element:null,_constructor:function(e,t){var n=r(this,t.showOn),a=i(n),o=e.containers[a];this.context=e,o||(o=e.containers[a]={shouldShow:n,containers:[]}),o.containers.push(this)},show:function(){},hide:function(){},focus:function(){},foreground:function(){},childVisible:function(){},childFocus:function(){},childForeground:function(){}});return e.extend(d,{showContainersForContext:function(e,t){var n,i,r;if(e.containers){r=e.containers;for(i in r)r.hasOwnProperty(i)&&(n=r[i],a(n.containers,n.shouldShow(t)))}}}),d}),define("ui/surface",["aloha/core","jquery","util/class","ui/container"],function(e,t,n){var i=n.extend({_constructor:function(e){e.surfaces.push(this)},isActive:function(){return!0}});return t.extend(i,{range:null,show:function(e){t.each(e.surfaces,function(e,t){t.show()})},hide:function(e){t.each(e.surfaces,function(e,t){t.hide()})},trackRange:function(t){t.bind("mousedown",function(t){if(t.originalEvent.stopSelectionUpdate=!0,e.eventHandled=!0,i.suppressHide=!0,e.activeEditable){var n=e.getSelection();i.range=0<n.getRangeCount()?n.getRangeAt(0):null}}),t.bind("mouseup",function(t){t.originalEvent.stopSelectionUpdate=!0,e.eventHandled=!1,i.suppressHide=!1})}}),i}),define("ui/component",["aloha/core","jquery","util/class"],function(e,t,n){var i=0,a=n.extend({id:0,isInstance:!0,container:null,type:null,visible:!0,_constructor:function(){this.id=i++,this.init()},adoptParent:function(e){this.container=e},init:function(){},isVisible:function(){return this.visible},show:function(e){return!1===e?void this.hide():void(this.visible||(this.visible=!0,this.element.show(),this.container&&this.container.childVisible(this,!0)))},hide:function(){this.visible&&(this.visible=!1,this.element.hide(),this.container&&this.container.childVisible(this,!1))},focus:function(){this.element.focus(),this.container&&this.container.childFocus(this)},foreground:function(){this.container&&this.container.childForeground(this)},enable:function(){},disable:function(){}});return a}),define("jqueryui",["jquery"],function(jQuery){!function(e,t){function n(t,n){var a,r,o,s=t.nodeName.toLowerCase();return"area"===s?(a=t.parentNode,r=a.name,t.href&&r&&"map"===a.nodeName.toLowerCase()?(o=e("img[usemap=#"+r+"]")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s?t.href||n:n)&&i(t)}function i(t){return!e(t).parents().andSelf().filter(function(){return"hidden"===e.css(this,"visibility")||e.expr.filters.hidden(this)}).length}var a=0,r=/^ui-id-\d+$/;e.ui=e.ui||{},e.ui.version||(e.extend(e.ui,{version:"1.9.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return"number"==typeof t?this.each(function(){var i=this;setTimeout(function(){e(i).focus(),n&&n.call(i)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return t=Aloha.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,a,r=e(this[0]);r.length&&r[0]!==document;){if(i=r.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(a=parseInt(r.css("zIndex"),10),!isNaN(a)&&0!==a))return a;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function a(t,n,i,a){return e.each(r,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var r="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?s["inner"+i].call(this):this.each(function(){e(this).css(o,a(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?s["outer"+i].call(this,t):this.each(function(){e(this).css(o,a(this,t,!0,n)+"px")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),a=isNaN(i);return(a||i>=0)&&n(t,!a)}}),e(function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));n.offsetHeight,e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=100===n.offsetHeight,e.support.selectstart="onselectstart"in n,t.removeChild(n).style.display="none"}),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var a,r=e.ui[t].prototype;for(a in i)r.plugins[a]=r.plugins[a]||[],r.plugins[a].push([n,i[a]])},call:function(e,t,n){var i,a=e.plugins[t];if(a&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<a.length;i++)e.options[a[i][0]]&&a[i][1].apply(e.element,n)}},contains:e.contains,hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",a=!1;return t[i]>0?!0:(t[i]=1,a=t[i]>0,t[i]=0,a)},isOverAxis:function(e,t,n){return e>t&&t+n>e},isOver:function(t,n,i,a,r,o){return e.ui.isOverAxis(t,i,r)&&e.ui.isOverAxis(n,a,o)}}))}(jQuery),function(e,t){var n=0,i=Array.prototype.slice,a=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(r){}a(t)},e.widget=function(t,n,i){var a,r,o,s,l=t.split(".")[0];t=t.split(".")[1],a=l+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][a.toLowerCase()]=function(t){return!!e.data(t,a)},e[l]=e[l]||{},r=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},e.extend(o,r,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),s=new n,s.options=e.widget.extend({},s.options),e.each(i,function(t,a){e.isFunction(a)&&(i[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,r=this._superApply;return this._super=e,this._superApply=i,t=a.apply(this,arguments),this._super=n,this._superApply=r,t}}())}),o.prototype=e.widget.extend(s,{widgetEventPrefix:t},i,{constructor:o,namespace:l,widgetName:t,widgetBaseClass:a,widgetFullName:a}),r?(e.each(r._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,o,n._proto)}),delete r._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){for(var a,r,o=i.call(arguments,1),s=0,l=o.length;l>s;s++)for(a in o[s])r=o[s][a],o[s].hasOwnProperty(a)&&r!==t&&(n[a]=e.isPlainObject(r)?e.widget.extend({},n[a],r):r);return n},e.widget.bridge=function(n,a){var r=a.prototype.widgetFullName;e.fn[n]=function(o){var s="string"==typeof o,l=i.call(arguments,1),d=this;return o=!s&&l.length?e.widget.extend.apply(null,[o].concat(l)):o,this.each(s?function(){var i,a=e.data(this,r);return a?e.isFunction(a[o])&&"_"!==o.charAt(0)?(i=a[o].apply(a,l),i!==a&&i!==t?(d=i&&i.jquery?d.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+o+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+o+"'")}:function(){var t=e.data(this,r);t?t.option(o||{})._init():new a(o,this)}),d}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetName,this),e.data(i,this.widgetFullName,this),this._on({remove:"destroy"}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var a,r,o,s=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(s={},a=n.split("."),n=a.shift(),a.length){for(r=s[n]=e.widget.extend({},this.options[n]),o=0;o<a.length-1;o++)r[a[o]]=r[a[o]]||{},r=r[a[o]];if(n=a.pop(),i===t)return r[n]===t?null:r[n];r[n]=i}else{if(i===t)return this.options[n]===t?null:this.options[n];s[n]=i}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n){n?(t=e(t),this.bindings=this.bindings.add(t)):(n=t,t=this.element);var i=this;e.each(n,function(n,a){function r(){return i.options.disabled===!0||e(this).hasClass("ui-state-disabled")?void 0:("string"==typeof a?i[a]:a).apply(i,arguments)}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||e.guid++);var o=n.match(/^(\w+)\s*(.*)$/),s=o[1]+i.eventNamespace,l=o[2];l?i.widget().delegate(l,s,r):t.bind(s,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var a,r,o=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],r=n.originalEvent)for(a in r)a in n||(n[a]=r[a]);return this.element.trigger(n,i),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,a,r){"string"==typeof a&&(a={effect:a});var o,s=a?a===!0||"number"==typeof a?n:a.effect||n:t;a=a||{},"number"==typeof a&&(a={duration:a}),o=!e.isEmptyObject(a),a.complete=r,a.delay&&i.delay(a.delay),o&&e.effects&&(e.effects.effect[s]||e.uiBackCompat!==!1&&e.effects[s])?i[t](a):s!==t&&i[s]?i[s](a.duration,a.easing,r):i.queue(function(n){e(this)[t](),r&&r.call(i[0]),n()})}}),e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.9.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,a=1===n.which,r="string"==typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;return a&&!r&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(e){return!Aloha.browser.msie||document.documentMode>=9||e.button?this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted):this._mouseUp(e)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){function n(e,t,n){return[parseInt(e[0],10)*(h.test(e[0])?t/100:1),parseInt(e[1],10)*(h.test(e[1])?n/100:1)]}function i(t,n){return parseInt(e.css(t,n),10)||0}e.ui=e.ui||{};var a,r=Math.max,o=Math.abs,s=Math.round,l=/left|center|right/,d=/top|center|bottom/,c=/[\+\-]\d+%?/,u=/^\w+/,h=/%$/,p=e.fn.position;e.position={scrollbarWidth:function(){if(a!==t)return a;var n,i,r=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=r.children()[0];return e("body").append(r),n=o.offsetWidth,r.css("overflow","scroll"),i=o.offsetWidth,n===i&&(i=r[0].clientWidth),r.remove(),a=n-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),i=t.isWindow?"":t.element.css("overflow-y"),a="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,r="scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:r?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),i=e.isWindow(n[0]);return{element:n,isWindow:i,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:i?n.width():n.outerWidth(),height:i?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return p.apply(this,arguments);t=e.extend({},t);var a,h,f,g,m,b=e(t.of),v=e.position.getWithinInfo(t.within),y=e.position.getScrollInfo(v),_=b[0],w=(t.collision||"flip").split(" "),C={};return 9===_.nodeType?(h=b.width(),f=b.height(),g={top:0,left:0}):e.isWindow(_)?(h=b.width(),f=b.height(),g={top:b.scrollTop(),left:b.scrollLeft()}):_.preventDefault?(t.at="left top",h=f=0,g={top:_.pageY,left:_.pageX}):(h=b.outerWidth(),f=b.outerHeight(),g=b.offset()),m=e.extend({},g),e.each(["my","at"],function(){var e,n,i=(t[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):d.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=d.test(i[1])?i[1]:"center",e=c.exec(i[0]),n=c.exec(i[1]),C[this]=[e?e[0]:0,n?n[0]:0],t[this]=[u.exec(i[0])[0],u.exec(i[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===t.at[0]?m.left+=h:"center"===t.at[0]&&(m.left+=h/2),"bottom"===t.at[1]?m.top+=f:"center"===t.at[1]&&(m.top+=f/2),a=n(C.at,h,f),m.left+=a[0],m.top+=a[1],this.each(function(){var l,d,c=e(this),u=c.outerWidth(),p=c.outerHeight(),_=i(this,"marginLeft"),k=i(this,"marginTop"),x=u+_+i(this,"marginRight")+y.width,S=p+k+i(this,"marginBottom")+y.height,j=e.extend({},m),N=n(C.my,c.outerWidth(),c.outerHeight());"right"===t.my[0]?j.left-=u:"center"===t.my[0]&&(j.left-=u/2),"bottom"===t.my[1]?j.top-=p:"center"===t.my[1]&&(j.top-=p/2),j.left+=N[0],j.top+=N[1],e.support.offsetFractions||(j.left=s(j.left),j.top=s(j.top)),l={marginLeft:_,marginTop:k},e.each(["left","top"],function(n,i){e.ui.position[w[n]]&&e.ui.position[w[n]][i](j,{targetWidth:h,targetHeight:f,elemWidth:u,elemHeight:p,collisionPosition:l,collisionWidth:x,collisionHeight:S,offset:[a[0]+N[0],a[1]+N[1]],my:t.my,at:t.at,within:v,elem:c})}),e.fn.bgiframe&&c.bgiframe(),t.using&&(d=function(e){var n=g.left-j.left,i=n+h-u,a=g.top-j.top,s=a+f-p,l={target:{element:b,left:g.left,top:g.top,width:h,height:f},element:{element:c,left:j.left,top:j.top,width:u,height:p},horizontal:0>i?"left":n>0?"right":"center",vertical:0>s?"top":a>0?"bottom":"middle"};u>h&&o(n+i)<h&&(l.horizontal="center"),p>f&&o(a+s)<f&&(l.vertical="middle"),l.important=r(o(n),o(i))>r(o(a),o(s))?"horizontal":"vertical",t.using.call(this,e,l)}),c.offset(e.extend(j,{using:d}))})},e.ui.position={fit:{left:function(e,t){var n,i=t.within,a=i.isWindow?i.scrollLeft:i.offset.left,o=i.width,s=e.left-t.collisionPosition.marginLeft,l=a-s,d=s+t.collisionWidth-o-a;t.collisionWidth>o?l>0&&0>=d?(n=e.left+l+t.collisionWidth-o-a,e.left+=l-n):e.left=d>0&&0>=l?a:l>d?a+o-t.collisionWidth:a:l>0?e.left+=l:d>0?e.left-=d:e.left=r(e.left-s,e.left)},top:function(e,t){var n,i=t.within,a=i.isWindow?i.scrollTop:i.offset.top,o=t.within.height,s=e.top-t.collisionPosition.marginTop,l=a-s,d=s+t.collisionHeight-o-a;t.collisionHeight>o?l>0&&0>=d?(n=e.top+l+t.collisionHeight-o-a,e.top+=l-n):e.top=d>0&&0>=l?a:l>d?a+o-t.collisionHeight:a:l>0?e.top+=l:d>0?e.top-=d:e.top=r(e.top-s,e.top)}},flip:{left:function(e,t){var n,i,a=t.within,r=a.offset.left+a.scrollLeft,s=a.width,l=a.isWindow?a.scrollLeft:a.offset.left,d=e.left-t.collisionPosition.marginLeft,c=d-l,u=d+t.collisionWidth-s-l,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>c?(n=e.left+h+p+f+t.collisionWidth-s-r,(0>n||n<o(c))&&(e.left+=h+p+f)):u>0&&(i=e.left-t.collisionPosition.marginLeft+h+p+f-l,(i>0||o(i)<u)&&(e.left+=h+p+f))},top:function(e,t){var n,i,a=t.within,r=a.offset.top+a.scrollTop,s=a.height,l=a.isWindow?a.scrollTop:a.offset.top,d=e.top-t.collisionPosition.marginTop,c=d-l,u=d+t.collisionHeight-s-l,h="top"===t.my[1],p=h?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,g=-2*t.offset[1];0>c?(i=e.top+p+f+g+t.collisionHeight-s-r,e.top+p+f+g>c&&(0>i||i<o(c))&&(e.top+=p+f+g)):u>0&&(n=e.top-t.collisionPosition.marginTop+p+f+g-l,e.top+p+f+g>u&&(n>0||o(n)<u)&&(e.top+=p+f+g))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,i,a,r,o=document.getElementsByTagName("body")[0],s=document.createElement("div");t=document.createElement(o?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(r in i)t.style[r]=i[r];t.appendChild(s),n=o||document.documentElement,n.insertBefore(t,n.firstChild),s.style.cssText="position: absolute; left: 10.7432222px;",a=e(s).offset().left,e.support.offsetFractions=a>10&&11>a,t.innerHTML="",n.removeChild(t)}(),e.uiBackCompat!==!1&&!function(e){var n=e.fn.position;e.fn.position=function(i){if(!i||!i.offset)return n.call(this,i);var a=i.offset.split(" "),r=i.at.split(" ");return 1===a.length&&(a[1]=a[0]),/^\d/.test(a[0])&&(a[0]="+"+a[0]),/^\d/.test(a[1])&&(a[1]="+"+a[1]),1===r.length&&(/left|center|right/.test(r[0])?r[1]="center":(r[1]=r[0],r[0]="center")),n.call(this,e.extend(i,{at:r[0]+a[0]+" "+r[1]+a[1],offset:t}))}}(jQuery)}(jQuery),function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"!=this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)
},_mouseDrag:function(t,n){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1);for(var i=this.element[0],a=!1;i&&(i=i.parentNode);)i==document&&(a=!0);if(!a&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!n||"valid"==this.options.revert&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)){var r=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){r._trigger("stop",t)!==!1&&r._clear()})}else this._trigger("stop",t)!==!1&&this._clear();return!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var n=this.options.handle&&e(this.options.handle,this.element).length?!1:!0;return e(this.options.handle,this.element).find("*").andSelf().each(function(){this==t.target&&(n=!0)}),n},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"==n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"==n.appendTo?this.element[0].parentNode:n.appendTo),i[0]==this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&Aloha.browser.msie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;if("parent"==t.containment&&(t.containment=this.helper[0].parentNode),("document"==t.containment||"window"==t.containment)&&(this.containment=["document"==t.containment?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==t.containment?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==t.containment?0:e(window).scrollLeft())+e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==t.containment?0:e(window).scrollTop())+(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(t.containment)||t.containment.constructor==Array)t.containment.constructor==Array&&(this.containment=t.containment);else{var n=e(t.containment),i=n[0];if(!i)return;var a=(n.offset(),"hidden"!=e(i).css("overflow"));this.containment=[(parseInt(e(i).css("borderLeftWidth"),10)||0)+(parseInt(e(i).css("paddingLeft"),10)||0),(parseInt(e(i).css("borderTopWidth"),10)||0)+(parseInt(e(i).css("paddingTop"),10)||0),(a?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e(i).css("borderLeftWidth"),10)||0)-(parseInt(e(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(a?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e(i).css("borderTopWidth"),10)||0)-(parseInt(e(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"==t?1:-1,a=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),r=/(html|body)/i.test(a[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():r?0:a.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():r?0:a.scrollLeft())*i}},_generatePosition:function(t){var n=this.options,i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(i[0].tagName),r=t.pageX,o=t.pageY;if(this.originalPosition){var s;if(this.containment){if(this.relative_container){var l=this.relative_container.offset();s=[this.containment[0]+l.left,this.containment[1]+l.top,this.containment[2]+l.left,this.containment[3]+l.top]}else s=this.containment;t.pageX-this.offset.click.left<s[0]&&(r=s[0]+this.offset.click.left),t.pageY-this.offset.click.top<s[1]&&(o=s[1]+this.offset.click.top),t.pageX-this.offset.click.left>s[2]&&(r=s[2]+this.offset.click.left),t.pageY-this.offset.click.top>s[3]&&(o=s[3]+this.offset.click.top)}if(n.grid){var d=n.grid[1]?this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1]:this.originalPageY;o=s&&(d-this.offset.click.top<s[1]||d-this.offset.click.top>s[3])?d-this.offset.click.top<s[1]?d+n.grid[1]:d-n.grid[1]:d;var c=n.grid[0]?this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0]:this.originalPageX;r=s&&(c-this.offset.click.left<s[0]||c-this.offset.click.left>s[2])?c-this.offset.click.left<s[0]?c+n.grid[0]:c-n.grid[0]:c}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():a?0:i.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():a?0:i.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]==this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i]),"drag"==t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var i=e(this).data("draggable"),a=i.options,r=e.extend({},n,{item:i.element});i.sortables=[],e(a.connectToSortable).each(function(){var n=e.data(this,"sortable");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,r))})},stop:function(t,n){var i=e(this).data("draggable"),a=e.extend({},n,{item:i.element});e.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"==i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,a))})},drag:function(t,n){var i=e(this).data("draggable"),a=this;e.each(i.sortables,function(){this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(a).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var i=e(n.helper),a=e(this).data("draggable").options;i.css("opacity")&&(a._opacity=i.css("opacity")),i.css("opacity",a.opacity)},stop:function(t,n){var i=e(this).data("draggable").options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("draggable");t.scrollParent[0]!=document&&"HTML"!=t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("draggable"),i=n.options,a=!1;n.scrollParent[0]!=document&&"HTML"!=n.scrollParent[0].tagName?(i.axis&&"x"==i.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?n.scrollParent[0].scrollTop=a=n.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-n.overflowOffset.top<i.scrollSensitivity&&(n.scrollParent[0].scrollTop=a=n.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"==i.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?n.scrollParent[0].scrollLeft=a=n.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-n.overflowOffset.left<i.scrollSensitivity&&(n.scrollParent[0].scrollLeft=a=n.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"==i.axis||(t.pageY-e(document).scrollTop()<i.scrollSensitivity?a=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(a=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"==i.axis||(t.pageX-e(document).scrollLeft()<i.scrollSensitivity?a=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(a=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!=String?n.snap.items||":data(draggable)":n.snap).each(function(){var n=e(this),i=n.offset();this!=t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:i.top,left:i.left})})},drag:function(t,n){for(var i=e(this).data("draggable"),a=i.options,r=a.snapTolerance,o=n.offset.left,s=o+i.helperProportions.width,l=n.offset.top,d=l+i.helperProportions.height,c=i.snapElements.length-1;c>=0;c--){var u=i.snapElements[c].left,h=u+i.snapElements[c].width,p=i.snapElements[c].top,f=p+i.snapElements[c].height;if(o>u-r&&h+r>o&&l>p-r&&f+r>l||o>u-r&&h+r>o&&d>p-r&&f+r>d||s>u-r&&h+r>s&&l>p-r&&f+r>l||s>u-r&&h+r>s&&d>p-r&&f+r>d){if("inner"!=a.snapMode){var g=Math.abs(p-d)<=r,m=Math.abs(f-l)<=r,b=Math.abs(u-s)<=r,v=Math.abs(h-o)<=r;g&&(n.position.top=i._convertPositionTo("relative",{top:p-i.helperProportions.height,left:0}).top-i.margins.top),m&&(n.position.top=i._convertPositionTo("relative",{top:f,left:0}).top-i.margins.top),b&&(n.position.left=i._convertPositionTo("relative",{top:0,left:u-i.helperProportions.width}).left-i.margins.left),v&&(n.position.left=i._convertPositionTo("relative",{top:0,left:h}).left-i.margins.left)}var y=g||m||b||v;if("outer"!=a.snapMode){var g=Math.abs(p-l)<=r,m=Math.abs(f-d)<=r,b=Math.abs(u-o)<=r,v=Math.abs(h-s)<=r;g&&(n.position.top=i._convertPositionTo("relative",{top:p,left:0}).top-i.margins.top),m&&(n.position.top=i._convertPositionTo("relative",{top:f-i.helperProportions.height,left:0}).top-i.margins.top),b&&(n.position.left=i._convertPositionTo("relative",{top:0,left:u}).left-i.margins.left),v&&(n.position.left=i._convertPositionTo("relative",{top:0,left:h-i.helperProportions.width}).left-i.margins.left)}!i.snapElements[c].snapping&&(g||m||b||v||y)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[c].item})),i.snapElements[c].snapping=g||m||b||v||y}else i.snapElements[c].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[c].item})),i.snapElements[c].snapping=!1}}}),e.ui.plugin.add("draggable","stack",{start:function(){var t=e(this).data("draggable").options,n=e.makeArray(e(t.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(n.length){var i=parseInt(n[0].style.zIndex)||0;e(n).each(function(e){this.style.zIndex=i+e}),this[0].style.zIndex=i+n.length}}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var i=e(n.helper),a=e(this).data("draggable").options;i.css("zIndex")&&(a._zIndex=i.css("zIndex")),i.css("zIndex",a.zIndex)},stop:function(t,n){var i=e(this).data("draggable").options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}})}(jQuery),function(e){e.widget("ui.droppable",{version:"1.9.0",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var t=this.options,n=t.accept;this.isover=0,this.isout=1,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var t=e.ui.ddmanager.droppables[this.options.scope],n=0;n<t.length;n++)t[n]==this&&t.splice(n,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){"accept"==t&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!=this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!=this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var i=n||e.ui.ddmanager.current;if(!i||(i.currentItem||i.element)[0]==this.element[0])return!1;var a=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"droppable");return t.options.greedy&&!t.options.disabled&&t.options.scope==i.options.scope&&t.accept.call(t.element[0],i.currentItem||i.element)&&e.ui.intersect(i,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(a=!0,!1):void 0}),a?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(i)),this.element):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(t,n,i){if(!n.offset)return!1;var a=(t.positionAbs||t.position.absolute).left,r=a+t.helperProportions.width,o=(t.positionAbs||t.position.absolute).top,s=o+t.helperProportions.height,l=n.offset.left,d=l+n.proportions.width,c=n.offset.top,u=c+n.proportions.height;switch(i){case"fit":return a>=l&&d>=r&&o>=c&&u>=s;case"intersect":return l<a+t.helperProportions.width/2&&r-t.helperProportions.width/2<d&&c<o+t.helperProportions.height/2&&s-t.helperProportions.height/2<u;case"pointer":var h=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,p=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,f=e.ui.isOver(p,h,c,l,n.proportions.height,n.proportions.width);return f;case"touch":return(o>=c&&u>=o||s>=c&&u>=s||c>o&&s>u)&&(a>=l&&d>=a||r>=l&&d>=r||l>a&&r>d);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var i=e.ui.ddmanager.droppables[t.options.scope]||[],a=n?n.type:null,r=(t.currentItem||t.element).find(":data(droppable)").andSelf();e:for(var o=0;o<i.length;o++)if(!(i[o].options.disabled||t&&!i[o].accept.call(i[o].element[0],t.currentItem||t.element))){for(var s=0;s<r.length;s++)if(r[s]==i[o].element[0]){i[o].proportions.height=0;continue e}i[o].visible="none"!=i[o].element.css("display"),i[o].visible&&("mousedown"==a&&i[o]._activate.call(i[o],n),i[o].offset=i[o].element.offset(),i[o].proportions={width:i[o].element[0].offsetWidth,height:i[o].element[0].offsetHeight})}},drop:function(t,n){var i=!1;return e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(i=this._drop.call(this,n)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,n)))}),i},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var i=e.ui.intersect(t,this,this.options.tolerance),a=i||1!=this.isover?i&&0==this.isover?"isover":null:"isout";if(a){var r;if(this.options.greedy){var o=this.options.scope,s=this.element.parents(":data(droppable)").filter(function(){return e.data(this,"droppable").options.scope===o});s.length&&(r=e.data(s[0],"droppable"),r.greedyChild="isover"==a?1:0)}r&&"isover"==a&&(r.isover=0,r.isout=1,r._out.call(r,n)),this[a]=1,this["isout"==a?"isover":"isout"]=0,this["isover"==a?"_over":"_out"].call(this,n),r&&"isout"==a&&(r.isout=0,r.isover=1,r._over.call(r,n))}}})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),function(e){e.widget("ui.resizable",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var t=this,n=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=n.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var i=this.handles.split(",");this.handles={};for(var a=0;a<i.length;a++){var r=e.trim(i[a]),o="ui-resizable-"+r,s=e('<div class="ui-resizable-handle '+o+'"></div>');s.css({zIndex:n.zIndex}),"se"==r&&s.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(s)}}this._renderAxis=function(t){t=t||this.element;for(var n in this.handles){if(this.handles[n].constructor==String&&(this.handles[n]=e(this.handles[n],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var i=e(this.handles[n],this.element),a=0;a=/sw|ne|nw|se|n|s/.test(n)?i.outerHeight():i.outerWidth();var r=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");t.css(r,a),this._proportionallyResize()}e(this.handles[n]).length}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!t.resizing){if(this.className)var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);t.axis=e&&e[1]?e[1]:"se"}}),n.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){n.disabled||(e(this).removeClass("ui-resizable-autohide"),t._handles.show())}).mouseleave(function(){n.disabled||t.resizing||(e(this).addClass("ui-resizable-autohide"),t._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){t(this.element);var n=this.element;n.after(this.originalElement.css({position:n.css("position"),width:n.outerWidth(),height:n.outerHeight(),top:n.css("top"),left:n.css("left")})).remove()}return this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(t){var n=!1;for(var i in this.handles)e(this.handles[i])[0]==t.target&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(n){var i=this.options,a=this.element.position(),r=this.element;this.resizing=!0,this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()},(r.is(".ui-draggable")||/absolute/.test(r.css("position")))&&r.css({position:"absolute",top:a.top,left:a.left}),this._renderProxy();var o=t(this.helper.css("left")),s=t(this.helper.css("top"));i.containment&&(o+=e(i.containment).scrollLeft()||0,s+=e(i.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:s},this.size=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.originalSize=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.originalPosition={left:o,top:s},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalMousePosition={left:n.pageX,top:n.pageY},this.aspectRatio="number"==typeof i.aspectRatio?i.aspectRatio:this.originalSize.width/this.originalSize.height||1;var l=e(".ui-resizable-"+this.axis).css("cursor");return e("body").css("cursor","auto"==l?this.axis+"-resize":l),r.addClass("ui-resizable-resizing"),this._propagate("start",n),!0},_mouseDrag:function(e){var t=this.helper,n=(this.options,this.originalMousePosition),i=this.axis,a=e.pageX-n.left||0,r=e.pageY-n.top||0,o=this._change[i];if(!o)return!1;var s=o.apply(this,[e,a,r]);return this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(s=this._updateRatio(s,e)),s=this._respectSize(s,e),this._propagate("resize",e),t.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(s),this._trigger("resize",e,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var n=this.options,i=this;if(this._helper){var a=this._proportionallyResizeElements,r=a.length&&/textarea/i.test(a[0].nodeName),o=r&&e.ui.hasScroll(a[0],"left")?0:i.sizeDiff.height,s=r?0:i.sizeDiff.width,l={width:i.helper.width()-s,height:i.helper.height()-o},d=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;n.animate||this.element.css(e.extend(l,{top:c,left:d})),i.helper.height(i.size.height),i.helper.width(i.size.width),this._helper&&!n.animate&&this._proportionallyResize()}return e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,i,a,r,o,s=this.options;o={minWidth:n(s.minWidth)?s.minWidth:0,maxWidth:n(s.maxWidth)?s.maxWidth:1/0,minHeight:n(s.minHeight)?s.minHeight:0,maxHeight:n(s.maxHeight)?s.maxHeight:1/0},(this._aspectRatio||e)&&(t=o.minHeight*this.aspectRatio,a=o.minWidth/this.aspectRatio,i=o.maxHeight*this.aspectRatio,r=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),a>o.minHeight&&(o.minHeight=a),i<o.maxWidth&&(o.maxWidth=i),r<o.maxHeight&&(o.maxHeight=r)),this._vBoundaries=o},_updateCache:function(e){this.options;this.offset=this.helper.offset(),n(e.left)&&(this.position.left=e.left),n(e.top)&&(this.position.top=e.top),n(e.height)&&(this.size.height=e.height),n(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=(this.options,this.position),i=this.size,a=this.axis;return n(e.height)?e.width=e.height*this.aspectRatio:n(e.width)&&(e.height=e.width/this.aspectRatio),"sw"==a&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"==a&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e,t){var i=(this.helper,this._vBoundaries),a=(this._aspectRatio||t.shiftKey,this.axis),r=n(e.width)&&i.maxWidth&&i.maxWidth<e.width,o=n(e.height)&&i.maxHeight&&i.maxHeight<e.height,s=n(e.width)&&i.minWidth&&i.minWidth>e.width,l=n(e.height)&&i.minHeight&&i.minHeight>e.height;s&&(e.width=i.minWidth),l&&(e.height=i.minHeight),r&&(e.width=i.maxWidth),o&&(e.height=i.maxHeight);var d=this.originalPosition.left+this.originalSize.width,c=this.position.top+this.size.height,u=/sw|nw|w/.test(a),h=/nw|ne|n/.test(a);s&&u&&(e.left=d-i.minWidth),r&&u&&(e.left=d-i.maxWidth),l&&h&&(e.top=c-i.minHeight),o&&h&&(e.top=c-i.maxHeight);var p=!e.width&&!e.height;return p&&!e.left&&e.top?e.top=null:p&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){this.options;if(this._proportionallyResizeElements.length)for(var t=this.helper||this.element,n=0;n<this._proportionallyResizeElements.length;n++){var i=this._proportionallyResizeElements[n];if(!this.borderDif){var a=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],r=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")];this.borderDif=e.map(a,function(e,t){var n=parseInt(e,10)||0,i=parseInt(r[t],10)||0;return n+i})}i.css({height:t.height()-this.borderDif[0]-this.borderDif[2]||0,width:t.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,n=this.options;if(this.elementOffset=t.offset(),this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var i=Aloha.browser.msie&&Aloha.browser.version<7,a=i?1:0,r=i?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+r,height:this.element.outerHeight()+r,position:"absolute",left:this.elementOffset.left-a+"px",top:this.elementOffset.top-a+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=(this.options,this.originalSize),i=this.originalPosition;return{left:i.left+t,width:n.width-t}},n:function(e,t,n){var i=(this.options,this.originalSize),a=this.originalPosition;return{top:a.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},sw:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,i]))},ne:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},nw:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,i]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),"resize"!=t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}
}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("resizable"),n=t.options,i=function(t){e(t).each(function(){var t=e(this);t.data("resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof n.alsoResize||n.alsoResize.parentNode?i(n.alsoResize):n.alsoResize.length?(n.alsoResize=n.alsoResize[0],i(n.alsoResize)):e.each(n.alsoResize,function(e){i(e)})},resize:function(t,n){var i=e(this).data("resizable"),a=i.options,r=i.originalSize,o=i.originalPosition,s={height:i.size.height-r.height||0,width:i.size.width-r.width||0,top:i.position.top-o.top||0,left:i.position.left-o.left||0},l=function(t,i){e(t).each(function(){var t=e(this),a=e(this).data("resizable-alsoresize"),r={},o=i&&i.length?i:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(a[t]||0)+(s[t]||0);n&&n>=0&&(r[t]=n||null)}),t.css(r)})};"object"!=typeof a.alsoResize||a.alsoResize.nodeType?l(a.alsoResize):e.each(a.alsoResize,function(e,t){l(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).data("resizable"),i=n.options,a=n._proportionallyResizeElements,r=a.length&&/textarea/i.test(a[0].nodeName),o=r&&e.ui.hasScroll(a[0],"left")?0:n.sizeDiff.height,s=r?0:n.sizeDiff.width,l={width:n.size.width-s,height:n.size.height-o},d=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,c=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(l,c&&d?{top:c,left:d}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};a&&a.length&&e(a[0]).css({width:i.width,height:i.height}),n._updateCache(i),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var n=e(this).data("resizable"),i=n.options,a=n.element,r=i.containment,o=r instanceof e?r.get(0):/parent/.test(r)?a.parent().get(0):r;if(o)if(n.containerElement=e(o),/document/.test(r)||r==document)n.containerOffset={left:0,top:0},n.containerPosition={left:0,top:0},n.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var s=e(o),l=[];e(["Top","Right","Left","Bottom"]).each(function(e,n){l[e]=t(s.css("padding"+n))}),n.containerOffset=s.offset(),n.containerPosition=s.position(),n.containerSize={height:s.innerHeight()-l[3],width:s.innerWidth()-l[1]};var d=n.containerOffset,c=n.containerSize.height,u=n.containerSize.width,h=e.ui.hasScroll(o,"left")?o.scrollWidth:u,p=e.ui.hasScroll(o)?o.scrollHeight:c;n.parentData={element:o,left:d.left,top:d.top,width:h,height:p}}},resize:function(t){var n=e(this).data("resizable"),i=n.options,a=(n.containerSize,n.containerOffset),r=(n.size,n.position),o=n._aspectRatio||t.shiftKey,s={top:0,left:0},l=n.containerElement;l[0]!=document&&/static/.test(l.css("position"))&&(s=a),r.left<(n._helper?a.left:0)&&(n.size.width=n.size.width+(n._helper?n.position.left-a.left:n.position.left-s.left),o&&(n.size.height=n.size.width/n.aspectRatio),n.position.left=i.helper?a.left:0),r.top<(n._helper?a.top:0)&&(n.size.height=n.size.height+(n._helper?n.position.top-a.top:n.position.top),o&&(n.size.width=n.size.height*n.aspectRatio),n.position.top=n._helper?a.top:0),n.offset.left=n.parentData.left+n.position.left,n.offset.top=n.parentData.top+n.position.top;var d=Math.abs((n._helper?n.offset.left-s.left:n.offset.left-s.left)+n.sizeDiff.width),c=Math.abs((n._helper?n.offset.top-s.top:n.offset.top-a.top)+n.sizeDiff.height),u=n.containerElement.get(0)==n.element.parent().get(0),h=/relative|absolute/.test(n.containerElement.css("position"));u&&h&&(d-=n.parentData.left),d+n.size.width>=n.parentData.width&&(n.size.width=n.parentData.width-d,o&&(n.size.height=n.size.width/n.aspectRatio)),c+n.size.height>=n.parentData.height&&(n.size.height=n.parentData.height-c,o&&(n.size.width=n.size.height*n.aspectRatio))},stop:function(){var t=e(this).data("resizable"),n=t.options,i=(t.position,t.containerOffset),a=t.containerPosition,r=t.containerElement,o=e(t.helper),s=o.offset(),l=o.outerWidth()-t.sizeDiff.width,d=o.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(r.css("position"))&&e(this).css({left:s.left-a.left-i.left,width:l,height:d}),t._helper&&!n.animate&&/static/.test(r.css("position"))&&e(this).css({left:s.left-a.left-i.left,width:l,height:d})}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("resizable"),n=t.options,i=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){{var t=e(this).data("resizable");t.options}t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){{var t=e(this).data("resizable");t.options}t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(t){{var n=e(this).data("resizable"),i=n.options,a=n.size,r=n.originalSize,o=n.originalPosition,s=n.axis;i._aspectRatio||t.shiftKey}i.grid="number"==typeof i.grid?[i.grid,i.grid]:i.grid;var l=Math.round((a.width-r.width)/(i.grid[0]||1))*(i.grid[0]||1),d=Math.round((a.height-r.height)/(i.grid[1]||1))*(i.grid[1]||1);/^(se|s|e)$/.test(s)?(n.size.width=r.width+l,n.size.height=r.height+d):/^(ne)$/.test(s)?(n.size.width=r.width+l,n.size.height=r.height+d,n.position.top=o.top-d):/^(sw)$/.test(s)?(n.size.width=r.width+l,n.size.height=r.height+d,n.position.left=o.left-l):(n.size.width=r.width+l,n.size.height=r.height+d,n.position.top=o.top-d,n.position.left=o.left-l)}});var t=function(e){return parseInt(e,10)||0},n=function(e){return!isNaN(parseInt(e,10))}}(jQuery),function(e){e.widget("ui.selectable",e.ui.mouse,{version:"1.9.0",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var t=this;this.element.addClass("ui-selectable"),this.dragged=!1;var n;this.refresh=function(){n=e(t.options.filter,t.element[0]),n.addClass("ui-selectee"),n.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=n.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var n=this;if(this.opos=[t.pageX,t.pageY],!this.options.disabled){var i=this.options;this.selectees=e(i.filter,this.element[0]),this._trigger("start",t),e(i.appendTo).append(this.helper),this.helper.css({left:t.clientX,top:t.clientY,width:0,height:0}),i.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var i=e.data(this,"selectable-item");i.startselected=!0,t.metaKey||t.ctrlKey||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",t,{unselecting:i.element}))}),e(t.target).parents().andSelf().each(function(){var i=e.data(this,"selectable-item");if(i){var a=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected");return i.$element.removeClass(a?"ui-unselecting":"ui-selected").addClass(a?"ui-selecting":"ui-unselecting"),i.unselecting=!a,i.selecting=a,i.selected=a,a?n._trigger("selecting",t,{selecting:i.element}):n._trigger("unselecting",t,{unselecting:i.element}),!1}})}},_mouseDrag:function(t){var n=this;if(this.dragged=!0,!this.options.disabled){var i=this.options,a=this.opos[0],r=this.opos[1],o=t.pageX,s=t.pageY;if(a>o){var l=o;o=a,a=l}if(r>s){var l=s;s=r,r=l}return this.helper.css({left:a,top:r,width:o-a,height:s-r}),this.selectees.each(function(){var l=e.data(this,"selectable-item");if(l&&l.element!=n.element[0]){var d=!1;"touch"==i.tolerance?d=!(l.left>o||l.right<a||l.top>s||l.bottom<r):"fit"==i.tolerance&&(d=l.left>a&&l.right<o&&l.top>r&&l.bottom<s),d?(l.selected&&(l.$element.removeClass("ui-selected"),l.selected=!1),l.unselecting&&(l.$element.removeClass("ui-unselecting"),l.unselecting=!1),l.selecting||(l.$element.addClass("ui-selecting"),l.selecting=!0,n._trigger("selecting",t,{selecting:l.element}))):(l.selecting&&((t.metaKey||t.ctrlKey)&&l.startselected?(l.$element.removeClass("ui-selecting"),l.selecting=!1,l.$element.addClass("ui-selected"),l.selected=!0):(l.$element.removeClass("ui-selecting"),l.selecting=!1,l.startselected&&(l.$element.addClass("ui-unselecting"),l.unselecting=!0),n._trigger("unselecting",t,{unselecting:l.element}))),l.selected&&(t.metaKey||t.ctrlKey||l.startselected||(l.$element.removeClass("ui-selected"),l.selected=!1,l.$element.addClass("ui-unselecting"),l.unselecting=!0,n._trigger("unselecting",t,{unselecting:l.element}))))}}),!1}},_mouseStop:function(t){var n=this;this.dragged=!1;this.options;return e(".ui-unselecting",this.element[0]).each(function(){var i=e.data(this,"selectable-item");i.$element.removeClass("ui-unselecting"),i.unselecting=!1,i.startselected=!1,n._trigger("unselected",t,{unselected:i.element})}),e(".ui-selecting",this.element[0]).each(function(){var i=e.data(this,"selectable-item");i.$element.removeClass("ui-selecting").addClass("ui-selected"),i.selecting=!1,i.selected=!0,i.startselected=!0,n._trigger("selected",t,{selected:i.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(e){e.widget("ui.sortable",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){"disabled"===t?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var i=this;if(this.reverting)return!1;if(this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(t);{var a=null;e(t.target).parents().each(function(){return e.data(this,i.widgetName+"-item")==i?(a=e(this),!1):void 0})}if(e.data(t.target,i.widgetName+"-item")==i&&(a=e(t.target)),!a)return!1;if(this.options.handle&&!n){var r=!1;if(e(this.options.handle,a).find("*").andSelf().each(function(){this==t.target&&(r=!0)}),!r)return!1}return this.currentItem=a,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,i){var a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",a.cursor)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(var r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll){var n=this.options,i=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-this.overflowOffset.top<n.scrollSensitivity&&(this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop-n.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-this.overflowOffset.left<n.scrollSensitivity&&(this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft-n.scrollSpeed)):(t.pageY-e(document).scrollTop()<n.scrollSensitivity?i=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(i=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed)),t.pageX-e(document).scrollLeft()<n.scrollSensitivity?i=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(i=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed))),i!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)}this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px");for(var a=this.items.length-1;a>=0;a--){var r=this.items[a],o=r.item[0],s=this._intersectsWithPointer(r);if(s&&r.instance===this.currentContainer&&o!=this.currentItem[0]&&this.placeholder[1==s?"next":"prev"]()[0]!=o&&!e.contains(this.placeholder[0],o)&&("semi-dynamic"==this.options.type?!e.contains(this.element[0],o):!0)){if(this.direction=1==s?"down":"up","pointer"!=this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,a=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:a.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:a.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){i._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);n&&i.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n.each(function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,i=this.positionAbs.top,a=i+this.helperProportions.height,r=e.left,o=r+e.width,s=e.top,l=s+e.height,d=this.offset.click.top,c=this.offset.click.left,u=i+d>s&&l>i+d&&t+c>r&&o>t+c;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?u:r<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&s<i+this.helperProportions.height/2&&a-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var n="x"===this.options.axis||e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i="y"===this.options.axis||e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),a=n&&i,r=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return a?this.floating?o&&"right"==o||"down"==r?2:1:r&&("down"==r?2:1):!1},_intersectsWithSides:function(t){var n=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),a=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"==r&&i||"left"==r&&!i:a&&("down"==a&&n||"up"==a&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!=e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!=e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n=[],i=[],a=this._connectWith();if(a&&t)for(var r=a.length-1;r>=0;r--)for(var o=e(a[r]),s=o.length-1;s>=0;s--){var l=e.data(o[s],this.widgetName);l&&l!=this&&!l.options.disabled&&i.push([e.isFunction(l.options.items)?l.options.items.call(l.element):e(l.options.items,l.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),l])}i.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var r=i.length-1;r>=0;r--)i[r][0].each(function(){n.push(this)});return e(n)},_removeCurrentsFromItems:function(){for(var e=this.currentItem.find(":data("+this.widgetName+"-item)"),t=0;t<this.items.length;t++)for(var n=0;n<e.length;n++)e[n]==this.items[t].item[0]&&this.items.splice(t,1)},_refreshItems:function(t){this.items=[],this.containers=[this];var n=this.items,i=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],a=this._connectWith();if(a&&this.ready)for(var r=a.length-1;r>=0;r--)for(var o=e(a[r]),s=o.length-1;s>=0;s--){var l=e.data(o[s],this.widgetName);l&&l!=this&&!l.options.disabled&&(i.push([e.isFunction(l.options.items)?l.options.items.call(l.element[0],t,{item:this.currentItem}):e(l.options.items,l.element),l]),this.containers.push(l))}for(var r=i.length-1;r>=0;r--)for(var d=i[r][1],c=i[r][0],s=0,u=c.length;u>s;s++){var h=e(c[s]);h.data(this.widgetName+"-item",d),n.push({item:h,instance:d,width:0,height:0,left:0,top:0})}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var n=this.items.length-1;n>=0;n--){var i=this.items[n];if(i.instance==this.currentContainer||!this.currentContainer||i.item[0]==this.currentItem[0]){var a=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item;t||(i.width=a.outerWidth(),i.height=a.outerHeight());var r=a.offset();i.left=r.left,i.top=r.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var n=this.containers.length-1;n>=0;n--){var r=this.containers[n].element.offset();this.containers[n].containerCache.left=r.left,this.containers[n].containerCache.top=r.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight()}return this},_createPlaceholder:function(t){t=t||this;var n=t.options;if(!n.placeholder||n.placeholder.constructor==String){var i=n.placeholder;n.placeholder={element:function(){var n=e(document.createElement(t.currentItem[0].nodeName)).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return i||(n.style.visibility="hidden"),n},update:function(e,a){(!i||n.forcePlaceholderSize)&&(a.height()||a.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),a.width()||a.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}}t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_contactContainers:function(t){for(var n=null,i=null,a=this.containers.length-1;a>=0;a--)if(!e.contains(this.currentItem[0],this.containers[a].element[0]))if(this._intersectsWith(this.containers[a].containerCache)){if(n&&e.contains(this.containers[a].element[0],n.element[0]))continue;n=this.containers[a],i=a}else this.containers[a].containerCache.over&&(this.containers[a]._trigger("out",t,this._uiHash(this)),this.containers[a].containerCache.over=0);if(n)if(1===this.containers.length)this.containers[i]._trigger("over",t,this._uiHash(this)),this.containers[i].containerCache.over=1;else if(this.currentContainer!=this.containers[i]){for(var r=1e4,o=null,s=this.positionAbs[this.containers[i].floating?"left":"top"],l=this.items.length-1;l>=0;l--)if(e.contains(this.containers[i].element[0],this.items[l].item[0])){var d=this.containers[i].floating?this.items[l].item.offset().left:this.items[l].item.offset().top;Math.abs(d-s)<r&&(r=Math.abs(d-s),o=this.items[l],this.direction=d-s>0?"down":"up")}if(!o&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[i],o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[i].element,!0),this._trigger("change",t,this._uiHash()),this.containers[i]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[i]._trigger("over",t,this._uiHash(this)),this.containers[i].containerCache.over=1}},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"==n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||e("parent"!=n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(""==i[0].style.width||n.forceHelperSize)&&i.width(this.currentItem.width()),(""==i[0].style.height||n.forceHelperSize)&&i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&Aloha.browser.msie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;if("parent"==t.containment&&(t.containment=this.helper[0].parentNode),("document"==t.containment||"window"==t.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),!/^(document|window|parent)$/.test(t.containment)){var n=e(t.containment)[0],i=e(t.containment).offset(),a="hidden"!=e(n).css("overflow");this.containment=[i.left+(parseInt(e(n).css("borderLeftWidth"),10)||0)+(parseInt(e(n).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(n).css("borderTopWidth"),10)||0)+(parseInt(e(n).css("paddingTop"),10)||0)-this.margins.top,i.left+(a?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e(n).css("borderLeftWidth"),10)||0)-(parseInt(e(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(a?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e(n).css("borderTopWidth"),10)||0)-(parseInt(e(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"==t?1:-1,a=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),r=/(html|body)/i.test(a[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():r?0:a.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():r?0:a.scrollLeft())*i}},_generatePosition:function(t){var n=this.options,i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(i[0].tagName);"relative"!=this.cssPosition||this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset());var r=t.pageX,o=t.pageY;if(this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid)){var s=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1];o=this.containment&&(s-this.offset.click.top<this.containment[1]||s-this.offset.click.top>this.containment[3])?s-this.offset.click.top<this.containment[1]?s+n.grid[1]:s-n.grid[1]:s;var l=this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0];r=this.containment&&(l-this.offset.click.left<this.containment[0]||l-this.offset.click.left>this.containment[2])?l-this.offset.click.left<this.containment[0]?l+n.grid[0]:l-n.grid[0]:l}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():a?0:i.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():a?0:i.scrollLeft())}},_rearrange:function(e,t,n,i){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var a=this.counter;this._delay(function(){a==this.counter&&this.refreshPositions(!i)})},_clear:function(t,n){this.reverting=!1;var i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]==this.currentItem[0]){for(var a in this._storedCSS)("auto"==this._storedCSS[a]||"static"==this._storedCSS[a])&&(this._storedCSS[a]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!n&&i.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev==this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent==this.currentItem.parent()[0]||n||i.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(n||(i.push(function(e){this._trigger("remove",e,this._uiHash())}),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))));for(var a=this.containers.length-1;a>=0;a--)n||i.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))
}}.call(this,this.containers[a])),this.containers[a].containerCache.over&&(i.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[a])),this.containers[a].containerCache.over=0);if(this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!n){this._trigger("beforeStop",t,this._uiHash());for(var a=0;a<i.length;a++)i[a].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(n||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null,!n){for(var a=0;a<i.length;a++)i[a].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),function(e){var t=0,n={},i={};n.height=n.paddingTop=n.paddingBottom=n.borderTopWidth=n.borderBottomWidth="hide",i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.9.0",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var n=this.accordionId="ui-accordion-"+(this.element.attr("id")||++t),i=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset"),this.headers=this.element.find(i.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this._hoverable(this.headers),this._focusable(this.headers),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide(),i.collapsible||i.active!==!1||(i.active=0),i.active<0&&(i.active+=this.headers.length),this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"),this.active.next().addClass("ui-accordion-content-active").show(),this._createIcons(),this.originalHeight=this.element[0].style.height,this.refresh(),this.element.attr("role","tablist"),this.headers.attr("role","tab").each(function(t){var i=e(this),a=i.attr("id"),r=i.next(),o=r.attr("id");a||(a=n+"-header-"+t,i.attr("id",a)),o||(o=n+"-panel-"+t,r.attr("id",o)),i.attr("aria-controls",o),r.attr("aria-labelledby",a)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._on(this.headers,{keydown:"_keydown"}),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._setupEvents(i.event)},_getCreateEventData:function(){return{header:this.active,content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&(this.element.css("height",this.originalHeight),e.css("height",""))},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),void("disabled"===e&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)))},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var n=e.ui.keyCode,i=this.headers.length,a=this.headers.index(t.target),r=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:r=this.headers[(a+1)%i];break;case n.LEFT:case n.UP:r=this.headers[(a-1+i)%i];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:r=this.headers[0];break;case n.END:r=this.headers[i-1]}r&&(e(t.target).attr("tabIndex",-1),e(r).attr("tabIndex",0),r.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t,n,i=this.options.heightStyle,a=this.element.parent();this.element.css("height",this.originalHeight),"fill"===i?(e.support.minHeight||(n=a.css("overflow"),a.css("overflow","hidden")),t=a.height(),this.element.siblings(":visible").each(function(){var n=e(this),i=n.css("position");"absolute"!==i&&"fixed"!==i&&(t-=n.outerHeight(!0))}),n&&a.css("overflow",n),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===i&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).height("").height())}).height(t)),"content"!==i&&this.element.height(this.element.height())},_activate:function(t){var n=this._findActive(t)[0];n!==this.active[0]&&(n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var n={};t&&(e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._on(this.headers,n))},_eventHandler:function(t){var n=this.options,i=this.active,a=e(t.currentTarget),r=a[0]===i[0],o=r&&n.collapsible,s=o?e():a.next(),l=i.next(),d={oldHeader:i,oldPanel:l,newHeader:o?e():a,newPanel:s};t.preventDefault(),r&&!n.collapsible||this._trigger("beforeActivate",t,d)===!1||(n.active=o?!1:this.headers.index(a),this.active=r?e():a,this._toggle(d),i.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),r||(a.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&a.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),a.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var n=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=i,this.options.animate?this._animate(n,i,t):(i.hide(),n.show(),this._toggleComplete(t)),i.attr({"aria-expanded":"false","aria-hidden":"true"}),i.prev().attr("aria-selected","false"),n.length&&i.length?i.prev().attr("tabIndex",-1):n.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),n.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(e,t,a){var r,o,s,l=this,d=0,c=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},h=c&&u.down||u,p=function(){l._toggleComplete(a)};return"number"==typeof h&&(s=h),"string"==typeof h&&(o=h),o=o||h.easing||u.easing,s=s||h.duration||u.duration,t.length?e.length?(r=e.show().outerHeight(),t.animate(n,{duration:s,easing:o,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(i,{duration:s,easing:o,complete:p,step:function(e,n){n.now=Math.round(e),"height"!==n.prop?d+=n.now:"content"!==l.options.heightStyle&&(n.now=Math.round(r-t.outerHeight()-d),d=0)}})):t.animate(n,s,o,p):e.animate(i,s,o,p)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.uiBackCompat!==!1&&(!function(e,t){e.extend(t.options,{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var n=t._create;t._create=function(){if(this.options.navigation){var t=this,i=this.element.find(this.options.header),a=i.next(),r=i.add(a).find("a").filter(this.options.navigationFilter)[0];r&&i.add(a).each(function(n){return e.contains(this,r)?(t.options.active=Math.floor(n/2),!1):void 0})}n.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options,{heightStyle:null,autoHeight:!0,clearStyle:!1,fillSpace:!1});var n=t._create,i=t._setOption;e.extend(t,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle(),n.call(this)},_setOption:function(e){("autoHeight"===e||"clearStyle"===e||"fillSpace"===e)&&(this.options.heightStyle=this._mergeHeightStyle()),i.apply(this,arguments)},_mergeHeightStyle:function(){var e=this.options;return e.fillSpace?"fill":e.clearStyle?"content":e.autoHeight?"auto":void 0}})}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var n=t._createIcons;t._createIcons=function(){this.options.icons&&(this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected),n.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){t.activate=t._activate;var n=t._findActive;t._findActive=function(e){return-1===e&&(e=!1),e&&"number"!=typeof e&&(e=this.headers.index(this.headers.filter(e)),-1===e&&(e=!1)),n.call(this,e)}}(jQuery,jQuery.ui.accordion.prototype),jQuery.ui.accordion.prototype.resize=jQuery.ui.accordion.prototype.refresh,function(e,t){e.extend(t.options,{change:null,changestart:null});var n=t._trigger;t._trigger=function(e,t,i){var a=n.apply(this,arguments);return a?("beforeActivate"===e?a=n.call(this,"changestart",t,{oldHeader:i.oldHeader,oldContent:i.oldPanel,newHeader:i.newHeader,newContent:i.newPanel}):"activate"===e&&(a=n.call(this,"change",t,{oldHeader:i.oldHeader,oldContent:i.oldPanel,newHeader:i.newHeader,newContent:i.newPanel})),a):!1}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options,{animate:null,animated:"slide"});var n=t._create;t._create=function(){var e=this.options;null===e.animate&&(e.animate=e.animated?"slide"===e.animated?300:"bounceslide"===e.animated?{duration:200,down:{easing:"easeOutBounce",duration:1e3}}:e.animated:!1),n.call(this)}}(jQuery,jQuery.ui.accordion.prototype))}(jQuery),function(e){var t=0;e.widget("ui.autocomplete",{version:"1.9.0",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,n,i;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on({keydown:function(a){if(this.element.prop("readOnly"))return t=!0,i=!0,void(n=!0);t=!1,i=!1,n=!1;var r=e.ui.keyCode;switch(a.keyCode){case r.PAGE_UP:t=!0,this._move("previousPage",a);break;case r.PAGE_DOWN:t=!0,this._move("nextPage",a);break;case r.UP:t=!0,this._keyEvent("previous",a);break;case r.DOWN:t=!0,this._keyEvent("next",a);break;case r.ENTER:case r.NUMPAD_ENTER:this.menu.active&&(t=!0,a.preventDefault(),this.menu.select(a));break;case r.TAB:this.menu.active&&this.menu.select(a);break;case r.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(a),a.preventDefault());break;default:n=!0,this._searchTimeout(a)}},keypress:function(i){if(t)return t=!1,void i.preventDefault();if(!n){var a=e.ui.keyCode;switch(i.keyCode){case a.PAGE_UP:this._move("previousPage",i);break;case a.PAGE_DOWN:this._move("nextPage",i);break;case a.UP:this._keyEvent("previous",i);break;case a.DOWN:this._keyEvent("next",i)}}},input:function(e){return i?(i=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:e(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(i){i.target===t.element[0]||i.target===n||e.contains(n,i.target)||t.close()})})},menufocus:function(t,n){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});var i=n.item.data("ui-autocomplete-item")||n.item.data("item.autocomplete");!1!==this._trigger("focus",t,{item:i})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(i.value):this.liveRegion.text(i.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item")||t.item.data("item.autocomplete"),i=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),e.fn.bgiframe&&this.menu.element.bgiframe(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this.document.find(t||"body")[0]),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var t,n,i=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,i){i(e.ui.autocomplete.filter(t,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,a){i.xhr&&i.xhr.abort(),i.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){a(e)},error:function(){a([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,n=++t;return function(i){n===t&&e.__response(i),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(n,t),this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var i=this;e.each(n,function(e,n){i._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var i=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return i.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),function(e){var t,n,i,a,r="ui-button ui-widget ui-state-default ui-corner-all",o="ui-state-hover ui-state-active ",s="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",l=function(){var t=e(this).find(":ui-button");setTimeout(function(){t.button("refresh")},1)},d=function(t){var n=t.name,i=t.form,a=e([]);return n&&(a=i?e(i).find("[name='"+n+"']"):e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form})),a};e.widget("ui.button",{version:"1.9.0",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,l),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var o=this,s=this.options,c="checkbox"===this.type||"radio"===this.type,u="ui-state-hover"+(c?"":" ui-state-active"),h="ui-state-focus";null===s.label&&(s.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this.buttonElement.addClass(r).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){s.disabled||(e(this).addClass("ui-state-hover"),this===t&&e(this).addClass("ui-state-active"))}).bind("mouseleave"+this.eventNamespace,function(){s.disabled||e(this).removeClass(u)}).bind("click"+this.eventNamespace,function(e){s.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){o.buttonElement.addClass(h)}).bind("blur"+this.eventNamespace,function(){o.buttonElement.removeClass(h)}),c&&(this.element.bind("change"+this.eventNamespace,function(){a||o.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){s.disabled||(a=!1,n=e.pageX,i=e.pageY)}).bind("mouseup"+this.eventNamespace,function(e){s.disabled||(n!==e.pageX||i!==e.pageY)&&(a=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return s.disabled||a?!1:(e(this).toggleClass("ui-state-active"),void o.buttonElement.attr("aria-pressed",o.element[0].checked))}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(s.disabled||a)return!1;e(this).addClass("ui-state-active"),o.buttonElement.attr("aria-pressed","true");var t=o.element[0];d(t).not(t).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return s.disabled?!1:(e(this).addClass("ui-state-active"),t=this,void o.document.one("mouseup",function(){t=null}))}).bind("mouseup"+this.eventNamespace,function(){return s.disabled?!1:void e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return s.disabled?!1:void((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",s.disabled),this._resetButton()},_determineButtonType:function(){var e,t,n;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),n=this.element.is(":checked"),n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",n)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(r+" "+o+" "+s).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?void(t?this.element.prop("disabled",!0):this.element.prop("disabled",!1)):void this._resetButton()},refresh:function(){var t=this.element.is(":disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?d(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var t=this.buttonElement.removeClass(s),n=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),i=this.options.icons,a=i.primary&&i.secondary,r=[];i.primary||i.secondary?(this.options.text&&r.push("ui-button-text-icon"+(a?"s":i.primary?"-primary":"-secondary")),i.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+i.primary+"'></span>"),i.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+i.secondary+"'></span>"),this.options.text||(r.push(a?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(n)))):r.push("ui-button-text-only"),t.addClass(r.join(" "))}}),e.widget("ui.buttonset",{version:"1.9.0",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function($,undefined){function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function bindHover(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){$(this).removeClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&$(this).removeClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",function(){$.datepicker._isDisabledDatepicker(instActive.inline?e.parent()[0]:instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&$(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&$(this).addClass("ui-datepicker-next-hover"))})}function extendRemove(e,t){$.extend(e,t);for(var n in t)(null==t[n]||t[n]==undefined)&&(e[n]=t[n]);return e}$.extend($.ui,{datepicker:{version:"1.9.0"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline="div"==nodeName||"span"==nodeName;target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),"input"==nodeName?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(e,t){var n=e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(e,t){var n=$(e);t.append=$([]),t.trigger=$([]),n.hasClass(this.markerClassName)||(this._attachments(n,t),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,n,i){t.settings[n]=i}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),this._autoSize(t),$.data(e,PROP_NAME,t),t.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,t){var n=this._get(t,"appendText"),i=this._get(t,"isRTL");t.append&&t.append.remove(),n&&(t.append=$('<span class="'+this._appendClass+'">'+n+"</span>"),e[i?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove();var a=this._get(t,"showOn");if(("focus"==a||"both"==a)&&e.focus(this._showDatepicker),"button"==a||"both"==a){var r=this._get(t,"buttonText"),o=this._get(t,"buttonImage");t.trigger=$(this._get(t,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:o,alt:r,title:r}):$('<button type="button"></button>').addClass(this._triggerClass).html(""==o?r:$("<img/>").attr({src:o,alt:r,title:r}))),e[i?"before":"after"](t.trigger),t.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput==e[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!=e[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(e[0])):$.datepicker._showDatepicker(e[0]),!1})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t=new Date(2009,11,20),n=this._get(e,"dateFormat");
if(n.match(/[DM]/)){var i=function(e){for(var t=0,n=0,i=0;i<e.length;i++)e[i].length>t&&(t=e[i].length,n=i);return n};t.setMonth(i(this._get(e,n.match(/MM/)?"monthNames":"monthNamesShort"))),t.setDate(i(this._get(e,n.match(/DD/)?"dayNames":"dayNamesShort"))+20-t.getDay())}e.input.attr("size",this._formatDate(e,t).length)}},_inlineDatepicker:function(e,t){var n=$(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(t.dpDiv).bind("setData.datepicker",function(e,n,i){t.settings[n]=i}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),$.data(e,PROP_NAME,t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block"))},_dialogDatepicker:function(e,t,n,i,a){var r=this._dialogInst;if(!r){this.uuid+=1;var o="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+o+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),r=this._dialogInst=this._newInst(this._dialogInput,!1),r.settings={},$.data(this._dialogInput[0],PROP_NAME,r)}if(extendRemove(r.settings,i||{}),t=t&&t.constructor==Date?this._formatDate(r,t):t,this._dialogInput.val(t),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,!this._pos){var s=document.documentElement.clientWidth,l=document.documentElement.clientHeight,d=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[s/2-100+d,l/2-150+c]}return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),r.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,r),this},_destroyDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(t.hasClass(this.markerClassName)){var i=e.nodeName.toLowerCase();$.removeData(e,PROP_NAME),"input"==i?(n.append.remove(),n.trigger.remove(),t.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==i||"span"==i)&&t.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(t.hasClass(this.markerClassName)){var i=e.nodeName.toLowerCase();if("input"==i)e.disabled=!1,n.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==i||"span"==i){var a=t.children("."+this._inlineClass);a.children().removeClass("ui-state-disabled"),a.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t})}},_disableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(t.hasClass(this.markerClassName)){var i=e.nodeName.toLowerCase();if("input"==i)e.disabled=!0,n.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==i||"span"==i){var a=t.children("."+this._inlineClass);a.children().addClass("ui-state-disabled"),a.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t}),this._disabledInputs[this._disabledInputs.length]=e}},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]==e)return!0;return!1},_getInst:function(e){try{return $.data(e,PROP_NAME)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,n){var i=this._getInst(e);if(2==arguments.length&&"string"==typeof t)return"defaults"==t?$.extend({},$.datepicker._defaults):i?"all"==t?$.extend({},i.settings):this._get(i,t):null;var a=t||{};if("string"==typeof t&&(a={},a[t]=n),i){this._curInst==i&&this._hideDatepicker();var r=this._getDateDatepicker(e,!0),o=this._getMinMaxDate(i,"min"),s=this._getMinMaxDate(i,"max");extendRemove(i.settings,a),null!==o&&a.dateFormat!==undefined&&a.minDate===undefined&&(i.settings.minDate=this._formatDate(i,o)),null!==s&&a.dateFormat!==undefined&&a.maxDate===undefined&&(i.settings.maxDate=this._formatDate(i,s)),this._attachments($(e),i),this._autoSize(i),this._setDate(i,r),this._updateAlternate(i),this._updateDatepicker(i)}},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(e){var t=$.datepicker._getInst(e.target),n=!0,i=t.dpDiv.is(".ui-datepicker-rtl");if(t._keyEvent=!0,$.datepicker._datepickerShowing)switch(e.keyCode){case 9:$.datepicker._hideDatepicker(),n=!1;break;case 13:var a=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",t.dpDiv);a[0]&&$.datepicker._selectDay(e.target,t.selectedMonth,t.selectedYear,a[0]);var r=$.datepicker._get(t,"onSelect");if(r){var o=$.datepicker._formatDate(t);r.apply(t.input?t.input[0]:null,[o,t])}else $.datepicker._hideDatepicker();return!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&$.datepicker._clearDate(e.target),n=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&$.datepicker._gotoToday(e.target),n=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,i?1:-1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,-7,"D"),n=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,i?-1:1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,7,"D"),n=e.ctrlKey||e.metaKey;break;default:n=!1}else 36==e.keyCode&&e.ctrlKey?$.datepicker._showDatepicker(this):n=!1;n&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t=$.datepicker._getInst(e.target);if($.datepicker._get(t,"constrainInput")){var n=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),i=String.fromCharCode(e.charCode==undefined?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||" ">i||!n||n.indexOf(i)>-1}},_doKeyUp:function(e){var t=$.datepicker._getInst(e.target);if(t.input.val()!=t.lastVal)try{var n=$.datepicker.parseDate($.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,$.datepicker._getFormatConfig(t));n&&($.datepicker._setDateFromField(t),$.datepicker._updateAlternate(t),$.datepicker._updateDatepicker(t))}catch(i){$.datepicker.log(i)}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!=e.nodeName.toLowerCase()&&(e=$("input",e.parentNode)[0]),!$.datepicker._isDisabledDatepicker(e)&&$.datepicker._lastInput!=e){var t=$.datepicker._getInst(e);$.datepicker._curInst&&$.datepicker._curInst!=t&&($.datepicker._curInst.dpDiv.stop(!0,!0),t&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0]));var n=$.datepicker._get(t,"beforeShow"),i=n?n.apply(e,[e,t]):{};if(i!==!1){extendRemove(t.settings,i),t.lastVal=null,$.datepicker._lastInput=e,$.datepicker._setDateFromField(t),$.datepicker._inDialog&&(e.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(e),$.datepicker._pos[1]+=e.offsetHeight);var a=!1;$(e).parents().each(function(){return a|="fixed"==$(this).css("position"),!a});var r={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};if($.datepicker._pos=null,t.dpDiv.empty(),t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(t),r=$.datepicker._checkOffset(t,r,a),t.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":a?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),!t.inline){var o=$.datepicker._get(t,"showAnim"),s=$.datepicker._get(t,"duration"),l=function(){var e=t.dpDiv.find("iframe.ui-datepicker-cover");if(e.length){var n=$.datepicker._getBorders(t.dpDiv);e.css({left:-n[0],top:-n[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()})}};t.dpDiv.zIndex($(e).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&($.effects.effect[o]||$.effects[o])?t.dpDiv.show(o,$.datepicker._get(t,"showOptions"),s,l):t.dpDiv[o||"show"](o?s:null,l),o&&s||l(),t.input.is(":visible")&&!t.input.is(":disabled")&&t.input.focus(),$.datepicker._curInst=t}}}},_updateDatepicker:function(e){this.maxRows=4;var t=$.datepicker._getBorders(e.dpDiv);instActive=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var n=e.dpDiv.find("iframe.ui-datepicker-cover");n.length&&n.css({left:-t[0],top:-t[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()}),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i=this._getNumberOfMonths(e),a=i[1],r=17;if(e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),a>1&&e.dpDiv.addClass("ui-datepicker-multi-"+a).css("width",r*a+"em"),e.dpDiv[(1!=i[0]||1!=i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e==$.datepicker._curInst&&$.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!=document.activeElement&&e.input.focus(),e.yearshtml){var o=e.yearshtml;setTimeout(function(){o===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),o=e.yearshtml=null},0)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(e,t,n){var i=e.dpDiv.outerWidth(),a=e.dpDiv.outerHeight(),r=e.input?e.input.outerWidth():0,o=e.input?e.input.outerHeight():0,s=document.documentElement.clientWidth+(n?0:$(document).scrollLeft()),l=document.documentElement.clientHeight+(n?0:$(document).scrollTop());return t.left-=this._get(e,"isRTL")?i-r:0,t.left-=n&&t.left==e.input.offset().left?$(document).scrollLeft():0,t.top-=n&&t.top==e.input.offset().top+o?$(document).scrollTop():0,t.left-=Math.min(t.left,t.left+i>s&&s>i?Math.abs(t.left+i-s):0),t.top-=Math.min(t.top,t.top+a>l&&l>a?Math.abs(a+o):0),t},_findPos:function(e){for(var t=this._getInst(e),n=this._get(t,"isRTL");e&&("hidden"==e.type||1!=e.nodeType||$.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];var i=$(e).offset();return[i.left,i.top]},_hideDatepicker:function(e){var t=this._curInst;if(t&&(!e||t==$.data(e,PROP_NAME))&&this._datepickerShowing){var n=this._get(t,"showAnim"),i=this._get(t,"duration"),a=function(){$.datepicker._tidyDialog(t)};$.effects&&($.effects.effect[n]||$.effects[n])?t.dpDiv.hide(n,$.datepicker._get(t,"showOptions"),i,a):t.dpDiv["slideDown"==n?"slideUp":"fadeIn"==n?"fadeOut":"hide"](n?i:null,a),n||a(),this._datepickerShowing=!1;var r=this._get(t,"onClose");r&&r.apply(t.input?t.input[0]:null,[t.input?t.input.val():"",t]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if($.datepicker._curInst){var t=$(e.target),n=$.datepicker._getInst(t[0]);(t[0].id!=$.datepicker._mainDivId&&0==t.parents("#"+$.datepicker._mainDivId).length&&!t.hasClass($.datepicker.markerClassName)&&!t.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||t.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=n)&&$.datepicker._hideDatepicker()}},_adjustDate:function(e,t,n){var i=$(e),a=this._getInst(i[0]);this._isDisabledDatepicker(i[0])||(this._adjustInstDate(a,t+("M"==n?this._get(a,"showCurrentAtPos"):0),n),this._updateDatepicker(a))},_gotoToday:function(e){var t=$(e),n=this._getInst(t[0]);if(this._get(n,"gotoCurrent")&&n.currentDay)n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear;else{var i=new Date;n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()}this._notifyChange(n),this._adjustDate(t)},_selectMonthYear:function(e,t,n){var i=$(e),a=this._getInst(i[0]);a["selected"+("M"==n?"Month":"Year")]=a["draw"+("M"==n?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(i)},_selectDay:function(e,t,n,i){var a=$(e);if(!$(i).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(a[0])){var r=this._getInst(a[0]);r.selectedDay=r.currentDay=$("a",i).html(),r.selectedMonth=r.currentMonth=t,r.selectedYear=r.currentYear=n,this._selectDate(e,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear))}},_clearDate:function(e){{var t=$(e);this._getInst(t[0])}this._selectDate(t,"")},_selectDate:function(e,t){var n=$(e),i=this._getInst(n[0]);t=null!=t?t:this._formatDate(i),i.input&&i.input.val(t),this._updateAlternate(i);var a=this._get(i,"onSelect");a?a.apply(i.input?i.input[0]:null,[t,i]):i.input&&i.input.trigger("change"),i.inline?this._updateDatepicker(i):(this._hideDatepicker(),this._lastInput=i.input[0],"object"!=typeof i.input[0]&&i.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t=this._get(e,"altField");if(t){var n=this._get(e,"altFormat")||this._get(e,"dateFormat"),i=this._getDate(e),a=this.formatDate(n,i,this._getFormatConfig(e));$(t).each(function(){$(this).val(a)})}},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t=new Date(e.getTime());t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1},parseDate:function(e,t,n){if(null==e||null==t)throw"Invalid arguments";if(t="object"==typeof t?t.toString():t+"",""==t)return null;var i=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff;i="string"!=typeof i?i:(new Date).getFullYear()%100+parseInt(i,10);for(var a=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,r=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,s=(n?n.monthNames:null)||this._defaults.monthNames,l=-1,d=-1,c=-1,u=-1,h=!1,p=function(t){var n=v+1<e.length&&e.charAt(v+1)==t;return n&&v++,n},f=function(e){var n=p(e),i="@"==e?14:"!"==e?20:"y"==e&&n?4:"o"==e?3:2,a=new RegExp("^\\d{1,"+i+"}"),r=t.substring(b).match(a);if(!r)throw"Missing number at position "+b;return b+=r[0].length,parseInt(r[0],10)},g=function(e,n,i){var a=$.map(p(e)?i:n,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)}),r=-1;if($.each(a,function(e,n){var i=n[1];return t.substr(b,i.length).toLowerCase()==i.toLowerCase()?(r=n[0],b+=i.length,!1):void 0}),-1!=r)return r+1;throw"Unknown name at position "+b},m=function(){if(t.charAt(b)!=e.charAt(v))throw"Unexpected literal at position "+b;b++},b=0,v=0;v<e.length;v++)if(h)"'"!=e.charAt(v)||p("'")?m():h=!1;else switch(e.charAt(v)){case"d":c=f("d");break;case"D":g("D",a,r);break;case"o":u=f("o");break;case"m":d=f("m");break;case"M":d=g("M",o,s);break;case"y":l=f("y");break;case"@":var y=new Date(f("@"));l=y.getFullYear(),d=y.getMonth()+1,c=y.getDate();break;case"!":var y=new Date((f("!")-this._ticksTo1970)/1e4);l=y.getFullYear(),d=y.getMonth()+1,c=y.getDate();break;case"'":p("'")?m():h=!0;break;default:m()}if(b<t.length){var _=t.substr(b);if(!/^\s+/.test(_))throw"Extra/unparsed characters found in date: "+_}if(-1==l?l=(new Date).getFullYear():100>l&&(l+=(new Date).getFullYear()-(new Date).getFullYear()%100+(i>=l?0:-100)),u>-1)for(d=1,c=u;;){var w=this._getDaysInMonth(l,d-1);if(w>=c)break;d++,c-=w}var y=this._daylightSavingAdjust(new Date(l,d-1,c));if(y.getFullYear()!=l||y.getMonth()+1!=d||y.getDate()!=c)throw"Invalid date";return y},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,a=(n?n.dayNames:null)||this._defaults.dayNames,r=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,o=(n?n.monthNames:null)||this._defaults.monthNames,s=function(t){var n=h+1<e.length&&e.charAt(h+1)==t;return n&&h++,n},l=function(e,t,n){var i=""+t;if(s(e))for(;i.length<n;)i="0"+i;return i},d=function(e,t,n,i){return s(e)?i[t]:n[t]},c="",u=!1;if(t)for(var h=0;h<e.length;h++)if(u)"'"!=e.charAt(h)||s("'")?c+=e.charAt(h):u=!1;else switch(e.charAt(h)){case"d":c+=l("d",t.getDate(),2);break;case"D":c+=d("D",t.getDay(),i,a);break;case"o":c+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":c+=l("m",t.getMonth()+1,2);break;case"M":c+=d("M",t.getMonth(),r,o);break;case"y":c+=s("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=1e4*t.getTime()+this._ticksTo1970;break;case"'":s("'")?c+="'":u=!0;break;default:c+=e.charAt(h)}return c},_possibleChars:function(e){for(var t="",n=!1,i=function(t){var n=a+1<e.length&&e.charAt(a+1)==t;return n&&a++,n},a=0;a<e.length;a++)if(n)"'"!=e.charAt(a)||i("'")?t+=e.charAt(a):n=!1;else switch(e.charAt(a)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":i("'")?t+="'":n=!0;break;default:t+=e.charAt(a)}return t},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!=e.lastVal){var n,i,a=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null;n=i=this._getDefaultDate(e);var o=this._getFormatConfig(e);try{n=this.parseDate(a,r,o)||i}catch(s){this.log(s),r=t?"":r}e.selectedDay=n.getDate(),e.drawMonth=e.selectedMonth=n.getMonth(),e.drawYear=e.selectedYear=n.getFullYear(),e.currentDay=r?n.getDate():0,e.currentMonth=r?n.getMonth():0,e.currentYear=r?n.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(e,t,n){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(t){try{return $.datepicker.parseDate($.datepicker._get(e,"dateFormat"),t,$.datepicker._getFormatConfig(e))}catch(n){}for(var i=(t.toLowerCase().match(/^c/)?$.datepicker._getDate(e):null)||new Date,a=i.getFullYear(),r=i.getMonth(),o=i.getDate(),s=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=s.exec(t);l;){switch(l[2]||"d"){case"d":case"D":o+=parseInt(l[1],10);break;case"w":case"W":o+=7*parseInt(l[1],10);break;case"m":case"M":r+=parseInt(l[1],10),o=Math.min(o,$.datepicker._getDaysInMonth(a,r));break;case"y":case"Y":a+=parseInt(l[1],10),o=Math.min(o,$.datepicker._getDaysInMonth(a,r))}l=s.exec(t)}return new Date(a,r,o)},r=null==t||""===t?n:"string"==typeof t?a(t):"number"==typeof t?isNaN(t)?n:i(t):new Date(t.getTime());return r=r&&"Invalid Date"==r.toString()?n:r,r&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var i=!t,a=e.selectedMonth,r=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),a==e.selectedMonth&&r==e.selectedYear||n||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(i?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""==e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(n,-t,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(n,+t,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(n)},selectDay:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(n,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t=new Date;t=this._daylightSavingAdjust(new Date(t.getFullYear(),t.getMonth(),t.getDate()));var n=this._get(e,"isRTL"),i=this._get(e,"showButtonPanel"),a=this._get(e,"hideIfNoPrevNext"),r=this._get(e,"navigationAsDateFormat"),o=this._getNumberOfMonths(e),s=this._get(e,"showCurrentAtPos"),l=this._get(e,"stepMonths"),d=1!=o[0]||1!=o[1],c=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),u=this._getMinMaxDate(e,"min"),h=this._getMinMaxDate(e,"max"),p=e.drawMonth-s,f=e.drawYear;if(0>p&&(p+=12,f--),h){var g=this._daylightSavingAdjust(new Date(h.getFullYear(),h.getMonth()-o[0]*o[1]+1,h.getDate()));for(g=u&&u>g?u:g;this._daylightSavingAdjust(new Date(f,p,1))>g;)p--,0>p&&(p=11,f--)}e.drawMonth=p,e.drawYear=f;var m=this._get(e,"prevText");m=r?this.formatDate(m,this._daylightSavingAdjust(new Date(f,p-l,1)),this._getFormatConfig(e)):m;var b=this._canAdjustMonth(e,-1,f,p)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>":a?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>",v=this._get(e,"nextText");v=r?this.formatDate(v,this._daylightSavingAdjust(new Date(f,p+l,1)),this._getFormatConfig(e)):v;var y=this._canAdjustMonth(e,1,f,p)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+v+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+v+"</span></a>":a?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+v+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+v+"</span></a>",_=this._get(e,"currentText"),w=this._get(e,"gotoCurrent")&&e.currentDay?c:t;_=r?this.formatDate(_,w,this._getFormatConfig(e)):_;var C=e.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(e,"closeText")+"</button>",k=i?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(n?C:"")+(this._isInRange(e,w)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+_+"</button>":"")+(n?"":C)+"</div>":"",x=parseInt(this._get(e,"firstDay"),10);x=isNaN(x)?0:x;for(var S=this._get(e,"showWeek"),j=this._get(e,"dayNames"),N=(this._get(e,"dayNamesShort"),this._get(e,"dayNamesMin")),T=this._get(e,"monthNames"),E=this._get(e,"monthNamesShort"),A=this._get(e,"beforeShowDay"),D=this._get(e,"showOtherMonths"),O=this._get(e,"selectOtherMonths"),I=(this._get(e,"calculateWeek")||this.iso8601Week,this._getDefaultDate(e)),M="",R=0;R<o[0];R++){var P="";this.maxRows=4;for(var F=0;F<o[1];F++){var z=this._daylightSavingAdjust(new Date(f,p,e.selectedDay)),B=" ui-corner-all",L="";if(d){if(L+='<div class="ui-datepicker-group',o[1]>1)switch(F){case 0:L+=" ui-datepicker-group-first",B=" ui-corner-"+(n?"right":"left");break;case o[1]-1:L+=" ui-datepicker-group-last",B=" ui-corner-"+(n?"left":"right");break;default:L+=" ui-datepicker-group-middle",B=""}L+='">'}L+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+B+'">'+(/all|left/.test(B)&&0==R?n?y:b:"")+(/all|right/.test(B)&&0==R?n?b:y:"")+this._generateMonthYearHeader(e,p,f,u,h,R>0||F>0,T,E)+'</div><table class="ui-datepicker-calendar"><thead><tr>';for(var q=S?'<th class="ui-datepicker-week-col">'+this._get(e,"weekHeader")+"</th>":"",H=0;7>H;H++){var $=(H+x)%7;q+="<th"+((H+x+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+j[$]+'">'+N[$]+"</span></th>"}L+=q+"</tr></thead><tbody>";var W=this._getDaysInMonth(f,p);f==e.selectedYear&&p==e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,W));var G=(this._getFirstDayOfMonth(f,p)-x+7)%7,U=Math.ceil((G+W)/7),K=d&&this.maxRows>U?this.maxRows:U;this.maxRows=K;for(var V=this._daylightSavingAdjust(new Date(f,p,1-G)),Y=0;K>Y;Y++){L+="<tr>";for(var X=S?'<td class="ui-datepicker-week-col">'+this._get(e,"calculateWeek")(V)+"</td>":"",H=0;7>H;H++){var Q=A?A.apply(e.input?e.input[0]:null,[V]):[!0,""],J=V.getMonth()!=p,Z=J&&!O||!Q[0]||u&&u>V||h&&V>h;X+='<td class="'+((H+x+6)%7>=5?" ui-datepicker-week-end":"")+(J?" ui-datepicker-other-month":"")+(V.getTime()==z.getTime()&&p==e.selectedMonth&&e._keyEvent||I.getTime()==V.getTime()&&I.getTime()==z.getTime()?" "+this._dayOverClass:"")+(Z?" "+this._unselectableClass+" ui-state-disabled":"")+(J&&!D?"":" "+Q[1]+(V.getTime()==c.getTime()?" "+this._currentClass:"")+(V.getTime()==t.getTime()?" ui-datepicker-today":""))+'"'+(J&&!D||!Q[2]?"":' title="'+Q[2]+'"')+(Z?"":' data-handler="selectDay" data-event="click" data-month="'+V.getMonth()+'" data-year="'+V.getFullYear()+'"')+">"+(J&&!D?"&#xa0;":Z?'<span class="ui-state-default">'+V.getDate()+"</span>":'<a class="ui-state-default'+(V.getTime()==t.getTime()?" ui-state-highlight":"")+(V.getTime()==c.getTime()?" ui-state-active":"")+(J?" ui-priority-secondary":"")+'" href="#">'+V.getDate()+"</a>")+"</td>",V.setDate(V.getDate()+1),V=this._daylightSavingAdjust(V)}L+=X+"</tr>"}p++,p>11&&(p=0,f++),L+="</tbody></table>"+(d?"</div>"+(o[0]>0&&F==o[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),P+=L}M+=P}return M+=k+(Aloha.browser.msie&&parseInt(Aloha.browser.version,10)<7&&!e.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),e._keyEvent=!1,M},_generateMonthYearHeader:function(e,t,n,i,a,r,o,s){var l=this._get(e,"changeMonth"),d=this._get(e,"changeYear"),c=this._get(e,"showMonthAfterYear"),u='<div class="ui-datepicker-title">',h="";if(r||!l)h+='<span class="ui-datepicker-month">'+o[t]+"</span>";else{var p=i&&i.getFullYear()==n,f=a&&a.getFullYear()==n;h+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var g=0;12>g;g++)(!p||g>=i.getMonth())&&(!f||g<=a.getMonth())&&(h+='<option value="'+g+'"'+(g==t?' selected="selected"':"")+">"+s[g]+"</option>");h+="</select>"}if(c||(u+=h+(!r&&l&&d?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",r||!d)u+='<span class="ui-datepicker-year">'+n+"</span>";else{var m=this._get(e,"yearRange").split(":"),b=(new Date).getFullYear(),v=function(e){var t=e.match(/c[+-].*/)?n+parseInt(e.substring(1),10):e.match(/[+-].*/)?b+parseInt(e,10):parseInt(e,10);return isNaN(t)?b:t},y=v(m[0]),_=Math.max(y,v(m[1]||""));for(y=i?Math.max(y,i.getFullYear()):y,_=a?Math.min(_,a.getFullYear()):_,e.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';_>=y;y++)e.yearshtml+='<option value="'+y+'"'+(y==n?' selected="selected"':"")+">"+y+"</option>";e.yearshtml+="</select>",u+=e.yearshtml,e.yearshtml=null}return u+=this._get(e,"yearSuffix"),c&&(u+=(!r&&l&&d?"":"&#xa0;")+h),u+="</div>"},_adjustInstDate:function(e,t,n){var i=e.drawYear+("Y"==n?t:0),a=e.drawMonth+("M"==n?t:0),r=Math.min(e.selectedDay,this._getDaysInMonth(i,a))+("D"==n?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(i,a,r)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"==n||"Y"==n)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max"),a=n&&n>t?n:t;return a=i&&a>i?i:a},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,n,i){var a=this._getNumberOfMonths(e),r=this._daylightSavingAdjust(new Date(n,i+(0>t?t:a[0]*a[1]),1));return 0>t&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(e,r)},_isInRange:function(e,t){var n=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max");return(!n||t.getTime()>=n.getTime())&&(!i||t.getTime()<=i.getTime())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,i){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var a=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(i,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),a,this._getFormatConfig(e))}}),$.fn.datepicker=function(e){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick).find(document.body).append($.datepicker.dpDiv),$.datepicker.initialized=!0);var t=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!=e&&"getDate"!=e&&"widget"!=e?"option"==e&&2==arguments.length&&"string"==typeof arguments[1]?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t)):this.each(function(){"string"==typeof e?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this].concat(t)):$.datepicker._attachDatepicker(this,e)}):$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.9.0",window["DP_jQuery_"+dpuuid]=$}(jQuery),function(e,t){var n="ui-dialog ui-widget ui-widget-content ui-corner-all ",i={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},a={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.9.0",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;
0>n&&e(this).css("top",t.top-n)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),"string"!=typeof this.originalTitle&&(this.originalTitle=""),this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.options.title=this.options.title||this.originalTitle;{var t=this,i=this.options,a=i.title||"&#160;",r=(this.uiDialog=e("<div>")).addClass(n+i.dialogClass).css({display:"none",outline:0,zIndex:i.zIndex}).attr("tabIndex",-1).keydown(function(n){i.closeOnEscape&&!n.isDefaultPrevented()&&n.keyCode&&n.keyCode===e.ui.keyCode.ESCAPE&&(t.close(n),n.preventDefault())}).mousedown(function(e){t.moveToTop(!1,e)}).appendTo("body"),o=(this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(r),(this.uiDialogTitlebar=e("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").prependTo(r)),s=e("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(e){e.preventDefault(),t.close(e)}).appendTo(o),l=((this.uiDialogTitlebarCloseText=e("<span>")).addClass("ui-icon ui-icon-closethick").text(i.closeText).appendTo(s),e("<span>").uniqueId().addClass("ui-dialog-title").html(a).prependTo(o)),d=(this.uiDialogButtonPane=e("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");(this.uiButtonSet=e("<div>")).addClass("ui-dialog-buttonset").appendTo(d)}r.attr({role:"dialog","aria-labelledby":l.attr("id")}),o.find("*").add(o).disableSelection(),this._hoverable(s),this._focusable(s),i.draggable&&e.fn.draggable&&this._makeDraggable(),i.resizable&&e.fn.resizable&&this._makeResizable(),this._createButtons(i.buttons),this._isOpen=!1,e.fn.bgiframe&&r.bgiframe(),this._on(r,{keydown:function(t){if(i.modal&&t.keyCode===e.ui.keyCode.TAB){var n=e(":tabbable",r),a=n.filter(":first"),o=n.filter(":last");return t.target!==o[0]||t.shiftKey?t.target===a[0]&&t.shiftKey?(o.focus(1),!1):void 0:(a.focus(1),!1)}}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var e,t=this.oldPosition;this.overlay&&this.overlay.destroy(),this.uiDialog.hide(),this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(t){var n,i,a=this;if(this._isOpen&&!1!==this._trigger("beforeClose",t))return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this.uiDialog.hide(this.options.hide,function(){a._trigger("close",t)}):(this.uiDialog.hide(),this._trigger("close",t)),e.ui.dialog.overlay.resize(),this.options.modal&&(n=0,e(".ui-dialog").each(function(){this!==a.uiDialog[0]&&(i=e(this).css("z-index"),isNaN(i)||(n=Math.max(n,i)))}),e.ui.dialog.maxZ=n),this},isOpen:function(){return this._isOpen},moveToTop:function(t,n){var i,a=this.options;return a.modal&&!t||!a.stack&&!a.modal?this._trigger("focus",n):(a.zIndex>e.ui.dialog.maxZ&&(e.ui.dialog.maxZ=a.zIndex),this.overlay&&(e.ui.dialog.maxZ+=1,e.ui.dialog.overlay.maxZ=e.ui.dialog.maxZ,this.overlay.$el.css("z-index",e.ui.dialog.overlay.maxZ)),i={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},e.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",e.ui.dialog.maxZ),this.element.attr(i),this._trigger("focus",n),this)},open:function(){if(!this._isOpen){var t,n=this.options,i=this.uiDialog;return this._size(),this._position(n.position),i.show(n.show),this.overlay=n.modal?new e.ui.dialog.overlay(this):null,this.moveToTop(!0),t=this.element.find(":tabbable"),t.length||(t=this.uiDialogButtonPane.find(":tabbable"),t.length||(t=i)),t.eq(0).focus(),this._isOpen=!0,this._trigger("open"),this}},_createButtons:function(t){var n=this,i=!1;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),"object"==typeof t&&null!==t&&e.each(t,function(){return!(i=!0)}),i?(e.each(t,function(t,i){i=e.isFunction(i)?{click:i,text:t}:i;var a=e("<button type='button'>").attr(i,!0).unbind("click").click(function(){i.click.apply(n.element[0],arguments)}).appendTo(n.uiButtonSet);e.fn.button&&a.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var n=this,i=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(i,a){e(this).addClass("ui-dialog-dragging"),n._trigger("dragStart",i,t(a))},drag:function(e,i){n._trigger("drag",e,t(i))},stop:function(a,r){i.position=[r.position.left-n.document.scrollLeft(),r.position.top-n.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),n._trigger("dragStop",a,t(r)),e.ui.dialog.overlay.resize()}})},_makeResizable:function(n){function i(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}n=n===t?this.options.resizable:n;var a=this,r=this.options,o=this.uiDialog.css("position"),s="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:r.maxWidth,maxHeight:r.maxHeight,minWidth:r.minWidth,minHeight:this._minHeight(),handles:s,start:function(t,n){e(this).addClass("ui-dialog-resizing"),a._trigger("resizeStart",t,i(n))},resize:function(e,t){a._trigger("resize",e,i(t))},stop:function(t,n){e(this).removeClass("ui-dialog-resizing"),r.height=e(this).height(),r.width=e(this).width(),a._trigger("resizeStop",t,i(n)),e.ui.dialog.overlay.resize()}}).css("position",o).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(t){var n,i=[],a=[0,0];t?(("string"==typeof t||"object"==typeof t&&"0"in t)&&(i=t.split?t.split(" "):[t[0],t[1]],1===i.length&&(i[1]=i[0]),e.each(["left","top"],function(e,t){+i[e]===i[e]&&(a[e]=i[e],i[e]=t)}),t={my:i.join(" "),at:i.join(" "),offset:a.join(" ")}),t=e.extend({},e.ui.dialog.prototype.options.position,t)):t=e.ui.dialog.prototype.options.position,n=this.uiDialog.is(":visible"),n||this.uiDialog.show(),this.uiDialog.position(t),n||this.uiDialog.hide()},_setOptions:function(t){var n=this,r={},o=!1;e.each(t,function(e,t){n._setOption(e,t),e in i&&(o=!0),e in a&&(r[e]=t)}),o&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",r)},_setOption:function(t,i){var a,r,o=this.uiDialog;switch(t){case"buttons":this._createButtons(i);break;case"closeText":this.uiDialogTitlebarCloseText.text(""+i);break;case"dialogClass":o.removeClass(this.options.dialogClass).addClass(n+i);break;case"disabled":i?o.addClass("ui-dialog-disabled"):o.removeClass("ui-dialog-disabled");break;case"draggable":a=o.is(":data(draggable)"),a&&!i&&o.draggable("destroy"),!a&&i&&this._makeDraggable();break;case"position":this._position(i);break;case"resizable":r=o.is(":data(resizable)"),r&&!i&&o.resizable("destroy"),r&&"string"==typeof i&&o.resizable("option","handles",i),r||i===!1||this._makeResizable(i);break;case"title":e(".ui-dialog-title",this.uiDialogTitlebar).html(""+(i||"&#160;"))}this._super(t,i)},_size:function(){var t,n,i,a=this.options,r=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),a.minWidth>a.width&&(a.width=a.minWidth),t=this.uiDialog.css({height:"auto",width:a.width}).outerHeight(),n=Math.max(0,a.minHeight-t),"auto"===a.height?e.support.minHeight?this.element.css({minHeight:n,height:"auto"}):(this.uiDialog.show(),i=this.element.css("height","auto").height(),r||this.uiDialog.hide(),this.element.height(Math.max(i,n))):this.element.height(Math.max(a.height-t,0)),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),e.extend(e.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(e){var t=e.attr("id");return t||(this.uuid+=1,t=this.uuid),"ui-dialog-title-"+t},overlay:function(t){this.$el=e.ui.dialog.overlay.create(t)}}),e.extend(e.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".dialog-overlay"}).join(" "),create:function(t){0===this.instances.length&&(setTimeout(function(){e.ui.dialog.overlay.instances.length&&e(document).bind(e.ui.dialog.overlay.events,function(t){return e(t.target).zIndex()<e.ui.dialog.overlay.maxZ?!1:void 0})},1),e(window).bind("resize.dialog-overlay",e.ui.dialog.overlay.resize));var n=this.oldInstances.pop()||e("<div>").addClass("ui-widget-overlay");return e(document).bind("keydown.dialog-overlay",function(i){var a=e.ui.dialog.overlay.instances;0!==a.length&&a[a.length-1]===n&&t.options.closeOnEscape&&!i.isDefaultPrevented()&&i.keyCode&&i.keyCode===e.ui.keyCode.ESCAPE&&(t.close(i),i.preventDefault())}),n.appendTo(document.body).css({width:this.width(),height:this.height()}),e.fn.bgiframe&&n.bgiframe(),this.instances.push(n),n},destroy:function(t){var n=e.inArray(t,this.instances),i=0;-1!==n&&this.oldInstances.push(this.instances.splice(n,1)[0]),0===this.instances.length&&e([document,window]).unbind(".dialog-overlay"),t.height(0).width(0).remove(),e.each(this.instances,function(){i=Math.max(i,this.css("z-index"))}),this.maxZ=i},height:function(){var t,n;return Aloha.browser.msie?(t=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),n=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),n>t?e(window).height()+"px":t+"px"):e(document).height()+"px"},width:function(){var t,n;return Aloha.browser.msie?(t=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),n=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),n>t?e(window).width()+"px":t+"px"):e(document).width()+"px"},resize:function(){var t=e([]);e.each(e.ui.dialog.overlay.instances,function(){t=t.add(this)}),t.css({width:0,height:0}).css({width:e.ui.dialog.overlay.width(),height:e.ui.dialog.overlay.height()})}}),e.extend(e.ui.dialog.overlay.prototype,{destroy:function(){e.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(e){var t=!1;e.widget("ui.menu",{version:"1.9.0",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(n){var i=e(n.target).closest(".ui-menu-item");!t&&i.not(".ui-state-disabled").length&&(t=!0,this.select(n),i.has(".ui-menu").length?this.expand(n):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(n){e(n.target).closest(".ui-menu").length||this.collapseAll(n),t=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var i,a,r,o,s,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1,a=this.previousFilter||"",r=String.fromCharCode(t.keyCode),o=!1,clearTimeout(this.filterTimer),r===a?o=!0:r=a+r,s=new RegExp("^"+n(r),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return s.test(e(this).children("a").text())}),i=o&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(r=String.fromCharCode(t.keyCode),s=new RegExp("^"+n(r),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return s.test(e(this).children("a").text())})),i.length?(this.focus(t,i),i.length>1?(this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,i=this.element.find(this.options.menus+":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"});t=i.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-—–\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),i.each(function(){var t=e(this),i=t.prev("a"),a=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(a),t.attr("aria-labelledby",i.attr("id"))}),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(e,t){var n,i;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),i=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,i,a,r,o,s;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,a=t.offset().top-this.activeMenu.offset().top-n-i,r=this.activeMenu.scrollTop(),o=this.activeMenu.height(),s=t.height(),0>a?this.activeMenu.scrollTop(r+a):a+s>o&&this.activeMenu.scrollTop(r+a-o+s))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var i=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(t),this.activeMenu=i},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var i;this.active&&(i="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),i&&i.length&&this.active||(i=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(n,i)},nextPage:function(t){var n,i,a;return this.active?void(this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,a=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-i-a<0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var n,i,a;return this.active?void(this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,a=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-i+a>0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery),function(e,t){e.widget("ui.progressbar",{version:"1.9.0",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return e===t?this._value():(this._setOption("value",e),this)},_setOption:function(e,t){"value"===e&&(this.options.value=t,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),this._super(e,t)},_value:function(){var e=this.options.value;return"number"!=typeof e&&(e=0),Math.min(this.options.max,Math.max(this.min,e))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var e=this.value(),t=this._percentage();this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),this.valueDiv.toggle(e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(t.toFixed(0)+"%"),this.element.attr("aria-valuenow",e)}})}(jQuery),function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var n,i=this.options,a=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),r="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=i.values&&i.values.length||1,s=[];for(this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(i.disabled?" ui-slider-disabled ui-disabled":"")),this.range=e([]),i.range&&(i.range===!0&&(i.values||(i.values=[this._valueMin(),this._valueMin()]),i.values.length&&2!==i.values.length&&(i.values=[i.values[0],i.values[0]])),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===i.range||"max"===i.range?" ui-slider-range-"+i.range:""))),n=a.length;o>n;n++)s.push(r);this.handles=a.add(e(s.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).mouseenter(function(){i.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){i.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)}),this._on(this.handles,{keydown:function(n){var i,a,r,o,s=e(n.target).data("ui-slider-handle-index");switch(n.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(n.target).addClass("ui-state-active"),i=this._start(n,s),i===!1))return}switch(o=this.options.step,a=r=this.options.values&&this.options.values.length?this.values(s):this.value(),n.keyCode){case e.ui.keyCode.HOME:r=this._valueMin();break;case e.ui.keyCode.END:r=this._valueMax();break;case e.ui.keyCode.PAGE_UP:r=this._trimAlignValue(a+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:r=this._trimAlignValue(a-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(a===this._valueMax())return;r=this._trimAlignValue(a+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(a===this._valueMin())return;r=this._trimAlignValue(a-o)}this._slide(n,s,r)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,i,a,r,o,s,l,d,c=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(n),a=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(i-c.values(t));a>n&&(a=n,r=e(this),o=t)}),u.range===!0&&this.values(1)===u.min&&(o+=1,r=e(this.handles[o])),s=this._start(t,o),s===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,r.addClass("ui-state-active").focus(),l=r.offset(),d=!e(t.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=d?{left:0,top:0}:{left:t.pageX-l.left-r.width()/2,top:t.pageY-l.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,i,a,r;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),i=n/t,i>1&&(i=1),0>i&&(i=0),"vertical"===this.orientation&&(i=1-i),a=this._valueMax()-this._valueMin(),r=this._valueMin()+i*a,this._trimAlignValue(r)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var i,a,r;this.options.values&&this.options.values.length?(i=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&n>i||1===t&&i>n)&&(n=i),n!==this.values(t)&&(a=this.values(),a[t]=n,r=this._trigger("slide",e,{handle:this.handles[t],value:n,values:a}),i=this.values(t?0:1),r!==!1&&this.values(t,n,!0))):n!==this.value()&&(r=this._trigger("slide",e,{handle:this.handles[t],value:n}),r!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,n){var i,a,r;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(i=this.options.values,a=arguments[0],r=0;r<i.length;r+=1)i[r]=this._trimAlignValue(a[r]),this._change(null,r);this._refreshValue()},_setOption:function(t,n){var i,a=0;switch(e.isArray(this.options.values)&&(a=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"disabled":n?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;a>i;i+=1)this._change(null,i);this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,i;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);for(n=this.options.values.slice(),i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(n[i]);return n},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,i=e-n;return 2*Math.abs(n)>=t&&(i+=n>0?t:-t),parseFloat(i.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,i,a,r,o=this.options.range,s=this.options,l=this,d=this._animateOff?!1:s.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(i){n=(l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())*100,c["horizontal"===l.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[d?"animate":"css"](c,s.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[d?"animate":"css"]({left:n+"%"},s.animate),1===i&&l.range[d?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:s.animate})):(0===i&&l.range.stop(1,1)[d?"animate":"css"]({bottom:n+"%"},s.animate),1===i&&l.range[d?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:s.animate}))),t=n}):(i=this.value(),a=this._valueMin(),r=this._valueMax(),n=r!==a?(i-a)/(r-a)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[d?"animate":"css"](c,s.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[d?"animate":"css"]({width:n+"%"},s.animate),"max"===o&&"horizontal"===this.orientation&&this.range[d?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:s.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[d?"animate":"css"]({height:n+"%"},s.animate),"max"===o&&"vertical"===this.orientation&&this.range[d?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:s.animate}))}})}(jQuery),function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"1.9.0",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},n=this.element;return e.each(["min","max","step"],function(e,i){var a=n.attr(i);void 0!==a&&a.length&&(t[i]=a)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.uiSpinner.addClass("ui-state-active"),this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._refresh(),this.uiSpinner.removeClass("ui-state-active"),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)
},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function n(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i}))}var i;i=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),n.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,n.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:void this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this._hoverable(e),this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var n=this.options,i=e.ui.keyCode;switch(t.keyCode){case i.UP:return this._repeat(null,1,t),!0;case i.DOWN:return this._repeat(null,-1,t),!0;case i.PAGE_UP:return this._repeat(null,n.page,t),!0;case i.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-state-default ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,n){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,n)},e),this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:n})===!1||(this._value(n),this.counter++)},_increment:function(t){var n=this.options.incremental;return n?e.isFunction(n)?n(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return-1===n?0:t.length-n-1},_adjustValue:function(e){var t,n,i=this.options;return t=null!==i.min?i.min:0,n=e-t,n=Math.round(n/i.step)*i.step,e=t+n,e=parseFloat(e.toFixed(this._precision())),null!==i.max&&e>i.max?i.max:null!==i.min&&e<i.min?i.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var n=this._parse(this.element.val());return this.options[e]=t,void this.element.val(this._format(n))}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),this._super(e,t),"disabled"===e&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var n;""!==e&&(n=this._parse(e),null!==n&&(t||(n=this._adjustValue(n)),e=this._format(n))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._spin((e||1)*this.options.step)},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._spin((e||1)*-this.options.step)},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?void t(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(e,t){function n(){return++a}function i(e){return e=e.cloneNode(!1),e.hash.length>1&&e.href.replace(r,"")===location.href.replace(r,"")}var a=0,r=/#.*$/;e.widget("ui.tabs",{version:"1.9.0",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,n=this.options,i=n.active;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",n.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),null===i&&(location.hash&&this.anchors.each(function(e,t){return t.hash===location.hash?(i=e,!1):void 0}),null===i&&(i=this.tabs.filter(".ui-tabs-active").index()),(null===i||-1===i)&&(i=this.tabs.length?0:!1)),i!==!1&&(i=this.tabs.index(this.tabs.eq(i)),-1===i&&(i=n.collapsible?!1:0)),n.active=i,!n.collapsible&&n.active===!1&&this.anchors.length&&(n.active=0),e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(this.options.active):e(),this._refresh(),this.active.length&&this.load(n.active)},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),i=this.tabs.index(n),a=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:i++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:a=!1,i--;break;case e.ui.keyCode.END:i=this.anchors.length-1;break;case e.ui.keyCode.HOME:i=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i===this.options.active?!1:i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,a),t.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,n){function i(){return t>a&&(t=0),0>t&&(t=a),t}for(var a=this.tabs.length-1;-1!==e.inArray(i(),this.options.disabled);)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+n()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,a){var r,o,s,l=e(a).uniqueId().attr("id"),d=e(a).closest("li"),c=d.attr("aria-controls");i(a)?(r=a.hash,o=t.element.find(t._sanitizeSelector(r))):(s=t._tabId(d),r="#"+s,o=t.element.find(r),o.length||(o=t._createPanel(s),o.insertAfter(t.panels[n-1]||t.tablist)),o.attr("aria-live","polite")),o.length&&(t.panels=t.panels.add(o)),c&&d.data("ui-tabs-aria-controls",c),d.attr({"aria-controls":r.substring(1),"aria-labelledby":l}),o.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var n,i=0;n=this.tabs[i];i++)t===!0||-1!==e.inArray(i,t)?e(n).addClass("ui-state-disabled").attr("aria-disabled","true"):e(n).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var n={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,i,a=this.element.parent();"fill"===t?(e.support.minHeight||(i=a.css("overflow"),a.css("overflow","hidden")),n=a.height(),this.element.siblings(":visible").each(function(){var t=e(this),i=t.css("position");"absolute"!==i&&"fixed"!==i&&(n-=t.outerHeight(!0))}),i&&a.css("overflow",i),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,i=this.active,a=e(t.currentTarget),r=a.closest("li"),o=r[0]===i[0],s=o&&n.collapsible,l=s?e():this._getPanelForTab(r),d=i.length?this._getPanelForTab(i):e(),c={oldTab:i,oldPanel:d,newTab:s?e():r,newPanel:l};t.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||o&&!n.collapsible||this._trigger("beforeActivate",t,c)===!1||(n.active=s?!1:this.tabs.index(r),this.active=o?e():r,this.xhr&&this.xhr.abort(),d.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(r),t),this._toggle(t,c))},_toggle:function(t,n){function i(){r.running=!1,r._trigger("activate",t,n)}function a(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&r.options.show?r._show(o,r.options.show,i):(o.show(),i())}var r=this,o=n.newPanel,s=n.oldPanel;this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),a()),s.attr({"aria-expanded":"false","aria-hidden":"true"}),n.oldTab.attr("aria-selected","false"),o.length&&s.length?n.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr({"aria-expanded":"true","aria-hidden":"false"}),n.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var n,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),n=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n):t.removeAttr("aria-controls")}),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(n){var i=this.options.disabled;i!==!1&&(n===t?i=!1:(n=this._getIndex(n),i=e.isArray(i)?e.map(i,function(e){return e!==n?e:null}):e.map(this.tabs,function(e,t){return t!==n?t:null})),this._setupDisabled(i))},disable:function(n){var i=this.options.disabled;if(i!==!0){if(n===t)i=!0;else{if(n=this._getIndex(n),-1!==e.inArray(n,i))return;i=e.isArray(i)?e.merge([n],i).sort():[n]}this._setupDisabled(i)}},load:function(t,n){t=this._getIndex(t);var a=this,r=this.tabs.eq(t),o=r.find(".ui-tabs-anchor"),s=this._getPanelForTab(r),l={tab:r,panel:s};i(o[0])||(this.xhr=e.ajax(this._ajaxSettings(o,n,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(r.addClass("ui-tabs-loading"),s.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){s.html(e),a._trigger("load",n,l)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&a.panels.stop(!1,!0),r.removeClass("ui-tabs-loading"),s.removeAttr("aria-busy"),e===a.xhr&&delete a.xhr},1)})))},_ajaxSettings:function(t,n,i){var a=this;return{url:t.attr("href"),beforeSend:function(t,r){return a._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:r},i))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}}),e.uiBackCompat!==!1&&(e.ui.tabs.prototype._ui=function(e,t){return{tab:e,panel:t,index:this.anchors.index(e)}},e.widget("ui.tabs",e.ui.tabs,{url:function(e,t){this.anchors.eq(e).attr("href",t)}}),e.widget("ui.tabs",e.ui.tabs,{options:{ajaxOptions:null,cache:!1},_create:function(){this._super();var t=this;this._on({tabsbeforeload:function(n,i){return e.data(i.tab[0],"cache.tabs")?void n.preventDefault():void i.jqXHR.success(function(){t.options.cache&&e.data(i.tab[0],"cache.tabs",!0)})}})},_ajaxSettings:function(t,n,i){var a=this.options.ajaxOptions;return e.extend({},a,{error:function(e,t){try{a.error(e,t,i.tab.closest("li").index(),i.tab[0])}catch(n){}}},this._superApply(arguments))},_setOption:function(e,t){"cache"===e&&t===!1&&this.anchors.removeData("cache.tabs"),this._super(e,t)},_destroy:function(){this.anchors.removeData("cache.tabs"),this._super()},url:function(e){this.anchors.eq(e).removeData("cache.tabs"),this._superApply(arguments)}}),e.widget("ui.tabs",e.ui.tabs,{abort:function(){this.xhr&&this.xhr.abort()}}),e.widget("ui.tabs",e.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super(),this._on({tabsbeforeload:function(e,t){if(e.target===this.element[0]&&this.options.spinner){var n=t.tab.find("span"),i=n.html();n.html(this.options.spinner),t.jqXHR.complete(function(){n.html(i)})}}})}}),e.widget("ui.tabs",e.ui.tabs,{options:{enable:null,disable:null},enable:function(t){var n,i=this.options;(t&&i.disabled===!0||e.isArray(i.disabled)&&-1!==e.inArray(t,i.disabled))&&(n=!0),this._superApply(arguments),n&&this._trigger("enable",null,this._ui(this.anchors[t],this.panels[t]))},disable:function(t){var n,i=this.options;(t&&i.disabled===!1||e.isArray(i.disabled)&&-1===e.inArray(t,i.disabled))&&(n=!0),this._superApply(arguments),n&&this._trigger("disable",null,this._ui(this.anchors[t],this.panels[t]))}}),e.widget("ui.tabs",e.ui.tabs,{options:{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},add:function(n,i,a){a===t&&(a=this.anchors.length);var r,o,s=this.options,l=e(s.tabTemplate.replace(/#\{href\}/g,n).replace(/#\{label\}/g,i)),d=n.indexOf("#")?this._tabId(l):n.replace("#","");return l.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy",!0),l.attr("aria-controls",d),r=a>=this.tabs.length,o=this.element.find("#"+d),o.length||(o=this._createPanel(d),r?a>0?o.insertAfter(this.panels.eq(-1)):o.appendTo(this.element):o.insertBefore(this.panels[a])),o.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide(),r?l.appendTo(this.tablist):l.insertBefore(this.tabs[a]),s.disabled=e.map(s.disabled,function(e){return e>=a?++e:e}),this.refresh(),1===this.tabs.length&&s.active===!1&&this.option("active",0),this._trigger("add",null,this._ui(this.anchors[a],this.panels[a])),this},remove:function(t){t=this._getIndex(t);var n=this.options,i=this.tabs.eq(t).remove(),a=this._getPanelForTab(i).remove();return i.hasClass("ui-tabs-active")&&this.anchors.length>2&&this._activate(t+(t+1<this.anchors.length?1:-1)),n.disabled=e.map(e.grep(n.disabled,function(e){return e!==t}),function(e){return e>=t?--e:e}),this.refresh(),this._trigger("remove",null,this._ui(i.find("a")[0],a[0])),this}}),e.widget("ui.tabs",e.ui.tabs,{length:function(){return this.anchors.length}}),e.widget("ui.tabs",e.ui.tabs,{options:{idPrefix:"ui-tabs-"},_tabId:function(t){var i=t.is("li")?t.find("a[href]"):t;return i=i[0],e(i).closest("li").attr("aria-controls")||i.title&&i.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF\-]/g,"")||this.options.idPrefix+n()}}),e.widget("ui.tabs",e.ui.tabs,{options:{panelTemplate:"<div></div>"},_createPanel:function(t){return e(this.options.panelTemplate).attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)}}),e.widget("ui.tabs",e.ui.tabs,{_create:function(){var e=this.options;null===e.active&&e.selected!==t&&(e.active=-1===e.selected?!1:e.selected),this._super(),e.selected=e.active,e.selected===!1&&(e.selected=-1)},_setOption:function(e,t){if("selected"!==e)return this._super(e,t);var n=this.options;this._super("active",-1===t?!1:t),n.selected=n.active,n.selected===!1&&(n.selected=-1)},_eventHandler:function(){this._superApply(arguments),this.options.selected=this.options.active,this.options.selected===!1&&(this.options.selected=-1)}}),e.widget("ui.tabs",e.ui.tabs,{options:{show:null,select:null},_create:function(){this._super(),this.options.active!==!1&&this._trigger("show",null,this._ui(this.active.find(".ui-tabs-anchor")[0],this._getPanelForTab(this.active)[0]))},_trigger:function(e,t,n){var i=this._superApply(arguments);return i?("beforeActivate"===e&&n.newTab.length?i=this._super("select",t,{tab:n.newTab.find(".ui-tabs-anchor")[0],panel:n.newPanel[0],index:n.newTab.closest("li").index()}):"activate"===e&&n.newTab.length&&(i=this._super("show",t,{tab:n.newTab.find(".ui-tabs-anchor")[0],panel:n.newPanel[0],index:n.newTab.closest("li").index()})),i):!1}}),e.widget("ui.tabs",e.ui.tabs,{select:function(e){if(e=this._getIndex(e),-1===e){if(!this.options.collapsible||-1===this.options.selected)return;e=this.options.selected}this.anchors.eq(e).trigger(this.options.event+this.eventNamespace)}}),function(){var t=0;e.widget("ui.tabs",e.ui.tabs,{options:{cookie:null},_create:function(){var e,t=this.options;null==t.active&&t.cookie&&(e=parseInt(this._cookie(),10),-1===e&&(e=!1),t.active=e),this._super()},_cookie:function(n){var i=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++t)];return arguments.length&&(i.push(n===!1?-1:n),i.push(this.options.cookie)),e.cookie.apply(null,i)},_refresh:function(){this._super(),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(){this._superApply(arguments),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super(),this.options.cookie&&this._cookie(null,this.options.cookie)}})}(),e.widget("ui.tabs",e.ui.tabs,{_trigger:function(t,n,i){var a=e.extend({},i);return"load"===t&&(a.panel=a.panel[0],a.tab=a.tab.find(".ui-tabs-anchor")[0]),this._super(t,n,a)}}),e.widget("ui.tabs",e.ui.tabs,{options:{fx:null},_getFx:function(){var t,n,i=this.options.fx;return i&&(e.isArray(i)?(t=i[0],n=i[1]):t=n=i),i?{show:n,hide:t}:null},_toggle:function(e,t){function n(){a.running=!1,a._trigger("activate",e,t)}function i(){t.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),r.length&&s.show?r.animate(s.show,s.show.duration,function(){n()}):(r.show(),n())}var a=this,r=t.newPanel,o=t.oldPanel,s=this._getFx();return s?(a.running=!0,void(o.length&&s.hide?o.animate(s.hide,s.hide.duration,function(){t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),i()}):(t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),o.hide(),i()))):this._super(e,t)}}))}(jQuery),function(e){function t(t,n){var i=(t.attr("aria-describedby")||"").split(/\s+/);i.push(n),t.data("ui-tooltip-id",n).attr("aria-describedby",e.trim(i.join(" ")))}function n(t){var n=t.data("ui-tooltip-id"),i=(t.attr("aria-describedby")||"").split(/\s+/),a=e.inArray(n,i);-1!==a&&i.splice(a,1),t.removeData("ui-tooltip-id"),i=e.trim(i.join(" ")),i?t.attr("aria-describedby",i):t.removeAttr("aria-describedby")}var i=0;e.widget("ui.tooltip",{version:"1.9.0",options:{content:function(){return e(this).attr("title")},hide:!0,items:"[title]",position:{my:"left+15 center",at:"right center",collision:"flipfit flipfit"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={}},_setOption:function(t,n){var i=this;return"disabled"===t?(this[n?"_disable":"_enable"](),void(this.options[t]=n)):(this._super(t,n),void("content"===t&&e.each(this.tooltips,function(e,t){i._updateContent(t)})))},_disable:function(){var t=this;e.each(this.tooltips,function(n,i){var a=e.Event("blur");a.target=a.currentTarget=i[0],t.close(a,!0)}),this.element.find(this.options.items).andSelf().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var n=e(t?t.target:this.element).closest(this.options.items);if(n.length){if(this.options.track&&n.data("ui-tooltip-id"))return this._find(n).position(e.extend({of:n},this.options.position)),void this._off(this.document,"mousemove");n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("tooltip-open",!0),this._updateContent(n,t)}},_updateContent:function(e,t){var n,i=this.options.content,a=this;return"string"==typeof i?this._open(t,e,i):(n=i.call(e[0],function(n){e.data("tooltip-open")&&a._delay(function(){this._open(t,e,n)})}),void(n&&this._open(t,e,n)))},_open:function(n,i,a){function r(e){s.of=e,o.position(s)}var o,s;if(a){if(o=this._find(i),o.length)return void o.find(".ui-tooltip-content").html(a);i.is("[title]")&&(n&&"mouseover"===n.type?i.attr("title",""):i.removeAttr("title")),o=this._tooltip(i),t(i,o.attr("id")),o.find(".ui-tooltip-content").html(a),this.options.track&&n&&/^mouse/.test(n.originalEvent.type)?(s=e.extend({},this.options.position),this._on(this.document,{mousemove:r}),r(n)):o.position(e.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this._trigger("open",n,{tooltip:o}),this._on(i,{mouseleave:"close",focusout:"close",keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=i[0],this.close(n,!0)}}})}},close:function(t,i){var a=this,r=e(t?t.currentTarget:this.element),o=this._find(r);this.closing||(i||!t||"focusout"===t.type||this.document[0].activeElement!==r[0])&&(r.data("ui-tooltip-title")&&r.attr("title",r.data("ui-tooltip-title")),n(r),o.stop(!0),this._hide(o,this.options.hide,function(){e(this).remove(),delete a.tooltips[this.id]}),r.removeData("tooltip-open"),this._off(r,"mouseleave focusout keyup"),this._off(this.document,"mousemove"),this.closing=!0,this._trigger("close",t,{tooltip:o}),this.closing=!1)},_tooltip:function(t){var n="ui-tooltip-"+i++,a=e("<div>").attr({id:n,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return e("<div>").addClass("ui-tooltip-content").appendTo(a),a.appendTo(this.document[0].body),e.fn.bgiframe&&a.bgiframe(),this.tooltips[n]=t,a},_find:function(t){var n=t.data("ui-tooltip-id");return n?e("#"+n):e()},_destroy:function(){var t=this;e.each(this.tooltips,function(n,i){var a=e.Event("blur");a.target=a.currentTarget=i[0],t.close(a,!0),e("#"+n).remove(),i.data("ui-tooltip-title")&&(i.attr("title",i.data("ui-tooltip-title")),i.removeData("ui-tooltip-title"))})}})}(jQuery),jQuery.effects||function(e,t){var n=e.uiBackCompat!==!1,i="ui-effects-";e.effects={effect:{}},function(t,n){function i(e,t,n){var i=h[t.type]||{};return null==e?n||!t.def?null:t.def:(e=i.floor?~~e:parseFloat(e),isNaN(e)?t.def:i.mod?(e+i.mod)%i.mod:0>e?0:i.max<e?i.max:e)}function a(e){var n=c(),i=n._rgba=[];return e=e.toLowerCase(),g(d,function(t,a){var r,o=a.re.exec(e),s=o&&a.parse(o),l=a.space||"rgba";return s?(r=n[l](s),n[u[l].cache]=r[u[l].cache],i=n._rgba=r._rgba,!1):void 0}),i.length?("0,0,0,0"===i.join()&&t.extend(i,o.transparent),n):o[e]}function r(e,t,n){return n=(n+1)%1,1>6*n?e+(t-e)*n*6:1>2*n?t:2>3*n?e+(t-e)*(2/3-n)*6:e}var o,s="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),l=/^([\-+])=\s*(\d+\.?\d*)/,d=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],c=t.Color=function(e,n,i,a){return new t.Color.fn.parse(e,n,i,a)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},h={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},p=c.support={},f=t("<p>")[0],g=t.each;f.style.cssText="background-color:rgba(1,1,1,.5)",p.rgba=f.style.backgroundColor.indexOf("rgba")>-1,g(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),c.fn=t.extend(c.prototype,{parse:function(r,s,l,d){if(r===n)return this._rgba=[null,null,null,null],this;(r.jquery||r.nodeType)&&(r=t(r).css(s),s=n);var h=this,p=t.type(r),f=this._rgba=[];return s!==n&&(r=[r,s,l,d],p="array"),"string"===p?this.parse(a(r)||o._default):"array"===p?(g(u.rgba.props,function(e,t){f[t.idx]=i(r[t.idx],t)}),this):"object"===p?(r instanceof c?g(u,function(e,t){r[t.cache]&&(h[t.cache]=r[t.cache].slice())}):g(u,function(t,n){var a=n.cache;g(n.props,function(e,t){if(!h[a]&&n.to){if("alpha"===e||null==r[e])return;h[a]=n.to(h._rgba)}h[a][t.idx]=i(r[e],t,!0)}),h[a]&&e.inArray(null,h[a].slice(0,3))<0&&(h[a][3]=1,n.from&&(h._rgba=n.from(h[a])))}),this):void 0},is:function(e){var t=c(e),n=!0,i=this;return g(u,function(e,a){var r,o=t[a.cache];return o&&(r=i[a.cache]||a.to&&a.to(i._rgba)||[],g(a.props,function(e,t){return null!=o[t.idx]?n=o[t.idx]===r[t.idx]:void 0})),n}),n},_space:function(){var e=[],t=this;return g(u,function(n,i){t[i.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var n=c(e),a=n._space(),r=u[a],o=0===this.alpha()?c("transparent"):this,s=o[r.cache]||r.to(o._rgba),l=s.slice();return n=n[r.cache],g(r.props,function(e,a){var r=a.idx,o=s[r],d=n[r],c=h[a.type]||{};null!==d&&(null===o?l[r]=d:(c.mod&&(d-o>c.mod/2?o+=c.mod:o-d>c.mod/2&&(o-=c.mod)),l[r]=i((d-o)*t+o,a)))}),this[a](l)},blend:function(e){if(1===this._rgba[3])return this;var n=this._rgba.slice(),i=n.pop(),a=c(e)._rgba;return c(t.map(n,function(e,t){return(1-i)*a[t]+i*e}))},toRgbaString:function(){var e="rgba(",n=t.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===n[3]&&(n.pop(),e="rgb("),e+n.join()+")"},toHslaString:function(){var e="hsla(",n=t.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===n[3]&&(n.pop(),e="hsl("),e+n.join()+")"},toHexString:function(e){var n=this._rgba.slice(),i=n.pop();return e&&n.push(~~(255*i)),"#"+t.map(n,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),c.fn.parse.prototype=c.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,i=e[0]/255,a=e[1]/255,r=e[2]/255,o=e[3],s=Math.max(i,a,r),l=Math.min(i,a,r),d=s-l,c=s+l,u=.5*c;return t=l===s?0:i===s?60*(a-r)/d+360:a===s?60*(r-i)/d+120:60*(i-a)/d+240,n=0===u||1===u?u:.5>=u?d/c:d/(2-c),[Math.round(t)%360,n,u,null==o?1:o]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],i=e[2],a=e[3],o=.5>=i?i*(1+n):i+n-i*n,s=2*i-o;
return[Math.round(255*r(s,o,t+1/3)),Math.round(255*r(s,o,t)),Math.round(255*r(s,o,t-1/3)),a]},g(u,function(e,a){var r=a.props,o=a.cache,s=a.to,d=a.from;c.fn[e]=function(e){if(s&&!this[o]&&(this[o]=s(this._rgba)),e===n)return this[o].slice();var a,l=t.type(e),u="array"===l||"object"===l?e:arguments,h=this[o].slice();return g(r,function(e,t){var n=u["object"===l?e:t.idx];null==n&&(n=h[t.idx]),h[t.idx]=i(n,t)}),d?(a=c(d(h)),a[o]=h,a):c(h)},g(r,function(n,i){c.fn[n]||(c.fn[n]=function(a){var r,o=t.type(a),s="alpha"===n?this._hsla?"hsla":"rgba":e,d=this[s](),c=d[i.idx];return"undefined"===o?c:("function"===o&&(a=a.call(this,c),o=t.type(a)),null==a&&i.empty?this:("string"===o&&(r=l.exec(a),r&&(a=c+parseFloat(r[2])*("+"===r[1]?1:-1))),d[i.idx]=a,this[s](d)))})})}),g(s,function(e,n){t.cssHooks[n]={set:function(e,i){var r,o,s="";if("string"!==t.type(i)||(r=a(i))){if(i=c(r||i),!p.rgba&&1!==i._rgba[3]){for(o="backgroundColor"===n?e.parentNode:e;(""===s||"transparent"===s)&&o&&o.style;)try{s=t.css(o,"backgroundColor"),o=o.parentNode}catch(l){}i=i.blend(s&&"transparent"!==s?s:"_default")}i=i.toRgbaString()}try{e.style[n]=i}catch(i){}}},t.fx.step[n]=function(e){e.colorInit||(e.start=c(e.elem,n),e.end=c(e.end),e.colorInit=!0),t.cssHooks[n].set(e.elem,e.start.transition(e.end,e.pos))}}),t.cssHooks.borderColor={expand:function(e){var t={};return g(["Top","Right","Bottom","Left"],function(n,i){t["border"+i+"Color"]=e}),t}},o=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function n(){var t,n,i=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,a={};if(i&&i.length&&i[0]&&i[i[0]])for(n=i.length;n--;)t=i[n],"string"==typeof i[t]&&(a[e.camelCase(t)]=i[t]);else for(t in i)"string"==typeof i[t]&&(a[t]=i[t]);return a}function i(t,n){var i,a,o={};for(i in n)a=n[i],t[i]!==a&&(r[i]||(e.fx.step[i]||!isNaN(parseFloat(a)))&&(o[i]=a));return o}var a=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,n,e.end),e.setAttr=!0)}}),e.effects.animateClass=function(t,r,o,s){var l=e.speed(r,o,s);return this.queue(function(){var r,o=e(this),s=o.attr("class")||"",d=l.children?o.find("*").andSelf():o;d=d.map(function(){var t=e(this);return{el:t,start:n.call(this)}}),r=function(){e.each(a,function(e,n){t[n]&&o[n+"Class"](t[n])})},r(),d=d.map(function(){return this.end=n.call(this.el[0]),this.diff=i(this.start,this.end),this}),o.attr("class",s),d=d.map(function(){var t=this,n=e.Deferred(),i=jQuery.extend({},l,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,i),n.promise()}),e.when.apply(e,d.get()).done(function(){r(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),l.complete.call(o[0])})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,i,a){return n?e.effects.animateClass.call(this,{add:t},n,i,a):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,i,a){return n?e.effects.animateClass.call(this,{remove:t},n,i,a):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,i,a,r,o){return"boolean"==typeof i||i===t?a?e.effects.animateClass.call(this,i?{add:n}:{remove:n},a,r,o):this._toggleClass(n,i):e.effects.animateClass.call(this,{toggle:n},i,a,r)},switchClass:function(t,n,i,a,r){return e.effects.animateClass.call(this,{add:n,remove:t},i,a,r)}})}(),function(){function a(n,i,a,r){return e.isPlainObject(n)&&(i=n,n=n.effect),n={effect:n},i===t&&(i={}),e.isFunction(i)&&(r=i,a=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(r=a,a=i,i={}),e.isFunction(a)&&(r=a,a=null),i&&e.extend(n,i),a=a||i.duration,n.duration=e.fx.off?0:"number"==typeof a?a:a in e.fx.speeds?e.fx.speeds[a]:e.fx.speeds._default,n.complete=r||i.complete,n}function r(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?!1:n&&e.effects[t]?!1:!0}e.extend(e.effects,{version:"1.9.0",save:function(e,t){for(var n=0;n<t.length;n++)null!==t[n]&&e.data(i+t[n],e[0].style[t[n]])},restore:function(e,n){var a,r;for(r=0;r<n.length;r++)null!==n[r]&&(a=e.data(i+n[r]),a===t&&(a=""),e.css(n[r],a))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,i;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":i=0;break;case"center":i=.5;break;case"right":i=1;break;default:i=e[1]/t.width}return{x:i,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},i=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),a={width:t.width(),height:t.height()},r=document.activeElement;try{r.id}catch(o){r=document.body}return t.wrap(i),(t[0]===r||e.contains(t[0],r))&&e(r).focus(),i=t.parent(),"static"===t.css("position")?(i.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,i){n[i]=t.css(i),isNaN(parseInt(n[i],10))&&(n[i]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(a),i.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,i,a){return a=a||{},e.each(n,function(e,n){var r=t.cssUnit(n);r[0]>0&&(a[n]=r[0]*i+r[1])}),a}}),e.fn.extend({effect:function(){function t(t){function n(){e.isFunction(r)&&r.call(a[0]),e.isFunction(t)&&t()}var a=e(this),r=i.complete,o=i.mode;(a.is(":hidden")?"hide"===o:"show"===o)?n():s.call(a[0],i,n)}var i=a.apply(this,arguments),r=i.mode,o=i.queue,s=e.effects.effect[i.effect],l=!s&&n&&e.effects[i.effect];return e.fx.off||!s&&!l?r?this[r](i.duration,i.complete):this.each(function(){i.complete&&i.complete.call(this)}):s?o===!1?this.each(t):this.queue(o||"fx",t):l.call(this,{options:i,duration:i.duration,callback:i.complete,mode:i.mode})},_show:e.fn.show,show:function(e){if(r(e))return this._show.apply(this,arguments);var t=a.apply(this,arguments);return t.mode="show",this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(r(e))return this._hide.apply(this,arguments);var t=a.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(r(t)||"boolean"==typeof t||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=a.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)},cssUnit:function(t){var n=this.css(t),i=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(i=[parseFloat(n),t])}),i}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?n(2*e)/2:1-n(-2*e+2)/2}})}()}(jQuery),function(e){var t=/up|down|vertical/,n=/up|left|vertical|horizontal/;e.effects.effect.blind=function(i,a){var r,o,s,l=e(this),d=["position","top","bottom","left","right","height","width"],c=e.effects.setMode(l,i.mode||"hide"),u=i.direction||"up",h=t.test(u),p=h?"height":"width",f=h?"top":"left",g=n.test(u),m={},b="show"===c;l.parent().is(".ui-effects-wrapper")?e.effects.save(l.parent(),d):e.effects.save(l,d),l.show(),r=e.effects.createWrapper(l).css({overflow:"hidden"}),o=r[p](),s=parseFloat(r.css(f))||0,m[p]=b?o:0,g||(l.css(h?"bottom":"right",0).css(h?"top":"left","auto").css({position:"absolute"}),m[f]=b?s:o+s),b&&(r.css(p,0),g||r.css(f,s+o)),r.animate(m,{duration:i.duration,easing:i.easing,queue:!1,complete:function(){"hide"===c&&l.hide(),e.effects.restore(l,d),e.effects.removeWrapper(l),a()}})}}(jQuery),function(e){e.effects.effect.bounce=function(t,n){var i,a,r,o=e(this),s=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(o,t.mode||"effect"),d="hide"===l,c="show"===l,u=t.direction||"up",h=t.distance,p=t.times||5,f=2*p+(c||d?1:0),g=t.duration/f,m=t.easing,b="up"===u||"down"===u?"top":"left",v="up"===u||"left"===u,y=o.queue(),_=y.length;for((c||d)&&s.push("opacity"),e.effects.save(o,s),o.show(),e.effects.createWrapper(o),h||(h=o["top"===b?"outerHeight":"outerWidth"]()/3),c&&(r={opacity:1},r[b]=0,o.css("opacity",0).css(b,v?2*-h:2*h).animate(r,g,m)),d&&(h/=Math.pow(2,p-1)),r={},r[b]=0,i=0;p>i;i++)a={},a[b]=(v?"-=":"+=")+h,o.animate(a,g,m).animate(r,g,m),h=d?2*h:h/2;d&&(a={opacity:0},a[b]=(v?"-=":"+=")+h,o.animate(a,g,m)),o.queue(function(){d&&o.hide(),e.effects.restore(o,s),e.effects.removeWrapper(o),n()}),_>1&&y.splice.apply(y,[1,0].concat(y.splice(_,f+1))),o.dequeue()}}(jQuery),function(e){e.effects.effect.clip=function(t,n){var i,a,r,o=e(this),s=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(o,t.mode||"hide"),d="show"===l,c=t.direction||"vertical",u="vertical"===c,h=u?"height":"width",p=u?"top":"left",f={};e.effects.save(o,s),o.show(),i=e.effects.createWrapper(o).css({overflow:"hidden"}),a="IMG"===o[0].tagName?i:o,r=a[h](),d&&(a.css(h,0),a.css(p,r/2)),f[h]=d?r:0,f[p]=d?0:r/2,a.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){d||o.hide(),e.effects.restore(o,s),e.effects.removeWrapper(o),n()}})}}(jQuery),function(e){e.effects.effect.drop=function(t,n){var i,a=e(this),r=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(a,t.mode||"hide"),s="show"===o,l=t.direction||"left",d="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l?"pos":"neg",u={opacity:s?1:0};e.effects.save(a,r),a.show(),e.effects.createWrapper(a),i=t.distance||a["top"===d?"outerHeight":"outerWidth"](!0)/2,s&&a.css("opacity",0).css(d,"pos"===c?-i:i),u[d]=(s?"pos"===c?"+=":"-=":"pos"===c?"-=":"+=")+i,a.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&a.hide(),e.effects.restore(a,r),e.effects.removeWrapper(a),n()}})}}(jQuery),function(e){e.effects.effect.explode=function(t,n){function i(){y.push(this),y.length===u*h&&a()}function a(){p.css({visibility:"visible"}),e(y).remove(),g||p.hide(),n()}var r,o,s,l,d,c,u=t.pieces?Math.round(Math.sqrt(t.pieces)):3,h=u,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),g="show"===f,m=p.show().css("visibility","hidden").offset(),b=Math.ceil(p.outerWidth()/h),v=Math.ceil(p.outerHeight()/u),y=[];for(r=0;u>r;r++)for(l=m.top+r*v,c=r-(u-1)/2,o=0;h>o;o++)s=m.left+o*b,d=o-(h-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*b,top:-r*v}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:b,height:v,left:s+(g?d*b:0),top:l+(g?c*v:0),opacity:g?0:1}).animate({left:s+(g?0:d*b),top:l+(g?0:c*v),opacity:g?1:0},t.duration||500,t.easing,i)}}(jQuery),function(e){e.effects.effect.fade=function(t,n){var i=e(this),a=e.effects.setMode(i,t.mode||"toggle");i.animate({opacity:a},{queue:!1,duration:t.duration,easing:t.easing,complete:n})}}(jQuery),function(e){e.effects.effect.fold=function(t,n){var i,a,r=e(this),o=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),l="show"===s,d="hide"===s,c=t.size||15,u=/([0-9]+)%/.exec(c),h=!!t.horizFirst,p=l!==h,f=p?["width","height"]:["height","width"],g=t.duration/2,m={},b={};e.effects.save(r,o),r.show(),i=e.effects.createWrapper(r).css({overflow:"hidden"}),a=p?[i.width(),i.height()]:[i.height(),i.width()],u&&(c=parseInt(u[1],10)/100*a[d?0:1]),l&&i.css(h?{height:0,width:c}:{height:c,width:0}),m[f[0]]=l?a[0]:c,b[f[1]]=l?a[1]:0,i.animate(m,g,t.easing).animate(b,g,t.easing,function(){d&&r.hide(),e.effects.restore(r,o),e.effects.removeWrapper(r),n()})}}(jQuery),function(e){e.effects.effect.highlight=function(t,n){var i=e(this),a=["backgroundImage","backgroundColor","opacity"],r=e.effects.setMode(i,t.mode||"show"),o={backgroundColor:i.css("backgroundColor")};"hide"===r&&(o.opacity=0),e.effects.save(i,a),i.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&i.hide(),e.effects.restore(i,a),n()}})}}(jQuery),function(e){e.effects.effect.pulsate=function(t,n){var i,a=e(this),r=e.effects.setMode(a,t.mode||"show"),o="show"===r,s="hide"===r,l=o||"hide"===r,d=2*(t.times||5)+(l?1:0),c=t.duration/d,u=0,h=a.queue(),p=h.length;for((o||!a.is(":visible"))&&(a.css("opacity",0).show(),u=1),i=1;d>i;i++)a.animate({opacity:u},c,t.easing),u=1-u;a.animate({opacity:u},c,t.easing),a.queue(function(){s&&a.hide(),n()}),p>1&&h.splice.apply(h,[1,0].concat(h.splice(p,d+1))),a.dequeue()}}(jQuery),function(e){e.effects.effect.puff=function(t,n){var i=e(this),a=e.effects.setMode(i,t.mode||"hide"),r="hide"===a,o=parseInt(t.percent,10)||150,s=o/100,l={height:i.height(),width:i.width()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:a,complete:n,percent:r?o:100,from:r?l:{height:l.height*s,width:l.width*s}}),i.effect(t)},e.effects.effect.scale=function(t,n){var i=e(this),a=e.extend(!0,{},t),r=e.effects.setMode(i,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===r?0:100),s=t.direction||"both",l=t.origin,d={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()},c={y:"horizontal"!==s?o/100:1,x:"vertical"!==s?o/100:1};a.effect="size",a.queue=!1,a.complete=n,"effect"!==r&&(a.origin=l||["middle","center"],a.restore=!0),a.from=t.from||("show"===r?{height:0,width:0}:d),a.to={height:d.height*c.y,width:d.width*c.x,outerHeight:d.outerHeight*c.y,outerWidth:d.outerWidth*c.x},a.fade&&("show"===r&&(a.from.opacity=0,a.to.opacity=1),"hide"===r&&(a.from.opacity=1,a.to.opacity=0)),i.effect(a)},e.effects.effect.size=function(t,n){var i,a,r,o=e(this),s=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["position","top","bottom","left","right","overflow","opacity"],d=["width","height","overflow"],c=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),f=t.restore||"effect"!==p,g=t.scale||"both",m=t.origin||["middle","center"],b=o.css("position");"show"===p&&o.show(),i={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},o.from=t.from||i,o.to=t.to||i,r={from:{y:o.from.height/i.height,x:o.from.width/i.width},to:{y:o.to.height/i.height,x:o.to.width/i.width}},("box"===g||"both"===g)&&(r.from.y!==r.to.y&&(s=s.concat(u),o.from=e.effects.setTransition(o,u,r.from.y,o.from),o.to=e.effects.setTransition(o,u,r.to.y,o.to)),r.from.x!==r.to.x&&(s=s.concat(h),o.from=e.effects.setTransition(o,h,r.from.x,o.from),o.to=e.effects.setTransition(o,h,r.to.x,o.to))),("content"===g||"both"===g)&&r.from.y!==r.to.y&&(s=s.concat(c),o.from=e.effects.setTransition(o,c,r.from.y,o.from),o.to=e.effects.setTransition(o,c,r.to.y,o.to)),e.effects.save(o,f?s:l),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(a=e.effects.getBaseline(m,i),o.from.top=(i.outerHeight-o.outerHeight())*a.y,o.from.left=(i.outerWidth-o.outerWidth())*a.x,o.to.top=(i.outerHeight-o.to.outerHeight)*a.y,o.to.left=(i.outerWidth-o.to.outerWidth)*a.x),o.css(o.from),("content"===g||"both"===g)&&(u=u.concat(["marginTop","marginBottom"]).concat(c),h=h.concat(["marginLeft","marginRight"]),d=s.concat(u).concat(h),o.find("*[width]").each(function(){var n=e(this),i={height:n.height(),width:n.width()};f&&e.effects.save(n,d),n.from={height:i.height*r.from.y,width:i.width*r.from.x},n.to={height:i.height*r.to.y,width:i.width*r.to.x},r.from.y!==r.to.y&&(n.from=e.effects.setTransition(n,u,r.from.y,n.from),n.to=e.effects.setTransition(n,u,r.to.y,n.to)),r.from.x!==r.to.x&&(n.from=e.effects.setTransition(n,h,r.from.x,n.from),n.to=e.effects.setTransition(n,h,r.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){f&&e.effects.restore(n,d)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,f?s:l),f||("static"===b?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,n){var i=parseInt(n,10),a=e?o.to.left:o.to.top;return"auto"===n?a+"px":i+a+"px"})})),e.effects.removeWrapper(o),n()}})}}(jQuery),function(e){e.effects.effect.shake=function(t,n){var i,a=e(this),r=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(a,t.mode||"effect"),s=t.direction||"left",l=t.distance||20,d=t.times||3,c=2*d+1,u=Math.round(t.duration/c),h="up"===s||"down"===s?"top":"left",p="up"===s||"left"===s,f={},g={},m={},b=a.queue(),v=b.length;for(e.effects.save(a,r),a.show(),e.effects.createWrapper(a),f[h]=(p?"-=":"+=")+l,g[h]=(p?"+=":"-=")+2*l,m[h]=(p?"-=":"+=")+2*l,a.animate(f,u,t.easing),i=1;d>i;i++)a.animate(g,u,t.easing).animate(m,u,t.easing);a.animate(g,u,t.easing).animate(f,u/2,t.easing).queue(function(){"hide"===o&&a.hide(),e.effects.restore(a,r),e.effects.removeWrapper(a),n()}),v>1&&b.splice.apply(b,[1,0].concat(b.splice(v,c+1))),a.dequeue()}}(jQuery),function(e){e.effects.effect.slide=function(t,n){var i,a=e(this),r=["position","top","bottom","left","right","width","height"],o=e.effects.setMode(a,t.mode||"show"),s="show"===o,l=t.direction||"left",d="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l,u={};e.effects.save(a,r),a.show(),i=t.distance||a["top"===d?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(a).css({overflow:"hidden"}),s&&a.css(d,c?isNaN(i)?"-"+i:-i:i),u[d]=(s?c?"+=":"-=":c?"-=":"+=")+i,a.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&a.hide(),e.effects.restore(a,r),e.effects.removeWrapper(a),n()}})}}(jQuery),function(e){e.effects.effect.transfer=function(t,n){var i=e(this),a=e(t.to),r="fixed"===a.css("position"),o=e("body"),s=r?o.scrollTop():0,l=r?o.scrollLeft():0,d=a.offset(),c={top:d.top-s,left:d.left-l,height:a.innerHeight(),width:a.innerWidth()},u=i.offset(),h=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(t.className).css({top:u.top-s,left:u.left-l,height:i.innerHeight(),width:i.innerWidth(),position:r?"fixed":"absolute"}).animate(c,t.duration,t.easing,function(){h.remove(),n()})}}(jQuery)}),define("ui/tab",["aloha/core","jquery","ui/container","ui/component","PubSub","jqueryui"],function(e,t,n,i,a){function r(e){var n=!1;return 0!==t("button:not(.aloha-multisplit-toggle)",e.panel).length&&(n=!0),n}var o=0,s={},l=n.extend({_elemBySlot:null,_groupBySlot:null,_groupByComponent:null,_constructor:function(e,n,i){var a,r,s,l,d,c,u;for(this._elemBySlot={},this._groupBySlot={},this._groupByComponent={},this._slotsList=[],this._super(e,n),this.container=n.container,this.list=this.container.data("list"),this.panels=this.container.data("panels"),this.id="tab-ui-container-"+ ++o,this.panel=t("<div>",{id:this.id,unselectable:"on"}),this.handle=t('<li><a href="'+location.href.replace(/#.*$/,"")+"#"+this.id+'">'+n.label+"</a></li>"),a=0;a<i.length;a++)if("string"==typeof i[a])1===i[a].length&&10===i[a].charCodeAt(0)?this.panel.append("<div>",{unselectable:"on"}):(s=t("<span>",{unselectable:"on"}),this._elemBySlot[i[a]]=s,this.panel.append(s));else for(d=t("<div>",{"class":"aloha-ui-component-group aloha-ui-hidden",unselectable:"on"}).appendTo(this.panel),c={element:d,visibleCounter:0},l=i[a],r=0;r<l.length;r++)this._groupBySlot[l[r]]=c,l[r]&&1===l[r].length&&10===l[r].charCodeAt(0)?d.append(t("<div>",{unselectable:"on"})):(u=l[r],s=t("<span>",{unselectable:"on"}),this._elemBySlot[l[r]]=s,d.append(s));this.panel.append(t("<div>",{"class":"aloha-ui-clear",unselectable:"on"})),this.handle.appendTo(this.list),this.panel.appendTo(this.panels),this.container.tabs("refresh");var h=n.container.data("aloha-tabs");this.index=h.length,h.push(this)},adoptInto:function(e,t){var n,i=this._elemBySlot[e];return i?(s[e]=t,t.adoptParent(this),i.append(t.element),n=this._groupBySlot[e],this._slotsList.push(e),n&&(this._groupByComponent[t.id]=n,t.isVisible()&&(n.visibleCounter||n.element.removeClass("aloha-ui-hidden"),n.visibleCounter+=1)),!0):!1},foreground:function(){this.container.tabs("select",this.index)},childForeground:function(){this.foreground()},hasVisibleComponents:function(){var e,t=this._elemBySlot;for(e in t)if(t.hasOwnProperty(e)&&s[e]&&s[e].visible)return!0;return!1},childVisible:function(e,t){t?e.container.show():e.container.hasVisibleComponents()||e.container.hide();var n=this._groupByComponent[e.id];n&&(t?(0===n.visibleCounter&&n.element.removeClass("aloha-ui-hidden"),n.visibleCounter+=1):(n.visibleCounter-=1,0===n.visibleCounter&&n.element.addClass("aloha-ui-hidden")))},show:function(){this.list.children().length&&r(this)&&(this.handle.show(),this.visible=!0,this.container.show(),this.container.find(".ui-tabs-active").length&&this.container.tabs("option","selected")!==this.index||this.foreground())},hide:function(){var e=this.list.children();if(0!==e.length&&(this.handle.hide(),this.visible=!1,this.index===this.container.tabs("option","selected"))){e=this.container.data("aloha-tabs");var t;for(t=0;t<e.length;++t)if(e[t].visible)return void this.container.tabs("select",t);this.handle.removeClass("ui-tabs-active"),this.container.hide()}}});return t.extend(l,{createContainer:function(){var e=t("<div>",{unselectable:"on"}),n=t("<ul>",{unselectable:"on"}).appendTo(e),i=t("<div>",{unselectable:"on"}).appendTo(e);return e.data("list",n).data("panels",i).data("aloha-tabs",[]).tabs({select:function(t,n){var i=e.data("aloha-tabs");e.data("aloha-active-container",i[n.index]),a.pub("aloha.ui.container.selected",{data:i[n.index]})}}),e}}),l}),define("ui/subguarded",["aloha/core","jquery","PubSub"],function(e,t,n){function i(e){return e.alohaUid||(e.alohaUid=++c),e.alohaUid}function a(e){return h[e]||[]}function r(e){return u[e.alohaUid]||[]}function o(e,t){return u[e.alohaUid]||(u[e.alohaUid]=[]),u[e.alohaUid].push(t),u[e.alohaUid]}function s(e,t){return h[e]||(h[e]=[]),h[e].push(t),h[e]}function l(e){var t,n=a(e);for(t=0;t<n.length;t++)n[t].apply(null,[r(n[t])].concat(arguments))}function d(){var t=Array.prototype.slice.call(arguments),a=t.shift();"string"==typeof a&&(a=[a]);var r=t.shift();i(r),o(r,t);var d,c,u=function(e,t,n){l(c,e,t,n)},h=function(){l(c)};for(d=0;d<a.length;d++)c=a[d],s(c,r),e.bind(c,u),n.sub(c,h)}var c=0,u={},h={};return d}),define("vendor/amplify.store",["util/json2"],function(){var e={};return function(e,t){function n(e,n){i.addType(e,function(r,o,s){var l,d,c,u,h=o,p=(new Date).getTime();if(!r){h={},u=[],c=0;try{for(r=n.length;r=n.key(c++);)a.test(r)&&(d=JSON.parse(n.getItem(r)),d.expires&&d.expires<=p?u.push(r):h[r.replace(a,"")]=d.data);for(;r=u.pop();)n.removeItem(r)}catch(f){}return h}if(r="__amplify__"+r,o===t){if(l=n.getItem(r),d=l?JSON.parse(l):{expires:-1},!(d.expires&&d.expires<=p))return d.data;n.removeItem(r)}else if(null===o)n.removeItem(r);else{d=JSON.stringify({data:o,expires:s.expires?p+s.expires:null});try{n.setItem(r,d)}catch(f){i[e]();try{n.setItem(r,d)}catch(f){throw i.error()}}}return h})}var i=e.store=function(e,t,n,a){var a=i.type;return n&&n.type&&n.type in i.types&&(a=n.type),i.types[a](e,t,n||{})};i.types={},i.type=null,i.addType=function(e,t){i.type||(i.type=e),i.types[e]=t,i[e]=function(t,n,a){return a=a||{},a.type=e,i(t,n,a)}},i.error=function(){return"amplify.store quota exceeded"};var a=/^__amplify__/;for(var r in{localStorage:1,sessionStorage:1})try{window[r].getItem&&n(r,window[r])}catch(o){}if(window.globalStorage)try{n("globalStorage",window.globalStorage[window.location.hostname]),"sessionStorage"===i.type&&(i.type="globalStorage")}catch(o){}!function(){if(!i.types.localStorage){var e=document.createElement("div"),n="amplify";e.style.display="none",document.getElementsByTagName("head")[0].appendChild(e);try{e.addBehavior("#default#userdata"),e.load(n)}catch(a){return void e.parentNode.removeChild(e)}i.addType("userData",function(a,r,o){e.load(n);var s,l,d,c,u,h=r,p=(new Date).getTime();if(!a){for(h={},u=[],c=0;s=e.XMLDocument.documentElement.attributes[c++];)l=JSON.parse(s.value),l.expires&&l.expires<=p?u.push(s.name):h[s.name]=l.data;for(;a=u.pop();)e.removeAttribute(a);return e.save(n),h}if(a=a.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-"),r===t){if(s=e.getAttribute(a),l=s?JSON.parse(s):{expires:-1},!(l.expires&&l.expires<=p))return l.data;e.removeAttribute(a)}else null===r?e.removeAttribute(a):(d=e.getAttribute(a),l=JSON.stringify({data:r,expires:o.expires?p+o.expires:null}),e.setAttribute(a,l));try{e.save(n)}catch(f){null===d?e.removeAttribute(a):e.setAttribute(a,d),i.userData();try{e.setAttribute(a,l),e.save(n)}catch(f){throw null===d?e.removeAttribute(a):e.setAttribute(a,d),i.error()}}return h})}}(),function(){function e(e){return e===t?t:JSON.parse(JSON.stringify(e))}var n={},a={};i.addType("memory",function(i,r,o){return i?r===t?e(n[i]):(a[i]&&(clearTimeout(a[i]),delete a[i]),null===r?(delete n[i],null):(n[i]=r,o.expires&&(a[i]=setTimeout(function(){delete n[i],delete a[i]},o.expires)),r)):e(n)})}()}(e),e}),define("ui/floating",["jquery","aloha/core","ui/surface","ui/subguarded","PubSub","vendor/amplify.store","util/browser"],function(e,t,n,i,a,r,o){function s(t,n,i,r){"absolute"===C&&(n.top+=w.scrollTop(),n.left+=w.scrollLeft()),k.offset=n,t.stop().animate(n,i,function(){r(n),a.pub("aloha.floating.changed",{position:e.extend({},k)})})}function l(e,t,n,i){t.top-=e.height()+y,s(e,t,n,i)}function d(e,t,n,i){t.top+=y,s(e,t,n,i)}function c(e){r.store("Aloha.FloatingMenu.pinned","true"),r.store("Aloha.FloatingMenu.top",e.top),r.store("Aloha.FloatingMenu.left",e.left)}function u(){r.store("Aloha.FloatingMenu.pinned",null),r.store("Aloha.FloatingMenu.top",null),r.store("Aloha.FloatingMenu.left",null)}function h(){return"true"===r.store("Aloha.FloatingMenu.pinned")?{top:parseInt(r.store("Aloha.FloatingMenu.top"),10),left:parseInt(r.store("Aloha.FloatingMenu.left"),10),isPinned:!0}:{top:null,left:null,isPinned:!1}}function p(e){var t=e.left,n=e.top;return 0>n?n=0:n>w.height()&&(n=w.height()/2),0>t?t=0:t>w.width()&&(t=w.width()/2),{top:n,left:t}}function f(t,n,i,a){"number"!=typeof i&&(i=_);var r=(parseInt(e("body").css("marginTop"),10)||0)+(parseInt(e("body").css("paddingTop"),10)||0),o=t.$element,s=n.obj.offset(),c=s.top,u=s.left,h=w.scrollTop(),p=c-h-r,f=u+o.width()-w.width();f>0&&(u=Math.max(0,u-f)),p>=o.height()?l(o,{top:c-h,left:u},i,a):p+o.height()>p+n.obj.height()?d(o,{top:c+n.obj.height(),left:u},i,a):d(o,{top:r,left:u},i,a)}function g(e,t,n){var i=e.$element;n?(u(),i.find(".aloha-ui-pin").removeClass("aloha-ui-pin-down")):(c(t),i.find(".aloha-ui-pin").addClass("aloha-ui-pin-down")),i.css({position:"fixed",top:t.top})}function m(e,t,n,i,a){var r;for(r=0;r<e.length;r++)e[r][0].isActive()&&e[r][1](n,i,a)}function b(t){if(e.browser.msie){var n=t.$element.parent();t.$element.appendTo("body"),t.$element.css("position",C),n.length?t.$element.appendTo(n):t.$element.detach()}else t.$element.css("position",C)}function v(e,t){i(["aloha-selection-changed","aloha.ui.container.selected"],m,e,function(){e._move()});var n=function(){var n=p({top:t.pinTop,left:t.pinLeft});t.setFloatingPosition(n),e.$element.css({top:n.top,left:n.left})};w.scroll(function(){e._move(0)}),w.resize(function(){t.isFloatingMode||n()}),e.addPin(),b(e),t.isFloatingMode||n(),e.$element.css("z-index",10100).draggable({distance:20,stop:function(e,n){t.setFloatingPosition(n.position),t.isFloatingMode||c(n.position)}})}var y=10,_=500,w=e(window),C=o.ie7?"absolute":"fixed",k={style:C,offset:{top:0,left:0}};return{getPinState:h,makeFloating:v,floatSurface:f,togglePinSurface:g,POSITION_STYLE:C}}),function(){function e(e,t,n,i,a,r){t[e]&&(n.push(e),(t[e]===!0||1===t[e])&&i.push(a+e+"/"+r))}function t(e,t,n,i,a){var r=i+t+"/"+a;require._fileExists(e.toUrl(r))&&n.push(r)}function n(e,t,i){var a;for(a in t)!t.hasOwnProperty(a)||e.hasOwnProperty(a)&&!i?"object"==typeof t[a]&&n(e[a],t[a],i):e[a]=t[a]}var i=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(a){var r=a.config();return{version:"2.0.1",load:function(a,o,s,l){l=l||{},l.locale&&(r.locale=l.locale);var d,c,u,h=i.exec(a),p=h[1],f=h[4],g=h[5],m=f.split("-"),b=[],v={},y="";if(h[5]?(p=h[1],d=p+g):(d=a,g=h[4],f=r.locale,f||(f=r.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),m=f.split("-")),l.isBuild){for(b.push(d),t(o,"root",b,p,g),c=0;c<m.length;c++)u=m[c],y+=(y?"-":"")+u,t(o,y,b,p,g);o(b,function(){s()})}else o([d],function(t){var i,a=[];for(e("root",t,a,b,p,g),c=0;c<m.length;c++)i=m[c],y+=(y?"-":"")+i,e(y,t,a,b,p,g);o(b,function(){var e,i,r;for(e=a.length-1;e>-1&&a[e];e--)r=a[e],i=t[r],(i===!0||1===i)&&(i=o(p+r+"/"+g)),n(v,i);v.t=function(e,t){return this[e]?this[e]:t?t:e},s(v)})})}}})}(),define("ui/nls/i18n",{root:{"button.dismiss.label":"Dismiss","button.bold.label":"Bold","button.italic.label":"Italic","button.strikethrough.label":"Strikethrough","button.subscript.label":"Subscript","button.superscript.label":"Superscript","button.underline.label":"Underline","button.yes.label":"Yes","button.no.label":"No","button.p.label":"Paragraph","button.h1.label":"Heading 1","button.h2.label":"Heading 2","button.h3.label":"Heading 3","button.h4.label":"Heading 4","button.h5.label":"Heading 5","button.h6.label":"Heading 6","button.pre.label":"Preformatted text","button.removeFormatting.label":"Remove formatting","button.ol.label":"Insert ordered list","button.ul.label":"Insert unordered list","button.indent.label":"Indent list","button.outdent.label":"Outdent list","button.createLink.label":"Insert link","button.removeLink.label":"Remove link","button.createAbbr.label":"Insert abbreviation","button.characterPicker.label":"Pick special characters","button.createLink.label":"Insert link","button.removeLink.label":"Remove link","button.createAbbr.label":"Insert abbreviation","button.characterPicker.label":"Pick special characters","button.justifyLeft.label":"Align to the left","button.justifyRight.label":"Align to the right","button.justifyCenter.label":"Center","button.justifyFull.label":"Justify","button.horizontalRule.label":"Insert horizontal rule","button.createLanguageAnnotation.label":"Insert language annotation","button.metaview.label":"Switch between meta and normal view","button.quote.label":"Format selection as quote","button.blockquote.label":"Format selection as blockquote","tab.format.label":"Format","tab.insert.label":"Insert","tab.abbr.label":"Abbreviation","tab.img.label":"Image","tab.link.label":"Link","tab.list.label":"List","tab.table.label":"Table","tab.col.label":"Table Column","tab.row.label":"Table Row","tab.cell.label":"Table Cell","tab.wai-lang.label":"Language annotation"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("ui/toolbar",["jquery","aloha/core","ui/surface","ui/tab","ui/floating","ui/context","i18n!ui/nls/i18n","jqueryui"],function(e,t,n,i,a,r,o){function s(){return!t.settings||!t.settings.toolbar||t.settings.toolbar.floating!==!1
}var l=n.extend({_moveTimeout:null,$_container:null,_tabBySlot:null,_tabs:[],_constructor:function(t,n){var r,d,c,u;for(this._super(t),this.$element=e("<div>",{"class":"aloha-ui aloha-ui-toolbar",unselectable:"on"}),this.$_container=i.createContainer().appendTo(this.$element),this._tabBySlot={},c=0;c<n.length;c++){r=n[c],d=new i(t,{label:o.t(r.label,r.label),showOn:r.showOn,container:this.$_container},r.components);for(u in d._elemBySlot)d._elemBySlot.hasOwnProperty(u)&&(this._tabBySlot[u]=d);this._tabs.push({tab:d,settings:r})}s()&&a.makeFloating(this,l)},adoptInto:function(e,t){var n=this._tabBySlot[e];return n&&n.adoptInto(e,t)},getActiveContainer:function(){return this.$_container.data("aloha-active-container")},getContainers:function(){return this.$_container.data("aloha-tabs")},_move:function(e){var n=this;n._moveTimeout&&window.clearTimeout(n._moveTimeout),n._moveTimeout=window.setTimeout(function(){n._moveTimeout=null,t.activeEditable&&l.isFloatingMode&&a.floatSurface(n,t.activeEditable,e,l.setFloatingPosition)},20)},addPin:function(){var t=e('<div class="aloha-ui-pin">'),n=this.$element;n.find(".ui-tabs").append(t),n.find(".ui-tabs").hover(function(){n.addClass("aloha-ui-hover")},function(){n.removeClass("aloha-ui-hover")}),l.isFloatingMode||t.addClass("aloha-ui-pin-down");var i=this;t.click(function(){l.isFloatingMode=!l.isFloatingMode;var t;l.isFloatingMode?t={top:l.pinTop,left:l.pinLeft}:(t=i.$element.offset(),t.top-=e(window).scrollTop()),l.setFloatingPosition(t),a.togglePinSurface(i,t,l.isFloatingMode)})},show:function(){if(l.$surfaceContainer.children().detach(),l.$surfaceContainer.append(this.$element),l.$surfaceContainer.stop().fadeTo(200,1),s()){var e=l.getFloatingPosition();this.$element.stop().css({top:e.top,left:e.left}),this._move()}},hide:function(){l.$surfaceContainer.stop().fadeOut(200,function(){l.$surfaceContainer.children().detach()})}});return e.extend(l,{$surfaceContainer:null,isFloatingMode:!0,pinLeft:0,pinTop:0,init:function(){l.$surfaceContainer=e("<div>",{"class":"aloha aloha-surface aloha-toolbar",unselectable:"on"}).hide(),e(function(){l.$surfaceContainer.appendTo("body")}),n.trackRange(l.$surfaceContainer);var t=a.getPinState();l.pinTop=t.top,l.pinLeft=t.left,l.isFloatingMode=!t.isPinned},setFloatingPosition:function(e){l.pinTop=e.top,l.pinLeft=e.left},getFloatingPosition:function(){return{top:l.pinTop,left:l.pinLeft}}}),l.init(),l}),define("ui/settings",["jquery","util/arrays","util/maps","util/trees"],function(e,t,n,i){function a(i,a,l){function d(t){return"array"===e.type(t)?!t.length:u[t]}var c=n.fillTuples({},t.map(a,function(e){return[e.label,e]})),u=s(i,l);return i=o(i,c,d),a=r(a,u,d),i.concat(a)}function r(t,n,a){var r,o,s,l,d=[];for(r=0;r<t.length;r++)s=t[r],n[s.label]||(l=i.postprune(s.components,a),l&&(o=e.extend({},s),o.components=l,d.push(o)));return d}function o(t,n,a){var r,o,s,l,d,c,u=[];for(r=0;r<t.length;r++)s=t[r],l=s.components||[],d=n[s.label],!s.exclusive&&d&&(c=i.postprune(d.components,a),c&&(l=l.concat(c))),o=e.extend({},d||{},s),o.components=l,u.push(o);return u}function s(e,t){var a,r=n.fillKeys({},t,!0);for(a=0;a<e.length;a++)r[e[a].label]=!0,n.fillKeys(r,i.flatten(e[a].components),!0);return r}var l={tabs:[{label:"tab.format.label",showOn:{scope:"Aloha.continuoustext"},components:[["bold","strong","italic","emphasis","underline","\n","subscript","superscript","strikethrough","quote"],["formatLink","formatAbbr","formatNumeratedHeaders","toggleDragDrop","\n","toggleMetaView","wailang","toggleFormatlessPaste"],["alignLeft","alignCenter","alignRight","alignJustify","\n","orderedListFormatSelector","unorderedListFormatSelector","definitionListFormatSelector","\n","indentList","outdentList","colorPicker"],["formatBlock"]]},{label:"tab.insert.label",showOn:{scope:"Aloha.continuoustext"},components:[["createTable","characterPicker","insertLink","insertImage","insertAbbr","insertToc","insertHorizontalRule","insertTag"]]},{label:"tab.link.label",showOn:{scope:"link"},components:["editLink","removeLink","linkBrowser"]},{label:"tab.img.label",showOn:{scope:"image"},components:[["imageSource","\n","imageTitle"],["imageResizeWidth","\n","imageResizeHeight"],["imageAlignLeft","imageAlignRight","imageAlignNone","imageIncPadding","\n","imageCropButton","imageCnrReset","imageCnrRatio","imageDecPadding"],["imageBrowser"]]},{label:"tab.abbr.label",showOn:{scope:"abbr"},components:[["abbrText","removeAbbr"]]},{label:"tab.wai-lang.label",showOn:{scope:"wai-lang"},components:[["wailangfield","removewailang"]]},{label:"tab.table.label",showOn:{scope:"table.cell"},components:[["mergecells","splitcells","tableCaption","naturalFit","tableSummary"],["formatTable"]]},{label:"tab.col.label",showOn:{scope:"table.column"},components:[["addcolumnleft","addcolumnright","deletecolumns","columnheader","mergecellsColumn","splitcellsColumn","formatColumn"]]},{label:"tab.row.label",showOn:{scope:"table.row"},components:[["addrowbefore","addrowafter","deleterows","rowheader","mergecellsRow","splitcellsRow","formatRow"]]},{label:"tab.cell.label",showOn:{scope:"table.cell"},components:[["alignTop","alignMiddle","alignBottom","formatCell"]]}]};return{defaultToolbarSettings:l,combineToolbarSettings:a}}),define("ui/ui-plugin",["jquery","aloha","ui/context","ui/container","ui/surface","ui/toolbar","ui/scopes","ui/settings","PubSub","jqueryui"],function(e,t,n,i,a,r,o,s,l){function d(){var e=t.settings.toolbar,n=s.defaultToolbarSettings;return e?s.combineToolbarSettings(e.tabs||[],n.tabs,e.exclude||[]):n.tabs}function c(){var t,n,i=f._tabs,a=o.getPrimaryScope();for(n=0;n<i.length;n++)if(t=i[n].settings,"object"===e.type(t.showOn)&&t.showOn.scope===a){i[n].tab.foreground();break}}function u(e,t){return f.adoptInto(e,t)}function h(e){a.show(p),i.showContainersForContext(p,e)}var p=new n,f=new r(p,d());return t.bind("aloha-editable-activated",function(e){a.show(p),i.showContainersForContext(p,e)}),t.bind("aloha-editable-deactivated",function(){a.suppressHide||a.hide(p)}),l.sub("aloha.ui.scope.change",function(){i.showContainersForContext(p),c(o.getPrimaryScope())}),{adoptInto:u,showToolbar:h}}),define("ui/ui",["jquery","ui/ui-plugin"],function(e,t){function n(n,i,r){var o,s;return"string"!==e.type(n)?(r=i,i=n,n=r.name):r=e.extend({name:n},r),i.isInstance?s=i:(o=r?i.extend(r):i,s=new o),a[n]=s,t.adoptInto(n,s),s}function i(e){return a[e]||null}var a={};return{adopt:n,getAdoptedComponent:i}}),define("ui/utils",["jquery","jqueryui"],function(e){function t(t,n){return e("<label>",{"class":"aloha-ui-label"}).append(e("<span>",{"class":"aloha-ui-label-text",text:t})).append(n)}function n(e,t,n){return e.button({label:i(t),text:!(!t.text&&!t.html),icons:{primary:t.icon||t.iconUrl&&"aloha-ui-inline-icon-container"||null,secondary:n&&"aloha-jqueryui-icon ui-icon-triangle-1-s"||null}}),t.iconUrl&&e.button("widget").children(".ui-button-icon-primary").append(r(t.iconUrl)),e}function i(e){return e.html||e.text||e.tooltip}function a(e){var t=i(e);return e.iconUrl&&(t=r(e.iconUrl)+t),t}function r(e){return'<img class="aloha-ui-inline-icon" src="'+e+'">'}function o(t){return e("<button>",t).attr("type","button")}return{wrapWithLabel:t,makeButton:n,makeButtonElement:o,makeButtonLabel:i,makeButtonLabelWithIcon:a,makeButtonIconFromUrl:r}}),define("ui/vendor/jquery-ui-autocomplete-html",["jquery","jqueryui"],function(e){!function(e){function t(t,n){var i=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(t){return i.test(e("<div>").html(t.label||t.value||t).text())})}var n=e.ui.autocomplete.prototype,i=n._initSource;e.extend(n,{_initSource:function(){this.options.html&&e.isArray(this.options.source)?this.source=function(e,n){n(t(this.options.source,e.term))}:i.call(this)},_renderItem:function(t,n){return e("<li></li>").data("item.autocomplete",n).append(e("<a></a>")[this.options.html?"html":"text"](n.label)).appendTo(t)}})}(e)}),define("ui/port-helper-attribute-field",["jquery","ui/ui","ui/component","ui/scopes","ui/context","ui/utils","aloha/repositorymanager","aloha/selection","aloha/console","ui/vendor/jquery-ui-autocomplete-html"],function(e,t,n,i,a,r,o,s){var l=function(i){function l(e,t){t.item&&x(t.item.obj),p()}function d(){p()}function c(t){e(t.target).is(":visible")&&(g(),C()===X&&k(""))}function u(e){(13==e.keyCode||27==e.keyCode)&&e.preventDefault()}function h(e){H&&$!==C()&&(H=null,$=null),H||j(G,C()),(13==e.keyCode||27==e.keyCode)&&(s.getRangeObject().select(),p())}function p(){m(),W&&U!==e(W).attr(G)&&(H||o.markObject(W),""===C()&&v())}function f(t){var n=e(W);t(n);for(var i=0,a=et.length;a>i;i++)t(e(et[i]))}function g(){var t=e(W);J&&f(function(e){e.addClass(J)}),Q||(m(),t.context&&t.context.style&&t.context.style["background-color"]&&f(function(e){e.attr("data-original-background-color",e.context.style["background-color"])}),f(function(e){e.css("background-color","#80B5F2")}))}function m(){var t=e(W);if(J&&f(function(e){e.removeClass(J)}),!Q){var n=t.attr("data-original-background-color");f(function(e){e.css("background-color",n||"")}),t.attr("style")||f(function(e){e.removeAttr("style")}),f(function(e){e.removeAttr("data-original-background-color")})}}function b(e,t){return e.replace(/\{([^}]+)\}/g,function(e,n){return n in t?t[n]:""})}function v(){null!==X&&(Z.css("color","#AAA"),Z.val(X))}function y(e){q=e}function _(e){Y=e}function w(t,n){Z.bind(t,e.proxy(n,tt))}function C(){return Z.val()}function k(e){Z.val(e),Z.css("color","black")}function x(e){if(H=e,e){var t=e[V];k(t),$=t,j(G,e[K]),o.markObject(W,e),Z.trigger("item-change")}else $=null}function S(){return H}function j(t,n,i,a){W&&("undefined"==typeof a||a.match(new RegExp(i))?f(function(e){e.attr(t,n)}):e(W).removeAttr(t))}function N(t,n){return W=t,G=n,et=[],x(null),t&&n?(U=e(t).attr(n),k(e(W).attr(G)),void o.getObject(t,function(e){e&&e.length>0&&x(e[0])})):void k("")}function T(e){et.push(e)}function E(){return W}function A(){L.focus(),Z.focus()}function D(){L.foreground()}function O(){Z.show()}function I(){Z.hide()}function M(){Z.attr("disabled","disabled")}function R(){Z.removeAttr("disabled")}function P(){return Z.attr("id")}function F(){return!0}function z(){return Z[0]}function B(){return Z}var L,q,H,$,W,G,U,K=i.valueField||"id",V=i.displayField||"name",Y=i.objectTypeFilter||["all"],X=i.placeholder,Q=!!i.noTargetHighlight,J=i.targetHighlightClass,Z=e(i.element?i.element:'<input id="aloha-attribute-field-'+i.name+'">'),et=[];i.cls&&Z.addClass(i.cls),i.width&&Z.width(i.width),L=t.adopt(i.name,n,{scope:i.scope,init:function(){i.element?this.element=Z:i.label?(this.element=r.wrapWithLabel(i.label,Z),i.labelClass&&this.element.addClass(i.labelClass)):this.element=e("<span>").append(Z),Z.autocomplete({html:!0,appendTo:a.selector,source:function(t,n){o.query({queryString:t.term,objectTypeFilter:Y},function(t){n(e.map(t.items,function(e){return{label:b(q,e),value:e.name,obj:e}}))})},open:i.open,select:l})}}),Z.bind("focus",c).bind("blur",d).bind("keydown",u).bind("keyup",h),v(),Aloha.bind("aloha-editable-deactivated",d);var tt={getInputElem:z,hasInputElem:F,getInputId:P,hide:I,show:O,foreground:D,focus:A,getTargetObject:E,setTargetObject:N,addAdditionalTargetObject:T,setAttribute:j,getItem:S,setItem:x,setValue:k,getValue:C,addListener:w,setObjectTypeFilter:_,setTemplate:y,setPlaceholder:v,getInputJQuery:B,enableInput:R,disableInput:M};return tt};return l}),define("ui/button",["jquery","ui/component","ui/utils","jqueryui"],function(e,t,n){var i=t.extend({init:function(){this._super(),this.createButtonElement(),n.makeButton(this.buttonElement,this).button("widget").tooltip({tooltipClass:"aloha aloha-ui-tooltip",position:{my:"left top",at:"right bottom"}}).zIndex(0).click(e.proxy(function(){this.closeTooltip(),this._onClick()},this))},closeTooltip:function(){this.buttonElement.tooltip("close",null,!0)},_onClick:function(){this.click()},click:function(){},createButtonElement:function(){var e=n.makeButtonElement();this["class"]&&e.addClass(this["class"]),this.element=this.buttonElement=e;var t=this;return e.bind("mouseleave",function(){t.closeTooltip()}),e},disable:function(){this.element.button("option","disabled",!1)},enable:function(e){this.element.button("option","disabled",e===!1)}});return i}),define("ui/toggleButton",["jquery","ui/button","jqueryui"],function(e,t){var n=t.extend({_checked:!1,setState:function(e){this._checked!==e&&(this._checked=e,e?this.element.addClass("aloha-button-active"):this.element.removeClass("aloha-button-active"))},getState:function(){return this._checked},_onClick:function(){this.setState(!this._checked),this.click()}});return n}),define("link/nls/i18n",{root:{"button.addlink.tooltip":"Insert Link","button.removelink.tooltip":"Remove Link","newlink.defaulttext":"New Link","floatingmenu.tab.link":"Link","link.target.self":"Self","link.target.blank":"Blank","link.target.parent":"Parent","link.target.top":"Top","link.target.framename":"Framename","link.target.legend":"Target","link.title.legend":"Title","href.lang.legend":"Language",insertLink:"ctrl+k"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("aloha/nls/i18n",{root:{"plugin.abbr.floatingmenu.tab.abbr":"Abbreviation","floatingmenu.tab.format":"Format","floatingmenu.tab.insert":"Insert",yes:"Yes",no:"No",cancel:"Cancel","repository.no_item_found":"No item found.","repository.loading":"Loading","repository.no_items_found_yet":"No items found yet..."},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("util/keys",["jquery"],function(e){function t(e){return n[e]}var n=function(){var t={};return e.each({8:"backspace",9:"tab",13:"enter",16:"shift control alt",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",37:"left up right down",45:"insert",46:"delete",48:"0 1 2 3 4 5 6 7 8 9",65:"a b c d e f g h i j k l m n o p q r s t u v w x y z",112:"f1 f2 f3 f4 f5 f6 f7 f8 f9 f10 f11 f12 f13 f14 f15"},function(n,i){var a=parseInt(n,10);e.each(i.split(" "),function(e,n){t[a+e]=n})}),t}();return{getToken:t,keyCodeTokenMap:e.extend({},n)}}),define("link/../../../shared/languages/./iso639-1-de",[],function(){var e={aa:{name:"Afar"},ab:{name:"Abchasen"},af:{name:"Afrikaans"},ak:{name:"Akan"},sq:{name:"Albanisch"},am:{name:"Amharisch"},ar:{name:"Arabisch",flag:"ae"},an:{name:"Aragonesisch"},hy:{name:"Armenisch"},as:{name:"Assamesisch"},av:{name:"Avarisch"},ae:{name:"Avestan"},ay:{name:"Aymara"},az:{name:"Aserbaidschanisch"},ba:{name:"Baschkirisch"},bm:{name:"Bambara"},eu:{name:"Baskisch"},be:{name:"Weißrussisch",flag:"by"},bn:{name:"Bengalisch"},bh:{name:"Bihari Sprachen"},bi:{name:"Bislama"},bs:{name:"Bosnisch"},br:{name:"Bretonisch"},bg:{name:"Bulgarisch",flag:"bg"},my:{name:"Birmanisch"},ca:{name:"Katalanisch, Valencia",flag:"es"},ch:{name:"Chamorro"},ce:{name:"Tschetschenisch"},zh:{name:"Chinesisch"},cu:{name:"Kirchenslawisch; Altslawisch; Altbulgarisch; Altkirchenslawisch"},cv:{name:"Tschuwaschische Sprache"},kw:{name:"Cornish"},co:{name:"Korsisch"},cr:{name:"Cree"},cs:{name:"Tschechisch"},da:{name:"Dänisch",flag:"dk"},dv:{name:"Divehi; Dhivehi; maledivische"},nl:{name:"Niederländisch, Flämisch"},dz:{name:"Dzongkha"},en:{name:"Englisch",flag:"gb"},eo:{name:"Esperanto"},et:{name:"Estnisch",flag:"ee"},ee:{name:"Ewe"},fo:{name:"Färöisch"},fj:{name:"Fidschi"},fi:{name:"Finnisch",flag:"fi"},fr:{name:"Französisch"},fy:{name:"Westfriesisch"},ff:{name:"Fulah"},ka:{name:"Georgisch"},de:{name:"Deutsch",flag:"de"},gd:{name:"Gälisch, Schottisch-Gälisch"},ga:{name:"Irisch",flag:"ie"},gl:{name:"Galizisch"},gv:{name:"Manx"},el:{name:"Griechisch, Modern (1453 -)"},gn:{name:"Guarani"},gu:{name:"Gujarati"},ht:{name:"Haitianisch"},ha:{name:"Hausa"},he:{name:"Hebräisch",flag:"il"},hz:{name:"Herero"},hi:{name:"Hindi",flag:"in"},ho:{name:"Hiri Motu"},hr:{name:"Kroatisch",flag:"hr"},hu:{name:"Ungarisch",flag:"hu"},ig:{name:"Igbo"},is:{name:"Isländisch"},io:{name:"Ido"},ii:{name:"Sichuan Yi; Nuosu"},iu:{name:"Inuktitut"},ie:{name:"Interlingue; Okzidental"},ia:{name:"Interlingua (International Auxiliary Language Association)"},id:{name:"Indonesisch",flag:"id"},ik:{name:"Inupiaq"},it:{name:"Italienisch",flag:"it"},jv:{name:"Javaner"},ja:{name:"Japanisch",flag:"jp"},kl:{name:"Kalaallisut; Grönländisch"},kn:{name:"Kannada"},ks:{name:"Kashmiri"},kr:{name:"Kanuri"},kk:{name:"Kasachisch"},km:{name:"Mittel-Khmer"},ki:{name:"Kikuyu; Gikuyu"},rw:{name:"Kinyarwanda"},ky:{name:"Kirgisisch"},kv:{name:"Komi"},kg:{name:"Kongo"},ko:{name:"Koreanisch",flag:"kr"},kj:{name:"Kuanyama; Kwanyama"},ku:{name:"Kurdisch"},lo:{name:"Lao"},la:{name:"Latein"},lv:{name:"Lettisch",flag:"lv"},li:{name:"Limburgisch"},ln:{name:"Lingála"},lt:{name:"Litauisch",flag:"lt"},lb:{name:"Luxemburgisch, Lëtzebuergesch"},lu:{name:"Luba-Katanga"},lg:{name:"Ganda"},mk:{name:"Mazedonisch"},mh:{name:"Marshallese"},ml:{name:"Malayalam"},mi:{name:"Maori"},mr:{name:"Marathi"},ms:{name:"Malaiisch"},mg:{name:"Malagasy"},mt:{name:"Maltesisch",flag:"mt"},mn:{name:"Mongolisch"},na:{name:"Nauru"},nv:{name:"Navajo; Navaho"},nr:{name:"Ndebele, Süd, Süd-Ndebele"},nd:{name:"Ndebele, Nord, Nord-Ndebele"},ng:{name:"Ndonga"},ne:{name:"Nepali"},nn:{name:"Norwegisch Nynorsk"},nb:{name:"Bokmål, Norwegisch, Norwegisch Bokmål"},no:{name:"Norwegisch",flag:"no"},ny:{name:"Chichewa; Chewa; Nyanja"},oc:{name:"Occitan (post 1500); provenzalischen"},oj:{name:"Ojibwa"},or:{name:"Oriya"},om:{name:"Oromo"},os:{name:"Ossetisch"},pa:{name:"Panjabi, Punjabi"},fa:{name:"Persisch"},pi:{name:"Pali"},pl:{name:"Polnisch",flag:"pl"},pt:{name:"Portugiesisch",flag:"pt"},ps:{name:"Paschtu, Paschtu"},qu:{name:"Quechua"},rm:{name:"Rätoromanisch"},ro:{name:"Rumänisch; Moldawisch; Moldauisch"},rn:{name:"Rundi"},ru:{name:"Russisch",flag:"ru"},sg:{name:"Sango"},sa:{name:"Sanskrit"},si:{name:"Singhalesisch"},sk:{name:"Slowakisch"},sl:{name:"Slowenisch",flag:"si"},se:{name:"Nord Sami"},sm:{name:"Samoaner"},sn:{name:"Shona"},sd:{name:"Sindhi"},so:{name:"Somali"},st:{name:"Sotho, Südlich"},es:{name:"Spanisch, Kastilisch",flag:"es"},sc:{name:"Sardisch"},sr:{name:"Serbisch",flag:"rs"},ss:{name:"Swati"},su:{name:"Sundanesisch"},sw:{name:"Swahili"},sv:{name:"Schwedisch",flag:"se"},ty:{name:"Tahitianisch"},ta:{name:"Tamilisch"},tt:{name:"Tatar"},te:{name:"Telugu"},tg:{name:"Tadschikisch"},tl:{name:"Tagalog"},th:{name:"Thailändisch",flag:"th"},bo:{name:"Tibetisch"},ti:{name:"Tigrinya"},to:{name:"Tonga (Tonga-Inseln)"},tn:{name:"Tswana"},ts:{name:"Tsonga"},tk:{name:"Turkmenisch"},tr:{name:"Türkisch",flag:"tr"},tw:{name:"Twi"},ug:{name:"Uigurisch"},uk:{name:"Ukrainisch",flag:"ua"},ur:{name:"Urdu"},uz:{name:"Usbekisch"},ve:{name:"Venda"},vi:{name:"Vietnamesisch",flag:"vn"},vo:{name:"Volapük"},cy:{name:"Walisisch"},wa:{name:"Wallonisch"},wo:{name:"Wolof"},xh:{name:"Xhosa"},yi:{name:"Jiddisch"},yo:{name:"Yoruba"},za:{name:"Zhuang; Chuang"},zu:{name:"Zulu"}};return e}),define("link/../../../shared/languages/./iso639-2-de",[],function(){var e={aar:{name:"Afar"},abk:{name:"Abchasen"},ace:{name:"Achinese"},ach:{name:"Acholi"},ada:{name:"Adangme"},ady:{name:"Adyghe; Adygei"},afa:{name:"Afro-Asiatische Sprachen"},afh:{name:"Afrihili"},afr:{name:"Afrikaans"},ain:{name:"Ainu"},aka:{name:"Akan"},akk:{name:"Akkadisch"},alb:{name:"Albanisch"},sqi:{name:"Albanisch",flag:"al"},ale:{name:"Aleutisch"},alg:{name:"Algonkin-Sprachen"},alt:{name:"Südaltai"},amh:{name:"Amharisch"},ang:{name:"Englisch, Alt (ca.450-1100)"},anp:{name:"Angika"},apa:{name:"Apache Sprachen"},ara:{name:"Arabisch",flag:"ae"},arc:{name:"Offizielles Aramäisch (700-300 v. Chr.); Reichsaramäisch (700-300 v. Chr.)"},arg:{name:"Aragonesisch"},arm:{name:"Armenisch"},hye:{name:"Armenisch"},arn:{name:"Mapudungun; Mapuche"},arp:{name:"Arapaho"},art:{name:"Künstliche Sprachen"},arw:{name:"Arawak"},asm:{name:"Assamesisch"},ast:{name:"Asturisch"},ath:{name:"Athapascan Sprachen"},aus:{name:"Australische Sprachen"},ava:{name:"Avarisch"},ave:{name:"Avestan"},awa:{name:"Awadhi"},aym:{name:"Aymara"},aze:{name:"Aserbaidschanisch"},bad:{name:"Banda Sprachen"},bai:{name:"Bamileke Sprachen"},bak:{name:"Baschkirisch"},bal:{name:"Baluchi"},bam:{name:"Bambara"},ban:{name:"Balinesisch"},baq:{name:"Baskisch"},eus:{name:"Baskisch"},bas:{name:"Basa"},bat:{name:"Baltische Sprachen"},bej:{name:"Beja; Bedawiyet"},bel:{name:"Weißrussisch",flag:"by"},bem:{name:"Bemba"},ben:{name:"Bengalisch"},ber:{name:"Berbersprachen"},bho:{name:"Bhojpuri"},bih:{name:"Bihari Sprachen"},bik:{name:"Bikol"},bin:{name:"Bini, Edo"},bis:{name:"Bislama"},bla:{name:"Siksika"},bnt:{name:"Bantusprachen"},bos:{name:"Bosnisch"},bra:{name:"Braj"},bre:{name:"Bretonisch"},btk:{name:"Batak Sprachen"},bua:{name:"Buriatisch"},bug:{name:"Buginesisch"},bul:{name:"Bulgarisch",flag:"bg"},bur:{name:"Birmanisch"},mya:{name:"Birmanisch"},byn:{name:"Blin; Bilin"},cad:{name:"Caddo"},cai:{name:"Zentralamerikanische indische Sprachen"},car:{name:"Galibi Carib"},cat:{name:"Katalanisch, Valencia",flag:"es"},cau:{name:"Kaukasische Sprachen"},ceb:{name:"Cebuano"},cel:{name:"Keltische Sprachen"},cha:{name:"Chamorro"},chb:{name:"Chibcha"},che:{name:"Tschetschenisch"},chg:{name:"Dschag."},chi:{name:"Chinesisch"},zho:{name:"Chinesisch",flag:"cn"},chk:{name:"Chuukese"},chm:{name:"Mari"},chn:{name:"Chinook-Jargon"},cho:{name:"Choctaw"},chp:{name:"Chipewyan; Dene Suline"},chr:{name:"Cherokee"},chu:{name:"Kirchenslawisch; Altslawisch; Altbulgarisch; Altkirchenslawisch"},chv:{name:"Tschuwaschische Sprache"},chy:{name:"Cheyenne"},cmc:{name:"Chamic Sprachen"},cop:{name:"Koptisch"},cor:{name:"Cornish"},cos:{name:"Korsisch"},cpe:{name:"Kreolsprachen, englisch-basiert"},cpf:{name:"Kreolsprachen, französisch-basiert"},cpp:{name:"Kreolsprachen, portugiesisch-basiert"},cre:{name:"Cree"},crh:{name:"Krimtatarisch; Krim-türkisch"},crp:{name:"Kreolsprachen"},csb:{name:"Kaschubisch"},cus:{name:"Kuschitische Sprachen"},cze:{name:"Tschechisch"},ces:{name:"Tschechisch",flag:"cz"},dak:{name:"Dakota"},dan:{name:"Dänisch",flag:"dk"},dar:{name:"Dargwa"},day:{name:"Land Dayak Sprachen"},del:{name:"Delaware"},den:{name:"Slave (Athapascan)"},dgr:{name:"Dogrib"},din:{name:"Dinka"},div:{name:"Divehi; Dhivehi; maledivische"},doi:{name:"Dogri"},dra:{name:"Dravidische Sprachen"},dsb:{name:"Niedersorbisch"},dua:{name:"Duala"},dum:{name:"Niederländisch, Mittel (ca.1050-1350)"},dut:{name:"Niederländisch, Flämisch"},nld:{name:"Niederländisch, Flämisch",flag:"nl"},dyu:{name:"Dyula"},dzo:{name:"Dzongkha"},efi:{name:"Efik"},egy:{name:"Ägyptisch (Altertümlich)"},eka:{name:"Ekajuk"},elx:{name:"Elamite"},eng:{name:"Englisch",flag:"gb"},enm:{name:"Englisch, Mittle (1100-1500)"},epo:{name:"Esperanto"},est:{name:"Estnisch",flag:"ee"},ewe:{name:"Ewe"},ewo:{name:"Ewondo"},fan:{name:"Fang"},fao:{name:"Färöisch"},fat:{name:"Fanti"},fij:{name:"Fidschi"},fil:{name:"Filipinisch"},fin:{name:"Finnisch",flag:"fi"},fiu:{name:"Finno-ugrischen Sprachen"},fon:{name:"Fon"},fre:{name:"Französisch"},fra:{name:"Französisch",flag:"fr"},frm:{name:"Französisch, Mittel (ca.1400-1600)"},fro:{name:"Französisch, Alt (842-ca.1400)"},frr:{name:"Nordfriesisch"},frs:{name:"Ostfriesisch"},fry:{name:"Westfriesisch"},ful:{name:"Fulah"},fur:{name:"Friaulisch"},gaa:{name:"Ga"},gay:{name:"Gayo"},gba:{name:"Gbaya"},gem:{name:"Germanische Sprachen"},geo:{name:"Georgisch"},kat:{name:"Georgisch"},ger:{name:"Deutsch",flag:"de"},deu:{name:"Deutsch",flag:"de"},gez:{name:"Geez"},gil:{name:"Gilbertesisch"},gla:{name:"Gälisch, Schottisch-Gälisch"},gle:{name:"Irisch",flag:"ie"},glg:{name:"Galizisch"},glv:{name:"Manx"},gmh:{name:"Deutsch, Mittlehoch (ca.1050-1500)"},goh:{name:"Deutsch, Althoch (ca.750-1050)"},gon:{name:"Gondi"},gor:{name:"Gorontalo"},got:{name:"Gotisch"},grb:{name:"Grebo"},grc:{name:"Altgriechisch (bis 1453)"},gre:{name:"Griechisch, Modern (1453 -)"},ell:{name:"Griechisch, Modern (1453 -)",flag:"gr"},grn:{name:"Guarani"},gsw:{name:"Schweizerdeutsch, Alemannisch, Elsässisch"},guj:{name:"Gujarati"},gwi:{name:"Gwich'in"},hai:{name:"Haida"},hat:{name:"Haitianisch"},hau:{name:"Hausa"},haw:{name:"Hawaii"},heb:{name:"Hebräisch",flag:"il"},her:{name:"Herero"},hil:{name:"Hiligaynon"},him:{name:"Himachali Sprachen; Pahari westliche Sprachen"},hin:{name:"Hindi",flag:"in"},hit:{name:"Hethitisch"},hmn:{name:"Hmong, Mong"},hmo:{name:"Hiri Motu"},hrv:{name:"Kroatisch",flag:"hr"},hsb:{name:"Obersorbisch"},hun:{name:"Ungarisch",flag:"hu"},hup:{name:"Hupa"},iba:{name:"Iban"},ibo:{name:"Igbo"},ice:{name:"Isländisch"},isl:{name:"Isländisch",flag:"is"},ido:{name:"Ido"},iii:{name:"Sichuan Yi; Nuosu"},ijo:{name:"Ijo Sprachen"},iku:{name:"Inuktitut"},ile:{name:"Interlingue; Okzidental"},ilo:{name:"Iloko"},ina:{name:"Interlingua (International Auxiliary Language Association)"},inc:{name:"Indische Sprachen"},ind:{name:"Indonesisch",flag:"id"},ine:{name:"Indoeuropäische Sprachen"},inh:{name:"Inguschisch"},ipk:{name:"Inupiaq"},ira:{name:"Iranische Sprachen"},iro:{name:"Irokesen Sprachen"},ita:{name:"Italienisch",flag:"it"},jav:{name:"Javaner"},jbo:{name:"Lojban"},jpn:{name:"Japanisch",flag:"jp"},jpr:{name:"Jüdisch-persisch"},jrb:{name:"Jüdisch-arabisch"},kaa:{name:"Kara-Kalpak"},kab:{name:"Kabyle"},kac:{name:"Kachin; Jingpho"},kal:{name:"Kalaallisut; Grönländisch"},kam:{name:"Kamba"},kan:{name:"Kannada"},kar:{name:"Karen Sprachen"},kas:{name:"Kashmiri"},kau:{name:"Kanuri"},kaw:{name:"Kawi"},kaz:{name:"Kasachisch"},kbd:{name:"Kabardinisch"},kha:{name:"Khasi"},khi:{name:"Khoisan-Sprache"},khm:{name:"Mittel-Khmer"},kho:{name:"Khotanesisch; Sakan"},kik:{name:"Kikuyu; Gikuyu"},kin:{name:"Kinyarwanda"},kir:{name:"Kirgisisch"},kmb:{name:"Kimbundu"},kok:{name:"Konkani"},kom:{name:"Komi"},kon:{name:"Kongo"},kor:{name:"Koreanisch",flag:"kr"},kos:{name:"Kosraeanisch"},kpe:{name:"Kpelle"},krc:{name:"Karatschai-Balkar"},krl:{name:"Karelisch"},kro:{name:"Kru Sprachen"},kru:{name:"Kurukh"},kua:{name:"Kuanyama; Kwanyama"},kum:{name:"Kumykisch"},kur:{name:"Kurdisch"},kut:{name:"Kutenai"},lad:{name:"Ladino"},lah:{name:"Lahnda"},lam:{name:"Lamba"},lao:{name:"Lao"},lat:{name:"Latein"},lav:{name:"Lettisch",flag:"lv"},lez:{name:"Lesgisch"},lim:{name:"Limburgisch"},lin:{name:"Lingála"},lit:{name:"Litauisch",flag:"lt"},lol:{name:"Mongo"},loz:{name:"Lozi"},ltz:{name:"Luxemburgisch, Lëtzebuergesch"},lua:{name:"Luba-Lulua"},lub:{name:"Luba-Katanga"},lug:{name:"Ganda"},lui:{name:"Luiseno"},lun:{name:"Lunda"},luo:{name:"Luo (Kenia und Tansania)"},lus:{name:"Lushai"},mac:{name:"Mazedonisch"},mkd:{name:"Mazedonisch",flag:"mk"},mad:{name:"Maduresisch"},mag:{name:"Magahi"},mah:{name:"Marshallese"},mai:{name:"Maithili"},mak:{name:"Makasar"},mal:{name:"Malayalam"},man:{name:"Mandingo"},mao:{name:"Maori"},mri:{name:"Maori"},map:{name:"Austronesische Sprachen"},mar:{name:"Marathi"},mas:{name:"Masai"},may:{name:"Malaiisch"},msa:{name:"Malaiisch",flag:"my"},mdf:{name:"Moksha"},mdr:{name:"Mandar"},men:{name:"Mende"},mga:{name:"Irisch, Mittel (900-1200)"},mic:{name:"Mi'kmaq; Micmac"},min:{name:"Minangkabau"},mis:{name:"Unkodierte Sprachen"},mkh:{name:"Mon-Khmer-Sprachen"},mlg:{name:"Malagasy"},mlt:{name:"Maltesisch",flag:"mt"},mnc:{name:"Manchu"},mni:{name:"Manipuri"},mno:{name:"Manobo Sprachen"},moh:{name:"Mohawk"},mon:{name:"Mongolisch"},mos:{name:"Mossi"},mul:{name:"Mehrere Sprachen"},mun:{name:"Munda-Sprachen"},mus:{name:"Bach"},mwl:{name:"Mirandesisch"},mwr:{name:"Marwari"},myn:{name:"Maya-Sprachen"},myv:{name:"Erzya"},nah:{name:"Nahuatl Sprachen"},nai:{name:"Nordamerikanische Indianer Sprachen"},nap:{name:"Neapolitanisch"},nau:{name:"Nauru"},nav:{name:"Navajo; Navaho"},nbl:{name:"Ndebele, Süd, Süd-Ndebele"},nde:{name:"Ndebele, Nord, Nord-Ndebele"},ndo:{name:"Ndonga"},nds:{name:"Plattdeutsch; Niedersächsisch, Deutsch"},nep:{name:"Nepali"},"new":{name:"Nepal Bhasa; Newari"},nia:{name:"Nias"},nic:{name:"Niger-Kordofanianische Sprachen"},niu:{name:"Niuean"},nno:{name:"Norwegisch Nynorsk"},nob:{name:"Bokmål, Norwegisch, Norwegisch Bokmål"},nog:{name:"Nogai"},non:{name:"Norwegisch, Alt"},nor:{name:"Norwegisch",flag:"no"},nqo:{name:"N'Ko"},nso:{name:"Pedi; Sepedi; Nord Sotho"},nub:{name:"Nubische Sprachen"},nwc:{name:"Klassische Newari; Alt Newari; Klassische Nepal Bhasa"},nya:{name:"Chichewa; Chewa; Nyanja"},nym:{name:"Nyamwezi"},nyn:{name:"Nyankole"},nyo:{name:"Nyoro"},nzi:{name:"Nzima"},oci:{name:"Occitan (post 1500); provenzalischen"},oji:{name:"Ojibwa"},ori:{name:"Oriya"},orm:{name:"Oromo"},osa:{name:"Osage"},oss:{name:"Ossetisch"},ota:{name:"Türkisch, osmanische (1500-1928)"},oto:{name:"Otomian Sprachen"},paa:{name:"Papua-Sprachen"},pag:{name:"Pangasinan"},pal:{name:"Pahlavi"},pam:{name:"Pampanga; Kapampangan"},pan:{name:"Panjabi, Punjabi"},pap:{name:"Papiamento"},pau:{name:"Palau"},peo:{name:"Persisch, Alt (ca.600-400 v. Chr.)"},per:{name:"Persisch"},fas:{name:"Persisch"},phi:{name:"Philippinische Sprachen"},phn:{name:"Phönizisch"},pli:{name:"Pali"},pol:{name:"Polnisch",flag:"pl"},pon:{name:"Pohnpeian"},por:{name:"Portugiesisch",flag:"pt"},pra:{name:"Prakrit Sprachen"},pro:{name:"Provençal, Alt (bis 1500)"},pus:{name:"Paschtu, Paschtu"},"qaa-qtz":{name:"Reserviert für den lokalen Gebrauch"},que:{name:"Quechua"},raj:{name:"Rajasthani"},rap:{name:"Rapanui"},rar:{name:"Rarotongan; Cook Islands Maori"},roa:{name:"Romanische Sprachen"},roh:{name:"Rätoromanisch"},rom:{name:"Roma"},rum:{name:"Rumänisch; Moldawisch; Moldauisch"},ron:{name:"Rumänisch; Moldawisch; Moldauisch",flag:"ro"},run:{name:"Rundi"},rup:{name:"Aromunischen; Arumanian; Macedo-Rumänischen"},rus:{name:"Russisch",flag:"ru"},sad:{name:"Sandawe"},sag:{name:"Sango"},sah:{name:"Yakut"},sai:{name:"Südamerikanische Indianer (Andere)"},sal:{name:"Salishan Sprachen"},sam:{name:"Samariter Aramäisch"},san:{name:"Sanskrit"},sas:{name:"Sasak"},sat:{name:"Santali"},scn:{name:"Sizilianisch"},sco:{name:"Schottisch"},sel:{name:"Selkupisch"},sem:{name:"Semitische Sprachen"},sga:{name:"Irisch, Alt (bis 900)"},sgn:{name:"Registrierte Sprachen"},shn:{name:"Shan"},sid:{name:"Sidamo"},sin:{name:"Singhalesisch"},sio:{name:"Sioux-Sprachen"},sit:{name:"Sino-tibetische Sprachen"},sla:{name:"Slawische Sprachen"},slo:{name:"Slowakisch"},slk:{name:"Slowakisch",flag:"sk"},slv:{name:"Slowenisch",flag:"si"},sma:{name:"Süd Sami"},sme:{name:"Nord Sami"},smi:{name:"Sami Sprachen"},smj:{name:"Lulesamisch"},smn:{name:"Inari-Samen"},smo:{name:"Samoaner"},sms:{name:"Skolt Sami"},sna:{name:"Shona"},snd:{name:"Sindhi"},snk:{name:"Soninke"},sog:{name:"Sogdisch"},som:{name:"Somali"},son:{name:"Songhai Sprachen"},sot:{name:"Sotho, Südlich"},spa:{name:"Spanisch, Kastilisch",flag:"es"},srd:{name:"Sardisch"},srn:{name:"Sranan Tongo"},srp:{name:"Serbisch",flag:"rs"},srr:{name:"Serer"},ssa:{name:"Nilosaharanische Sprachen"},ssw:{name:"Swati"},suk:{name:"Sukuma"},sun:{name:"Sundanesisch"},sus:{name:"Susu"},sux:{name:"Sumerisch"},swa:{name:"Swahili"},swe:{name:"Schwedisch",flag:"se"},syc:{name:"Klassisch Syrisch"},syr:{name:"Syrisch"},tah:{name:"Tahitianisch"},tai:{name:"Tai Sprachen"},tam:{name:"Tamilisch"},tat:{name:"Tatar"},tel:{name:"Telugu"},tem:{name:"Timne"},ter:{name:"Tereno"},tet:{name:"Tetum"},tgk:{name:"Tadschikisch"},tgl:{name:"Tagalog"},tha:{name:"Thailändisch",flag:"th"},tib:{name:"Tibetisch"},bod:{name:"Tibetisch"},tig:{name:"Tigre"},tir:{name:"Tigrinya"},tiv:{name:"Tiv"},tkl:{name:"Tokelau"},tlh:{name:"Klingonisch; tlhIngan-Hol"},tli:{name:"Tlingit"},tmh:{name:"Tamashek"},tog:{name:"Tonga (Nyasa)"},ton:{name:"Tonga (Tonga-Inseln)"},tpi:{name:"Tok Pisin"},tsi:{name:"Tsimshian"},tsn:{name:"Tswana"},tso:{name:"Tsonga"},tuk:{name:"Turkmenisch"},tum:{name:"Tumbuka"},tup:{name:"Tupi-Sprachen"},tur:{name:"Türkisch",flag:"tr"},tut:{name:"Altaische Sprachen"},tvl:{name:"Tuvalu"},twi:{name:"Twi"},tyv:{name:"Tuvinisch"},udm:{name:"Udmurtisch"},uga:{name:"Ugaritisch"},uig:{name:"Uigurisch"},ukr:{name:"Ukrainisch",flag:"ua"},umb:{name:"Umbundu"},und:{name:"Unbestimmt"},urd:{name:"Urdu"},uzb:{name:"Usbekisch"},vai:{name:"Vai"},ven:{name:"Venda"},vie:{name:"Vietnamesisch",flag:"vn"},vol:{name:"Volapük"},vot:{name:"Wotisch"},wak:{name:"Wakashan Sprachen"},wal:{name:"Walamo"},war:{name:"Waray"},was:{name:"Washo"},wel:{name:"Walisisch"},cym:{name:"Walisisch"},wen:{name:"Sorbische Sprachen"},wln:{name:"Wallonisch"},wol:{name:"Wolof"},xal:{name:"Kalmücken; Oirat"},xho:{name:"Xhosa"},yao:{name:"Yao"},yap:{name:"Yap"},yid:{name:"Jiddisch"},yor:{name:"Yoruba"},ypk:{name:"Yupik Sprachen"},zap:{name:"Zapoteken"},zbl:{name:"Bliss-Symbole; Blissymbolics; Bliss"},zen:{name:"Zenaga"},zha:{name:"Zhuang; Chuang"},znd:{name:"Zande Sprachen"},zul:{name:"Zulu"},zun:{name:"Zuni"},zxx:{name:"Kein sprachlicher Inhalt; Entfällt"},zza:{name:"Zaza; Dimili; Dimli; Kirdki; Kirmanjki; Zazaki"}};
return e}),define("link/../../../shared/languages/./iso639-1-en",[],function(){var e={aa:{name:"Afar"},ab:{name:"Abkhazian"},af:{name:"Afrikaans"},ak:{name:"Akan"},sq:{name:"Albanian"},am:{name:"Amharic"},ar:{name:"Arabic",flag:"ae"},an:{name:"Aragonese"},hy:{name:"Armenian"},as:{name:"Assamese"},av:{name:"Avaric"},ae:{name:"Avestan"},ay:{name:"Aymara"},az:{name:"Azerbaijani"},ba:{name:"Bashkir"},bm:{name:"Bambara"},eu:{name:"Basque"},be:{name:"Belarusian",flag:"by"},bn:{name:"Bengali"},bh:{name:"Bihari languages"},bi:{name:"Bislama"},bs:{name:"Bosnian"},br:{name:"Breton"},bg:{name:"Bulgarian",flag:"bg"},my:{name:"Burmese"},ca:{name:"Catalan; Valencian",flag:"es"},ch:{name:"Chamorro"},ce:{name:"Chechen"},zh:{name:"Chinese"},cu:{name:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic"},cv:{name:"Chuvash"},kw:{name:"Cornish"},co:{name:"Corsican"},cr:{name:"Cree"},cs:{name:"Czech"},da:{name:"Danish",flag:"dk"},dv:{name:"Divehi; Dhivehi; Maldivian"},nl:{name:"Dutch; Flemish"},dz:{name:"Dzongkha"},en:{name:"English",flag:"gb"},eo:{name:"Esperanto"},et:{name:"Estonian",flag:"ee"},ee:{name:"Ewe"},fo:{name:"Faroese"},fj:{name:"Fijian"},fi:{name:"Finnish",flag:"fi"},fr:{name:"French"},fy:{name:"Western Frisian"},ff:{name:"Fulah"},ka:{name:"Georgian"},de:{name:"German",flag:"de"},gd:{name:"Gaelic; Scottish Gaelic"},ga:{name:"Irish",flag:"ie"},gl:{name:"Galician"},gv:{name:"Manx"},el:{name:"Greek, Modern (1453-)"},gn:{name:"Guarani"},gu:{name:"Gujarati"},ht:{name:"Haitian; Haitian Creole"},ha:{name:"Hausa"},he:{name:"Hebrew",flag:"il"},hz:{name:"Herero"},hi:{name:"Hindi",flag:"in"},ho:{name:"Hiri Motu"},hr:{name:"Croatian",flag:"hr"},hu:{name:"Hungarian",flag:"hu"},ig:{name:"Igbo"},is:{name:"Icelandic"},io:{name:"Ido"},ii:{name:"Sichuan Yi; Nuosu"},iu:{name:"Inuktitut"},ie:{name:"Interlingue; Occidental"},ia:{name:"Interlingua (International Auxiliary Language Association)"},id:{name:"Indonesian",flag:"id"},ik:{name:"Inupiaq"},it:{name:"Italian",flag:"it"},jv:{name:"Javanese"},ja:{name:"Japanese",flag:"jp"},kl:{name:"Kalaallisut; Greenlandic"},kn:{name:"Kannada"},ks:{name:"Kashmiri"},kr:{name:"Kanuri"},kk:{name:"Kazakh"},km:{name:"Central Khmer"},ki:{name:"Kikuyu; Gikuyu"},rw:{name:"Kinyarwanda"},ky:{name:"Kirghiz; Kyrgyz"},kv:{name:"Komi"},kg:{name:"Kongo"},ko:{name:"Korean",flag:"kr"},kj:{name:"Kuanyama; Kwanyama"},ku:{name:"Kurdish"},lo:{name:"Lao"},la:{name:"Latin"},lv:{name:"Latvian",flag:"lv"},li:{name:"Limburgan; Limburger; Limburgish"},ln:{name:"Lingala"},lt:{name:"Lithuanian",flag:"lt"},lb:{name:"Luxembourgish; Letzeburgesch"},lu:{name:"Luba-Katanga"},lg:{name:"Ganda"},mk:{name:"Macedonian"},mh:{name:"Marshallese"},ml:{name:"Malayalam"},mi:{name:"Maori"},mr:{name:"Marathi"},ms:{name:"Malay"},mg:{name:"Malagasy"},mt:{name:"Maltese",flag:"mt"},mn:{name:"Mongolian"},na:{name:"Nauru"},nv:{name:"Navajo; Navaho"},nr:{name:"Ndebele, South; South Ndebele"},nd:{name:"Ndebele, North; North Ndebele"},ng:{name:"Ndonga"},ne:{name:"Nepali"},nn:{name:"Norwegian Nynorsk; Nynorsk, Norwegian"},nb:{name:"Bokmål, Norwegian; Norwegian Bokmål"},no:{name:"Norwegian",flag:"no"},ny:{name:"Chichewa; Chewa; Nyanja"},oc:{name:"Occitan (post 1500); Provençal"},oj:{name:"Ojibwa"},or:{name:"Oriya"},om:{name:"Oromo"},os:{name:"Ossetian; Ossetic"},pa:{name:"Panjabi; Punjabi"},fa:{name:"Persian"},pi:{name:"Pali"},pl:{name:"Polish",flag:"pl"},pt:{name:"Portuguese",flag:"pt"},ps:{name:"Pushto; Pashto"},qu:{name:"Quechua"},rm:{name:"Romansh"},ro:{name:"Romanian; Moldavian; Moldovan"},rn:{name:"Rundi"},ru:{name:"Russian",flag:"ru"},sg:{name:"Sango"},sa:{name:"Sanskrit"},si:{name:"Sinhala; Sinhalese"},sk:{name:"Slovak"},sl:{name:"Slovenian",flag:"si"},se:{name:"Northern Sami"},sm:{name:"Samoan"},sn:{name:"Shona"},sd:{name:"Sindhi"},so:{name:"Somali"},st:{name:"Sotho, Southern"},es:{name:"Spanish; Castilian",flag:"es"},sc:{name:"Sardinian"},sr:{name:"Serbian",flag:"rs"},ss:{name:"Swati"},su:{name:"Sundanese"},sw:{name:"Swahili"},sv:{name:"Swedish",flag:"se"},ty:{name:"Tahitian"},ta:{name:"Tamil"},tt:{name:"Tatar"},te:{name:"Telugu"},tg:{name:"Tajik"},tl:{name:"Tagalog"},th:{name:"Thai",flag:"th"},bo:{name:"Tibetan"},ti:{name:"Tigrinya"},to:{name:"Tonga (Tonga Islands)"},tn:{name:"Tswana"},ts:{name:"Tsonga"},tk:{name:"Turkmen"},tr:{name:"Turkish",flag:"tr"},tw:{name:"Twi"},ug:{name:"Uighur; Uyghur"},uk:{name:"Ukrainian",flag:"ua"},ur:{name:"Urdu"},uz:{name:"Uzbek"},ve:{name:"Venda"},vi:{name:"Vietnamese",flag:"vn"},vo:{name:"Volapük"},cy:{name:"Welsh"},wa:{name:"Walloon"},wo:{name:"Wolof"},xh:{name:"Xhosa"},yi:{name:"Yiddish"},yo:{name:"Yoruba"},za:{name:"Zhuang; Chuang"},zu:{name:"Zulu"}};return e}),define("link/../../../shared/languages/./iso639-2-en",[],function(){var e={aar:{name:"Afar"},abk:{name:"Abkhazian"},ace:{name:"Achinese"},ach:{name:"Acoli"},ada:{name:"Adangme"},ady:{name:"Adyghe; Adygei"},afa:{name:"Afro-Asiatic languages"},afh:{name:"Afrihili"},afr:{name:"Afrikaans"},ain:{name:"Ainu"},aka:{name:"Akan"},akk:{name:"Akkadian"},alb:{name:"Albanian"},sqi:{name:"Albanian",flag:"al"},ale:{name:"Aleut"},alg:{name:"Algonquian languages"},alt:{name:"Southern Altai"},amh:{name:"Amharic"},ang:{name:"English, Old (ca.450-1100)"},anp:{name:"Angika"},apa:{name:"Apache languages"},ara:{name:"Arabic",flag:"ae"},arc:{name:"Official Aramaic (700-300 BCE); Imperial Aramaic (700-300 BCE)"},arg:{name:"Aragonese"},arm:{name:"Armenian"},hye:{name:"Armenian"},arn:{name:"Mapudungun; Mapuche"},arp:{name:"Arapaho"},art:{name:"Artificial languages"},arw:{name:"Arawak"},asm:{name:"Assamese"},ast:{name:"Asturian; Bable; Leonese; Asturleonese"},ath:{name:"Athapascan languages"},aus:{name:"Australian languages"},ava:{name:"Avaric"},ave:{name:"Avestan"},awa:{name:"Awadhi"},aym:{name:"Aymara"},aze:{name:"Azerbaijani"},bad:{name:"Banda languages"},bai:{name:"Bamileke languages"},bak:{name:"Bashkir"},bal:{name:"Baluchi"},bam:{name:"Bambara"},ban:{name:"Balinese"},baq:{name:"Basque"},eus:{name:"Basque"},bas:{name:"Basa"},bat:{name:"Baltic languages"},bej:{name:"Beja; Bedawiyet"},bel:{name:"Belarusian",flag:"by"},bem:{name:"Bemba"},ben:{name:"Bengali"},ber:{name:"Berber languages"},bho:{name:"Bhojpuri"},bih:{name:"Bihari languages"},bik:{name:"Bikol"},bin:{name:"Bini; Edo"},bis:{name:"Bislama"},bla:{name:"Siksika"},bnt:{name:"Bantu (Other)"},bos:{name:"Bosnian"},bra:{name:"Braj"},bre:{name:"Breton"},btk:{name:"Batak languages"},bua:{name:"Buriat"},bug:{name:"Buginese"},bul:{name:"Bulgarian",flag:"bg"},bur:{name:"Burmese"},mya:{name:"Burmese"},byn:{name:"Blin; Bilin"},cad:{name:"Caddo"},cai:{name:"Central American Indian languages"},car:{name:"Galibi Carib"},cat:{name:"Catalan; Valencian",flag:"es"},cau:{name:"Caucasian languages"},ceb:{name:"Cebuano"},cel:{name:"Celtic languages"},cha:{name:"Chamorro"},chb:{name:"Chibcha"},che:{name:"Chechen"},chg:{name:"Chagatai"},chi:{name:"Chinese"},zho:{name:"Chinese",flag:"cn"},chk:{name:"Chuukese"},chm:{name:"Mari"},chn:{name:"Chinook jargon"},cho:{name:"Choctaw"},chp:{name:"Chipewyan; Dene Suline"},chr:{name:"Cherokee"},chu:{name:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic"},chv:{name:"Chuvash"},chy:{name:"Cheyenne"},cmc:{name:"Chamic languages"},cop:{name:"Coptic"},cor:{name:"Cornish"},cos:{name:"Corsican"},cpe:{name:"Creoles and pidgins, English based"},cpf:{name:"Creoles and pidgins, French-based "},cpp:{name:"Creoles and pidgins, Portuguese-based "},cre:{name:"Cree"},crh:{name:"Crimean Tatar; Crimean Turkish"},crp:{name:"Creoles and pidgins "},csb:{name:"Kashubian"},cus:{name:"Cushitic languages"},cze:{name:"Czech"},ces:{name:"Czech",flag:"cz"},dak:{name:"Dakota"},dan:{name:"Danish",flag:"dk"},dar:{name:"Dargwa"},day:{name:"Land Dayak languages"},del:{name:"Delaware"},den:{name:"Slave (Athapascan)"},dgr:{name:"Dogrib"},din:{name:"Dinka"},div:{name:"Divehi; Dhivehi; Maldivian"},doi:{name:"Dogri"},dra:{name:"Dravidian languages"},dsb:{name:"Lower Sorbian"},dua:{name:"Duala"},dum:{name:"Dutch, Middle (ca.1050-1350)"},dut:{name:"Dutch; Flemish"},nld:{name:"Dutch; Flemish",flag:"nl"},dyu:{name:"Dyula"},dzo:{name:"Dzongkha"},efi:{name:"Efik"},egy:{name:"Egyptian (Ancient)"},eka:{name:"Ekajuk"},elx:{name:"Elamite"},eng:{name:"English",flag:"gb"},enm:{name:"English, Middle (1100-1500)"},epo:{name:"Esperanto"},est:{name:"Estonian",flag:"ee"},ewe:{name:"Ewe"},ewo:{name:"Ewondo"},fan:{name:"Fang"},fao:{name:"Faroese"},fat:{name:"Fanti"},fij:{name:"Fijian"},fil:{name:"Filipino; Pilipino"},fin:{name:"Finnish",flag:"fi"},fiu:{name:"Finno-Ugrian languages"},fon:{name:"Fon"},fre:{name:"French"},fra:{name:"French",flag:"fr"},frm:{name:"French, Middle (ca.1400-1600)"},fro:{name:"French, Old (842-ca.1400)"},frr:{name:"Northern Frisian"},frs:{name:"Eastern Frisian"},fry:{name:"Western Frisian"},ful:{name:"Fulah"},fur:{name:"Friulian"},gaa:{name:"Ga"},gay:{name:"Gayo"},gba:{name:"Gbaya"},gem:{name:"Germanic languages"},geo:{name:"Georgian"},kat:{name:"Georgian"},ger:{name:"German",flag:"de"},deu:{name:"German",flag:"de"},gez:{name:"Geez"},gil:{name:"Gilbertese"},gla:{name:"Gaelic; Scottish Gaelic"},gle:{name:"Irish",flag:"ie"},glg:{name:"Galician"},glv:{name:"Manx"},gmh:{name:"German, Middle High (ca.1050-1500)"},goh:{name:"German, Old High (ca.750-1050)"},gon:{name:"Gondi"},gor:{name:"Gorontalo"},got:{name:"Gothic"},grb:{name:"Grebo"},grc:{name:"Greek, Ancient (to 1453)"},gre:{name:"Greek, Modern (1453-)"},ell:{name:"Greek, Modern (1453-)",flag:"gr"},grn:{name:"Guarani"},gsw:{name:"Swiss German; Alemannic; Alsatian"},guj:{name:"Gujarati"},gwi:{name:"Gwich'in"},hai:{name:"Haida"},hat:{name:"Haitian; Haitian Creole"},hau:{name:"Hausa"},haw:{name:"Hawaiian"},heb:{name:"Hebrew",flag:"il"},her:{name:"Herero"},hil:{name:"Hiligaynon"},him:{name:"Himachali languages; Western Pahari languages"},hin:{name:"Hindi",flag:"in"},hit:{name:"Hittite"},hmn:{name:"Hmong; Mong"},hmo:{name:"Hiri Motu"},hrv:{name:"Croatian",flag:"hr"},hsb:{name:"Upper Sorbian"},hun:{name:"Hungarian",flag:"hu"},hup:{name:"Hupa"},iba:{name:"Iban"},ibo:{name:"Igbo"},ice:{name:"Icelandic"},isl:{name:"Icelandic",flag:"is"},ido:{name:"Ido"},iii:{name:"Sichuan Yi; Nuosu"},ijo:{name:"Ijo languages"},iku:{name:"Inuktitut"},ile:{name:"Interlingue; Occidental"},ilo:{name:"Iloko"},ina:{name:"Interlingua (International Auxiliary Language Association)"},inc:{name:"Indic languages"},ind:{name:"Indonesian",flag:"id"},ine:{name:"Indo-European languages"},inh:{name:"Ingush"},ipk:{name:"Inupiaq"},ira:{name:"Iranian languages"},iro:{name:"Iroquoian languages"},ita:{name:"Italian",flag:"it"},jav:{name:"Javanese"},jbo:{name:"Lojban"},jpn:{name:"Japanese",flag:"jp"},jpr:{name:"Judeo-Persian"},jrb:{name:"Judeo-Arabic"},kaa:{name:"Kara-Kalpak"},kab:{name:"Kabyle"},kac:{name:"Kachin; Jingpho"},kal:{name:"Kalaallisut; Greenlandic"},kam:{name:"Kamba"},kan:{name:"Kannada"},kar:{name:"Karen languages"},kas:{name:"Kashmiri"},kau:{name:"Kanuri"},kaw:{name:"Kawi"},kaz:{name:"Kazakh"},kbd:{name:"Kabardian"},kha:{name:"Khasi"},khi:{name:"Khoisan languages"},khm:{name:"Central Khmer"},kho:{name:"Khotanese; Sakan"},kik:{name:"Kikuyu; Gikuyu"},kin:{name:"Kinyarwanda"},kir:{name:"Kirghiz; Kyrgyz"},kmb:{name:"Kimbundu"},kok:{name:"Konkani"},kom:{name:"Komi"},kon:{name:"Kongo"},kor:{name:"Korean",flag:"kr"},kos:{name:"Kosraean"},kpe:{name:"Kpelle"},krc:{name:"Karachay-Balkar"},krl:{name:"Karelian"},kro:{name:"Kru languages"},kru:{name:"Kurukh"},kua:{name:"Kuanyama; Kwanyama"},kum:{name:"Kumyk"},kur:{name:"Kurdish"},kut:{name:"Kutenai"},lad:{name:"Ladino"},lah:{name:"Lahnda"},lam:{name:"Lamba"},lao:{name:"Lao"},lat:{name:"Latin"},lav:{name:"Latvian",flag:"lv"},lez:{name:"Lezghian"},lim:{name:"Limburgan; Limburger; Limburgish"},lin:{name:"Lingala"},lit:{name:"Lithuanian",flag:"lt"},lol:{name:"Mongo"},loz:{name:"Lozi"},ltz:{name:"Luxembourgish; Letzeburgesch"},lua:{name:"Luba-Lulua"},lub:{name:"Luba-Katanga"},lug:{name:"Ganda"},lui:{name:"Luiseno"},lun:{name:"Lunda"},luo:{name:"Luo (Kenya and Tanzania)"},lus:{name:"Lushai"},mac:{name:"Macedonian"},mkd:{name:"Macedonian",flag:"mk"},mad:{name:"Madurese"},mag:{name:"Magahi"},mah:{name:"Marshallese"},mai:{name:"Maithili"},mak:{name:"Makasar"},mal:{name:"Malayalam"},man:{name:"Mandingo"},mao:{name:"Maori"},mri:{name:"Maori"},map:{name:"Austronesian languages"},mar:{name:"Marathi"},mas:{name:"Masai"},may:{name:"Malay"},msa:{name:"Malay",flag:"my"},mdf:{name:"Moksha"},mdr:{name:"Mandar"},men:{name:"Mende"},mga:{name:"Irish, Middle (900-1200)"},mic:{name:"Mi'kmaq; Micmac"},min:{name:"Minangkabau"},mis:{name:"Uncoded languages"},mkh:{name:"Mon-Khmer languages"},mlg:{name:"Malagasy"},mlt:{name:"Maltese",flag:"mt"},mnc:{name:"Manchu"},mni:{name:"Manipuri"},mno:{name:"Manobo languages"},moh:{name:"Mohawk"},mon:{name:"Mongolian"},mos:{name:"Mossi"},mul:{name:"Multiple languages"},mun:{name:"Munda languages"},mus:{name:"Creek"},mwl:{name:"Mirandese"},mwr:{name:"Marwari"},myn:{name:"Mayan languages"},myv:{name:"Erzya"},nah:{name:"Nahuatl languages"},nai:{name:"North American Indian languages"},nap:{name:"Neapolitan"},nau:{name:"Nauru"},nav:{name:"Navajo; Navaho"},nbl:{name:"Ndebele, South; South Ndebele"},nde:{name:"Ndebele, North; North Ndebele"},ndo:{name:"Ndonga"},nds:{name:"Low German; Low Saxon; German, Low; Saxon, Low"},nep:{name:"Nepali"},"new":{name:"Nepal Bhasa; Newari"},nia:{name:"Nias"},nic:{name:"Niger-Kordofanian languages"},niu:{name:"Niuean"},nno:{name:"Norwegian Nynorsk; Nynorsk, Norwegian"},nob:{name:"Bokmål, Norwegian; Norwegian Bokmål"},nog:{name:"Nogai"},non:{name:"Norse, Old"},nor:{name:"Norwegian",flag:"no"},nqo:{name:"N'Ko"},nso:{name:"Pedi; Sepedi; Northern Sotho"},nub:{name:"Nubian languages"},nwc:{name:"Classical Newari; Old Newari; Classical Nepal Bhasa"},nya:{name:"Chichewa; Chewa; Nyanja"},nym:{name:"Nyamwezi"},nyn:{name:"Nyankole"},nyo:{name:"Nyoro"},nzi:{name:"Nzima"},oci:{name:"Occitan (post 1500); Provençal"},oji:{name:"Ojibwa"},ori:{name:"Oriya"},orm:{name:"Oromo"},osa:{name:"Osage"},oss:{name:"Ossetian; Ossetic"},ota:{name:"Turkish, Ottoman (1500-1928)"},oto:{name:"Otomian languages"},paa:{name:"Papuan languages"},pag:{name:"Pangasinan"},pal:{name:"Pahlavi"},pam:{name:"Pampanga; Kapampangan"},pan:{name:"Panjabi; Punjabi"},pap:{name:"Papiamento"},pau:{name:"Palauan"},peo:{name:"Persian, Old (ca.600-400 B.C.)"},per:{name:"Persian"},fas:{name:"Persian"},phi:{name:"Philippine languages"},phn:{name:"Phoenician"},pli:{name:"Pali"},pol:{name:"Polish",flag:"pl"},pon:{name:"Pohnpeian"},por:{name:"Portuguese",flag:"pt"},pra:{name:"Prakrit languages"},pro:{name:"Provençal, Old (to 1500)"},pus:{name:"Pushto; Pashto"},"qaa-qtz":{name:"Reserved for local use"},que:{name:"Quechua"},raj:{name:"Rajasthani"},rap:{name:"Rapanui"},rar:{name:"Rarotongan; Cook Islands Maori"},roa:{name:"Romance languages"},roh:{name:"Romansh"},rom:{name:"Romany"},rum:{name:"Romanian; Moldavian; Moldovan"},ron:{name:"Romanian; Moldavian; Moldovan",flag:"ro"},run:{name:"Rundi"},rup:{name:"Aromanian; Arumanian; Macedo-Romanian"},rus:{name:"Russian",flag:"ru"},sad:{name:"Sandawe"},sag:{name:"Sango"},sah:{name:"Yakut"},sai:{name:"South American Indian (Other)"},sal:{name:"Salishan languages"},sam:{name:"Samaritan Aramaic"},san:{name:"Sanskrit"},sas:{name:"Sasak"},sat:{name:"Santali"},scn:{name:"Sicilian"},sco:{name:"Scots"},sel:{name:"Selkup"},sem:{name:"Semitic languages"},sga:{name:"Irish, Old (to 900)"},sgn:{name:"Sign Languages"},shn:{name:"Shan"},sid:{name:"Sidamo"},sin:{name:"Sinhala; Sinhalese"},sio:{name:"Siouan languages"},sit:{name:"Sino-Tibetan languages"},sla:{name:"Slavic languages"},slo:{name:"Slovak"},slk:{name:"Slovak",flag:"sk"},slv:{name:"Slovenian",flag:"si"},sma:{name:"Southern Sami"},sme:{name:"Northern Sami"},smi:{name:"Sami languages"},smj:{name:"Lule Sami"},smn:{name:"Inari Sami"},smo:{name:"Samoan"},sms:{name:"Skolt Sami"},sna:{name:"Shona"},snd:{name:"Sindhi"},snk:{name:"Soninke"},sog:{name:"Sogdian"},som:{name:"Somali"},son:{name:"Songhai languages"},sot:{name:"Sotho, Southern"},spa:{name:"Spanish; Castilian",flag:"es"},srd:{name:"Sardinian"},srn:{name:"Sranan Tongo"},srp:{name:"Serbian",flag:"rs"},srr:{name:"Serer"},ssa:{name:"Nilo-Saharan languages"},ssw:{name:"Swati"},suk:{name:"Sukuma"},sun:{name:"Sundanese"},sus:{name:"Susu"},sux:{name:"Sumerian"},swa:{name:"Swahili"},swe:{name:"Swedish",flag:"se"},syc:{name:"Classical Syriac"},syr:{name:"Syriac"},tah:{name:"Tahitian"},tai:{name:"Tai languages"},tam:{name:"Tamil"},tat:{name:"Tatar"},tel:{name:"Telugu"},tem:{name:"Timne"},ter:{name:"Tereno"},tet:{name:"Tetum"},tgk:{name:"Tajik"},tgl:{name:"Tagalog"},tha:{name:"Thai",flag:"th"},tib:{name:"Tibetan"},bod:{name:"Tibetan"},tig:{name:"Tigre"},tir:{name:"Tigrinya"},tiv:{name:"Tiv"},tkl:{name:"Tokelau"},tlh:{name:"Klingon; tlhIngan-Hol"},tli:{name:"Tlingit"},tmh:{name:"Tamashek"},tog:{name:"Tonga (Nyasa)"},ton:{name:"Tonga (Tonga Islands)"},tpi:{name:"Tok Pisin"},tsi:{name:"Tsimshian"},tsn:{name:"Tswana"},tso:{name:"Tsonga"},tuk:{name:"Turkmen"},tum:{name:"Tumbuka"},tup:{name:"Tupi languages"},tur:{name:"Turkish",flag:"tr"},tut:{name:"Altaic languages"},tvl:{name:"Tuvalu"},twi:{name:"Twi"},tyv:{name:"Tuvinian"},udm:{name:"Udmurt"},uga:{name:"Ugaritic"},uig:{name:"Uighur; Uyghur"},ukr:{name:"Ukrainian",flag:"ua"},umb:{name:"Umbundu"},und:{name:"Undetermined"},urd:{name:"Urdu"},uzb:{name:"Uzbek"},vai:{name:"Vai"},ven:{name:"Venda"},vie:{name:"Vietnamese",flag:"vn"},vol:{name:"Volapük"},vot:{name:"Votic"},wak:{name:"Wakashan languages"},wal:{name:"Walamo"},war:{name:"Waray"},was:{name:"Washo"},wel:{name:"Welsh"},cym:{name:"Welsh"},wen:{name:"Sorbian languages"},wln:{name:"Walloon"},wol:{name:"Wolof"},xal:{name:"Kalmyk; Oirat"},xho:{name:"Xhosa"},yao:{name:"Yao"},yap:{name:"Yapese"},yid:{name:"Yiddish"},yor:{name:"Yoruba"},ypk:{name:"Yupik languages"},zap:{name:"Zapotec"},zbl:{name:"Blissymbols; Blissymbolics; Bliss"},zen:{name:"Zenaga"},zha:{name:"Zhuang; Chuang"},znd:{name:"Zande languages"},zul:{name:"Zulu"},zun:{name:"Zuni"},zxx:{name:"No linguistic content; Not applicable"},zza:{name:"Zaza; Dimili; Dimli; Kirdki; Kirmanjki; Zazaki"}};return e}),define("link/../../../shared/languages/languages",["aloha","jquery","./iso639-1-de","./iso639-2-de","./iso639-1-en","./iso639-2-en"],function(e,t,n,i,a,r){var o={"iso639-1-de":n,"iso639-2-de":i,"iso639-1-en":a,"iso639-2-en":r},s=e.getAlohaUrl()+"/../plugins/shared/languages/";return e.AbstractRepository.extend({languageCodes:[],locale:"de",iso:"iso639-1",objectType:"language",flags:!1,_constructor:function(e,t,n,i,a){this._super(e),"undefined"!=typeof t&&(this.flags=t),"undefined"!=typeof n&&(this.iso="iso639-1"===n?"iso639-1":"iso639-2"),"undefined"!=typeof i&&(this.locale=i),"undefined"!=typeof a&&(this.objectType=a);var r=o[this.iso+"-"+this.locale];this.storeLanguageCodes(r),this.languageData=r},init:function(){},markObject:function(){},errorHandler:function(e){console.log("error",this,"Error while loading languages. "+e)},storeLanguageCodes:function(n){var i=this,a=s+"img/";t.each(n,function(t,n){var r=n;r.id=t,r.repositoryId=i.repositoryId,r.type=i.objectType,i.flags&&(r.url=r.flag?a+r.flag+".png":a+"default.png"),i.languageCodes.push(new e.RepositoryDocument(r))})},_searchInLanguageCodes:function(e,n){var i,a,r,o,s=new RegExp("^"+e.queryString,"i"),l=[];for(i=0;i<this.languageCodes.length;++i)o=this.languageCodes[i],a=!e.queryString||o.name.match(s),r=!e.objectTypeFilter||!e.objectTypeFilter.length||t.inArray(o.type,e.objectTypeFilter)>-1,a&&r&&l.push(o);n.call(this,l)},query:function(e,t){this._searchInLanguageCodes(e,t)},getObjectById:function(e,t){var n,i;for(n=0;n<this.languageCodes.length;++n)if(i=this.languageCodes[n],i.id===e){t.call(this,[i]);break}}})}),define("link/link-plugin",["aloha","aloha/plugin","aloha/ephemera","jquery","ui/port-helper-attribute-field","ui/ui","ui/scopes","ui/surface","ui/button","ui/toggleButton","i18n!link/nls/i18n","i18n!aloha/nls/i18n","aloha/console","PubSub","util/keys","../../../shared/languages/languages"],function(e,t,n,i,a,r,o,s,l,d,c,u,h,p,f,g){function m(t,n){S=a({name:"hreflangfield",valueField:"id",minChars:1,scope:"Aloha.continuoustext",open:function(){e.browser.mozilla&&S.getInputJQuery().autocomplete("widget").css("z-index","9999999999")}}),S.setTemplate(t.flags?'<div class="aloha-wai-lang-img-item"><img class="aloha-wai-lang-img" src="{url}" /><div class="aloha-wai-lang-label-item">{name} ({id})</div></div>':'<div class="aloha-wai-lang-img-item"><div class="aloha-wai-lang-label-item">{name} ({id})</div></div>'),S.setObjectTypeFilter(["language/link"]),S.addListener("item-change",function(){this.getItem()&&i(n.effective).attr("hreflang",this.getItem().id)}),S.addListener("keyup",function(){0===i.trim(this.getValue()).length&&(this.setValue(""),i(n.effective).attr("hreflang",""))})}function b(e){return j.languageData?j.languageData[e].name:e}function v(){i(document).bind("keydown.aloha-link.pointer-fix",function(e){(e.metaKey||"control"===f.getToken(e.keyCode))&&i("body").addClass("aloha-link-pointer")}).bind("keyup.aloha-link.pointer-fix",function(e){(e.metaKey||"control"===f.getToken(e.keyCode))&&i("body").removeClass("aloha-link-pointer")})}function y(){i(document).unbind(".aloha-link.pointer-fix")}function _(t){t.obj.delegate("a","click.aloha-link.meta-click-link",function(t){return t.metaKey||t.ctrlKey?(e.activeEditable.blur(),window.setTimeout(function(){location.href=t.target},0),t.stopPropagation(),!1):void 0})}function w(e){e.obj.unbind(".aloha-link.meta-click-link")}function C(e,t){for(var n=e.findAllMarkupByTagName("A",e),i=0,a=n.length;a>i;i++)t.addAdditionalTargetObject(n[i])}function k(t,n){var a,r=!1;return!t.ignoreNextSelectionChangedEvent&&e.Selection.isSelectionEditable()&&null!=e.activeEditable?(a=t.findLinkMarkup(n),a?(t.toggleLinkScope(!0),t.hrefField.setTargetObject(a,"href"),C(n,t.hrefField),0==i("#"+t.hrefField.getInputId()).length&&(null!==t.hrefUpdateInt&&clearInterval(t.hrefUpdateInt),t.hrefUpdateInt=setInterval(function(){i("#"+t.hrefField.getInputId()).length>0&&(t.hrefField.setTargetObject(a,"href"),clearInterval(t.hrefUpdateInt))},200)),e.trigger("aloha-link-selected"),r=!0,p.pub("aloha.link.selected",{input:t.hrefField.getInputElem(),href:t.hrefField.getValue(),element:t.hrefField.getTargetObject()})):(t.toggleLinkScope(!1),t.hrefField.setTargetObject(null),e.trigger("aloha-link-unselected"))):t.toggleLinkScope(!1),t.ignoreNextSelectionChangedEvent=!1,r}var x,S,j,N=window.GENTICS,T="aloha-link",E="",A=/^([a-z]){3,10}:\/\/.+/i,D={merge:!0,mergeable:function(e){return"aloha-new-link"===e.className&&e.nextSibling&&"aloha-new-link"===e.nextSibling.className}};return n.classes("aloha-link-pointer","aloha-link-text"),t.create("link",{config:["a"],title:null,titleregex:null,targetregex:"",target:"",cssclassregex:null,cssclass:"",objectTypeFilter:[],onHrefChange:null,ignoreNextSelectionChangedEvent:!1,hrefUpdateInt:null,hotKey:{insertLink:c.t("insertLink","ctrl+k")},hrefValue:"http://",flags:!0,init:function(){var t=this;"undefined"!=typeof this.settings.title&&(this.title=this.settings.title),"undefined"!=typeof this.settings.titleregex&&(this.titleregex=this.settings.titleregex),"undefined"!=typeof this.settings.targetregex&&(this.targetregex=this.settings.targetregex),"undefined"!=typeof this.settings.target&&(this.target=this.settings.target),"undefined"!=typeof this.settings.cssclassregex&&(this.cssclassregex=this.settings.cssclassregex),"undefined"!=typeof this.settings.cssclass&&(this.cssclass=this.settings.cssclass),"undefined"!=typeof this.settings.objectTypeFilter&&(this.objectTypeFilter=this.settings.objectTypeFilter),"undefined"!=typeof this.settings.onHrefChange&&(this.onHrefChange=this.settings.onHrefChange),"undefined"!=typeof this.settings.hotKey&&i.extend(!0,this.hotKey,this.settings.hotKey),"undefined"!=typeof this.settings.hrefValue&&(this.hrefValue=this.settings.hrefValue),this.createButtons(),this.subscribeEvents(),this.bindInteractions(),e.bind("aloha-plugins-loaded",function(){t.initSidebar(e.Sidebar.right),p.pub("aloha.link.ready",{plugin:t})}),j=new g("link-languages",this.flags,"iso639-1",e.settings.locale,"language/link")},nsSel:function(){var e=[],t=T;return i.each(arguments,function(){e.push("."+(""==this?t:t+"-"+this))}),i.trim(e.join(" "))},nsClass:function(){var e=[],t=T;return i.each(arguments,function(){e.push(""==this?t:t+"-"+this)}),i.trim(e.join(" "))},initSidebar:function(e){var t=this;e.addPanel({id:t.nsClass("sidebar-panel-target"),title:c.t("floatingmenu.tab.link"),content:"",expanded:!0,activeOn:"a, link",onInit:function(){m(t,this);var e=this,n=this.setContent('<div class="'+t.nsClass("target-container")+'"><fieldset><legend>'+c.t("link.target.legend")+'</legend><ul><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_self" /><span>'+c.t("link.target.self")+'</span></li><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_blank" /><span>'+c.t("link.target.blank")+'</span></li><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_parent" /><span>'+c.t("link.target.parent")+'</span></li><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_top" /><span>'+c.t("link.target.top")+'</span></li><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="framename" /><span>'+c.t("link.target.framename")+'</span></li><li><input type="text" class="'+t.nsClass("framename")+'" /></li></ul></fieldset></div><div class="'+t.nsClass("title-container")+'" ><fieldset><legend>'+c.t("link.title.legend")+'</legend><input type="text" class="'+t.nsClass("linkTitle")+'" /></fieldset></div><div class="'+t.nsClass("href-lang-container")+'" ><fieldset><legend>'+c.t("href.lang.legend")+"</legend></fieldset></div>").content;i(S.getInputElem()).addClass(t.nsClass("hrefLang")),i(n).find("."+t.nsClass("href-lang-container")+" fieldset").append(S.getInputElem()),i(t.nsSel("framename")).live("keyup",function(){i(e.effective).attr("target",i(this).val().replace('"',"&quot;").replace("'","&#39;"))}),i(t.nsSel("radioTarget")).live("change",function(){"framename"==i(this).val()?i(t.nsSel("framename")).slideDown():(i(t.nsSel("framename")).slideUp().val(""),i(e.effective).attr("target",i(this).val()))}),i(t.nsSel("linkTitle")).live("keyup",function(){i(e.effective).attr("title",i(this).val().replace('"',"&quot;").replace("'","&#39;"))})},onActivate:function(e){var n=this;if(n.effective=e,null!=i(n.effective).attr("target")){var a=!0;i(t.nsSel("framename")).hide().val(""),i(t.nsSel("radioTarget")).each(function(){i(this).removeAttr("checked"),i(this).val()===i(n.effective).attr("target")&&(a=!1,i(this).attr("checked","checked"))}),a&&(i(t.nsSel('radioTarget[value="framename"]')).attr("checked","checked"),i(t.nsSel("framename")).val(i(n.effective).attr("target")).show())}else i(t.nsSel("radioTarget")).first().attr("checked","checked"),i(n.effective).attr("target",i(t.nsSel("radioTarget")).first().val());var n=this;n.effective=e,i(t.nsSel("linkTitle")).val(i(n.effective).attr("title"));var r=i(e).attr("hreflang");if(r&&r.length>0){var o=b(r);S.setValue(o)}else S.setValue("");A.test(i(e).attr("href"))?S.enableInput():S.disableInput()}}),e.show()},subscribeEvents:function(){var t=this,n={},a=0;e.bind("aloha-editable-created",function(e,r){var o=t.getEditableConfig(r.obj),s=-1!==i.inArray("a",o);n[r.getId()]=s,s&&(r.obj.bind("keydown.aloha-link",t.hotKey.insertLink,function(){return t.findLinkMarkup()?(t.hrefField.foreground(),t.hrefField.focus()):t.insertLink(!0),!1}),r.obj.find("a").each(function(){t.addLinkEventHandlers(this)}),0===a++&&v())}),e.bind("aloha-editable-destroyed",function(e,t){t.obj.unbind(".aloha-link"),0===--a&&y()}),e.bind("aloha-editable-activated",function(i,a){n[e.activeEditable.getId()]?(t._formatLinkButton.show(),t._insertLinkButton.show()):(t._formatLinkButton.hide(),t._insertLinkButton.hide()),_(a.editable)});var r=!1;e.bind("aloha-selection-changed",function(i,a){var o=!1;e.activeEditable&&n[e.activeEditable.getId()]&&(o=k(t,a),o&&r!==o&&t.hrefField.foreground()),r=o});var o=this;e.bind("aloha-editable-deactivated",function(e,t){r&&(setTimeout(function(){r||o.toggleLinkScope(!1)},100),r=!1),w(t.editable)})},toggleLinkScope:function(t){this._isScopeActive===t&&e.activeEditable&&this._isScopeActive_editableId===e.activeEditable.getId()||(this._isScopeActive=t,this._isScopeActive_editableId=e.activeEditable&&e.activeEditable.getId(),t?(this.hrefField.show(),this._insertLinkButton.hide(),e.activeEditable&&"A"===e.activeEditable.obj[0].nodeName?this._removeLinkButton.hide():this._removeLinkButton.show(),this._formatLinkButton.setState(!0),o.enterScope(this.name,"link")):(this.hrefField.hide(),this._insertLinkButton.show(),this._removeLinkButton.hide(),this._formatLinkButton.setState(!1),o.leaveScope(this.name,"link",!0)))},addLinkEventHandlers:function(t){var n=this;i(t).mouseenter(function(){e.Log.debug(n,"mouse over link."),n.mouseOverLink=t,n.updateMousePointer()}),i(t).mouseleave(function(){e.Log.debug(n,"mouse left link."),n.mouseOverLink=null,n.updateMousePointer()}),i(t).click(function(t){return t.metaKey?(e.activeEditable.blur(),window.setTimeout(function(){location.href=t.target},0),t.stopPropagation(),!1):void 0})},createButtons:function(){var e=this;this._formatLinkButton=r.adopt("formatLink",d,{tooltip:c.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",click:function(){e.formatLink()}}),this._insertLinkButton=r.adopt("insertLink",l,{tooltip:c.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",click:function(){e.insertLink(!1)}}),this.hrefField=a({name:"editLink",width:320,valueField:"url",cls:"aloha-link-href-field",scope:"Aloha.continuoustext",noTargetHighlight:!1,targetHighlightClass:"aloha-focus"}),this.hrefField.setTemplate("<span><b>{name}</b><br/>{url}</span>"),this.hrefField.setObjectTypeFilter(this.objectTypeFilter),this._removeLinkButton=r.adopt("removeLink",l,{tooltip:c.t("button.removelink.tooltip"),icon:"aloha-icon aloha-icon-unlink",scope:"Aloha.continuoustext",click:function(){e.removeLink()}})},bindInteractions:function(){var t=this;this.hrefField.addListener("item-change",function(){t.hrefChange()}),this.hrefField.addListener("keyup",function(n){if("escape"===f.getToken(n.keyCode)){var a=t.hrefField.getValue();if("/"==a[0]||"#"==a[0]||a.match(/^.*\.([a-z]){2,4}$/i)||a.match(A)||a.match(/^(mailto|tel):.+/i));else{var r=t.hrefField.getValue();t.hrefField.setValue(r),(r==t.hrefValue||""==r)&&t.removeLink(!1)}}if(t.hrefChange(),"enter"===f.getToken(n.keyCode)){var s=e.Selection.getRangeObject();t.ignoreNextSelectionChangedEvent=!0,s.startContainer=s.endContainer,s.startOffset=s.endOffset,s.select();var r=i(t.hrefField.getInputElem()).attr("value");(r==t.hrefValue||""==r)&&t.removeLink(!1),window.setTimeout(function(){o.setScope("Aloha.continuoustext")},100)}else x=i(t.hrefField.getInputElem()).attr("value"),E!=x&&(E=x)}),i(document).keydown(function(n){e.Log.debug(t,"Meta key down."),t.metaKey=n.metaKey,t.updateMousePointer()}).keyup(function(n){e.Log.debug(t,"Meta key up."),t.metaKey=n.metaKey,t.updateMousePointer()})},updateMousePointer:function(){this.metaKey&&this.mouseOverLink?(e.Log.debug(this,"set pointer"),i(this.mouseOverLink).removeClass("aloha-link-text"),i(this.mouseOverLink).addClass("aloha-link-pointer")):(i(this.mouseOverLink).removeClass("aloha-link-pointer"),i(this.mouseOverLink).addClass("aloha-link-text"))},findLinkMarkup:function(t){if("undefined"==typeof t&&(t=e.Selection.getRangeObject()),e.activeEditable){var n=e.activeEditable.obj;return n[0]&&"A"===n[0].nodeName&&(n=n.parent()),t.findMarkup(function(){return"A"==this.nodeName},n)}return null},formatLink:function(){e.activeEditable&&(this.findLinkMarkup(e.Selection.getRangeObject())?this.removeLink():this.insertLink())},insertLink:function(t){var n,a,r=this,o=e.Selection.getRangeObject();if(o.startContainer&&o.endContainer&&!this.findLinkMarkup(o)){this.hrefField.foreground(),o.isCollapsed()&&t!==!1&&N.Utils.Dom.extendToWord(o),o.isCollapsed()?(n=c.t("newlink.defaulttext"),a=i('<a href="'+r.hrefValue+'" class="aloha-new-link">'+n+"</a>"),N.Utils.Dom.insertIntoDOM(a,o,i(e.activeEditable.obj)),o.startContainer=o.endContainer=a.contents().get(0),o.startOffset=0,o.endOffset=n.length):(a=i('<a href="'+r.hrefValue+'" class="aloha-new-link"></a>'),N.Utils.Dom.addMarkup(o,a,!1),N.Utils.Dom.doCleanup(D,o)),e.activeEditable.obj.find("a.aloha-new-link").each(function(){r.addLinkEventHandlers(this),i(this).removeClass("aloha-new-link")
}),o.select(),this.hrefField.focus(),this.hrefField.hasInputElem()&&i(this.hrefField.getInputElem()).attr("value",r.hrefValue).select();var s=e.createRange();s.setStart(o.startContainer,o.startOffset),s.setEnd(o.endContainer,o.endOffset),p.pub("aloha.link.insert",{range:s}),this.hrefChange()}},removeLink:function(t){var n,a=e.Selection.getRangeObject(),r=this.findLinkMarkup();if(this.hrefField.setItem(null),r){n=i(r).text(),N.Utils.Dom.removeFromDOM(r,a,!0),a.startContainer=a.endContainer,a.startOffset=a.endOffset,a.select(),("undefined"==typeof t||t===!0)&&o.setScope("Aloha.continuoustext");var s=e.createRange();s.setStart(a.startContainer,a.startOffset),s.setEnd(a.endContainer,a.endOffset),p.pub("aloha.link.remove",{range:s,text:n})}},automaticallySetTitle:function(e,t,n){var a=i(e.getTargetObject()).attr("title"),r=!a||t===a;t&&r&&e.setAttribute("title",t,n,e.getValue())},hrefChange:function(){var t=this;this.automaticallySetTitle(this.hrefField,this.title,this.titleregex),""!=this.target&&this.hrefField.setAttribute("target",this.target,this.targetregex,this.hrefField.getValue()),null!=this.cssclassregex&&this.hrefField.setAttribute("class",this.cssclass,this.cssclassregex,this.hrefField.getValue());var n=t.hrefField.getValue(),i=t.hrefField.getTargetObject();e.trigger("aloha-link-href-change",{href:n,obj:i,item:t.hrefField.getItem()}),p.pub("aloha.link.changed",{href:n,element:i,input:t.hrefField.getInputElem()}),"function"==typeof this.onHrefChange&&this.onHrefChange.call(this,this.hrefField.getTargetObject(),this.hrefField.getValue(),this.hrefField.getItem());var a=this.hrefField.getItem();if(a&&a.language){var r=b(a.language);this.hrefField.setAttribute("hreflang",a.language),S.setValue(r),S.disableInput()}else A.test(n)?S.enableInput():(S.setValue(""),this.hrefField.setAttribute("hreflang",""),S.disableInput())}})}),define("ui/dialog",["jquery","ui/component","i18n!ui/nls/i18n"],function(e,t,n){function i(t){var n={};return t.text&&(n.text=t.text),t.html&&(n.html=t.html),e("<div>",n)}function a(t){return function(){t.apply(this),e(this).dialog("destroy").remove()}}function r(e){var t;for(t in e)e.hasOwnProperty(t)&&(e[t]=a(e[t]));return e}function o(e,t){var n="aloha aloha-dialog";return e.cls&&(n+=" "+e.cls),{resizable:!1,modal:!0,title:e.title||t,dialogClass:n,zIndex:10200}}return{confirm:function(t){var a=t.buttons||{},s=n.t("button.yes.label"),l=n.t("button.no.label");if(null!==a.Yes&&"Yes"!==s&&(a[s]=a.Yes,delete a.Yes),null!==a.No&&"No"!==l&&(a[l]=a.No,delete a.No),a[s]=a[s]||t.yes||e.noop,a[l]=a[l]||t.no||e.noop,t.answer){var d=a[s],c=a[l];a[s]=function(){d(),t.answer(!0)},a[l]=function(){c(),t.answer(!1)}}var u=i(t).dialog(e.extend(o(t,"Confirm"),{buttons:r(a)}));return function(){u.dialog("destroy").remove()}},alert:function(t){var a={};a[n.t("button.dismiss.label")]=e.noop;var s=i(t).dialog(e.extend(o(t,"Alert"),{buttons:r(a)}));return function(){s.dialog("destroy").remove()}},modal:function(t){var n=i(t).dialog(e.extend(o(t,""),t));return n.parent().find(".ui-dialog-titlebar").remove(),n},progress:function(t){var n=e("<div>").progressbar({value:null!=t.value?t.value:100}),a=i(t).dialog(e.extend(o(t,"Progress"),{open:function(){e(this).append(n)}}));return function(e){null!=e?n.progressbar({value:e}):a.dialog("destroy").remove()}}}}),define("ui/multiSplit",["jquery","ui/component","ui/button","ui/utils"],function(e,t,n,i){var a=t.extend({_activeButton:null,_isOpen:!1,init:function(){this._super();{var t=this,n=this.element=e("<div>",{"class":"aloha-multisplit"});this.contentElement=e("<div>",{"class":"aloha-multisplit-content"}).appendTo(n),this.toggleButton=i.makeButtonElement({"class":"aloha-multisplit-toggle",click:function(){t.toggle()}}).button().appendTo(n)}this.buttons=[];var a=this.getButtons();0===a.length&&n.hide();for(var r=0;r<a.length;r++)this.addButton(a[r]);e("body").click(function(e){t._isOpen&&!t.element.is(e.target)&&0===t.element.find(e.target).length&&t.close()})},addButton:function(e){var t=this,i=new(n.extend({tooltip:e.tooltip,icon:e.wide?e.icon:"aloha-large-icon "+e.icon,iconOnly:e.wide?!1:!0,init:function(){this._super(),e.init&&e.init.call(this)},click:function(){e.click.apply(t,arguments),t.close()}}));e.wide||i.element.addClass("aloha-large-button"),t.buttons[e.name]={settings:e,component:i,element:i.element,visible:!0};var a=this.contentElement.children(".aloha-ui-multisplit-fullwidth");!e.wide&&a.length?a.before(i.element[0]):this.contentElement.append(i.element[0])},setActiveButton:function(e){e||(e=null),null!==this._activeButton&&this.buttons[this._activeButton].element.removeClass("aloha-multisplit-active"),this._activeButton=e,null!==e&&this.buttons[e].element.addClass("aloha-multisplit-active")},toggle:function(){this.element.toggleClass("aloha-multisplit-open"),this._isOpen=!this._isOpen},open:function(){this.element.addClass("aloha-multisplit-open"),this._isOpen=!0},close:function(){this.element.removeClass("aloha-multisplit-open"),this._isOpen=!1},show:function(e){e||(e=null),null!==e&&void 0!==this.buttons[e]&&(this.buttons[e].element.show(),this.buttons[e].visible=!0,this.element.show())},hide:function(e){var t,n=!1;if(e||(e=null),null!==e&&void 0!==this.buttons[e]){this.buttons[e].element.hide(),this.buttons[e].visible=!1;for(t in this.buttons)if(this.buttons.hasOwnProperty(t)&&this.buttons[t].visible){this.element.show(),n=!0;break}n||this.element.hide()}}});return a}),define("ui/port-helper-multi-split",["aloha/core","jquery","ui/ui","ui/multiSplit"],function(e,t,n,i){function a(e){var a;return a=n.adopt(e.name,i,{scope:e.scope,getButtons:function(){var n=[];return t.each(e.items,function(e,t){n.push({tooltip:t.tooltip,text:t.text,name:t.name,icon:t.iconClass,click:t.click,init:function(){t.cls&&this.element.addClass(t.cls),t.init&&t.init.call(this)},wide:t.wide})}),n}}),{pushItem:function(e){a.addButton(e)},showItem:function(e){a.show(e)},hideItem:function(e){a.hide(e)},setActiveItem:function(e){a.setActiveButton(e)}}}return a}),define("table/nls/i18n",{root:{"floatingmenu.tab.table":"Table","floatingmenu.tab.tablelayout":"Table Layout","deleterows.confirm":"Do you really want to delete the selected rows?","deletecolumns.confirm":"Do you really want to delete the selected columns?","deletetable.confirm":"Do you really want to delete the table?",Table:"Table","button.createtable.tooltip":"Insert Table","button.addcolleft.tooltip":"Add Column left","button.addcolright.tooltip":"Add Column right","button.delcols.tooltip":"Delete Columns","button.addrowbefore.tooltip":"Add Row before","button.addrowafter.tooltip":"Add Row after","button.delrows.tooltip":"Delete Rows","button.caption.tooltip":"Table caption","button.naturalfit.tooltip":"Reset table sizing","empty.caption":"Table caption","button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting","button.rowheader.tooltip":"Format row as table header","button.columnheader.tooltip":"Format column as table header","button.mergecells.tooltip":"Merge Cells","button.splitcells.tooltip":"Split Cells","table.label.target":"Summary","table.sidebar.title":"Table","table.mergeCells.notRectangular":"Only a rectangular selection can be merged","table.addColumns.nonConsecutive":"Please select a single column or a consecutive range of columns","table.createTable.nestedTablesNoSupported":"Sorry, nested tables are not supported"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("table/table-create-layer",["jquery"],function(e){return CreateLayer=function(e){this.TablePlugin=e},CreateLayer.prototype.parameters={elemId:"aloha-table-createLayer",className:"aloha-table-createdialog",numX:10,numY:10,layer:void 0,target:void 0},CreateLayer.prototype.config=new Object,CreateLayer.prototype.visible=!1,CreateLayer.prototype.show=function(){var e=this.get("layer");null==e?this.create():(this.setPosition(e),e.find("td").removeClass("hover"),e.show()),this.visible=!0},CreateLayer.prototype.create=function(){var t=this,n=e("<div></div>");n.id=this.get("elemId"),n.addClass(this.get("className"));var i=e("<table></table>");i.css("width",15*(this.get("numX")+6));for(var a,r,o=0;o<this.get("numY");o++){a=e("<tr></tr>");for(var s=0;s<this.get("numX");s++)r=e("<td> </td>"),0==o&&0==s&&r.addClass("hover"),r.bind("mouseover",{rowId:o,colId:s},function(e){t.handleMouseOver(e,i)}),r.bind("click",{rowId:o,colId:s},function(e){var n=e.data.rowId+1,i=e.data.colId+1;t.TablePlugin.createTable(i,n),t.hide()}),a.append(r);i.append(a)}n.append(i),this.set("layer",n),this.setPosition(),n.bind("click",function(e){e.stopPropagation()}).mousedown(function(e){e.stopPropagation()}),e("body").append(n).bind("click",function(n){t.visible&&n.target!==t.get("target")[0]&&!e.contains(t.get("target")[0],n.target)&&t.hide()})},CreateLayer.prototype.handleMouseOver=function(t,n){for(var i=t.data.rowId,a=t.data.colId,r=n.find("tr"),o=0;o<=r.length;o++)for(var s=e(r[o]).find("td"),l=0;l<=s.length;l++)i>=o&&a>=l?e(s[l]).addClass("hover"):e(s[l]).removeClass("hover")},CreateLayer.prototype.setPosition=function(){var t=e(this.get("target")),n=t.offset();this.get("layer").css("left",n.left+"px"),this.get("layer").css("top",n.top+t.height()+"px")},CreateLayer.prototype.hide=function(){this.get("layer").hide(),this.visible=!1},CreateLayer.prototype.get=function(e){return this.config[e]?this.config[e]:this.parameters[e]?this.parameters[e]:void 0},CreateLayer.prototype.set=function(e,t){this.config[e]?this.config[e]=t:this.parameters[e]=t},CreateLayer}),define("table/table-plugin-utils",["jquery","aloha/copypaste","util/browser","aloha/console"],function(e,t,n,i){function a(n){if(0===n.length)return null;var i,a,r=t.getRange();if(r&&(a=e(r.commonAncestorContainer).closest(".aloha-table-cell-editable")[0]),a)for(i=0;i<n.length;i++)if(e(n[i]).find(a).length)return n[i];return n[0]}var r={cellIndexToGridColumn:function(e,t,n){var i=null;return r.walkCells(e,function(e,a,r){return e===t&&a===n?(i=r,!1):void 0}),i},walkCells:function(e,t){for(var n=[],i=0;i<e.length;i++){for(var a=e[i].cells,o=0,s=0;s<a.length;s++){for(var l=a[s],d=r.colspan(l),c=r.rowspan(l);n[s+o];)n[s+o]-=1,o+=1;if(!1===t(i,s,s+o,d,c))return;for(var u=0;d>u;u++){if(n[s+o+u])throw"an impossible case has occurred";n[s+o+u]=c-1}o+=d-1}for(;s+o<n.length;o++)n[s+o]&&(n[s+o]-=1)}},makeGrid:function(e){var t=[];return r.walkCells(e,function(n,i,a,r,o){for(var s=e[n].cells[i],l=0;o>l;l++){t[n+l]=t[n+l]||[];for(var d=0;r>d;d++)t[n+l][a+d]={cell:s,colspan:r,rowspan:o,spannedX:d,spannedY:l}}}),t},containsDomCell:function(e){return 0===e.spannedX&&0===e.spannedY},leftDomCell:function(e,t,n){do{var i=e[t][n];if(0===i.spannedY)return i.cell;n-=i.spannedX+1}while(n>=0);return null},splitCell:function(t,n){var i=e(t),a=r.colspan(t),o=r.rowspan(t);if(1!==a||1!==o){for(var s=i.parent(),l=s.parent().children(),d=s.index(),c=i.index(),u=r.makeGrid(l),h=r.cellIndexToGridColumn(l,d,c),p=0;o>p;p++)for(var f=0===p?1:0;a>f;f++){var g=r.leftDomCell(u,d+p,h);null==g?l.eq(d+p).prepend(n()):e(g).after(n())}i.removeAttr("colSpan"),i.removeAttr("rowSpan")}},rowspan:function(t){return parseInt(e(t).attr("rowspan"))||1},colspan:function(t){return parseInt(e(t).attr("colspan"))||1},walkGrid:function(e,t){for(var n,i=0,a=e.length;a>i;i++){n=e[i];for(var r=0,o=n.length;o>r;r++)if(!1===t(n[r],r,i))return}},walkGridInsideRect:function(e,t,n){r.walkGrid(e,function(e,i,a){return a>=t.top&&a<t.bottom&&i>=t.left&&i<t.right?n(e,i,a):void 0})},leftTrimArray:function(e){for(var t=0;t<e.length;t++)if(null!=e[t])return e.slice(t,e.length);return[]},makeContour:function(e,t){var n=[],i=[],a=[],o=[];return r.walkGrid(e,function(e,r,s){t(e,r,s)&&((null==n[s]||r<n[s])&&(n[s]=r),(null==i[s]||r>i[s])&&(i[s]=r),(null==a[r]||s<a[r])&&(a[r]=s),(null==o[r]||s>o[r])&&(o[r]=s))}),n=r.leftTrimArray(n),i=r.leftTrimArray(i),a=r.leftTrimArray(a),o=r.leftTrimArray(o),{left:n,right:i,top:a,bottom:o}},indexOfAnyBut:function(e,t){for(var n=0;n<e.length;n++)if(t!==e[n])return n;return-1},isConsecutive:function(e){for(var t=1;t<e.length;t++)if(1!==Math.abs(e[t]-e[t-1]))return!1;return!0},resizeCellWidth:function(t,n){e(t).css("width",n),e(t).find(".aloha-table-cell-editable").eq(0).css({width:n,"word-wrap":"break-word"})},getMinColWidth:function(t){var n=t.closest("tbody").children("tr"),i=t.closest("tr"),a=r.cellIndexToGridColumn(n,n.index(i),i.children().index(t)),o="";r.walkCells(n,function(t,i,r,s){if(r===a){var l=e(e(n[t]).children()[i]);if(s>1)return;for(var d=l.text().split(" "),c=0;c<d.length;c++)d[c].length>o.length&&(o=d[c])}});var s=e("<span></span>");s.css("text-indent",-9999),s.css("display","inline"),s.text(o),e(t).append(s);var l=s.width();return e(s).remove(),l},getCellResizeBoundaries:function(t,n,i){var a,o;r.walkCells(n,function(s,l,d,c){var u=e(e(n[s]).children()[l]);return u.hasClass("aloha-table-selectrow")||u.closest("tr").hasClass("aloha-table-selectcolumn")?!0:(d===t&&1===c&&(a=u.offset().left+r.getCellBorder(u)+u.width()-r.getMinColWidth(u)),d===t-1&&1===c&&(o=u.offset().left+r.getCellBorder(u)+r.getCellPadding(u)+r.getMinColWidth(u)),a&&o?(i(a,o),!1):void 0)})},getCellBorder:function(e){return(e.outerWidth()-e.innerWidth())/2},getCellPadding:function(e){return e.innerWidth()-e.width()},selectAnchorContents:function(r){var o=a(r);if(o){var s=e(">.aloha-table-cell-editable",o)[0];if(n.ie&&o.ownerDocument.documentMode<=8)try{t.selectAllOf(s)}catch(l){i.warn("Table Plugin",l.message)}else t.selectAllOf(s)}}};return r}),define("table/table-cell",["aloha","aloha/jquery","aloha/ephemera","table/table-plugin-utils","util/browser"],function(e,t,n,i,a){var r=function(e,n){null==e&&(e="<td>&nbsp;</td>"),e=t(e).get(0),this.obj=t(e),this.tableObj=n,n.cells.push(this)};return r.prototype.tableObj=void 0,r.prototype.obj=void 0,r.prototype.wrapper=void 0,r.prototype.hasFocus=!1,r.prototype.activate=function(){var a=this,r=a.obj;r.wrapInner("<div/>");var o=r.children("div").eq(0);return o.contentEditable(!0),o.addClass("aloha-table-cell-editable"),n.markWrapper(o),o.bind("focus",function(e){a.tableObj.tablePlugin._splitcellsButton.enable(i.colspan(a.obj)>1||i.rowspan(a.obj)>1?!0:!1),e.currentTarget&&(e.currentTarget.indexOf=function(){return-1}),a._editableFocus(e)}),o.bind("mousedown",function(e){if(e.currentTarget&&(e.currentTarget.indexOf=function(){return-1}),a._editableMouseDown(e),a.tableObj.selection.baseCellPosition=[a._virtualY(),a._virtualX()],e.shiftKey){var n=a.tableObj.selection.lastBaseCellPosition[1],r=a.tableObj.selection.lastBaseCellPosition[0],o=a.tableObj.selection.baseCellPosition,s=o[1];s>n&&(s=n,n=o[1]);var l=o[0];l>r&&(l=r,r=o[0]);var d={top:l,right:n,bottom:r,left:s},c=a.tableObj,u=c.obj.children().children("tr"),h=i.makeGrid(u);c.selection.selectedCells=[];var p=c.get("classCellSelected");i.walkGrid(h,function(e,n,a){i.containsDomCell(e)&&(a>=d.top&&a<=d.bottom&&n>=d.left&&n<=d.right?(t(e.cell).addClass(p),c.selection.selectedCells.push(e.cell)):t(e.cell).removeClass(p))}),c.selection.notifyCellsSelected()}else a.tableObj.selection.lastBaseCellPosition=a.tableObj.selection.baseCellPosition,a._editableMouseDown(e),a._startCellSelection()}),o.bind("blur",function(e){a._editableBlur(e)}),o.bind("keyup",function(e){a._editableKeyUp(e)}),o.bind("keydown",function(e){a._editableKeyDown(e)}),o.bind("mouseover",function(){a._selectCellRange()}),o.contentEditableSelectionChange(function(t){return e.Selection.onChange(o,t),o}),r.bind("mousedown",function(e){window.setTimeout(function(){a.wrapper.trigger("focus"),a._selectAll(o)},1),e.shiftKey||(a.tableObj.selection.unselectCells(),a._startCellSelection()),e.stopPropagation()}),r.get(0)&&(r.get(0).onselectstart=function(){return!1}),this.wrapper=r.children(),this.wrapper.get(0)&&(this.wrapper.get(0).onselectstart=function(){window.event.cancelBubble=!0},this.wrapper.get(0).ondragstart=function(){return!1}),this},r.prototype.deactivate=function(){var e=t(this.obj.children(".aloha-table-cell-editable"));e.length&&(e.parent().append(e.contents()),e.remove(),this.obj.unbind("click"),this.obj.unbind("mousedown"),""==t.trim(this.obj.attr("class"))&&this.obj.removeAttr("class"))},r.prototype.toString=function(){return"TableCell"},r.prototype._editableFocus=function(){this.hasFocus||(this.tableObj.focus(),this.obj.addClass("aloha-table-cell_active"),this.hasFocus=!0,this.tableObj.selection.selectionType="cell")},r.prototype._editableBlur=function(){this.hasFocus=!1,this.obj.removeClass("aloha-table-cell_active")},r.prototype._virtualX=function(){var e=this.tableObj.obj.children().children("tr"),t=this.obj.parent().index(),n=this.obj.index();return i.cellIndexToGridColumn(e,t,n)},r.prototype._virtualY=function(){return this.obj.parent("tr").index()},r.prototype._startCellSelection=function(){if(!this.tableObj.selection.cellSelectionMode){this.tableObj.selection.unselectCells(),this.tableObj.selection.cellSelectionMode=!0;var e=this;t("body").bind("mouseup.cellselection",function(){e._endCellSelection()}),this.tableObj.selection.baseCellPosition=[this._virtualY(),this._virtualX()]}},r.prototype._endCellSelection=function(){this.tableObj.selection.cellSelectionMode&&(i.selectAnchorContents(this.tableObj.selection.selectedCells),this.tableObj.selection.cellSelectionMode=!1,this.tableObj.selection.baseCellPosition=null,this.tableObj.selection.lastSelectionRange=null,this.tableObj.selection.selectionType="cell",t("body").unbind("mouseup.cellselection"))},r.prototype._getSelectedRect=function(){var e=this._virtualX(),t=this._virtualY(),n=this.tableObj.selection.baseCellPosition,i=n[1];i>e&&(i=e,e=n[1]);var a=n[0];return a>t&&(a=t,t=n[0]),{top:a,right:e,bottom:t,left:i}},r.prototype._selectCellRange=function(){if(!this.tableObj.selection.resizeMode&&this.tableObj.selection.cellSelectionMode){var e=this._getSelectedRect(),n=this.tableObj,a=n.obj.children().children("tr"),r=i.makeGrid(a);n.selection.selectedCells=[];var o=n.get("classCellSelected");i.walkGrid(r,function(a,r,s){i.containsDomCell(a)&&(s>=e.top&&s<=e.bottom&&r>=e.left&&r<=e.right?(t(a.cell).addClass(o),n.selection.selectedCells.push(a.cell)):t(a.cell).removeClass(o))}),n.selection.notifyCellsSelected()}},r.prototype._selectAll=function(e){var n=e.jquery?e.get(0):e;if(t.browser.msie){if(document.getSelection){var i=document.getSelection(),a=document.createRange();a.selectNodeContents(n),i.removeAllRanges(),i.addRange(a)}else if(document.selection){var a=document.body.createTextRange();a.moveToElementText(n),a.select()}}else{var i=window.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(n,0,n,Math.max(0,n.innerText.length-1));else{window.opera&&"<BR>"==n.innerHTML.substring(n.innerHTML.length-4)&&(n.innerHTML=n.innerHTML+"&#160;");var a=document.createRange();a.selectNodeContents(n),i.removeAllRanges(),i.addRange(a)}}},r.prototype._editableMouseDown=function(e){this.tableObj.selection.unselectCells(),this.tableObj.hasFocus&&("function"==typeof e.stopPropagation?e.stopPropagation():"undefined"!=typeof e.cancelBubble&&(e.cancelBubble=!0))},r.prototype._editableKeyUp=function(){},r.prototype._editableKeyDown=function(e){var t=9;if(this._checkForEmptyEvent(e),this.obj[0]===this.tableObj.obj.find("tr:last td:last")[0]&&t==e.keyCode&&!e.altKey&&!e.shiftKey&&!e.ctrlKey){var n=this.tableObj.addRow(this.obj.parent().index()+1);a.mozilla&&(e.preventDefault(),$(n).find("td:nth-child(2) .aloha-table-cell-editable").focus())}},r.prototype._checkForEmptyEvent=function(){var e=t(this.wrapper),n=e.text();e.children().length>0||""===n&&(this.wrapper.text(" "),this.wrapper.get(0).blur(),this.wrapper.get(0).focus())},r.getContainer=function(e){return t(e.firstChild).hasClass("aloha-table-cell-editable")?e.firstChild:e},r}),define("table/table-selection",["aloha","aloha/jquery","table/table-plugin-utils","table/table-cell","ui/dialog","i18n!table/nls/i18n"],function(e,t,n,i,a,r){function o(e){return"string"==typeof e&&""!==t.trim(e)||e.nodeType&&3===e.nodeType&&""!==t.trim(e.data)||1===e.nodeType}function s(e){return{top:e.top[0],right:e.right[0]+1,bottom:e.bottom[0]+1,left:e.left[0]}}function l(e,t,i){var a=!0;if(-1!==n.indexOfAnyBut(t.top,t.top[0])||-1!==n.indexOfAnyBut(t.right,t.right[0])||-1!==n.indexOfAnyBut(t.bottom,t.bottom[0])||-1!==n.indexOfAnyBut(t.left,t.left[0]))a=!1;else{var r=s(t);n.walkGridInsideRect(e,r,function(e){return i(e)?void 0:(a=!1,!1)})}return a}var d=function(e){this.table=e};return d.prototype.selectionType=void 0,d.prototype.selectedCells=new Array,d.prototype.selectedColumnIdxs=new Array,d.prototype.selectedRowIdxs=new Array,d.prototype.cellSelectionMode=!1,d.prototype.baseCellPosition=null,d.prototype.lastSelectionRange=null,d.prototype.selectColumns=function(e){this.unselectCells();var i=this.table.getRows();i.shift();for(var a=n.makeGrid(i),r=0;r<e.length;r++)if(-1===t.inArray(e[r],this.selectedColumnIdxs)){this.selectedColumnIdxs.push(e[r]);for(var o=0;o<a.length;o++){var s=a[o][e[r]];n.containsDomCell(s)&&(t(s.cell).addClass(this.table.get("classCellSelected")),this.selectedCells.push(s.cell))}}this.selectionType="column"},d.prototype.selectRows=function(e){this.unselectCells();var n=this.table.getRows();e.sort(function(e,t){return e-t});for(var i=0;i<e.length;i++)if(n[e[i]]){for(var a=0;a<this.selectedRowIdxs.length;a++)if(e[i]==this.selectedRowIdxs[a])return;this.selectedRowIdxs.push(e[i]);for(var r=1;r<n[e[i]].cells.length;r++)this.selectedCells.push(n[e[i]].cells[r]),t(n[e[i]].cells[r]).addClass(this.table.get("classCellSelected"))}this.selectionType="row"},d.prototype.selectAll=function(){var e=t.map(this.table.getRows(),function(e,t){return t});e.shift(),this.selectRows(e),this.selectionType="all"},d.prototype.notifyCellsSelected=function(){e.trigger("aloha-table-selection-changed")},d.prototype._notifyCellsUnselected=function(){e.trigger("aloha-table-selection-changed")},d.prototype.isHeader=function(){if(0==this.selectedCells.length)return!1;for(var e=0;e<this.selectedCells.length;e++)if(!this.selectedCells[e]||"th"!=this.selectedCells[e].nodeName.toLowerCase())return!1;return!0},d.prototype.unselectCells=function(){if(!this.cellSelectionMode&&this.selectedCells.length>0){for(var e=this.selectedCells,n=this.table.get("classCellSelected"),i=0,a=e.length;a>i;i++)t(e[i]).removeClass(n);this.selectedCells=new Array,this.selectedColumnIdxs=new Array,this.selectedRowIdxs=new Array,this.selectionType="cell",this._notifyCellsUnselected()}},d.prototype.selectionIndex=function(e){for(var t=0;t<this.selectedCells.length;t++)if(this.selectedCells[t]===e)return t;return-1},d.prototype.mergeCells=function(){var d=this.selectedCells;if(0!==d.length){var c=function(e){return-1!=t.inArray(e.cell,d)},u=n.makeGrid(this.table.getRows()),h=n.makeContour(u,c);if(!l(u,h,c))return void a.alert({title:r.t("Table"),text:r.t("table.mergeCells.notRectangular")});var p=s(h),f=t(u[p.top][p.left].cell),g=t(i.getContainer(f.get(0)));n.walkGridInsideRect(u,p,function(e,n,a){if(n-e.spannedX!==p.left||a-e.spannedY!==p.top){for(var r=e.cell,s=t(i.getContainer(r)).contents(),l=0;l<s.length;l++)if(o(s[l])){g.append(" "),g.append(s);break}t(r).remove()}}),f.attr({rowspan:p.bottom-p.top,colspan:p.right-p.left}),this.selectedCells=[f.get(0)],this.cellSelectionMode=!1,this.baseCellPosition=null,this.lastSelectionRange=null,this.selectionType="cell",e.trigger("aloha-table-selection-changed")}},d.prototype.splitCells=function(){var i=this,a=this.selectedCells;a.length>0&&(t(a).each(function(){n.splitCell(this,function(){return i.table.newActiveCell().obj})}),this.cellSelectionMode=!1,this.baseCellPosition=null,this.lastSelectionRange=null,this.selectionType="cell",e.trigger("aloha-table-selection-changed"))},d.prototype.cellsAreMergeable=function(){var e=this.selectedCells;if(e.length<2)return!1;var i=function(n){return-1!=t.inArray(n.cell,e)},a=n.makeGrid(this.table.getRows()),r=n.makeContour(a,i);return l(a,r,i)?!0:!1},d.prototype.cellsAreSplitable=function(){var e=0;return this.selectedCells.length>0?(t(this.selectedCells).each(function(){var t=this,i=n.colspan(t),a=n.rowspan(t);(i>1||a>1)&&e++}),e>0?!0:!1):!1},d}),define("table/table",["aloha","jquery","ui/scopes","ui/dialog","i18n!table/nls/i18n","table/table-cell","table/table-selection","table/table-plugin-utils","aloha/ephemera","util/html","util/dom2","aloha/console"],function(e,t,n,i,a,r,o,s,l,d,c,u){function h(e){e.jquery&&(e=e[0]);var t,n,i=[];for(t=0;t<e.childNodes.length;t++)n=e.childNodes[t],i.push(n),1===n.nodeType&&(i=i.concat(h(n)));return i}function p(e,n){var i;return"first"===e?(i=t("[contenteditable]",n).first()[0].firstChild,b===i&&(i=t("*",n).first()[0].firstChild)):"last"===e&&(i=h(t("td:last",n)).reverse()[0]),i}function f(e){var n,i,a,r,o,l,d,c,u=(e.obj,e.getRows()),h=u.length,p=0,f=[h];for(n=0;h>n;n++){if(a=t(u[n]),r=a.children("td, th"),o=r.length,l=s.cellIndexToGridColumn(u,n,o-1)+1,c=parseInt(r.last().attr("colspan"),10),0==c||isNaN(c)||(1==c&&r.last().removeAttr("colspan"),l+=c-1),rowSpan=parseInt(r.last().attr("rowspan"),10),rowSpan>1)for(i=1;rowSpan-1>i;i++)f[n+i]+=c>1?c:1;f[n]+=l,f[n]>p&&(p=f[n])}for(n=0;h>n;n++)d=p-f[n],d>0&&t(u[n]).append(new Array(d+1).join("<td></td>"))}function g(e,n,i,a){for(var r,o=!1,s=0;s<i.length;s++)a.showItem(i[s].name);a.setActiveItem();for(var s=0;s<n.length;s++)if(t(e[0]).hasClass(n[s].cssClass)){o=!0,r=n[s].name;break}t(e).each(function(){t(this).hasClass(r)||(o=!1)}),o&&a.setActiveItem(r)}function m(e,t){var n=-1,i=null;if("before"===e)i=t.selectedCells[0];else if("after"===e){var a=t.selectedCells.length-1;i=t.selectedCells[a]}return i&&1==i.nodeType&&(n=i.parentNode.rowIndex),n}var b=void 0,v=window.GENTICS,y=function(e,n){this.obj=t(e),f(this),this.obj.attr("id")||this.obj.attr("id",v.Utils.guid()),l.markAttr(this.obj,"id"),this.tablePlugin=n,this.selection=new o(this),this.refresh()};return t.extend(y.prototype,{obj:b,tableWrapper:b,cells:b,numRows:b,numCols:b,isActive:!1,hasFocus:!1,parentEditable:b,mousedown:!1,clickedColumnId:-1,clickedRowId:-1,columnsToSelect:[],rowsToSelect:[],fmPluginId:b}),y.prototype.refresh=function(){this.numCols=this.countVirtualCols();var e=this.getRows();this.numRows=e.length,this.cells=[];for(var n=0;n<e.length;n++)for(var i=t(e[n]),a=i.children(),r=0;r<a.length;r++){var o=a[r];this.newCell(o)}},y.prototype.countVirtualCols=function(){var e=this.obj.children().children("tr:first-child").children();return e.length-e.filter("."+this.get("classLeftUpperCorner")).length},y.prototype.get=function(e){return this.tablePlugin.get(e)},y.prototype.set=function(e,t){this.tablePlugin.set(e,t)},y.prototype.activate=function(){function n(e){return!d.isUnrenderedNode(e)}function i(e){var t=e.startOffset,i=e.startContainer;return 0===t?!0:1===i.nodeType?!d.findNodeRight(i.childNodes[t-1],n):3===i.nodeType?d.isWSPorZWSPText(i.data.substr(0,t)):!1}function a(e){var t=e.startOffset,i=e.startContainer;return c.nodeLength(i)===t?!0:1===i.nodeType?!d.findNodeLeft(i.childNodes[t-1],n):3===i.nodeType?d.isWSPorZWSPText(i.data.substr(t)):!1}if(!this.isActive){var r,o,s,u=this;this.obj.addClass(this.get("className")),this.obj.contentEditable(!1),""==this.obj.attr("id")&&this.obj.attr("id",v.Utils.guid()),this.selection.selectionType=b,s=this.obj.children("tbody"),0===s.length&&(s=this.obj),s.bind("keydown",function(e){e.ctrlKey||e.shiftKey||u.selection.selectedCells.length>0&&u.selection.selectedCells[0].length>0&&u.selection.selectedCells[0][0].firstChild.focus()}),e.bind("aloha-command-will-execute",function(t,r){var o,s=e.getSelection().getRangeAt(0);if("forwarddelete"===r.commandId){if(!s.collapsed||!a(s))return;var l=s.commonAncestorContainer;3===l.nodeType?o=l.parentNode&&d.findNodeLeft(l.parentNode.nextSibling,n):1===l.nodeType&&(o=d.findNodeLeft(l.nextSibling,n)),o===u.tableWrapper&&(r.preventDefault=!0,e.getSelection().collapse(p("first",u.obj),0))}else if("delete"===r.commandId){if(!s.collapsed||!i(s))return;var l=s.commonAncestorContainer;if(3===l.nodeType?o=l.parentNode&&d.findNodeRight(l.parentNode.previousSibling,n):1===l.nodeType&&(o=d.findNodeRight(l.previousSibling,n)),o===u.tableWrapper){var h=p("last",u.obj);r.preventDefault=!0,e.getSelection().collapse(h,c.nodeLength(h))}}}),this.obj.on("keydown",function(e){46===e.keyCode&&("row"===u.selection.selectionType?u.deleteRows():"column"===u.selection.selectionType&&u.deleteColumns(),"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)}),s.delegate("th, td","mousemove",function(e){var n=t(this),i=3;if(!t(this).hasClass("aloha-table-selectrow")&&!t(this).closest("tr").hasClass("aloha-table-selectcolumn")){var a=function(t){return e.pageX-t.offset().left<i},r=function(t){return e.pageY-t.offset().top<i},o=function(t){var n=t.closest("tr");if(n.next("tr").length>0)return!1;var a=e.pageY-(n.offset().top+n.outerHeight());return a>-1*i&&i>a},s=u.tablePlugin.colResize,l=u.tablePlugin.rowResize;return s&&a(n)?(n.css("cursor","col-resize"),u.attachColumnResize(n)):l&&r(n)?(n.css("cursor","row-resize"),u.attachRowResize(n)):l&&o(n)?(n.css("cursor","row-resize"),u.attachRowResize(n,!0)):(n.css("cursor","default"),u.detachRowColResize(n))}}),s.bind("mousemove",function(e){var n=t(this).closest("table"),i=function(t){var n=e.pageX-(t.offset().left+t.outerWidth());return n>-5&&5>n},a=u.tablePlugin.tableResize;return a&&i(n)?u.attachTableResizeWidth(n):void 0}),s.bind("mousedown",function(e){return u.hasFocus||u.focus(),e.stopPropagation(),e.preventDefault(),!1}),o=t('<div class="'+this.get("classTableWrapper")+' aloha-block-collection" data-block-skip-scope="true"></div>'),o.contentEditable(!1),l.markWrapper(o),this.obj.wrap(o);var h=this.obj.parent();h.alohaBlock&&h.alohaBlock(),r=this.obj.parents("."+this.get("classTableWrapper")),r.get(0).onresizestart=function(){return!1},r.get(0).oncontrolselect=function(){return!1},r.get(0).ondragstart=function(){return!1},r.get(0).onmovestart=function(){return!1},this.tableWrapper=this.obj.parents("."+this.get("classTableWrapper")).get(0),t(this.cells).each(function(){this.activate()}),this.attachSelectionColumn(),this.attachSelectionRow(),this.makeCaptionEditable(),this.checkWai(),this.isActive=!0,e.trigger("aloha-table-activated")}},y.prototype.makeCaptionEditable=function(){var e=this.obj.find("caption").eq(0);e&&this.tablePlugin.makeCaptionEditable(e)},y.prototype.checkWai=function(){var e=this.wai;if(!e)return!1;var n=this.get("waiGreen"),i=this.get("waiRed");return e.removeClass(n+" "+i),""!==t.trim(this.obj[0].summary)?(e.addClass(n),!0):(e.addClass(i),!1)},y.prototype.attachSelectionColumn=function(){var e,n,i,a,r,o=t("<td>"),s=this;for(o.html(" "),s=this,a=this.obj.context.rows,r=0;r<a.length;r++)i=t(a[r]),n=o.clone(),n.addClass(this.get("classSelectionColumn")),n.css("width",this.get("selectionArea")+"px"),i.prepend(n),e=r+1,this.attachRowSelectionEventsToCell(n)},y.prototype.attachRowSelectionEventsToCell=function(e){var t=this;l.markElement(e),e.unbind("mousedown"),e.unbind("mouseover"),e.get(0).onselectstart=function(){return!1},e.bind("mousedown",function(e){return t.rowSelectionMouseDown(e)}),e.bind("mouseover",function(e){return t.mousedown?t.rowSelectionMouseOver(e):void 0})},y.prototype.rowSelectionMouseDown=function(e){if(this.focus(),0==this.selection.selectedCells.length&&(this.rowsToSelect=[]),this.clickedRowId=e.currentTarget.parentNode.rowIndex,e.metaKey){var n=t.inArray(this.clickedRowId,this.rowsToSelect);n>=0?this.rowsToSelect.splice(n,1):this.rowsToSelect.push(this.clickedRowId)}else if(e.shiftKey){this.rowsToSelect.sort(function(e,t){return e-t});var i=this.rowsToSelect[0],a=this.clickedRowId;i>a&&(i=a,a=this.rowsToSelect[0]),this.rowsToSelect=[];for(var r=i;a>=r;r++)this.rowsToSelect.push(r)}else this.rowsToSelect=[this.clickedRowId];return this.selectRows(),e.preventDefault(),e.stopPropagation(),!1},y.prototype.rowSelectionMouseOver=function(e){var n,i,a,r,o=e.currentTarget.parentNode.rowIndex;if(this.mousedown&&this.clickedRowId>=0){for(n=t.inArray(o,this.rowsToSelect),i=o<this.clickedRowId?o:this.clickedRowId,a=o<this.clickedRowId?this.clickedRowId:o,this.rowsToSelect=new Array,r=i;a>=r;r++)this.rowsToSelect.push(r);
return this.selectRows(),e.preventDefault(),e.stopPropagation(),!1}},y.prototype.attachSelectionRow=function(){var e=this,n=t("<td>");n.html(" ");for(var i=0,a=0;a<this.obj.context.rows.length;a++){for(var r=0,o=0;o<this.obj.context.rows[a].cells.length;o++){var d=s.colspan(this.obj.context.rows[a].cells[o]);r+=d}r>i&&(i=r)}var c=t("<tr>");c.addClass(this.get("classSelectionRow")),c.css("height",this.get("selectionArea")+"px"),l.markElement(c);for(var a=0;i>a;a++){var h=n.clone();if(a>0)this.attachColumnSelectEventsToCell(h);else{var h=t("<td>").clone();h.addClass(this.get("classLeftUpperCorner"));var p=function(t){e.focus(),e.selection.selectAll(),e.tablePlugin.activeTable.selection.selectionType="cell",e.tablePlugin.updateFloatingMenuScope(),e._removeCursorSelection(),e.tablePlugin.settings.summaryinsidebar&&(e.tablePlugin.sidebar.open(),e.tablePlugin.sidebarPanel.activate(e.obj),e.tablePlugin.sidebar.correctHeight());try{e.tablePlugin.summary.focus(),t.stopPropagation(),t.preventDefault()}catch(t){u.error("Table",t.message)}return!1};this.wai=t("<div/>").width(25).height(12).click(p),h.append(this.wai)}c.append(h)}t(document).bind("mouseup",function(t){e.columnSelectionMouseUp(t)}),this.obj.find("tr:first").before(c)},y.prototype.attachColumnSelectEventsToCell=function(e){var t=this;e.unbind("mousedown"),e.unbind("mouseover"),e.get(0).onselectstart=function(){return!1},e.bind("mousedown",function(e){t.columnSelectionMouseDown(e)}),e.bind("mouseover",function(e){t.columnSelectionMouseOver(e)})},y.prototype.columnSelectionMouseDown=function(e){if(this.focus(),0==this.selection.selectedCells.length&&(this.columnsToSelect=[]),this.clickedColumnId=t(e.currentTarget.parentNode).children().index(e.currentTarget),e.metaKey){var n=t.inArray(this.clickedColumnId,this.columnsToSelect);n>=0?this.columnsToSelect.splice(n,1):this.columnsToSelect.push(this.clickedColumnId)}else if(e.shiftKey){this.columnsToSelect.sort(function(e,t){return e-t});var i=this.columnsToSelect[0],a=this.clickedColumnId;i>a&&(i=a,a=this.columnsToSelect[0]),this.columnsToSelect=[];for(var r=i;a>=r;r++)this.columnsToSelect.push(r)}else this.columnsToSelect=[this.clickedColumnId];return this.selectColumns(),e.preventDefault(),e.stopPropagation(),!1},y.prototype.columnSelectionMouseOver=function(e){var t,n,i=e.currentTarget.cellIndex,a=[];if(this.mouseDownColIdx){t=i<this.mouseDownColIdx?i:this.mouseDownColIdx,n=i<this.mouseDownColIdx?this.mouseDownColIdx:i;for(var r=t;n>=r;r++)a.push(r);this.selectColumns(a)}},y.prototype.columnSelectionMouseUp=function(){this.mouseDownColIdx=!1},y.prototype.deleteRows=function(){var e=[],n={},r=this;if(0!==this.selection.selectedCells.length){for(var o=0;o<this.selection.selectedCells.length;o++)n[this.selection.selectedCells[o].parentNode.rowIndex]=!0;for(rowId in n)e.push(rowId);var l=!1;if(e.length==this.numRows&&(l=!0),l){var d=this;i.confirm({title:a.t("Table"),text:a.t("deletetable.confirm"),yes:function(){d.deleteTable()}})}else{e.sort(function(e,t){return e-t});var c=e[0];c>this.numRows-e.length&&c--;var u=this.getRows();t.each(e,function(e,t){for(var n=u[t],i=0;i<n.cells.length;i++)s.splitCell(n.cells[i],function(){return r.newActiveCell().obj})});var h=s.makeGrid(u);t.each(e,function(e,n){for(var i=h[n],a=0;a<i.length;){var r=i[a],o=s.rowspan(r.cell);o>1&&t(r.cell).attr("rowspan",o-1),a+=r.colspan}t(u[n]).remove()}),this.numRows-=e.length,window.setTimeout(function(){var e=t(u[1].cells[c+1]);e.focus()},5),this.selection.unselectCells()}}},y.prototype.deleteColumns=function(){var e,n=[],r=this.getRows(),o=this,l=s.makeGrid(r),d=1;if(this.selection.selectedColumnIdxs.length==l[0].length-d)i.confirm({title:a.t("Table"),text:a.t("deletetable.confirm"),yes:function(){o.deleteTable()}});else{n.sort(function(e,t){return e-t});for(var c=this.selection.selectedColumnIdxs.sort(function(e,t){return t-e}),u=0;u<c.length;u++){for(var h=c[u],p=0;p<r.length;p++){var e=l[p][h];if(e){if(0===e.spannedX){if(1<e.colspan){var f=this.newActiveCell().obj;t(e.cell).after(f),f.attr("rowspan",e.rowspan),f.attr("colspan",e.colspan-1)}t(e.cell).remove()}else t(e.cell).attr("colspan",e.colspan-1);p+=e.rowspan-1}}l=s.makeGrid(r)}this.numCols-=n.length,window.setTimeout(function(){var e=t(r[1].cells[1]);e.focus()},5),this.selection.unselectCells()}},y.prototype.deleteTable=function(){for(var t=-1,n=0;n<this.tablePlugin.TableRegistry.length;n++)if(this.tablePlugin.TableRegistry[n].obj.attr("id")==this.obj.attr("id")){t=n;break}if(t>=0){this.deactivate(),this.selection.selectionType=b,this.tablePlugin.TableRegistry.splice(n,1);var i=e.Selection.rangeObject;i.endContainer=this.obj.get(0).parentNode,i.startContainer=i.endContainer,i.endOffset=v.Utils.Dom.getIndexInParent(this.obj.get(0)),i.startOffset=i.endOffset,i.clearCaches(),this.obj.remove(),this.parentEditable.obj.focus(),i.correctRange(),i.select()}},y.prototype.addRowBeforeSelection=function(){var e=m("before",this.selection);-1!==e&&this.addRow(e)},y.prototype.addRowAfterSelection=function(){var e=m("after",this.selection);-1!==e&&this.addRow(e+1)},y.prototype.addRow=function(e){for(var n,i=1,a=this.get("classSelectionColumn"),r=this.obj.children().children("tr"),o=0;i>o;o++){n=t("<tr>");var l=t("<td>");l.addClass(a),this.attachRowSelectionEventsToCell(l),n.append(l);var d=s.makeGrid(r),c=1;if(e>=d.length)for(var u=c;u<d[0].length;u++)n.append(this.newActiveCell().obj);else for(var h=d[e],u=c,p=h.length;p>u;){var f=h[u];if(s.containsDomCell(f))for(var g=f.colspan;g--;)n.append(this.newActiveCell().obj);else t(f.cell).attr("rowspan",f.rowspan+1);u+=f.colspan}e>=r.length?r.eq(r.length-1).after(n):r.eq(e).before(n)}return this.numRows+=i,n[0]},y.prototype.addColumnsRight=function(){this.addColumns("right")},y.prototype.addColumnsLeft=function(){this.addColumns("left")},y.prototype.addColumns=function(e){var n,r,o=t("<td>"),l=this.getRows(),d=this.selection.selectedColumnIdxs;if(0!==d.length){if(d.sort(function(e,t){return e-t}),!s.isConsecutive(d))return void i.alert({title:a.t("Table"),text:a.t("table.addColumns.nonConsecutive")});if("left"===e){r=d[0];for(var c=0;c<this.selection.selectedColumnIdxs.length;c++)this.selection.selectedColumnIdxs[c]+=1}else r=d[d.length-1];for(var u=s.makeGrid(l),c=0;c<l.length;c++){n=o.clone(),n.html(" "),0==c?this.attachColumnSelectEventsToCell(n):(cellObj=this.newActiveCell(n.get(0)),n=cellObj.obj);var h=s.leftDomCell(u,c,r);null==h?t(l[c]).prepend(n):"left"===e&&s.containsDomCell(u[c][r])?t(h).before(n):t(h).after(n),this.numCols++}}},y.prototype.focus=function(){this.hasFocus||(this.parentEditable.isActive||this.parentEditable.obj.focus(),this.tablePlugin.setFocusedTable(this))},y.prototype.focusOut=function(){this.hasFocus&&(this.tablePlugin.setFocusedTable(b),this.selection.selectionType=b)},y.prototype._removeCursorSelection=function(){var n=e.getSelection();if(n&&n._nativeSelection&&0!=n._nativeSelection._ranges.length){var i=n.getRangeAt(0);if(null!=i.startContainer&&0===t(i.startContainer).closest("table").length&&0!==this.selection.selectedCells.length){var a=r.getContainer(this.selection.selectedCells[0]);t(a).focus()}}},y.prototype.selectColumns=function(e){var t;t=e?e:this.columnsToSelect,this.selection.selectColumns(t),this.tablePlugin._columnheaderButton.setState(this.selection.isHeader()),g(this.selection.selectedCells,this.tablePlugin.columnConfig,this.tablePlugin.columnMSItems,this.tablePlugin.columnMSButton),this.obj.find("div.aloha-ui-table-cell-editable").blur(),s.selectAnchorContents(this.selection.selectedCells),this.selection.notifyCellsSelected(),this._removeCursorSelection(),n.setScope(this.tablePlugin.name+".column")},y.prototype.selectRows=function(){this.selection.selectRows(this.rowsToSelect),this.tablePlugin._rowheaderButton.setState(this.selection.isHeader()),g(this.selection.selectedCells,this.tablePlugin.rowConfig,this.tablePlugin.rowMSItems,this.tablePlugin.rowMSButton),this.obj.find("div.aloha-ui-table-cell-editable").blur(),s.selectAnchorContents(this.selection.selectedCells),this.selection.notifyCellsSelected(),this._removeCursorSelection(),n.setScope(this.tablePlugin.name+".row")},y.prototype.deactivate=function(){var e=this.obj.parent();e.mahaloBlock&&e.mahaloBlock(),this.obj.removeClass(this.get("className")),""==t.trim(this.obj.attr("class"))&&this.obj.removeAttr("class"),this.obj.removeAttr("contenteditable"),this.obj.parents("."+this.get("classTableWrapper")).length&&this.obj.unwrap(),this.obj.find("tr."+this.get("classSelectionRow")+":first").remove();var n=this;t.each(this.obj.context.rows,function(){t(this).children("td."+n.get("classSelectionColumn")).remove()}),this.obj.find("td, th").removeClass(this.get("classCellSelected")),this.obj.find("td, th").removeClass("aloha-table-cell_active"),this.obj.find("td, th").css("cursor",""),this.obj.unbind(),this.obj.children("tbody").unbind();for(var i=0;i<this.cells.length;i++){var a=this.cells[i];a.deactivate()}this.obj.find("caption div").each(function(){t(this).contents().unwrap()}),this.isActive=!1},y.prototype.attachColumnResize=function(e){var n=this;n.detachRowColResize(e);var i=e.closest("tbody").children("tr"),a=e.closest("tr"),r=s.cellIndexToGridColumn(i,i.index(a),a.children().index(e)),o=function(e){var n,a;s.walkCells(i,function(o,l,d,c){var u=t(t(i[o]).children()[l]);return u.hasClass("aloha-table-selectrow")||u.closest("tr").hasClass("aloha-table-selectcolumn")||c>1?!0:(d===r?(a||(a=u.width()-e),s.resizeCellWidth(u,a)):d===r-1&&(n||(n=u.width()+e),s.resizeCellWidth(u,n)),!0)})};e.bind("mousedown.resize",function(){var a=t("<div></div>"),l=t(e),d=l.outerWidth()-l.innerWidth(),c=l.closest("tbody").innerHeight();a.css({height:1>c?1:c,width:1>d?1:d,top:l.closest("tbody").offset().top,left:l.offset().left,position:"absolute","background-color":"#80B5F2"}),t("body").append(a),s.getCellResizeBoundaries(r,i,function(i,r){n.selection.resizeMode=!0,t("body").bind("mousemove.dnd_col_resize",function(e){e.pageX>r&&e.pageX<i&&a.css("left",e.pageX)}),t("body").bind("mouseup.dnd_col_resize",function(s){var l=0;s.pageX<r?l=r-e.offset().left:s.pageX>r&&s.pageX<i?l=s.pageX-e.offset().left:s.pageX>i&&(l=i-e.offset().left),0!==l&&o(l),t("body").unbind("mousemove.dnd_col_resize"),t("body").unbind("mouseup.dnd_col_resize"),n.selection.resizeMode=!1,a.remove()})})})},y.prototype.attachRowResize=function(e,n){var i=this;i.detachRowColResize(e);var a=function(t){var i;i=n?e.closest("tr"):e.closest("tr").prev("tr");var a=i.height(),r=a+t;0>r&&(r=1),i.css("height",r)};e.bind("mousedown.resize",function(){var r=t("<div></div>"),o=function(){return n?e.offset().top+e.outerHeight():e.offset().top},s=e.closest("tbody").innerWidth(),l=e.outerHeight()-e.innerHeight();r.css({width:1>s?1:s,height:1>l?1:l,top:o(),left:e.closest("tbody").offset().left,position:"absolute","background-color":"#80B5F2"}),t("body").append(r);var d=function(){return n?e.closest("tr").offset().top:e.closest("tr").prev("tr").offset().top};i.selection.resizeMode=!0,t("body").bind("mousemove.dnd_row_resize",function(e){e.pageY>d()&&r.css("top",e.pageY)}),t("body").bind("mouseup.dnd_row_resize",function(o){var s=0;s=n?o.pageY-(e.offset().top+e.outerHeight()):o.pageY-e.offset().top,a(s),t("body").unbind("mousemove.dnd_row_resize"),t("body").unbind("mouseup.dnd_row_resize"),i.selection.resizeMode=!1,r.remove()})})},y.prototype.attachTableResizeWidth=function(e){var n,i=this,a=e.closest(".aloha-table-wrapper"),r="tr:not(.aloha-table-selectcolumn)",o=e.find(r+" th:last-child, "+r+" td:last-child");t.each(o,function(){return!t(this).attr("colspan")||t(this).attr("colspan")<2?(n=t(this),!1):void 0}),o.css("cursor","col-resize");var l=function(i){var a=e.find("tr"),r=n.closest("tr"),o=s.cellIndexToGridColumn(a,a.index(r),r.children().index(n)),l=i-s.getCellBorder(n)-s.getCellPadding(n);s.walkCells(a,function(e,n,i,r){var d=t(t(a[e]).children()[n]);return d.hasClass("aloha-table-selectrow")||d.closest("tr").hasClass("aloha-table-selectcolumn")||r>1?!0:(i===o?s.resizeCellWidth(d,l):s.resizeCellWidth(d,d.width()),!0)})};o.bind("mousedown.resize",function(){var r=t("<div></div>"),d=e.children("tbody").innerHeight(),c=n.outerWidth()-n.innerWidth();r.css({height:1>d?1:d,width:1>c?1:c,top:e.find("tbody").offset().top,left:e.offset().left+e.outerWidth(),position:"absolute","background-color":"#80B5F2"}),t("body").append(r);var u=a.offset().left+a.width(),h=n.offset().left+(n.innerWidth()-n.width())+s.getMinColWidth(n);i.selection.resizeMode=!0,t("body").bind("mousemove.dnd_col_resize",function(e){e.pageX>h&&e.pageX<u&&r.css("left",e.pageX)}),t("body").bind("mouseup.dnd_col_resize",function(e){var a=0;e.pageX<=h?a=h-n.offset().left:e.pageX>h&&e.pageX<u?a=e.pageX-n.offset().left:e.pageX>u&&(a=u-n.offset().left),l(a),t("body").unbind("mousemove.dnd_col_resize"),t("body").unbind("mouseup.dnd_col_resize"),o.unbind("mousedown.resize"),o.css("cursor","default"),i.selection.resizeMode=!1,r.remove()})})},y.prototype.detachRowColResize=function(e){return e.unbind("mousedown.resize")},y.prototype.toString=function(){return"Table"},y.prototype.newCell=function(e){return new r(e,this)},y.prototype.newActiveCell=function(e){var t=new r(e,this);return t.activate(),t},y.prototype.getRows=function(){var e=this.obj.get(0).rows;return t.makeArray(e)},y}),define("table/table-plugin",["aloha","jquery","aloha/plugin","aloha/pluginmanager","ui/ui","ui/scopes","ui/button","ui/toggleButton","ui/dialog","ui/port-helper-attribute-field","ui/port-helper-multi-split","i18n!table/nls/i18n","i18n!aloha/nls/i18n","table/table-create-layer","table/table","table/table-plugin-utils","util/dom","aloha/ephemera","aloha/console"],function(e,t,n,i,a,r,o,s,l,d,c,u,h,p,f,g,m,b,v){function y(e){var t=D(e.summary.getInputElem()),n=e.activeTable.get("waiRed"),i=e.activeTable.get("waiGreen");t.removeClass(n+" "+i),t.addClass(e.activeTable.checkWai()?i:n)}function _(e){return 0<e.parents(".aloha-editable table").length}function w(e){var t,n,i=e.parents();for(t=0;t<i.length;t++){if(n=i.eq(t),n.is(".aloha-editable"))return!1;if(n.is(".aloha-block"))return!0}return!1}function C(e){return O.Utils.Dom.isEditable(e)}function k(e){var t=e.is("table")?"table":"table table";return e.find(t).length?(v.warn("Table Plugin","Nested tables found. They will not be initialized."),!0):!1}function x(t){var n=D(t),i=C(t)&&!_(n)&&!w(n);if(i){var a=new f(t,I),r=D(m.getEditingHostOf(t));return a.parentEditable=e.getEditableById(r.attr("id")),I.TableRegistry.push(a),k(n),e.activeEditable===a.parentEditable&&a.activate(),a}return null}function S(n,i){var a,r,o,s,l=n.selection.isHeader();for(a=0;a<n.selection.selectedCells.length;a++){for(o=n.selection.selectedCells[a],r=0;r<n.cells.length;r++)if(o===n.cells[r].obj[0]){cell=n.cells[r];break}s=l?e.Markup.transformDomObject(o,"td").removeAttr("scope").get(0):e.Markup.transformDomObject(o,"th").attr("scope",i).get(0),null!=cell&&(cell.obj[0]=s,cell.deactivate(),cell.activate()),t(n.selection.selectedCells[a]).bind("mousedown",function(){var e=t(this).children("div").eq(0);window.setTimeout(function(){e.trigger("focus")},1)})}}function j(e,n,i){for(var a=!0,r=0;r<i.length;r++)if(t(i[r]).attr("class").indexOf(n)<0){a=!1;break}if(a)for(var r=0;r<i.length;r++)t(i[r]).removeClass(n);else for(var r=0;r<i.length;r++){t(i[r]).addClass(n);for(var o=0;o<e.length;o++)e[o].cssClass!=n&&t(i[r]).removeClass(e[o].cssClass)}}function N(){var e=[],n=M;return t.each(arguments,function(){e.push("."+(""==this?n:n+"-"+this))}),t.trim(e.join(" "))}function T(){var e=[],n=M;return t.each(arguments,function(){e.push(""==this?n:n+"-"+this)}),t.trim(e.join(" "))}function E(e,n){var i=e.endContainer,a=e.startContainer,r=3==i.nodeType?i.length:i.childNodes.length;3==a.nodeType&&"P"==a.parentNode.tagName&&1==a.parentNode.childNodes.length&&/^(\s|%A0)$/.test(escape(a.data))&&(a.data="",e.startOffset=0,i==a&&(e.endOffset=0)),O.Utils.Dom.allowsNesting(3==a.nodeType?a.parentNode:a,n)||(0==e.startOffset&&t(3==a.nodeType?a.parentNode:a).addClass("aloha-table-cleanme"),e.endOffset==r&&t(3==i.nodeType?i.parentNode:i).addClass("aloha-table-cleanme"))}function A(){for(var e=t(".aloha-table-cleanme").removeClass("aloha-table-cleanme"),n=0;n<e.length;n++)""!=t.trim(t(e[n]).html())||O.Utils.Dom.isEditingHost(e[n])||t(e[n]).remove()}var D=t,O=window.GENTICS,I=new n("table");I.createLayer=void 0,I.config=["table"],I.TableRegistry=new Array,I.activeTable=void 0,I.parameters={className:"aloha-table",classSelectionRow:"aloha-table-selectcolumn",classSelectionColumn:"aloha-table-selectrow",classLeftUpperCorner:"aloha-table-leftuppercorner",classTableWrapper:"aloha-table-wrapper",classCellSelected:"aloha-cell-selected",waiRed:"aloha-wai-red",waiGreen:"aloha-wai-green",selectionArea:10},I.checkConfig=function(e){if("object"==typeof e&&e.length){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push({name:e[n].name,text:e[n].text?e[n].text:e[n].name,tooltip:e[n].tooltip?e[n].tooltip:e[n].text,iconClass:e[n].iconClass?e[n].iconClass:"aloha-icon-"+e[n].name,cssClass:e[n].cssClass?e[n].cssClass:e[n].name});e=t}else e=[];return e},I.init=function(){var n=this,i={};b.classes(this.get("className"),this.get("classCellSelected")),this.tableConfig=this.checkConfig(this.tableConfig||this.settings.tableConfig),this.columnConfig=this.checkConfig(this.columnConfig||this.settings.columnConfig),this.rowConfig=this.checkConfig(this.rowConfig||this.settings.rowConfig),this.cellConfig=this.checkConfig(this.cellConfig||this.settings.cellConfig),this.tableResize=void 0===this.settings.tableResize?!1:this.settings.tableResize,this.colResize=void 0===this.settings.colResize?!1:this.settings.colResize,this.rowResize=void 0===this.settings.rowResize?!1:this.settings.rowResize,t.browser.msie&&parseInt(t.browser.version,10)<8&&(this.tableResize=!1,this.colResize=!1,this.rowResize=!1),this.createLayer=new p(this),e.bind("aloha-editable-created",function(e,a){var r=n.getEditableConfig(a.obj);i[a.getId()]=-1!==t.inArray("table",r),a.obj.bind("mousedown",function(){I.setFocusedTable(void 0)}),a.obj.find("table").each(function(e,t){x(t)})}),this.initTableButtons(),e.bind("aloha-table-selection-changed",function(){"undefined"!=typeof I.activeTable&&I.activeTable.selection&&(I.updateFloatingMenuScope(),I.activeTable.selection.cellsAreSplitable()?(n._splitcellsButton.enable(!0),n._splitcellsRowButton.enable(!0),n._splitcellsColumnButton.enable(!0)):(n._splitcellsButton.enable(!1),n._splitcellsRowButton.enable(!1),n._splitcellsColumnButton.enable(!1)),I.activeTable.selection.cellsAreMergeable()?(n._mergecellsButton.enable(!0),n._mergecellsRowButton.enable(!0),n._mergecellsColumnButton.enable(!0)):(n._mergecellsButton.enable(!1),n._mergecellsRowButton.enable(!1),n._mergecellsColumnButton.enable(!1)))}),e.bind("aloha-selection-changed",function(t,a){if(a.startContainer&&e.activeEditable&&(i[e.activeEditable.getId()]&&e.Selection.mayInsertTag("table")?n._createTableButton.show():n._createTableButton.hide(),n.activeTable)){var r=a.findMarkup(function(){return"TABLE"===this.nodeName},e.activeEditable.obj);r?(I.updateFloatingMenuScope(),I.setActiveCellStyle()):(n.activeTable.selection.cellSelectionMode=!1,n.activeTable.selection.baseCellPosition=null,n.activeTable.selection.lastSelectionRange=null,n.activeTable.focusOut())}}),e.bind("aloha-editable-activated",function(e,i){n._splitcellsButton.enable(!1),n._mergecellsButton.enable(!1),n._splitcellsRowButton.enable(!1),n._mergecellsRowButton.enable(!1),n._splitcellsColumnButton.enable(!1),n._mergecellsColumnButton.enable(!1),i.editable.obj.find("table").each(function(){for(var e=I.TableRegistry,n=0;n<e.length;n++)if(e[n].obj.attr("id")===t(this).attr("id"))return e[n].activate(),!0;x(this)})}),e.bind("aloha-editable-deactivated",function(){I.activeTable&&I.activeTable.selection.unselectCells(),I.setFocusedTable(void 0);for(var e=I.TableRegistry,t=0;t<e.length;t++)e[t].deactivate()}),e.bind("aloha-smart-content-changed",function(){e.activeEditable&&e.activeEditable.obj.find("table").each(function(){-1==I.indexOfTableInRegistry(this)&&x(this)&&(this.id=O.Utils.guid())})}),this.settings.summaryinsidebar&&e.bind("aloha-plugins-loaded",function(){n.initSidebar(e.Sidebar.right.show())})};var M="aloha-table";return I.initSidebar=function(e){var n=this;n.sidebar=e,n.sidebarPanel=e.addPanel({id:T("sidebar-panel"),title:u.t("table.sidebar.title"),content:"",expanded:!0,activeOn:"table",onInit:function(){{var e=this;this.setContent('<label class="'+T("label")+'" for="'+T("textarea")+'" >'+u.t("table.label.target")+'</label><textarea id="'+T("textarea")+'" class="'+T("textarea")+'" />').content}t(N("textarea")).live("keyup",function(){t(e.effective).attr("summary",t(N("textarea")).val());var i=t('div[class*="wai"]',"table#"+t(e.effective).attr("id"));i.removeClass(n.get("waiGreen")),i.removeClass(n.get("waiRed")),i.addClass(""!=t(N("textarea")).val().trim()?n.get("waiGreen"):n.get("waiRed"))})},onActivate:function(e){var n=this;n.effective=e,t(N("textarea")).val(t(n.effective).attr("summary"))}}),e.show()},I.isEditableTable=function(e){return O.Utils.Dom.isEditable(e)},I.indexOfTableInRegistry=function(e){for(var t=this.TableRegistry,n=0;n<t.length;n++)if(t[n].obj[0].id==e.id)return n;return-1},I.getTableFromRegistry=function(e){var t=this.indexOfTableInRegistry(e);return t>-1?this.TableRegistry[t]:null},I.isSelectionInTable=function(){var n=e.Selection.getRangeObject(),i=t(n.commonAncestorContainer);return 0==i.length?!1:i.parents(".aloha-editable table").length?!0:!1},I.preventNestedTables=function(){return this.isSelectionInTable()?(l.alert({title:u.t("Table"),text:u.t("table.createTable.nestedTablesNoSupported")}),!0):!1},I.initMergeSplitCellsBtns=function(){this._mergecellsButton=a.adopt("mergecells",o,{tooltip:u.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".cell",click:function(){I.activeTable&&I.activeTable.selection.mergeCells()}}),this._splitcellsButton=a.adopt("splitcells",o,{tooltip:u.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".cell",click:function(){var t;I.activeTable&&(I.activeTable.selection.selectedCells.length>0?I.activeTable.selection.splitCells():(t=I.selectedOrActiveCells(),t.length>0&&(g.splitCell(t,function(){return I.activeTable.newActiveCell().obj}),e.trigger("aloha-table-selection-changed"))))}}),this._mergecellsRowButton=a.adopt("mergecellsRow",o,{tooltip:u.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".row",click:function(){I.activeTable&&I.activeTable.selection.mergeCells()}}),this._splitcellsRowButton=a.adopt("splitcellsRow",o,{tooltip:u.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".row",click:function(){I.activeTable&&I.activeTable.selection.splitCells()}}),this._mergecellsColumnButton=a.adopt("mergecellsColumn",o,{tooltip:u.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".column",click:function(){I.activeTable&&I.activeTable.selection.mergeCells()}}),this._splitcellsColumnButton=a.adopt("splitcellsColumn",o,{tooltip:u.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".column",click:function(){I.activeTable&&I.activeTable.selection.splitCells()}})},I.initNaturalFitBtn=function(){var e=this;(this.colResize||this.rowResize)&&(this._tableNaturalFitButton=a.adopt("naturalFit",o,{tooltip:u.t("button.naturalfit.tooltip"),icon:"aloha-icon aloha-icon-table-naturalfit",scope:this.name+".cell",click:function(){if(e.activeTable){var n=e.activeTable.obj;n.find("td, th").each(function(){t(this).find("div").css("width",""),t(this).css("width","")}),n.find("tr").each(function(){t(this).css("height","")})}}}))},I.initRowsBtns=function(){var e=this;this._addrowbeforeButton=a.adopt("addrowbefore",o,{tooltip:u.t("button.addrowbefore.tooltip"),icon:"aloha-icon aloha-icon-addrowbefore",scope:this.name+".row",click:function(){e.activeTable&&e.activeTable.addRowBeforeSelection()}}),this._addrowafterButton=a.adopt("addrowafter",o,{tooltip:u.t("button.addrowafter.tooltip"),icon:"aloha-icon aloha-icon-addrowafter",scope:this.name+".row",click:function(){e.activeTable&&e.activeTable.addRowAfterSelection()}}),this._deleterowsButton=a.adopt("deleterows",o,{tooltip:u.t("button.delrows.tooltip"),icon:"aloha-icon aloha-icon-deleterows",scope:this.name+".row",click:function(){if(e.activeTable){var t=e.activeTable;l.confirm({title:u.t("Table"),text:u.t("deleterows.confirm"),yes:function(){t.deleteRows()}})}}}),this._rowheaderButton=a.adopt("rowheader",s,{tooltip:u.t("button.rowheader.tooltip"),icon:"aloha-icon aloha-icon-rowheader",scope:this.name+".row",click:function(){e.activeTable&&(e.activeTable.refresh(),S(e.activeTable,"col"),e.activeTable.selection.selectRows(e.activeTable.selection.selectedRowIdxs),e.activeTable.selection.unselectCells())}}),this.rowMSItems=[],t.each(this.rowConfig,function(t,n){e.rowMSItems.push({name:n.name,text:u.t(n.text),tooltip:u.t(n.tooltip),iconClass:"aloha-icon aloha-row-layout "+n.iconClass,click:function(){e.activeTable&&(j(e.rowConfig,n.cssClass,e.activeTable.selection.selectedCells),e.activeTable.selectRows())}})}),this.rowMSItems.length>0&&this.rowMSItems.push({name:"removeFormat",text:u.t("button.removeFormat.text"),tooltip:u.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:!0,click:function(){if(e.activeTable){for(var n=e.activeTable.selection.selectedCells,i=0;i<n.length;i++)for(var a=0;a<e.rowConfig.length;a++)t(n[i]).removeClass(e.rowConfig[a].cssClass);e.activeTable.selectRows()}}}),this.rowMSButton=c({items:this.rowMSItems,name:"formatRow",hideIfEmpty:!0,scope:this.name+".row"})},I.initColumnBtns=function(){var e=this;this._addcolumnleftButton=a.adopt("addcolumnleft",o,{tooltip:u.t("button.addcolleft.tooltip"),icon:"aloha-icon aloha-icon-addcolumnleft",scope:this.name+".column",click:function(){e.activeTable&&e.activeTable.addColumnsLeft()}}),this._addcolumnrightButton=a.adopt("addcolumnright",o,{tooltip:u.t("button.addcolright.tooltip"),icon:"aloha-icon aloha-icon-addcolumnright",scope:this.name+".column",click:function(){e.activeTable&&e.activeTable.addColumnsRight()}}),this._deletecolumnsButton=a.adopt("deletecolumns",o,{tooltip:u.t("button.delcols.tooltip"),icon:"aloha-icon aloha-icon-deletecolumns",scope:this.name+".column",click:function(){if(e.activeTable){var t=e.activeTable;l.confirm({title:u.t("Table"),text:u.t("deletecolumns.confirm"),yes:function(){t.deleteColumns()}})}}}),this._columnheaderButton=a.adopt("columnheader",s,{tooltip:u.t("button.columnheader.tooltip"),icon:"aloha-icon aloha-icon-columnheader",scope:this.name+".column",click:function(){e.activeTable&&(e.activeTable.refresh(),S(e.activeTable,"row"),e.activeTable.selection.selectColumns(e.activeTable.selection.selectedColumnIdxs),e.activeTable.selection.unselectCells())}}),this.columnMSItems=[],t.each(this.columnConfig,function(t,n){var i={name:n.name,text:u.t(n.text),tooltip:u.t(n.tooltip),iconClass:"aloha-icon aloha-column-layout "+n.iconClass,click:function(){e.activeTable&&(j(e.columnConfig,n.cssClass,e.activeTable.selection.selectedCells),e.activeTable.selectColumns())}};e.columnMSItems.push(i)}),this.columnMSItems.length>0&&this.columnMSItems.push({name:"removeFormat",text:u.t("button.removeFormat.text"),tooltip:u.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:!0,click:function(){if(e.activeTable){for(var n=e.activeTable.selection.selectedCells,i=0;i<n.length;i++)for(var a=0;a<e.columnConfig.length;a++)t(n[i]).removeClass(e.columnConfig[a].cssClass);e.activeTable.selectColumns()}}}),this.columnMSButton=c({items:this.columnMSItems,name:"formatColumn",hideIfEmpty:!0,scope:this.name+".column"})},I.initCellBtns=function(){var e=this;this.cellMSItems=[],t.each(this.cellConfig,function(t,n){var i={name:n.name,text:u.t(n.text),tooltip:u.t(n.tooltip),iconClass:"aloha-icon aloha-column-layout "+n.iconClass,click:function(){e.activeTable&&(j(e.cellConfig,n.cssClass,e.selectedOrActiveCells()),e.setActiveCellStyle())}};e.cellMSItems.push(i)}),this.cellMSItems.length>0&&this.cellMSItems.push({name:"removeFormat",text:u.t("button.removeFormat.text"),tooltip:u.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:!0,click:function(){if(e.activeTable){for(var n=e.selectedOrActiveCells(),i=0;i<n.length;i++)for(var a=0;a<e.cellConfig.length;a++)t(n[i]).removeClass(e.cellConfig[a].cssClass);e.setActiveCellStyle()}}}),this.cellMSButton=c({items:this.cellMSItems,name:"formatCell",hideIfEmpty:!0,scope:this.name+".cell"})},I.initTableButtons=function(){var n=this;r.createScope(this.name+".row","Aloha.continuoustext"),r.createScope(this.name+".column","Aloha.continuoustext"),r.createScope(this.name+".cell","Aloha.continuoustext"),this._createTableButton=a.adopt("createTable",o,{tooltip:u.t("button.createtable.tooltip"),icon:"aloha-icon aloha-icon-createTable",scope:"Aloha.continuoustext",click:function(){I.createDialog(this.element)}}),this.initColumnBtns(),this.initRowsBtns(),this.initCellBtns(),this.initMergeSplitCellsBtns(),this.initNaturalFitBtn(),this.tableMSItems=[];var i=this.tableConfig;t.each(i,function(e,t){n.tableMSItems.push({name:t.name,text:u.t(t.text),tooltip:u.t(t.tooltip),iconClass:"aloha-icon aloha-table-layout "+t.iconClass,click:function(){if(n.activeTable)if(n.activeTable.obj.hasClass(t.cssClass)){for(var e=0;e<i.length;e++)n.activeTable.obj.removeClass(i[e].cssClass);n.tableMSButton.setActiveItem()}else{for(var e=0;e<i.length;e++)n.activeTable.obj.removeClass(i[e].cssClass);n.activeTable.obj.addClass(t.cssClass),n.tableMSButton.setActiveItem(t.cssClass)}}})}),this.tableMSItems.length>0&&this.tableMSItems.push({name:"removeFormat",text:u.t("button.removeFormat.text"),tooltip:u.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:!0,click:function(){if(n.activeTable){for(var e=0;e<i.length;e++)n.activeTable.obj.removeClass(n.tableConfig[e].cssClass);n.tableMSButton.setActiveItem()}}}),this.tableMSButton=c({items:this.tableMSItems,name:"formatTable",hideIfEmpty:!0,scope:this.name+".cell"}),this._tableCaptionButton=a.adopt("tableCaption",s,{tooltip:u.t("button.caption.tooltip"),icon:"aloha-icon aloha-icon-table-caption",scope:this.name+".cell",click:function(){if(n.activeTable){var i=n.activeTable.obj.children("caption");if(i.is("caption")&&i.is(":visible"))i.hide();else{i.is("caption")||(i=t("<caption></caption>"),n.activeTable.obj.prepend(i)),i.show(),0===t.trim(i.text()).length&&i.text(u.t("empty.caption")),n.makeCaptionEditable(i,i.text());var a=i.find("div").eq(0),r=a.contents().eq(0);if(r.length>0){var o=new O.Utils.RangeObject;o.startContainer=o.endContainer=r.get(0),o.startOffset=0,o.endOffset=r.text().length,n.activeTable.obj.find("div.aloha-table-cell-editable").blur(),a.focus(),o.select(),e.Selection.updateSelection()}}}}}),this.summary=d({width:275,name:"tableSummary",noTargetHighlight:!0,scope:this.name+".cell",element:t('<input id="aloha-attribute-field-tableSummary" class="aloha-wai-red" style="color: black; padding-left: 32px; background-color: white"/>')}),this.summary.addListener("keyup",function(){n.activeTable&&y(n)})},I.makeCaptionEditable=function(e,n){var i=e.children("div");0===i.length?(i=t("<div></div>"),i.addClass("aloha-ui aloha-editable-caption aloha-block"),b.markWrapper(i),e.contents().length>0?(i.append(e.contents()),e.append(i)):(n&&i.text(n),e.append(i))):i.length>1&&(e.children("div:not(:first-child)").each(function(){$this=t(this),i.eq(0).append($this.contents()),$this.remove()}),i=i.eq(0)),i.contentEditable(!0)},I.createDialog=function(e){this.createLayer.set("target",e),this.createLayer.show()},I.createTable=function(n,i){if(!this.preventNestedTables())if(e.activeEditable&&"undefined"!=typeof e.activeEditable.obj){for(var a=document.createElement("table"),r=a.id=O.Utils.guid(),o=document.createElement("tbody"),s=0;i>s;s++){for(var l=document.createElement("tr"),d=0;n>d;d++){var c=document.createTextNode(" "),u=document.createElement("td");
u.appendChild(c),l.appendChild(u)}o.appendChild(l)}a.appendChild(o),E(e.Selection.getRangeObject(),a),O.Utils.Dom.insertIntoDOM(t(a),e.Selection.getRangeObject(),e.activeEditable.obj),A();var h=document.getElementById(r),p=x(h);p&&(D.browser.msie?window.setTimeout(function(){p.cells[0].wrapper.get(0).focus()},20):p.cells[0].wrapper.get(0).focus()),p.focus(),I.activeTable.selection.selectionType="cell",I.updateFloatingMenuScope()}else this.error("There is no active Editable where the table can be				inserted!")},I.setFocusedTable=function(e){var t=this;null!=this.activeTable&&this.activeTable.selection.unselectCells();for(var n=0;n<I.TableRegistry.length;n++)I.TableRegistry[n].hasFocus=!1;if("undefined"!=typeof e){if(this.summary.setTargetObject(e.obj,"summary"),e.obj.children("caption").is("caption")){this._tableCaptionButton.setState(!0);var i=e.obj.children("caption");t.makeCaptionEditable(i)}e.hasFocus=!0}I.activeTable=e,I.activeTable&&y(I);for(var n=0;n<this.tableMSItems.length;n++)this.tableMSButton.showItem(this.tableMSItems[n].name);if(this.tableMSButton.setActiveItem(),this.activeTable)for(var n=0;n<this.tableConfig.length;n++)this.activeTable.obj.hasClass(this.tableConfig[n].cssClass)&&this.tableMSButton.setActiveItem(this.tableConfig[n].name)},I.error=function(t){e.Log.error(this,t)},I.debug=function(t){e.Log.debug(this,t)},I.info=function(t){e.Log.info(this,t)},I.log=function(t){e.log("log",this,t)},I.get=function(e){return this.config[e]?this.config[e]:this.parameters[e]?this.parameters[e]:void 0},I.set=function(e,t){this.config[e]?this.config[e]=t:this.parameters[e]=t},I.makeClean=function(e){e.find("td, th").css("cursor","")},I.toString=function(){return this.prefix},I.updateFloatingMenuScope=function(){null!=I.activeTable&&null!=I.activeTable.selection.selectionType&&r.setScope(I.name+"."+I.activeTable.selection.selectionType)},I.setActiveCellStyle=function(){var e,n=this,i=!1;this.cellMSButton.setActiveItem();for(var a=n.selectedOrActiveCells(),r=0;r<n.cellConfig.length;r++)if(t(a[0]).hasClass(n.cellConfig[r].cssClass)){e=n.cellConfig[r].name,i=!0;break}t(a).each(function(){t(this).hasClass(e)||(i=!1)}),i&&this.cellMSButton.setActiveItem(e)},I.selectedOrActiveCells=function(){var t=this.activeTable.selection.selectedCells;if(!t||t.length<1){var n=function(){var t=e.Selection.getRangeObject();return e.activeEditable?t.findMarkup(function(){return"td"===this.nodeName.toLowerCase()},e.activeEditable.obj):null},i=n();return i?[i]:[]}return t},i.register(I),I}),define("format/nls/i18n",{root:{"button.strong.tooltip":"Strong","button.em.tooltip":"Emphasize","button.b.tooltip":"Bold","button.i.tooltip":"Italic","button.u.tooltip":"Underline","button.cite.tooltip":"Cite","button.q.tooltip":"Tooltip","button.code.tooltip":"Code","button.abbr.tooltip":"Abbreviation","button.del.tooltip":"Strikethrough","button.s.tooltip":"Strikethrough","button.sub.tooltip":"Subscript","button.sup.tooltip":"Superscript","button.p.tooltip":"Paragraph","button.h1.tooltip":"Heading 1","button.h2.tooltip":"Heading 2","button.h3.tooltip":"Heading 3","button.h4.tooltip":"Heading 4","button.h5.tooltip":"Heading 5","button.h6.tooltip":"Heading 6","button.pre.tooltip":"Preformatted text","button.title.tooltip":"Title","button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting",GENTICS_button_p:"GENTICS_button_p",GENTICS_button_h1:"GENTICS_button_h1",GENTICS_button_h2:"GENTICS_button_h2",GENTICS_button_h3:"GENTICS_button_h3",GENTICS_button_h4:"GENTICS_button_h4",GENTICS_button_h5:"GENTICS_button_h5",GENTICS_button_h6:"GENTICS_button_h6",GENTICS_button_pre:"GENTICS_button_pre",GENTICS_button_title:"GENTICS_button_title",formatBold:"Ctrl+b",formatItalic:"Ctrl+i",formatUnderline:"Ctrl+u",formatParagraph:"Alt+Ctrl+0",formatH1:"Alt+Ctrl+1",formatH2:"Alt+Ctrl+2",formatH3:"Alt+Ctrl+3",formatH4:"Alt+Ctrl+4",formatH5:"Alt+Ctrl+5",formatH6:"Alt+Ctrl+6",formatPre:"Alt+Ctrl+P",formatDel:"Ctrl+\\",formatSub:"Ctrl+,",formatSup:"Ctrl+.","floatingmenu.tab.format":"Format","format.class.legend":"CSS class","format.class.none":"none"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("format/format-plugin",["aloha","aloha/plugin","aloha/state-override","jquery","util/arrays","util/html","util/dom","ui/ui","ui/toggleButton","ui/port-helper-multi-split","PubSub","i18n!format/nls/i18n","i18n!aloha/nls/i18n","aloha/selection"],function(e,t,n,i,a,r,o,s,l,d,c,u){function h(e){var t=e.startContainer,n=e.startOffset,i=e.endContainer,a=e.endOffset;return t===i&&0===n&&a===i.length}function p(e){var t=e.commonAncestorContainer;if(R(t)){var n=t.parentNode;return e.startContainer=n,e.endContainer=n,e.commonAncestorContainer=n,e.startOffset=0,e.endOffset=1,void p(e)}e.update()}function f(e){return P[e.nodeName]}function g(e){return e.startContainer!==e.endContainer}function m(e){p(e);var t=e.commonAncestorContainer;if(f(t)&&(h(e)||g(e))){var n=i(e.startContainer.parentNode).nextUntil(i(e.endContainer.parentNode).next()).andSelf(),a=i(e.startContainer.parentNode).prevAll(),r=i(e.endContainer.parentNode).nextAll(),o=e.startContainer.parentNode.parentNode.nodeName;1===n.length&&0===a.length?n.each(function(){i(this).addClass("_moved")}).remove().insertBefore(r.parent()):1===n.length&&0===r.length?n.each(function(){i(this).addClass("_moved")}).remove().insertAfter(a.parent()):1===n.length&&r.length>1?(n.each(function(){i(this).addClass("_moved")}).remove().insertAfter(a.parent()),i("<"+o.toLowerCase()+">").append(r).insertAfter(i(e.endContainer))):(n.each(function(){i(this).addClass("_moved")}).remove().insertAfter(t),r.length>0&&i("<"+o.toLowerCase()+">").append(r).insertAfter(i(e.endContainer))),i("._moved").each(function(){i(this).contents().unwrap().wrap("<p>")}),0===a.length&&t.remove()}}function b(e){var t=i(".aloha-cell-selected");if(t.length>0){var n=0;return t.each(function(){var t=i(this).find("div"),a=t.find(e);a.length>0&&(a.contents().unwrap(),n++),t.contents().wrap("<"+e+"></"+e+">")}),n===t.length&&t.find(e).contents().unwrap(),!0}return!1}function v(e,t){return b(t)?!1:(e.addMarkup(t),!1)}function y(t,n){return b(n)?!1:(t.changeMarkup(n),e.activeEditable&&i.browser.mozilla&&e.activeEditable.obj.focus(),void(e.activeEditable&&e.trigger("aloha-format-block")))}function _(e,t){var n=A[t],i=n;D.hasOwnProperty(t)&&(i=D[t]);var a=s.adopt(i,l,{tooltip:u.t("button."+t+".tooltip"),icon:"aloha-icon aloha-icon-"+i,scope:"Aloha.continuoustext",click:function(){return v(e,t)}});return a}function w(e,t){return{name:t,tooltip:u.t("button."+t+".tooltip"),iconClass:"aloha-icon "+u.t("aloha-large-icon-"+t),markup:i("<"+t+">"),click:function(){return y(e,t)}}}function C(e,t){return{name:t,text:u.t("button."+t+".text"),tooltip:u.t("button."+t+".tooltip"),wide:!0,cls:"aloha-ui-multisplit-fullwidth",click:function(){e.removeFormat()}}}function k(t){e.Selection.changeMarkupOnSelection(i("<"+t+">"))}function x(t,n){n.select(),T(t,e.Selection.getRangeObject())}function S(e,t,n){o.addMarkup(t,n),x(e,t)}function j(e,t,n){var a=t.getEditableConfig(n.obj);return i.inArray(e,a)>-1}function N(t){var r=this,s=i("<"+t+">"),l=e.Selection.rangeObject;if("undefined"!=typeof t&&""!=t){var d=M[s[0].nodeName]||[s[0].nodeName],c=l.findMarkup(function(){return-1!==a.indexOf(d,this.nodeName)},e.activeEditable.obj);if(c)l.isCollapsed()?o.removeFromDOM(c,l,!0):o.removeMarkup(l,i(c),e.activeEditable.obj),x(r,l);else{if(l.isCollapsed()&&(o.extendToWord(l),l.isCollapsed()&&n.enabled()))return void n.setWithRangeObject(A[t],l,function(e,t){S(r,t,s)});S(r,l,s)}}}function T(t,n){var a,r,o,s,l;if(i.each(t.buttons,function(t,r){var l=!1,d=M[r.markup[0].nodeName]||[r.markup[0].nodeName];for(o=0;o<n.markupEffectiveAtStart.length;o++)for(a=n.markupEffectiveAtStart[o],s=0;s<d.length;s++)e.Selection.standardTextLevelSemanticsComparator(a,i("<"+d[s]+">"))&&(r.handle.setState(!0),l=!0);l||r.handle.setState(!1)}),t.multiSplitItems.length>0){for(r=!1,o=0;o<n.markupEffectiveAtStart.length&&!r;o++)for(a=n.markupEffectiveAtStart[o],s=0;s<t.multiSplitItems.length&&!r;s++)l=t.multiSplitItems[s],l.markup&&e.Selection.standardTextLevelSemanticsComparator(a,l.markup)&&(t.multiSplitButton.setActiveItem(l.name),r=!0);r||t.multiSplitButton.setActiveItem(null)}}var E="aloha-format",A={b:"bold",strong:"bold",i:"italic",em:"italic",del:"strikethrough",sub:"subscript",sup:"superscript",u:"underline",s:"strikethrough"},D={strong:"strong",em:"emphasis",s:"strikethrough2"},O={u:!0,em:!0,strong:!0,b:!0,i:!0,cite:!0,q:!0,code:!0,abbr:!0,del:!0,s:!0,sub:!0,sup:!0},I={p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,pre:!0},M={B:["STRONG","B"],I:["EM","I"],STRONG:["STRONG","B"],EM:["EM","I"]},R=r.isInlineFormattable,P={OL:!0,UL:!0,LI:!0,DL:!0,DT:!0,DD:!0};return t.create("format",{config:["b","i","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","removeFormat"],availableButtons:["u","strong","del","em","b","i","s","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","removeFormat"],hotKey:{formatBold:"ctrl+b",formatItalic:"ctrl+i",formatParagraph:"alt+ctrl+0",formatH1:"alt+ctrl+1",formatH2:"alt+ctrl+2",formatH3:"alt+ctrl+3",formatH4:"alt+ctrl+4",formatH5:"alt+ctrl+5",formatH6:"alt+ctrl+6",formatPre:"ctrl+p",formatDel:"ctrl+d",formatSub:"alt+shift+s",formatSup:"ctrl+shift+s"},init:function(){var t=this;"undefined"!=typeof this.settings.hotKey&&i.extend(!0,this.hotKey,this.settings.hotKey),this.initButtons(),e.bind("aloha-plugins-loaded",function(){t.initSidebar(e.Sidebar.right)}),e.bind("aloha-editable-activated",function(e,n){t.applyButtonConfig(n.editable.obj);var i=function(e){return function(){return j(e,t,n.editable)&&t.addMarkup(e),!1}},a=function(e){return function(){return j(e,t,n.editable)&&t.changeMarkup(e),!1}};n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatBold,i("b")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatItalic,i("i")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatDel,i("del")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatSub,i("sub")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatSup,i("sup")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatParagraph,a("p")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH1,a("h1")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH2,a("h2")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH3,a("h3")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH4,a("h4")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH5,a("h5")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH6,a("h6")),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatPre,a("pre"))}),e.bind("aloha-editable-deactivated",function(e,t){t.editable.obj.unbind("keydown.aloha.format")})},applyButtonConfig:function(e){var t,n,a,r=this.getEditableConfig(e);if("object"==typeof r){var o=[];i.each(r,function(e,t){("number"!=typeof e||"string"!=typeof t)&&o.push(e)}),o.length>0&&(r=o)}this.formatOptions=r;for(t in this.buttons)this.buttons.hasOwnProperty(t)&&(-1!==i.inArray(t,r)?this.buttons[t].handle.show():this.buttons[t].handle.hide());for(a=this.multiSplitItems.length,n=0;a>n;n++)-1!==i.inArray(this.multiSplitItems[n].name,r)?this.multiSplitButton.showItem(this.multiSplitItems[n].name):this.multiSplitButton.hideItem(this.multiSplitItems[n].name)},initButtons:function(){var t=this;this.buttons={},this.multiSplitItems=[],i.each(this.availableButtons,function(n,a){var r=!1;"number"!=typeof n&&"string"!=typeof a&&(r=a,a=n),O[a]?t.buttons[a]={handle:_(t,a),markup:i("<"+a+">",{"class":r||""})}:I[a]?t.multiSplitItems.push(w(t,a)):"removeFormat"===a?t.multiSplitItems.push(C(t,a)):e.log("warn",t,'Button "'+a+'" is not defined')}),this.multiSplitButton=new d({name:"formatBlock",items:this.multiSplitItems,hideIfEmpty:!0,scope:"Aloha.continuoustext"}),c.sub("aloha.selection.context-change",function(e){T(t,e.range)})},initSidebar:function(e){var t=this;t.sidebar=e,e.addPanel({id:t.nsClass("sidebar-panel-class"),title:u.t("floatingmenu.tab.format"),content:"",expanded:!0,activeOn:this.formatOptions||!1,onInit:function(){},onActivate:function(e){var n=this;if(n.effective=e,e[0]){n.format=e[0].nodeName.toLowerCase();var a=i("<div>").attr("class",t.nsClass("target-container")),r=i("<fieldset>");r.append(i("<legend>"+n.format+" "+u.t("format.class.legend")).append(i("<select>"))),a.append(r);var o='<div class="'+t.nsClass("target-container")+'"><fieldset><legend>'+u.t("format.class.legend")+'</legend><select name="targetGroup" class="'+t.nsClass("radioTarget")+'"><option value="">'+u.t("format.class.none")+"</option>";t.config[n.format]&&t.config[n.format]["class"]&&i.each(t.config[n.format]["class"],function(e,t){o+='<option value="'+e+'" >'+t+"</option>"}),o+="</select></fieldset></div>";{this.setContent(o).content}i(t.nsSel("framename")).live("keyup",function(){i(n.effective).attr("target",i(this).val().replace('"',"&quot;").replace("'","&#39;"))}),n.effective=e,i(t.nsSel("linkTitle")).val(i(n.effective).attr("title"))}}}),e.show()},nsClass:function(){var e=[],t=E;return i.each(arguments,function(){e.push(""==this?t:t+"-"+this)}),i.trim(e.join(" "))},nsSel:function(){var e=[],t=E;return i.each(arguments,function(){e.push("."+(""==this?t:t+"-"+this))}),i.trim(e.join(" "))},addMarkup:N,changeMarkup:k,removeFormat:function(){var t,n=["u","strong","em","b","i","q","del","s","code","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","quote","blockquote","section","article","aside","header","footer","address","main","hr","figure","figcaption","div","small","cite","dfn","abbr","data","time","var","samp","kbd","mark","span","wbr","ins"],a=e.Selection.rangeObject;if(this.settings.removeFormats&&(n=this.settings.removeFormats),!a.isCollapsed()){for(t=0;t<n.length;t++)o.removeMarkup(a,i("<"+n[t]+">"),e.activeEditable.obj);m(a),a.select(),e.activeEditable.smartContentChange({type:"block-change"})}},toString:function(){return"format"}})}),define("ui/menuButton",["jquery","ui/component","ui/utils","jqueryui"],function(e,t,n){function i(t,r){var o=[];return e.each(r,function(r,s){var l=e("<li>");if(l.append(e("<a>",{href:"javascript:void 0",html:n.makeButtonLabelWithIcon(s)})),s.click&&l.data("aloha-ui-menubutton-select",function(){t(),s.click()}),s.menu){var d=e("<ul>").appendTo(l);d.append(i(a(d,t),s.menu))}o.push(l[0])}),o}function a(t,n){return n=n||e.noop,function(){t.blur().hide(),t.parent().removeClass("aloha-ui-menubutton-pressed"),n()}}function r(e,t){var n=t.item.data("aloha-ui-menubutton-select");n&&n(e,t),e.preventDefault()}var o=t.extend({init:function(){this.element=o.makeMenuButton(this)}});return o.makeMenuButton=function(t){function o(e){e.hide().parent().removeClass("aloha-ui-menubutton-pressed")}var s=e("<div>",{"class":"aloha-ui-menubutton-container"}),l=n.makeButtonElement({"class":"aloha-ui-menubutton-expand"}),d=e("<ul>",{"class":"aloha-ui-menubutton-menu"}),c=null,u=null;return e.browser.msie&&s.addClass("aloha-ui-menubutton-iehack"),t.click?(c=n.makeButton(n.makeButtonElement({"class":"aloha-ui-menubutton-action"}),t).click(t.click),n.makeButton(l,{},!0),u=e("<div>").buttonset().append(c).append(l)):n.makeButton(l,t,!0).addClass("aloha-ui-menubutton-single"),t.menu?(l.click(function(){return s.addClass("aloha-ui-menubutton-pressed"),t.siblingContainer&&t.siblingContainer.find(".aloha-ui-menubutton-menu").each(function(){this!==d[0]&&o(e(this))}),d.is(":visible")?void o(d):(d.show().position({my:"left top",at:"left bottom",of:c||l}),e(document).bind("click",function(t){e(this).unbind(t),d.hide(),s.removeClass("aloha-ui-menubutton-pressed")}),!1)}),s.append(u||l).append(d),d.append(i(a(d),t.menu)),d.hide().menu({select:r}),s):s.append(c)},o}),define("list/nls/i18n",{root:{"button.createulist.tooltip":"Insert Unordered List","button.createolist.tooltip":"Insert Ordered List","button.indentlist.tooltip":"Indent List","button.outdentlist.tooltip":"Outdent List","floatingmenu.tab.list":"Lists"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("list/list-plugin",["aloha","jquery","aloha/plugin","util/dom","ui/ui","ui/scopes","ui/button","ui/toggleButton","ui/menuButton","i18n!list/nls/i18n","i18n!aloha/nls/i18n","aloha/engine","PubSub"],function(e,t,n,a,r,o,s,l,d,c,u,h,p){function f(e,t){var n=function(e,n){return void 0===t[n]?e:t[n]},i=/\${\s*([a-z0-9\-_]+)\s*}/gi;do{var a=e;e=e.replace(i,n);var r=e!==a}while(r);return e}function g(e,t,n){switch(t){case"ul":e.templates.ul&&e._unorderedListFormatSelectorButton.show(n);break;case"ol":e.templates.ol&&e._orderedListFormatSelectorButton.show(n);break;case"dl":e.templates.dl&&e._definitionListFormatSelectorButton.show(n)}}function m(n,i){t(n).find(n.nodeName).each(function(){b(this)&&e.Markup.transformDomObject(this,i,e.Selection.rangeObject)}),e.Markup.transformDomObject(n,i,e.Selection.rangeObject)}function b(t){var n=e.Selection.getSelectionTree();return v(n,t)}function v(e,n){var i=!1;return t.each(e,function(e,t){(t.domobj===n&&"none"!==t.selection||v(t.children,n))&&(i=!0)}),i}var y=n.create("list",{config:["ul","ol","dl"],transformableElements:{p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,ul:!0,ol:!0,dl:!0},templates:{ul:{classes:["aloha-list-disc","aloha-list-circle","aloha-list-square"],template:'<ul class="${cssClass}"><li>${first}<ul class="${cssClass}"><li>${second}<ul class="${cssClass}"><li>${third}</li></ul></li></ul></li></ul>',locale:{fallback:{first:"first layer",second:"second layer",third:"third layer"},de:{first:"erste Ebene",second:"zweite Ebene",third:"dritte Ebene"}}},ol:{classes:["aloha-list-decimal","aloha-list-decimal-leading-zero","aloha-list-lower-roman","aloha-list-upper-roman","aloha-list-lower-greek","aloha-list-lower-latin","aloha-list-upper-latin"],template:'<ol class="${cssClass}"><li>${first}<ol class="${cssClass}"><li>${second}<ol class="${cssClass}"><li>${third}</li></ol></li></ol></li></ol>',locale:{fallback:{first:"first layer",second:"second layer",third:"third layer"},de:{first:"erste Ebene",second:"zweite Ebene",third:"dritte Ebene"}}},dl:{classes:["aloha-list-blue","aloha-list-green","aloha-list-red"],template:'<dl class="${cssClass}"><dt>${first}<dt><dd>${second}</dd></dl>',locale:{fallback:{first:"first item",second:"second item"},de:{first:"erstes Element",second:"zweites Element"}}}},toggleListStyle:function(e,n){var i=this.getStartingDomObjectToTransform(),a=i.nodeName.toLowerCase(),r=t(i),o=!1;"ul"!==a&&"ol"!==a&&"dl"!==a&&(this.transformList(e),i=this.getStartingDomObjectToTransform(),a=i.nodeName.toLowerCase(),r=t(this.getStartingDomObjectToTransform())),e===a&&(t.each(this.templates[a].classes,function(){r.hasClass(this.cssClass)&&this.cssClass===n&&(o=!0),r.removeClass(this.cssClass)}),o||r.addClass(n))},orderedListStyleButtons:[],unorderedListStyleButtons:[],definitionListStyleButtons:[],makeListStyleButton:function(t,n){var i=this,a=i.templates[t],r=a.locale[e.settings.locale]||a.locale.fallback,o=f(a.template,{cssClass:n,first:r.first,second:r.second,third:r.third});return{html:'<div class="aloha-list-templates">'+o+"</div>",click:function(){i.toggleListStyle(t,n)}}},init:function(){var n=this;e.settings.plugins&&e.settings.plugins.list&&e.settings.plugins.list.templates&&(n.templates=e.settings.plugins.list.templates),n.templates.dl&&(t.each(n.templates.dl.classes,function(e,t){n.definitionListStyleButtons.push(n.makeListStyleButton("dl",t))}),this._definitionListFormatSelectorButton=r.adopt("definitionListFormatSelector",d,{click:function(){n.transformList("dl")},html:'<span class="ui-button-icon-primary ui-icon aloha-icon aloha-icon-definitionlist"></span>',menu:n.definitionListStyleButtons.length?n.definitionListStyleButtons:null})),n.templates.ol&&(t.each(n.templates.ol.classes,function(e,t){n.orderedListStyleButtons.push(n.makeListStyleButton("ol",t))}),this._orderedListFormatSelectorButton=r.adopt("orderedListFormatSelector",d,{click:function(){n.transformList("ol")},html:'<span class="ui-button-icon-primary ui-icon aloha-icon aloha-icon-orderedlist"></span>',menu:n.orderedListStyleButtons.length?n.orderedListStyleButtons:null})),n.templates.ul&&(t.each(n.templates.ul.classes,function(e,t){n.unorderedListStyleButtons.push(n.makeListStyleButton("ul",t))}),this._unorderedListFormatSelectorButton=r.adopt("unorderedListFormatSelector",d,{click:function(){n.transformList("ul")},html:'<span class="ui-button-icon-primary ui-icon aloha-icon aloha-icon-unorderedlist"></span>',menu:n.unorderedListStyleButtons.length?n.unorderedListStyleButtons:null})),this._indentListButton=r.adopt("indentList",s,{tooltip:c.t("button.indentlist.tooltip"),icon:"aloha-icon aloha-icon-indent",scope:"Aloha.continuoustext",click:function(){n.indentList()}}),this._outdentListButton=r.adopt("outdentList",s,{tooltip:c.t("button.outdentlist.tooltip"),icon:"aloha-icon aloha-icon-outdent",scope:"Aloha.continuoustext",click:function(){n.outdentList()}}),o.createScope("Aloha.List","Aloha.continuoustext"),p.sub("aloha.selection.context-change",function(i){var a,r,o=i.range;for(t(".aloha-icon-unorderedlist").parents(".aloha-ui-menubutton-container").removeClass("aloha-button-active"),t(".aloha-icon-orderedlist").parents(".aloha-ui-menubutton-container").removeClass("aloha-button-active"),t(".aloha-icon-definitionlist").parents(".aloha-ui-menubutton-container").removeClass("aloha-button-active"),n._outdentListButton.show(!1),n._indentListButton.show(!1),g(n,"ul",!1),g(n,"ol",!1),g(n,"dl",!1),a=0;a<o.markupEffectiveAtStart.length;a++){if(r=o.markupEffectiveAtStart[a],e.Selection.standardTagNameComparator(r,t("<ul></ul>"))){g(n,"ul",!0),n._outdentListButton.show(!0),n._indentListButton.show(!0),t(".aloha-icon-unorderedlist").parents(".aloha-ui-menubutton-container").addClass("aloha-button-active");break}if(e.Selection.standardTagNameComparator(r,t("<ol></ol>"))){g(n,"ol",!0),n._outdentListButton.show(!0),n._indentListButton.show(!0),t(".aloha-icon-orderedlist").parents(".aloha-ui-menubutton-container").addClass("aloha-button-active");break}if(e.Selection.standardTagNameComparator(r,t("<dl></dl>"))){g(n,"dl",!0),t(r).addClass("alohafocus"),t(".aloha-icon-definitionlist").parents(".aloha-ui-menubutton-container").addClass("aloha-button-active");break}}e.activeEditable&&n.applyButtonConfig(e.activeEditable.obj),t("div.aloha-list-templates ul").removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","").attr("aria-hidden","").attr("aria-expanded","").css("display","block")}),e.Markup.addKeyHandler(9,function(e){return n.processTab(e)})},applyButtonConfig:function(n){var i=this.getEditableConfig(n);e.Selection.rangeObject.unmodifiableMarkupAtStart[0]&&(-1!=t.inArray("ul",i)&&-1!=e.Selection.canTag1WrapTag2(e.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ul")?g(this,"ul",!0):g(this,"ul",!1),-1!=t.inArray("ol",i)&&-1!=e.Selection.canTag1WrapTag2(e.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ol")?g(this,"ol",!0):g(this,"ol",!1),-1!=t.inArray("dl",i)&&-1!=e.Selection.canTag1WrapTag2(e.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"dl")?g(this,"dl",!0):g(this,"dl",!1))},processTab:function(e){return 9===e.keyCode?e.shiftKey?this.outdentList():this.indentList():!0},getStartingDomObjectToTransform:function(){var t,n,i=e.Selection.rangeObject;for(t=0;t<i.markupEffectiveAtStart.length;t++)if(n=i.markupEffectiveAtStart[t],this.transformableElements[n.nodeName.toLowerCase()])return n;return!1},getNearestSelectedListItem:function(){var t,n,i=e.Selection.rangeObject;for(t=0;t<i.markupEffectiveAtStart.length;t++)if(n=i.markupEffectiveAtStart[t],a.isListElement(n))return n;return!1},transformListToParagraph:function(n,i){var a,r=t(n);t.each(r.children(i),function(t,n){a=e.Markup.transformDomObject(n,"p",e.Selection.rangeObject),a.after(a.children("ol,ul,dl")),h.ensureContainerEditable(a.get(0))}),r.children().unwrap()},fixupNestedLists:function(e){var n=t(e);"li"===e.get(0).nodeName.toLowerCase()?(e.after(n.children()),n.remove()):n.children().unwrap()},createList:function(n,i){var r,o,s,l,d=e.Selection.rangeObject.getSelectedSiblings(i);switch(n){case"ol":r=t("<ol></ol>"),o=t("<li></li>");break;case"ul":r=t("<ul></ul>"),o=t("<li></li>");break;case"dl":r=t("<dl></dl>"),o=t("<dt></dt>")}if(r.append(o),t(i).contents().appendTo(o),t(i).replaceWith(r),e.Selection.rangeObject.startContainer==i&&(e.Selection.rangeObject.startContainer=o.get(0)),e.Selection.rangeObject.endContainer==i&&(e.Selection.rangeObject.endContainer=o.get(0)),s=o,d)for(var c=!0,u=!1,h=0;h<d.length;++h)if(a.isBlockLevelElement(d[h]))u&&(u=!1),"dl"===n?(o=c?e.Markup.transformDomObject(d[h],"dd",e.Selection.rangeObject):e.Markup.transformDomObject(d[h],"dt",e.Selection.rangeObject),c=!c):o=e.Markup.transformDomObject(d[h],"li",e.Selection.rangeObject),r.append(o),s=o;else{if(3==d[h].nodeType&&0===t.trim(d[h].data).length)continue;u||(u=o,r.append(u),s=u),u.append(d[h])}if(this.mergeAdjacentLists(r),l=s.get(0),a.isEmpty(l)){var p=e.createRange(),f=e.getSelection();l.appendChild(document.createTextNode("")),p.selectNodeContents(l.lastChild),f.removeAllRanges(),f.addRange(p),e.Selection.updateSelection()}},prepareNewList:function(n){var i,a,r,o,s,l;e.Selection.changeMarkupOnSelection(t("<p></p>"));var d=this.getStartingDomObjectToTransform();if(!d)if(e.Selection.rangeObject.startContainer.contentEditable){switch(n){case"ol":i=t("<ol></ol>"),a=t("<li></li>");break;case"ul":i=t("<ul></ul>"),a=t("<li></li>");break;case"dl":i=t("<dl></dl>"),a=t("<dt></dt>")}i.append(a),r=a.get(0),o=e.getActiveEditable().obj,r.appendChild(document.createTextNode("")),o.append(i),o.focus(),s=e.createRange(),l=e.getSelection(),s.setStart(r.firstChild,0),s.setEnd(r.firstChild,0),l.removeAllRanges(),l.addRange(s),e.Selection.updateSelection()}else e.Log.error(this,"Could not transform selection into a list");return d},transformList:function(e){var n,i,r,o=this.getStartingDomObjectToTransform();this._outdentListButton.show(!0),this._indentListButton.show(!0),o||(o=this.prepareNewList(e)),r=o.nodeName.toLowerCase(),r===e?(n=t(o),i=n.parent(),i.length>0&&a.isListElement(i.get(0))?this.fixupNestedLists(i):"dl"===e?this.transformListToParagraph(o,"dd, dt"):this.transformListToParagraph(o,"li")):"ul"==r&&"ol"===e?(m(o,"ol"),this.mergeAdjacentLists(t(o))):"ol"==r&&"ul"===e?(m(o,"ul"),this.mergeAdjacentLists(t(o))):"ul"===r&&"dl"===e?(this.transformListToParagraph(o,"li"),o=this.prepareNewList(e),this.createList(e,o)):"ol"===r&&"dl"===e?(this.transformListToParagraph(o,"li"),o=this.prepareNewList(e),this.createList(e,o)):"dl"===r&&"ol"===e?(this.transformListToParagraph(o,"dd, dt"),o=this.prepareNewList(e),this.createList(e,o)):"dl"===r&&"ul"===e?(this.transformListToParagraph(o,"dd, dt"),o=this.prepareNewList(e),this.createList(e,o)):this.createList(e,o),this.refreshSelection()},indentList:function(){var n,i,a,r,o,s=this.getNearestSelectedListItem();if(s){if(o=t(s).prev("li"),0===o.length)return!1;if(r=t(s).parent(),a=e.Selection.rangeObject.getSelectedSiblings(s),i=t(s).parent().clone(!1).empty(),i.append(s),o.append(i),a)for(n=0;n<a.length;++n)i.append(t(a[n]));return this.mergeAdjacentLists(i,!0),this.refreshSelection(),!1}return!0},outdentList:function(){var n,i,r,o,s,l,d,c,u=this.getNearestSelectedListItem();if(u){if(r=t(u),o=r.parent(),s=o.parents("ul,ol"),l=o.parent("li"),s.length>0&&a.isListElement(s.get(0))){if(d=e.Selection.rangeObject.getSelectedSiblings(u),c=d&&d.length>0?t(d[d.length-1]):r,c.nextAll("li").length>0&&(i=o.clone(!1).empty(),i.append(c.nextAll()),c.append(i)),l.length>0?l.after(r):o.before(r),d&&d.length>0)for(n=d.length-1;n>=0;--n)r.after(t(d[n]));0===o.contents("li").length&&o.remove(),l.length>0&&0===l.contents().length&&l.remove(),this.refreshSelection()}return!1}return!0},refreshSelection:function(){e.Selection.rangeObject.update(),e.Selection.rangeObject.select(),e.Selection.updateSelection()},mergeAdjacentLists:function(e,n){for(var i,a=e.get(0);a.previousSibling&&1===a.previousSibling.nodeType&&this.isMergable(a.previousSibling,a,n);)a=a.previousSibling;for(e=t(a);a.nextSibling&&(1===a.nextSibling.nodeType&&this.isMergable(a.nextSibling,a,n)||3===a.nextSibling.nodeType&&0===t.trim(a.nextSibling.data).length);)i=t(a.nextSibling),1==a.nextSibling.nodeType&&i.contents().appendTo(e),i.remove()},isMergable:function(e,t,n){return n?"ul"==e.nodeName.toLowerCase()||"ol"==e.nodeName.toLowerCase():e.nodeName==t.nodeName}});return h.commands.insertdefinitionlist={action:function(t,n){y.transformList("dl"),n&&e.Selection.rangeObject&&(n.startContainer=e.Selection.rangeObject.startContainer,n.startOffset=e.Selection.rangeObject.startOffset,n.endContainer=e.Selection.rangeObject.endContainer,n.endOffset=e.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){if(effectiveMarkup=rangeObject.markupEffectiveAtStart[i],e.Selection.standardTagNameComparator(effectiveMarkup,t("<ul></ul>")))return!1;if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ol></ol>")))return!1;if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<dl></dl>")))return!0}return!1}},h.commands.insertorderedlist={action:function(t,n){y.transformList("ol"),n&&e.Selection.rangeObject&&(n.startContainer=e.Selection.rangeObject.startContainer,n.startOffset=e.Selection.rangeObject.startOffset,n.endContainer=e.Selection.rangeObject.endContainer,n.endOffset=e.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){if(effectiveMarkup=rangeObject.markupEffectiveAtStart[i],e.Selection.standardTagNameComparator(effectiveMarkup,t("<ul></ul>")))return!1;if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ol></ol>")))return!0;if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<dl></dl>")))return!1}return!1}},h.commands.insertunorderedlist={action:function(t,n){y.transformList("ul"),n&&e.Selection.rangeObject&&(n.startContainer=e.Selection.rangeObject.startContainer,n.startOffset=e.Selection.rangeObject.startOffset,n.endContainer=e.Selection.rangeObject.endContainer,n.endOffset=e.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){if(effectiveMarkup=rangeObject.markupEffectiveAtStart[i],e.Selection.standardTagNameComparator(effectiveMarkup,t("<ul></ul>")))return!0;if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ol></ol>")))return!1;if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<dl></dl>")))return!1}return!1}},h.commands.indent={action:function(t,n){y.indentList(),n&&e.Selection.rangeObject&&(n.startContainer=e.Selection.rangeObject.startContainer,n.startOffset=e.Selection.rangeObject.startOffset,n.endContainer=e.Selection.rangeObject.endContainer,n.endOffset=e.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){return!1}},h.commands.outdent={action:function(t,n){y.outdentList(),n&&e.Selection.rangeObject&&(n.startContainer=e.Selection.rangeObject.startContainer,n.startOffset=e.Selection.rangeObject.startOffset,n.endContainer=e.Selection.rangeObject.endContainer,n.endOffset=e.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){return!1}},y}),define("image/nls/i18n",{root:{"size.natural":"Original size","button.addimg.tooltip":"add image ref","floatingmenu.tab.img":"Image","floatingmenu.tab.formatting":"Formatting","floatingmenu.tab.resize":"Resize","floatingmenu.tab.crop":"Crop","button.uploadimg.tooltip":"Upload img","button.uploadimg.label":"Upload","button.img.align.left.tooltip":"Left align","button.img.align.right.tooltip":"Right Align","button.img.align.none.tooltip":"No alignment","field.img.title.label":"Title","field.img.title.tooltip":"Title","field.img.label":"URL","field.img.tooltip":"Source","border ":"Add Border to Image","padding.increase ":"Increase Padding","padding.decrease ":"Decrease Padding","size.increase ":"Increase Size","size.decrease ":"Decrease Size",Resize:"Resize",Crop:"Crop",Reset:"Reset",Accept:"Accept",Cancel:"Cancel",height:"Height",width:"Width","button.toggle.tooltip":"Toggle keep aspect ratio","field.img.src.label":"Source","field.img.src.tooltip":"Source"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("image/image-floatingMenu",["jquery","util/class","i18n!image/nls/i18n","i18n!aloha/nls/i18n","ui/ui","ui/scopes","ui/button","ui/toggleButton","ui/port-helper-attribute-field"],function(e,t,n,i,a,r,o,s,l){window.GENTICS,window.Aloha;
return t.extend({_constructor:function(){},init:function(e){e.floatingMenuControl=this,this.plugin=e,r.createScope(e.name,"Aloha.empty"),this._addUIInsertButton(),this._addUIMetaButtons(),this._addUIResetButton(),this._addUIAlignButtons(),this._addUIMarginButtons(),this._addUICropButtons(),this._addUIResizeButtons(),this._addUIAspectRatioToggleButton()},_addUIAspectRatioToggleButton:function(){var e=this.plugin;this._imageCnrRatioButton=a.adopt("imageCnrRatio",s,{tooltip:n.t("button.toggle.tooltip"),icon:"aloha-icon-cnr-ratio",scope:e.name,click:function(){e.toggleKeepAspectRatio()}}),e.settings.fixedAspectRatio!==!1&&(this._imageCnrRatioButton.setState(!0),e.keepAspectRatio=!0)},_addUIResetButton:function(){var e=this.plugin;this._imageCnrResetButton=a.adopt("imageCnrReset",o,{tooltip:n.t("Reset"),icon:"aloha-icon-cnr-reset",scope:e.name,click:function(){e.reset()}})},_addUIInsertButton:function(){var e=this.plugin;this._insertImageButton=a.adopt("insertImage",o,{tooltip:n.t("button.addimg.tooltip"),icon:"aloha-button aloha-image-insert",scope:"Aloha.continuoustext",click:function(){e.insertImg()}})},_addUIMetaButtons:function(){var e=this.plugin;this.imgSrcField=new l({label:n.t("field.img.src.label"),labelClass:"aloha-image-input-label",tooltip:n.t("field.img.src.tooltip"),name:"imageSource",scope:e.name}),this.imgSrcField.setTemplate("<span><b>{name}</b><br/>{url}</span>"),this.imgSrcField.setObjectTypeFilter(e.objectTypeFilter),this.imgTitleField=new l({label:n.t("field.img.title.label"),labelClass:"aloha-image-input-label",tooltip:n.t("field.img.title.tooltip"),name:"imageTitle",scope:e.name}),this.imgTitleField.setObjectTypeFilter()},_addUIAlignButtons:function(){var t=this.plugin;this._imageAlignLeftButton=a.adopt("imageAlignLeft",o,{tooltip:n.t("button.img.align.left.tooltip"),icon:"aloha-img aloha-image-align-left",scope:t.name,click:function(){var n=e(t.getPluginFocus());n.add(n.parent()).css("float","left")}}),this._imageAlignRightButton=a.adopt("imageAlignRight",o,{tooltip:n.t("button.img.align.right.tooltip"),icon:"aloha-img aloha-image-align-right",scope:t.name,click:function(){var n=e(t.getPluginFocus());n.add(n.parent()).css("float","right")}}),this._imageAlignNoneButton=a.adopt("imageAlignNone",o,{tooltip:n.t("button.img.align.none.tooltip"),icon:"aloha-img aloha-image-align-none",scope:t.name,click:function(){var n=e(t.getPluginFocus());n.add(n.parent()).css({"float":"none",display:"inline-block"})}})},_addUIMarginButtons:function(){var t=this.plugin;this._imageIncPaddingButton=a.adopt("imageIncPadding",o,{tooltip:n.t("padding.increase"),icon:"aloha-img aloha-image-padding-increase",scope:t.name,click:function(){e(t.getPluginFocus()).increase("padding")}}),this._imageDecPaddingButton=a.adopt("imageDecPadding",o,{tooltip:n.t("padding.decrease"),icon:"aloha-img aloha-image-padding-decrease",scope:t.name,click:function(){e(t.getPluginFocus()).decrease("padding")}})},_addUICropButtons:function(){var e=this.plugin;r.createScope("Aloha.img",["Aloha.global"]),this._imageCropButton=a.adopt("imageCropButton",s,{tooltip:n.t("Crop"),icon:"aloha-icon-cnr-crop",scope:e.name,click:function(){this.getState()?e.crop():e.endCrop()}})},_addUIResizeButtons:function(){var e=this.plugin;this.imgResizeHeightField=new l({label:n.t("height"),labelClass:"aloha-image-input-label",name:"imageResizeHeight",width:50,scope:e.name}),this.imgResizeHeightField.maxValue=e.settings.maxHeight,this.imgResizeHeightField.minValue=e.settings.minHeight,this.imgResizeWidthField=new l({label:n.t("width"),labelClass:"aloha-image-input-label",name:"imageResizeWidth",width:50,scope:e.name}),this.imgResizeWidthField.maxValue=e.settings.maxWidth,this.imgResizeWidthField.minValue=e.settings.minWidth},setScope:function(){r.setScope(this.plugin.name)},doLayout:function(){}})}),define("image/vendor/jcrop/jquery.jcrop.min",["jquery"],function(e){!function(e){e.Jcrop=function(t,n){function a(e){return""+parseInt(e)+"px"}function r(e){return""+parseInt(e)+"%"}function o(e){return P.baseClass+"-"+e}function s(t){var n=e(t).offset();return[n.left,n.top]}function l(e){return[e.pageX-at[0],e.pageY-at[1]]}function d(e){e!=Y&&(st.setCursor(e),Y=e)}function c(e,t){if(at=s(z),st.setCursor("move"==e?e:e+"-resize"),"move"==e)return st.activateHandlers(p(t),v);var n=rt.getFixed(),i=f(e),a=rt.getCorner(f(i));rt.setPressed(rt.getCorner(i)),rt.setCurrent(a),st.activateHandlers(u(e,n),v)}function u(e,t){return function(n){if(P.aspectRatio)switch(e){case"e":n[1]=t.y+1;break;case"w":n[1]=t.y+1;break;case"n":n[0]=t.x+1;break;case"s":n[0]=t.x+1}else switch(e){case"e":n[1]=t.y2;break;case"w":n[1]=t.y2;break;case"n":n[0]=t.x2;break;case"s":n[0]=t.x2}rt.setCurrent(n),ot.update()}}function p(e){var t=e;return lt.watchKeys(),function(e){rt.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,ot.update()}}function f(e){switch(e){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function g(e){return function(t){return P.disabled?!1:"move"!=e||P.allowMove?(V=!0,c(e,l(t)),t.stopPropagation(),t.preventDefault(),!1):!1}}function m(e,t,n){var i=e.width(),a=e.height();i>t&&t>0&&(i=t,a=t/e.width()*e.height()),a>n&&n>0&&(a=n,i=n/e.height()*e.width()),U=e.width()/i,K=e.height()/a,e.width(i).height(a)}function b(e){return{x:parseInt(e.x*U),y:parseInt(e.y*K),x2:parseInt(e.x2*U),y2:parseInt(e.y2*K),w:parseInt(e.w*U),h:parseInt(e.h*K)}}function v(){var e=rt.getFixed();e.w>P.minSelect[0]&&e.h>P.minSelect[1]?(ot.enableHandles(),ot.done()):ot.release(),st.setCursor(P.allowSelect?"crosshair":"default")}function y(e){if(P.disabled)return!1;if(!P.allowSelect)return!1;V=!0,at=s(z),ot.disableHandles(),d("crosshair");var t=l(e);return rt.setPressed(t),st.activateHandlers(_,v),lt.watchKeys(),ot.update(),e.stopPropagation(),e.preventDefault(),!1}function _(e){rt.setCurrent(e),ot.update()}function C(){var t=e("<div></div>").addClass(o("tracker"));return e.browser.msie&&t.css({opacity:0,backgroundColor:"white"}),t}function k(e){function t(){window.setTimeout(v,d)}var n=e[0]/U,i=e[1]/K,a=e[2]/U,r=e[3]/K;if(!X){var o=rt.flipCoords(n,i,a,r),s=rt.getFixed(),l=initcr=[s.x,s.y,s.x2,s.y2],d=P.animationDelay,c=l[0],u=l[1],a=l[2],r=l[3],h=o[0]-initcr[0],p=o[1]-initcr[1],f=o[2]-initcr[2],g=o[3]-initcr[3],m=0,b=P.swingSpeed;ot.animMode(!0);var v=function(){return function(){m+=(100-m)/b,l[0]=c+m/100*h,l[1]=u+m/100*p,l[2]=a+m/100*f,l[3]=r+m/100*g,100>m?t():ot.done(),m>=99.8&&(m=100),S(l)}}();t()}}function x(e){S([e[0]/U,e[1]/K,e[2]/U,e[3]/K])}function S(e){rt.setPressed([e[0],e[1]]),rt.setCurrent([e[2],e[3]]),ot.update()}function j(t){"object"!=typeof t&&(t={}),P=e.extend(P,t),"function"!=typeof P.onChange&&(P.onChange=function(){}),"function"!=typeof P.onSelect&&(P.onSelect=function(){})}function N(){return b(rt.getFixed())}function T(){return rt.getFixed()}function E(e){j(e),M()}function A(){P.disabled=!0,ot.disableHandles(),ot.setCursor("default"),st.setCursor("default")}function D(){P.disabled=!1,M()}function O(){ot.done(),st.activateHandlers(null,null)}function I(){q.remove(),F.show()}function M(e){P.allowResize?e?ot.enableOnly():ot.enableHandles():ot.disableHandles(),st.setCursor(P.allowSelect?"crosshair":"default"),ot.setCursor(P.allowMove?"move":"default"),q.css("backgroundColor",P.bgColor),"setSelect"in P&&(x(n.setSelect),ot.done(),delete P.setSelect),"trueSize"in P&&(U=P.trueSize[0]/B,K=P.trueSize[1]/L),H=P.maxSize[0]||0,$=P.maxSize[1]||0,W=P.minSize[0]||0,G=P.minSize[1]||0,"outerImage"in P&&(z.attr("src",P.outerImage),delete P.outerImage),ot.refresh()}var t=t,n=n;"object"!=typeof t&&(t=e(t)[0]),"object"!=typeof n&&(n={}),"trackDocument"in n||(n.trackDocument=e.browser.msie?!1:!0,e.browser.msie&&"8"==e.browser.version.split(".")[0]&&(n.trackDocument=!0)),"keySupport"in n||(n.keySupport=e.browser.msie?!1:!0);var R={trackDocument:!1,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,borderOpacity:.4,handleOpacity:.5,handlePad:5,handleSize:9,handleOffset:5,edgeMargin:14,aspectRatio:0,keySupport:!0,cornerHandles:!0,sideHandles:!0,drawBorders:!0,dragEdges:!0,boxWidth:0,boxHeight:0,boundary:8,animationDelay:20,swingSpeed:3,allowSelect:!0,allowMove:!0,allowResize:!0,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){}},P=R;j(n);var F=e(t),z=F.clone().removeAttr("id").css({position:"absolute"});z.width(F.width()),z.height(F.height()),F.after(z).hide(),m(z,P.boxWidth,P.boxHeight);var B=z.width(),L=z.height(),q=e("<div />").width(B).height(L).addClass(o("holder")).css({position:"relative",backgroundColor:P.bgColor}).insertAfter(F).append(z);P.addClass&&q.addClass(P.addClass);var H,$,W,G,U,K,V,Y,X,Q,J=e("<img />").attr("src",z.attr("src")).css("position","absolute").width(B).height(L),Z=e("<div />").width(r(100)).height(r(100)).css({zIndex:310,position:"absolute",overflow:"hidden"}).append(J),et=e("<div />").width(r(100)).height(r(100)).css("zIndex",320),tt=e("<div />").css({position:"absolute",zIndex:300}).insertBefore(z).append(Z,et),nt=P.boundary,it=C().width(B+2*nt).height(L+2*nt).css({position:"absolute",top:a(-nt),left:a(-nt),zIndex:290}).mousedown(y),at=s(z),rt=function(){function e(e){var e=o(e);g=p=e[0],m=f=e[1]}function t(e){var e=o(e);c=e[0]-g,u=e[1]-m,g=e[0],m=e[1]}function n(){return[c,u]}function i(e){var t=e[0],n=e[1];0>p+t&&(t-=t+p),0>f+n&&(n-=n+f),m+n>L&&(n+=L-(m+n)),g+t>B&&(t+=B-(g+t)),p+=t,g+=t,f+=n,m+=n}function a(e){var t=r();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function r(){if(!P.aspectRatio)return l();var e,t,n=P.aspectRatio,i=P.minSize[0]/U,a=(P.minSize[1]/K,P.maxSize[0]/U),r=P.maxSize[1]/K,o=g-p,c=m-f,u=Math.abs(o),b=Math.abs(c),v=u/b;return 0==a&&(a=10*B),0==r&&(r=10*L),n>v?(t=m,w=b*n,e=0>o?p-w:w+p,0>e?(e=0,h=Math.abs((e-p)/n),t=0>c?f-h:h+f):e>B&&(e=B,h=Math.abs((e-p)/n),t=0>c?f-h:h+f)):(e=g,h=u/n,t=0>c?f-h:f+h,0>t?(t=0,w=Math.abs((t-f)*n),e=0>o?p-w:w+p):t>L&&(t=L,w=Math.abs(t-f)*n,e=0>o?p-w:w+p)),e>p?(i>e-p?e=p+i:e-p>a&&(e=p+a),t=t>f?f+(e-p)/n:f-(e-p)/n):p>e&&(i>p-e?e=p-i:p-e>a&&(e=p-a),t=t>f?f+(p-e)/n:f-(p-e)/n),0>e?(p-=e,e=0):e>B&&(p-=e-B,e=B),0>t?(f-=t,t=0):t>L&&(f-=t-L,t=L),last=d(s(p,f,e,t))}function o(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>B&&(e[0]=B),e[1]>L&&(e[1]=L),[e[0],e[1]]}function s(e,t,n,i){var a=e,r=n,o=t,s=i;return e>n&&(a=n,r=e),t>i&&(o=i,s=t),[Math.round(a),Math.round(o),Math.round(r),Math.round(s)]}function l(){var e=g-p,t=m-f;if(H&&Math.abs(e)>H&&(g=e>0?p+H:p-H),$&&Math.abs(t)>$&&(m=t>0?f+$:f-$),G&&Math.abs(t)<G&&(m=t>0?f+G:f-G),W&&Math.abs(e)<W&&(g=e>0?p+W:p-W),0>p&&(g-=p,p-=p),0>f&&(m-=f,f-=f),0>g&&(p-=g,g-=g),0>m&&(f-=m,m-=m),g>B){var n=g-B;p-=n,g-=n}if(m>L){var n=m-L;f-=n,m-=n}if(p>B){var n=p-L;m-=n,f-=n}if(f>L){var n=f-L;m-=n,f-=n}return d(s(p,f,g,m))}function d(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var c,u,p=0,f=0,g=0,m=0;return{flipCoords:s,setPressed:e,setCurrent:t,getOffset:n,moveOffset:i,getCorner:a,getFixed:r}}(),ot=function(){function t(t){var n=e("<div />").css({position:"absolute",opacity:P.borderOpacity}).addClass(o(t));return Z.append(n),n}function n(t,n){var i=e("<div />").mousedown(g(t)).css({cursor:t+"-resize",position:"absolute",zIndex:n});return et.append(i),i}function s(e){return n(e,N++).css({top:a(-D+1),left:a(-D+1),opacity:P.handleOpacity}).addClass(o("handle"))}function l(e){var t=P.handleSize,i=D,o=t,s=t,l=i,d=i;switch(e){case"n":case"s":s=r(100);break;case"e":case"w":o=r(100)}return n(e,N++).width(s).height(o).css({top:a(-l+1),left:a(-d+1)})}function d(e){for(i in e)E[e[i]]=s(e[i])}function c(e){var t=Math.round(e.h/2-D),n=Math.round(e.w/2-D),i=(west=-D+1,e.w-D),r=e.h-D;"e"in E&&E.e.css({top:a(t),left:a(i)})&&E.w.css({top:a(t)})&&E.s.css({top:a(r),left:a(n)})&&E.n.css({left:a(n)}),"ne"in E&&E.ne.css({left:a(i)})&&E.se.css({top:a(r),left:a(i)})&&E.sw.css({top:a(r)}),"b"in E&&E.b.css({top:a(r)})&&E.r.css({left:a(i)})}function u(e,t){J.css({top:a(-t),left:a(-e)}),tt.css({top:a(t),left:a(e)})}function h(e,t){tt.width(e).height(t)}function p(){var e=rt.getFixed();rt.setPressed([e.x,e.y]),rt.setCurrent([e.x2,e.y2]),f()}function f(){return j?m():void 0}function m(){var e=rt.getFixed();h(e.w,e.h),u(e.x,e.y),P.drawBorders&&T.right.css({left:a(e.w-1)})&&T.bottom.css({top:a(e.h-1)}),A&&c(e),j||v(),P.onChange(b(e))}function v(){tt.show(),z.css("opacity",P.bgOpacity),j=!0}function y(){k(),tt.hide(),z.css("opacity",1),j=!1}function _(){A&&(c(rt.getFixed()),et.show())}function w(){return A=!0,P.allowResize?(c(rt.getFixed()),et.show(),!0):void 0}function k(){A=!1,et.hide()}function x(e){(X=e)?k():w()}function S(){x(!1),p()}var j,N=370,T={},E={},A=!1,D=P.handleOffset;P.drawBorders&&(T={top:t("hline").css("top",a(e.browser.msie?-1:0)),bottom:t("hline"),left:t("vline"),right:t("vline")}),P.dragEdges&&(E.t=l("n"),E.b=l("s"),E.r=l("e"),E.l=l("w")),P.sideHandles&&d(["n","s","e","w"]),P.cornerHandles&&d(["sw","nw","ne","se"]);var O=C().mousedown(g("move")).css({cursor:"move",position:"absolute",zIndex:360});return Z.append(O),k(),{updateVisible:f,update:m,release:y,refresh:p,setCursor:function(e){O.css("cursor",e)},enableHandles:w,enableOnly:function(){A=!0},showHandles:_,disableHandles:k,animMode:x,done:S}}(),st=function(){function t(){it.css({zIndex:450}),c&&e(document).mousemove(i).mouseup(a)}function n(){it.css({zIndex:290}),c&&e(document).unbind("mousemove",i).unbind("mouseup",a)}function i(e){s(l(e))}function a(e){return e.preventDefault(),e.stopPropagation(),V&&(V=!1,d(l(e)),P.onSelect(b(rt.getFixed())),n(),s=function(){},d=function(){}),!1}function r(e,n){return V=!0,s=e,d=n,t(),!1}function o(e){it.css("cursor",e)}var s=function(){},d=function(){},c=P.trackDocument;return c||it.mousemove(i).mouseup(a).mouseout(a),z.before(it),{activateHandlers:r,setCursor:o}}(),lt=function(){function t(){P.keySupport&&(r.show(),r.focus())}function n(){r.hide()}function i(e,t,n){P.allowMove&&(rt.moveOffset([t,n]),ot.updateVisible()),e.preventDefault(),e.stopPropagation()}function a(e){if(e.ctrlKey)return!0;Q=e.shiftKey?!0:!1;var t=Q?10:1;switch(e.keyCode){case 37:i(e,-t,0);break;case 39:i(e,t,0);break;case 38:i(e,0,-t);break;case 40:i(e,0,t);break;case 27:ot.release();break;case 9:return!0}return nothing(e)}var r=e('<input type="radio" />').css({position:"absolute",left:"-30px"}).keypress(a).blur(n),o=e("<div />").css({position:"absolute",overflow:"hidden"}).append(r);return P.keySupport&&o.insertBefore(z),{watchKeys:t}}();et.hide(),M(!0);var dt={animateTo:k,setSelect:x,setOptions:E,tellSelect:N,tellScaled:T,disable:A,enable:D,cancel:O,focus:lt.watchKeys,getBounds:function(){return[B*U,L*K]},getWidgetSize:function(){return[B,L]},release:ot.release,destroy:I};return F.data("Jcrop",dt),dt},e.fn.Jcrop=function(t){function n(n){var i=t.useImg||n.src,a=new Image;a.onload=function(){e.Jcrop(n,t)},a.src=i}return"object"!=typeof t&&(t={}),this.each(function(){if(e(this).data("Jcrop")){if("api"==t)return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else n(this)}),this}}(e)}),define("image/vendor/mousewheel/mousewheel",["jquery"],function(e){!function(e){function t(t){var n=t||window.event,i=[].slice.call(arguments,1),a=0,r=0,o=0;return t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(a=n.wheelDelta/120),n.detail&&(a=-n.detail/3),o=a,void 0!==n.axis&&n.axis===n.HORIZONTAL_AXIS&&(o=0,r=-1*a),void 0!==n.wheelDeltaY&&(o=n.wheelDeltaY/120),void 0!==n.wheelDeltaX&&(r=-1*n.wheelDeltaX/120),i.unshift(t,a,r,o),(e.event.dispatch||e.event.handle).apply(this,i)}var n=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var i=n.length;i;)e.event.fixHooks[n[--i]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(e)}),define("image/image-plugin",["jquery","aloha/plugin","image/image-floatingMenu","i18n!aloha/nls/i18n","i18n!image/nls/i18n","jqueryui","image/vendor/jcrop/jquery.jcrop.min","image/vendor/mousewheel/mousewheel"],function(e,t,n,i,a){var r=e,o=e,s=window.GENTICS,l=window.Aloha,d=!1,c=!1,u=!1;return String.prototype.toInteger=String.prototype.toInteger||function(){return parseInt(String(this).replace(/px$/,"")||0,10)},String.prototype.toFloat=String.prototype.toInteger||function(){return parseFloat(String(this).replace(/px$/,"")||0,10)},Number.prototype.toInteger=Number.prototype.toInteger||String.prototype.toInteger,Number.prototype.toFloat=Number.prototype.toFloat||String.prototype.toFloat,r.extend(!0,r.fn,{increase:r.fn.increase||function(e){var t,n,i=r(this);return i.length?(t=i.css(e).toFloat(),n=Math.round(1.2*(t||1)),t===n&&n++,i.css(e,n),i):i},decrease:r.fn.decrease||function(e){var t,n,i=r(this);return i.length?(t=i.css(e).toFloat(),n=Math.round(.8*(t||0)),t===n&&n>0&&n--,i.css(e,n),i):i}}),t.create("image",{defaultSettings:{maxWidth:1600,minWidth:3,maxHeight:1200,minHeight:3,autoCorrectManualInput:!0,fixedAspectRatio:!1,autoResize:!1,ui:{meta:!0,crop:!0,resizable:!0},handles:"ne, se, sw, nw",onCropped:function(e,t){l.Log.info("Default onCropped invoked",e,t)},onReset:function(e){return l.Log.info("Default onReset invoked",e),!1},onResize:function(e){l.Log.info("Default onResize invoked",e)},onResized:function(e){l.Log.info("Default onResized invoked",e)}},_onCropped:function(e,t){o("body").trigger("aloha-image-cropped",[e,t]),this.keepAspectRatio&&(c=this.imageObj.width()/this.imageObj.height()),this.onCropped(e,t)},_onReset:function(e){return o("body").trigger("aloha-image-reset",e),this.onReset(e)},_onResize:function(e){o("body").trigger("aloha-image-resize",e),this._applyValuesToFields(e.width(),e.height()),this.onResize(e)},_onResized:function(e){o("body").trigger("aloha-image-resized",e),this._applyValuesToFields(e.width(),e.height()),this.onResized(e)},imageObj:null,jcAPI:null,keepAspectRatio:!1,restoreProps:[],objectTypeFilter:[],init:function(){{var e=this;l.getPluginUrl("image")}"undefined"!=typeof this.settings.objectTypeFilter&&(this.objectTypeFilter=this.settings.objectTypeFilter),e.config=e.defaultSettings,e.settings=r.extend(!0,e.defaultSettings,e.settings),"number"==typeof this.settings.fixedAspectRatio?(c=u=this.settings.fixedAspectRatio,e.keepAspectRatio=!0):e.keepAspectRatio=e.settings.fixedAspectRatio===!0?!0:!1,e.initializeUI(),e.bindInteractions(),e.subscribeEvents()},initializeUI:function(){this.ui=new n,this.ui.init(this)},bindInteractions:function(){var e=this;if(e.settings.ui.resizable)try{document.execCommand("enableObjectResizing",!1,!1)}catch(t){l.Log.info(t,"Could not disable enableObjectResizing")}e.settings.ui.meta&&(e.ui.imgSrcField.addListener("keyup",function(){e.srcChange()}),e.ui.imgSrcField.addListener("blur",function(){var t=r(e.ui.imgSrcField.getTargetObject());""===t.attr("src")&&t.remove()})),e.settings.onCropped&&"function"==typeof e.settings.onCropped&&(e.onCropped=e.settings.onCropped),e.settings.onReset&&"function"==typeof e.settings.onReset&&(e.onReset=e.settings.onReset),e.settings.onResized&&"function"==typeof e.settings.onResized&&(e.onResized=e.settings.onResized),e.settings.onResize&&"function"==typeof e.settings.onResize&&(e.onResize=this.settings.onResize)},subscribeEvents:function(){var e=this,t=this.settings;r("img").filter(t.globalselector).unbind(),r("img").filter(t.globalselector).click(function(t){e.clickImage(t)}),l.bind("aloha-drop-files-in-editable",function(t,n){for(var i,a,o,d=n.filesObjs.length;--d>=0;)a=n.filesObjs[d],a.file.type.match(/image\//)&&(o=e.getEditableConfig(n.editable),i=r("<img/>"),i.css({"max-width":that.maxWidth,"max-height":that.maxHeight}),i.attr("id",a.id),"undefined"==typeof a.src?i.attr("src",a.data):i.attr("src",a.src),s.Utils.Dom.insertIntoDOM(i,n.range,r(l.activeEditable.obj)))}),l.bind("aloha-selection-changed",function(t,n,i){var a,o;if(i&&i.target&&e.settings.ui.resizable&&!r(i.target).hasClass("ui-resizable-handle")&&(e.endResize(),e.imageObj=null,l.trigger("aloha-image-unselected")),null!==l.activeEditable){if(o=e.findImgMarkup(n),a=e.getEditableConfig(l.activeEditable.obj),"undefined"==typeof a)return void e.ui._insertImageButton.hide();e.ui._insertImageButton.show(),o?(e.ui._insertImageButton.show(),e.ui.setScope(),e.settings.ui.meta&&(e.ui.imgSrcField.setTargetObject(o,"src"),e.ui.imgTitleField.setTargetObject(o,"title")),e.ui.imgSrcField.foreground(),e.ui.imgSrcField.focus()):e.settings.ui.meta&&e.ui.imgSrcField.setTargetObject(null),e.ui.doLayout()}}),l.bind("aloha-editable-created",function(t,n){try{document.execCommand("enableObjectResizing",!1,!1)}catch(i){l.Log.info(i,"Could not disable enableObjectResizing")}n.obj.delegate("img","mouseup",function(t){d||(e.clickImage(t),t.stopPropagation())})}),e._subscribeToResizeFieldEvents()},autoResize:function(e){var t=this,n=(r("#"+t.ui.imgResizeWidthField.getInputId()),r("#"+t.ui.imgResizeHeightField.getInputId()),t.imageObj.width()),i=t.imageObj.height(),a=!1;(n<t.settings.minWidth||n>t.settings.maxWidth||i<t.settings.minHeight||i>t.settings.maxHeight)&&(a=!0);var o=n/i;return a?(n>t.settings.maxWidth&&(n=t.settings.maxWidth,i=n/o),i>t.settings.maxHeight&&(i=t.settings.maxHeight,n=i*o),n<t.settings.minWidth&&e&&(n=t.settings.minWidth,i=n/o),i<t.settings.minHeight&&e&&(i=t.settings.minHeight,n*=o),t._applyValuesToFields(n,i),t.setSizeByFieldValue(),!0):!1},toggleKeepAspectRatio:function(){if(this.keepAspectRatio=!this.keepAspectRatio,"undefined"!=typeof this.jcAPI&&null!==this.jcAPI){var e=this.jcAPI.tellSelect();u=this.keepAspectRatio?"number"!=typeof this.settings.fixedAspectRatio?e.w/e.h>0?e.w/e.h:this.imageObj.width()/this.imageObj.height():this.settings.fixedAspectRatio:!1,this.jcAPI.setOptions(this.keepAspectRatio?{aspectRatio:u}:{aspectRatio:0}),this.jcAPI.focus()}else this.endResize(),c=this.keepAspectRatio?"number"!=typeof this.settings.fixedAspectRatio?this.imageObj.width()/this.imageObj.height():this.settings.fixedAspectRatio:!1,this.startResize()},_subscribeToResizeFieldEvents:function(){function e(e){var t=(e.data.minValue,e.data.maxValue,e.data.fieldName);if(8===e.keyCode||46===e.keyCode)n._updateFields(t,o(this).val(),!1)&&("undefined"!=typeof n.jcAPI&&null!==n.jcAPI?n.setCropAreaByFieldValue():n.setSizeByFieldValue());else if(e.keyCode<=57&&e.keyCode>=48||e.keyCode<=105&&e.keyCode>=96)n._updateFields(t,o(this).val(),!1)&&("undefined"!=typeof n.jcAPI&&null!==n.jcAPI?n.setCropAreaByFieldValue():n.setSizeByFieldValue());else{var i=0;38===e.keyCode||107===e.keyCode?i=1:(40===e.keyCode||109===e.keyCode)&&(i=-1),(e.shiftKey||e.metaKey||e.ctrlKey)&&(i=10*i);var a=!1;0>i&&(a=!0);var r=parseInt(o(this).val(),10)+i;n._updateFields(t,r,a)&&("undefined"!=typeof n.jcAPI&&null!==n.jcAPI?n.setCropAreaByFieldValue():n.setSizeByFieldValue())}return e.preventDefault(),!1}function t(e,t){var i=(e.data.minValue,e.data.maxValue,e.data.fieldName);(e.shiftKey||e.metaKey||e.ctrlKey)&&(t=10*t);var a=parseInt(o(this).val(),10)+t,r=!1;return 0>t&&(r=!0),n._updateFields(i,a,r)&&("undefined"!=typeof n.jcAPI&&null!==n.jcAPI?n.setCropAreaByFieldValue():n.setSizeByFieldValue()),!1}var n=this,i=o("#"+n.ui.imgResizeHeightField.getInputId()),a={fieldName:"height",maxValue:n.ui.imgResizeHeightField.maxValue,minValue:n.ui.imgResizeHeightField.minValue};i.live("keyup",a,e),i.live("mousewheel",a,t);var r=o("#"+n.ui.imgResizeWidthField.getInputId()),s={fieldName:"width",maxValue:n.ui.imgResizeWidthField.maxValue,minValue:n.ui.imgResizeWidthField.minValue};r.live("keyup",s,e),r.live("mousewheel",s,t)},setSize:function(e,t){var n=this;n.imageObj.width(e),n.imageObj.height(t);var i=n.imageObj.closest(".Aloha_Image_Resize");i.height(t),i.width(e),n._onResize(n.imageObj),n._onResized(n.imageObj)},clickImage:function(e){var t=this;t.endResize(),t.imageObj=r(e.target);var n=t.imageObj;if(!n.hasClass("aloha-ui")){t.ui.setScope();{n.closest(".aloha-editable")}t.ui._imageCnrRatioButton.setState(this.keepAspectRatio),t.restoreProps.push({obj:t.imageObj,src:t.imageObj.attr("src"),width:t.imageObj.width(),height:t.imageObj.height()}),t._applyValuesToFields(t.imageObj.width(),t.imageObj.height()),t.settings.ui.meta&&(t.ui.imgSrcField.setTargetObject(t.imageObj,"src"),t.ui.imgTitleField.setTargetObject(t.imageObj,"title")),l.Selection.preventSelectionChanged();try{t.ui.imgSrcField.focus()}catch(e){}u=c=t.imageObj.width()/t.imageObj.height(),t.settings.ui.resizable&&t.startResize(),t.settings.autoResize&&t.autoResize(!0),l.Selection.preventSelectionChangedFlag=!1,l.trigger("aloha-image-selected")}},findImgMarkup:function(e){{var t,n;this.config}"undefined"==typeof e&&(e=l.Selection.getRangeObject()),n=r(e.startContainer);try{if(l.activeEditable)return"undefined"!=typeof e.startContainer&&"undefined"!=typeof e.startContainer.childNodes&&"undefined"!=typeof e.startOffset&&"undefined"!=typeof e.startContainer.childNodes[e.startOffset]&&"img"===e.startContainer.childNodes[e.startOffset].nodeName.toLowerCase()&&e.startOffset+1===e.endOffset||n.hasClass("Aloha_Image_Resize")?(t=n.find("img")[0],t.css||(t.css=""),t.title||(t.title=""),t.src||(t.src=""),t):null}catch(i){l.Log.debug(i,"Error finding img markup.")}return null},getPluginFocus:function(){return this.imageObj},_updateFields:function(e,t,n){var i=this,a=null,r=null,s=null,l=null,d=null,h=null,p=null;if(s="undefined"!=typeof i.jcAPI&&null!==i.jcAPI&&u?u:c,"width"==e)a=o("#"+i.ui.imgResizeWidthField.getInputId()),r=o("#"+i.ui.imgResizeHeightField.getInputId()),s=1/s,l=i.settings.minWidth,d=i.settings.maxWidth,h=i.settings.minHeight,p=i.settings.maxHeight;else{if("height"!=e)return!1;a=o("#"+i.ui.imgResizeHeightField.getInputId()),r=o("#"+i.ui.imgResizeWidthField.getInputId()),s=s,l=i.settings.minHeight,d=i.settings.maxHeight,h=i.settings.minWidth,p=i.settings.maxWidth}if(isNaN(t))return a.css("background-color","red"),!1;a.val(t);var f=!0;t>d?i.settings.autoCorrectManualInput?(a.val(d),t=a.val(),a.css("background-color",""),f=!0):(a.css("background-color","red"),f=!1):l>t?n?(a.val(l),t=a.val(),f=!0):i.settings.autoCorrectManualInput?(a.css("background-color","wheat"),f=!1):(a.css("background-color","red"),f=!1):(a.css("background-color",""),f=!0);var g=!0;if(i.keepAspectRatio){var m=Math.round(t*s);m>p?i.settings.autoCorrectManualInput?(r.val(p),a.val(r.val()/s),t=a.val(),a.css("background-color",""),r.css("background-color",""),g=!0):(m.css("background-color","red"),g=!1):h>m?n?(r.val(h),a.val(r.val()/s),t=a.val(),f=!0):i.settings.autoCorrectManualInput?(r.val(m),r.css("background-color","wheat"),g=!1):(r.css("background-color","red"),g=!1):(r.val(m),r.css("background-color",""),g=!0)}return r.val()<h&&(g=!1),f&&g?!0:!1},setSizeByFieldValue:function(){var e=this.ui.imgResizeWidthField.getValue(),t=this.ui.imgResizeHeightField.getValue();this.setSize(e,t)},_applyValuesToFields:function(e,t){this.ui.imgResizeWidthField.setValue(e),this.ui.imgResizeHeightField.setValue(t),this.ui.imgResizeWidthField.getInputJQuery().css("background-color",""),this.ui.imgResizeHeightField.getInputJQuery().css("background-color","")},setCropAreaByFieldValue:function(){var e=this.jcAPI.tellSelect(),t=parseInt(this.ui.imgResizeWidthField.getValue(),10),n=parseInt(this.ui.imgResizeHeightField.getValue(),10),i=[e.x,e.y,e.x+t,e.y+n];this.jcAPI.setSelect(i),this._onCropSelect(),this.jcAPI.enable()},insertImg:function(){var e,t,n,i=l.Selection.getRangeObject(),a=this.getEditableConfig(l.activeEditable.obj),o=l.getPluginUrl("image");i.isCollapsed()?(e="max-width: "+a.maxWidth+"; max-height: "+a.maxHeight,t='<img style="'+e+'" src="'+o+'/img/blank.jpg" title="" />',n=r(t),s.Utils.Dom.insertIntoDOM(n,i,r(l.activeEditable.obj))):l.Log.error("img cannot markup a selection")},srcChange:function(){this.imageObj.attr("src",this.ui.imgSrcField.getValue())},positionCropButtons:function(){var e=r(".jcrop-tracker:first"),t=e.offset(),n=t.top,i=t.left,a=e.height(),o=e.width(),s=0,l=0,d=r("#aloha-CropNResize-btns");0===n&&0===i&&d.hide(),n=parseInt(n+a+3,10),i=parseInt(i+o/2-d.width()/2+10,10),(s!=i||l!=n)&&d.offset({top:n,left:i}),s=i,l=n},initCropButtons:function(){var e,t=this;r("body").append('<div id="aloha-CropNResize-btns" display="none"><button class="cnr-crop-apply" title="'+a.t("Accept")+'"></button><button class="cnr-crop-cancel" title="'+a.t("Cancel")+'"></button></div>'),e=r("#aloha-CropNResize-btns"),e.find(".cnr-crop-apply").click(function(){t.acceptCrop()}),e.find(".cnr-crop-cancel").click(function(){t.endCrop()}),this.interval=window.setInterval(function(){t.positionCropButtons()},10)},destroyCropButtons:function(){r("#aloha-CropNResize-btns").remove(),window.clearInterval(this.interval)},_disableSelection:function(e){e.find("*").attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"})},crop:function(){var e=this,t=(this.config,e.keepAspectRatio?c:!1);this.ui._imageCropButton.setState(!0),e.initCropButtons(),e.settings.ui.resizable&&e.endResize(),e.jcAPI=r.Jcrop(e.imageObj,{onSelect:function(){e._onCropSelect(),window.setTimeout(function(){e.ui.setScope()},10)},aspectRatio:t,minSize:[e.settings.minWidth,e.settings.minHeight]}),e._disableSelection(o(".jcrop-holder")),e._disableSelection(o("#imageContainer")),e._disableSelection(o("#aloha-CropNResize-btns")),o("body").trigger("aloha-image-crop-start",[e.imageObj])},_onCropSelect:function(){var e=this;if(r(".jcrop-handle").mousedown(function(){r("#aloha-CropNResize-btns").hide()}),r(".jcrop-tracker").mousedown(function(){r("#aloha-CropNResize-btns").hide()}),"undefined"!=typeof e.jcAPI&&null!==e.jcAPI){e.positionCropButtons();var t=e.jcAPI.tellSelect();t.h>0&&t.w>0&&r("#aloha-CropNResize-btns").fadeIn("slow"),e._applyValuesToFields(t.w,t.h)}},endCrop:function(){this.jcAPI&&(this.jcAPI.destroy(),this.jcAPI=null),this.destroyCropButtons(),this.ui._imageCropButton.setState(!1),this.settings.ui.resizable&&this.startResize(),o("body").trigger("aloha-image-crop-stop",[this.imageObj]),this._applyValuesToFields(this.imageObj.width(),this.imageObj.height())},acceptCrop:function(){this._onCropped(this.imageObj,this.jcAPI.tellSelect()),this.endCrop()},startResize:function(){var e=this,t=this.imageObj,n=e.keepAspectRatio?c:!1;t=this.imageObj.css({height:this.imageObj.height(),width:this.imageObj.width(),position:"relative","max-height":"","max-width":""}),t.resizable({maxHeight:e.settings.maxHeight,minHeight:e.settings.minHeight,maxWidth:e.settings.maxWidth,minWidth:e.settings.minWidth,aspectRatio:n,handles:e.settings.handles,grid:e.settings.grid,resize:function(){d=!0,e._onResize(e.imageObj)},stop:function(t){d=!1,e._onResized(e.imageObj),this.enableCrop&&window.setTimeout(function(){e.ui.setScope(),that.done(t)},10)}}),t.css("display","inline-block"),r(".ui-wrapper").attr("contentEditable",!1).addClass("aloha-image-box-active Aloha_Image_Resize aloha").css({position:"relative",display:"inline-block","float":e.imageObj.css("float")}).bind("resizestart",function(e){e.preventDefault()}).bind("mouseup",function(e){e.originalEvent.stopSelectionUpdate=!0})},endResize:function(){if(this.imageObj){this.imageObj.closest(".aloha-editable")}this.imageObj&&this.imageObj.is(":ui-resizable")&&this.imageObj.resizable("destroy").css({top:0,left:0})},resetSize:function(){var e=this,t=new Image;t.onload=function(){var n=e.getPluginFocus();e.settings.ui.resizable&&e.endResize(),r(n).add(n.parent()).css({width:t.width+"px",height:t.height+"px","max-width":"","max-height":""}),e.settings.ui.resizable&&e.resize()},t.src=e.getPluginFocus().attr("src")},reset:function(){var e;if(this.settings.ui.crop&&this.endCrop(),this.settings.ui.resizable&&this.endResize(),e=this._onReset(this.imageObj),!e)for(var t=0;t<this.restoreProps.length;t++)if(this.imageObj.get(0)===this.restoreProps[t].obj.get(0)){this.imageObj.attr("src",this.restoreProps[t].src),this.imageObj.width(this.restoreProps[t].width),this.imageObj.height(this.restoreProps[t].height);
break}this._applyValuesToFields(this.imageObj.width(),this.imageObj.height())}})}),define("highlighteditables/highlighteditables-plugin",["aloha","jquery","aloha/plugin","aloha/ephemera"],function(e,t,n,i){var a=window.GENTICS;return n.create("highlighteditables",{config:["highlight"],init:function(){var t,n=this;i.classes("aloha-editable-highlight"),a.Utils.Position.addMouseMoveCallback(function(){var i,a;for(i=0;i<e.editables.length;i++)a=e.editables[i],t=n.getEditableConfig(a.obj),e.activeEditable||a.isDisabled()||"highlight"!=t||a.obj.addClass("aloha-editable-highlight")}),a.Utils.Position.addMouseStopCallback(function(){n.fade()}),e.bind("aloha-editable-activated",function(){n.fade()})},fade:function(){var n,i,a=function(){t(this).css("outline","")};for(n=0;n<e.editables.length;n++)i=e.editables[n].obj,i.hasClass("aloha-editable-highlight")&&i.css("outline",i.css("outlineColor")+" "+i.css("outlineStyle")+" 5px").removeClass("aloha-editable-highlight").animate({outlineWidth:"0px"},300,"swing",a)}})}),define("dom-to-xhtml/dom-to-xhtml",["jquery","util/dom2","util/misc","util/browser","aloha/ephemera","aloha/console"],function(e,t,n,i,a,r){function o(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function s(e){return o(e).replace(/"/g,"&quot;")}function l(e,n){var r,o,l=t.attrs(e),d="";if(i.ie7)for(var c in f)if(f.hasOwnProperty(c)&&e[c]){for(r=0,o=l.length;o>r;r++)if(c===l[r][0].toLowerCase()){l.splice(r,1);break}l.push([c,c])}for(r=0,o=l.length;o>r;r++){var u=l[r],h=u[0].toLowerCase(),p=u[1];if(!n||!a.isAttrEphemeral(e,h,n.attrMap||{},n.attrRxs||{})){var g=f[h];(g||""!==p)&&(d+=" "+h+'="'+s(g?h:p)+'"')}}return d}function d(e){var t=e.nodeName,n=g[t];if(null!=n)return n;var i="/"+e.nodeName,a=e.nextSibling;for(n=!1;null!=a;){if(i==a.nodeName){n=!0;break}a=a.nextSibling}return g[t]=n,n}function c(e,t,n,i,a){for(;null!=t;){if(1===t.nodeType&&n&&"/"+e.nodeName==t.nodeName){t=t.nextSibling;break}1===t.nodeType&&d(t)?t=u(t,t.nextSibling,!0,i,a):(h(t,i,a),t=t.nextSibling)}return t}function u(e,t,n,i,a){var r=e.nodeName.toLowerCase();return e.scopeName&&"HTML"!=e.scopeName&&-1===r.indexOf(":")&&(r=e.scopeName.toLowerCase()+":"+r),!n&&null==t&&p[r]?a.push("<"+r+l(e,i)+"/>"):(a.push("<"+r+l(e,i)+">"),t=c(e,t,n,i,a),a.push("</"+r+">")),t}function h(e,t,n){var i=e.nodeType;1===i?u(e,e.firstChild,d(e),t,n):3===e.nodeType?n.push(o(e.nodeValue)):8===e.nodeType?n.push("<!--"+e.nodeValue+"-->"):r.warn("Unknown node type encountered during serialization, ignoring it: type="+e.nodeType+" name="+e.nodeName+" value="+e.nodeValue)}var p={area:!0,base:!0,basefont:!0,br:!0,col:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,link:!0,meta:!0,param:!0,embed:!0},f={checked:!0,compact:!0,declare:!0,defer:!0,disabled:!0,ismap:!0,multiple:!0,nohref:!0,noresize:!0,noshade:!0,nowrap:!0,readonly:!0,selected:!0},g={DIV:!1,SPAN:!1,UL:!1,OL:!1,LI:!1,TABLE:!1,TR:!1,TD:!1,TH:!1,I:!1,B:!1,EM:!1,STRONG:!1,A:!1,P:!1};return{contentsToXhtml:function(e,t){var n=[];return c(e,e.firstChild,!1,t,n),n.join("")},nodeToXhtml:function(e,t){var n=[];return h(e,t,n),n.join("")}}}),define("dom-to-xhtml/dom-to-xhtml-plugin",["aloha","jquery","aloha/plugin","aloha/ephemera","dom-to-xhtml/dom-to-xhtml"],function(e,t,n,i,a){return n.create("dom-to-xhtml",{init:function(){var n=this;e.Editable.setContentSerializer(function(e){return n.settings.editables||n.settings.config?n.settings.editables&&"dom-to-xhtml"==n.settings.editables["#"+t(e).attr("id")]?a.contentsToXhtml(e,i.ephemera()):n.settings.config&&"dom-to-xhtml"==n.settings.config&&!n.settings.editables["#"+t(e).attr("id")]?a.contentsToXhtml(e,i.ephemera()):t(e).html():a.contentsToXhtml(e)})}})}),define("contenthandler/contenthandler-utils",["jquery"],function(e){function t(t){var n=e.trim(t);if(!n)return!1;var i=e("<div>"+n+"</div>")[0],a=i.firstChild===i.lastChild&&"p"===i.firstChild.nodeName.toLowerCase();if(a){var r=i.firstChild.children;return r&&1===r.length&&"br"===r[0].nodeName.toLowerCase()}return!1}function n(t){return"string"==typeof t?e("<div>"+t+"</div>"):t instanceof e?e("<div>").append(t):null}return{wrapContent:n,isProppedParagraph:t}}),define("contenthandler/wordcontenthandler",["jquery","aloha","aloha/contenthandlermanager","contenthandler/contenthandler-utils","util/dom2","util/html"],function(e,t,n,i,a,r){function o(t){switch(t[0].nodeName.toLowerCase()){case"table":return 0===t.find("tbody,tr").length;case"tbody":return 0===t.find("tr").length;case"tr":return 0===t.find("td,th").length;default:return""===e.trim(t.text())}}function s(e){if(0===e.length||!h.test(e[0].outerHTML))return!1;var t,n,i,a=e.find("*");for(t=0;t<a.length;t++){if(n=a.eq(t).attr("style"),n&&n.toLowerCase().indexOf("mso")>=0)return!0;if(i=a.eq(t).attr("class"),i&&i.toLowerCase().indexOf("mso")>=0)return!0}return!1}function l(e){var t,n,i=e[0].childNodes;for(t=0,n=i.length;n>t;t++)i[t]&&r.isUnrenderedNode(i[t])&&e[0].removeChild(i[t])}function d(t){var n,i,a,r,s,d=t.find("*");for(r=0,s=d.length;s>r;r++)i=d.eq(r),n=i[0].nodeName.toLowerCase(),"a"===n?(a=i.attr("href"),a&&p.test(e.trim(a))&&i.contents().unwrap()):"div"===n||"span"===n?i.contents().unwrap():"td"!==n&&o(i)&&i.contents().unwrap();l(t)}function c(n){n.find("p.MsoTitle").each(function(){t.Markup.transformDomObject(e(this),"h1")}),n.find("p.MsoSubtitle").each(function(){t.Markup.transformDomObject(e(this),"h2")})}var u=e,h=/mso/,p=/^#(.*)/,f=n.createHandler({handleContent:function(e){var t=i.wrapContent(e);return t?(s(t)&&this.transformWordContent(t),t.html()):e},isOrderedList:function(t){return"Wingdings"==t.css("fontFamily")||"Symbol"==t.css("fontFamily")?!1:e.trim(t.text()).match(/^([0-9]{1,3}\.)|([0-9]{1,3}\)|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\)))$/)?!0:!1},transformListsFromWord:function(e){var t,n,i,a,r,o,s=this;o="aloha-list-element",r="aloha-list-bullet",n="p.MsoListParagraphCxSpFirst,p.MsoListParagraphCxSpMiddle,p.MsoListParagraphCxSpLast,p.MsoListParagraph,p span",a=e.find(n),a.each(function(){var e=u(this),t=e.css("font-family")||"",n=e.css("mso-list")||"",i=e.attr("style")||"";e.hasClass("MsoListParagraphCxSpFirst")||e.hasClass("MsoListParagraph")?e.addClass(o):t.indexOf("Symbol")>=0?e.closest("p").addClass(o):t.indexOf("Wingdings")>=0?e.closest("p").addClass(o):""!==n?e.closest("p").addClass(o):i.indexOf("mso-list")>=0&&e.closest("p").addClass(o)}),n="p span span span",i=e.find(n),i.each(function(){var e,t=u(this),n=u.trim(t.text()).replace(/&nbsp;/g,"");0===n.length&&(e=u.trim(t.parent().parent().text()).replace(/&nbsp;/g,""),e.match(/^([0-9]{1,3}\.)|([0-9]{1,3}\))|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\))|(.)$/)&&(t.closest("p").addClass(o),t.parent().parent().addClass(r)))}),n="p."+o,t=":not("+n+", font)",a=e.find(n),a.length>0&&a.each(function(){var e,n,i,a,l,d,c,h,p=u(this);p.removeClass(o),p.find("font").each(function(){u(this).contents().unwrap()}),h=[],c=parseFloat(p.css("marginLeft")),isNaN(c)&&(c=0),d=[],l=p.nextUntil(t),a=u(p.find("span."+r)),0===a.length&&(a=p.find("span").eq(0)),i=s.isOrderedList(a),a.remove(),n=u(i?"<ol></ol>":"<ul></ul>"),d.push(n),e=u("<li></li>"),n.append(e),p.contents().appendTo(e),p.replaceWith(n),l.each(function(){var t,o,l=u(this);if(!l.is("font")){if(l.find("font").each(function(){u(this).contents().unwrap()}),t=parseFloat(l.css("marginLeft")),isNaN(t)&&(t=0),a=u(l.find("span."+r)),0===a.length&&(a=l.find("span").eq(0)),i=s.isOrderedList(a),a.remove(),t>c)o=u(i?"<ol></ol>":"<ul></ul>"),n.children(":last").append(o),n=o,d.push(n),h.push(t),c=t;else if(c>t&&h.length>0){for(;h.length>0&&h[h.length-1]>t;)h.pop(),d.pop();n=d[d.length-1],c=t}e=u("<li></li>"),n.append(e),l.contents().appendTo(e),l.remove()}})})},removeParagraphNumbering:function(e){var t="h1,h2,h3,h4,h5,h6",n=e.find(t);n.length>0&&n.each(function(){var e=u(this),t=e.find("span"),n=e.find("a");t.each(function(){u.trim(u(this).text()).match(/^([\.\(]?[\d\D][\.\(]?){1,4}$/)&&u(this).remove()}),n.each(function(){"undefined"==typeof u(this).attr("href")&&u(this).contents().unwrap()})})},transformToc:function(e){var t="[class*=MsoToc]",n=e.find(t);n.each(function(){var e=u(this),t=e.find("span"),n=e.find("a");t.each(function(){u(this).attr("style")&&u(this).attr("style").search("mso-hide")>-1&&u(this).remove(),u(this).contents().unwrap()}),n.each(function(){u(this).contents().unwrap()})})},transformWordContent:function(e){this.transformToc(e),this.removeParagraphNumbering(e),this.transformListsFromWord(e),c(e),d(e)}});return f}),define("contenthandler/genericcontenthandler",["jquery","aloha","aloha/contenthandlermanager","contenthandler/contenthandler-utils"],function(e,t,n,i){function a(t){var n=e.trim(t);if(!n)return!1;var i=e("<div>"+n+"</div>")[0],a=i.firstChild===i.lastChild&&"p"===i.firstChild.nodeName.toLowerCase();if(a){var r=i.firstChild.children;return r&&1===r.length&&"br"===r[0].nodeName.toLowerCase()}return!1}function r(t){t.find("table").removeAttr("cellpadding").removeAttr("cellspacing").removeAttr("border").removeAttr("border-top").removeAttr("border-bottom").removeAttr("border-left").removeAttr("border-right"),t.find("td").each(function(){var t=this;a(t.innerHTML)&&(t.innerHTML="&nbsp;");var n=e(">p",t);1===n.length&&n.contents().unwrap()}),t.find("table,th,td,tr").removeAttr("width").removeAttr("height").removeAttr("valign"),t.find("colgroup").remove()}function o(n){return!!(t.settings.contentHandler&&t.settings.contentHandler.allows&&t.settings.contentHandler.allows.elements&&-1!==e.inArray(n.toLowerCase(),t.settings.contentHandler.allows.elements))}var s=["strong","em","s","u","strike"],l=n.createHandler({handleContent:function(e){var n=i.wrapContent(e);if(!n)return e;if(n.find(".aloha-block").length)return n.html();r(n),this.cleanLists(n),this.removeComments(n),this.unwrapTags(n),this.removeStyles(n),this.removeNamespacedElements(n);var a=!0;return t.settings.contentHandler&&t.settings.contentHandler.handler&&t.settings.contentHandler.handler.generic&&"undefinded"!=typeof t.settings.contentHandler.handler.generic.transformFormattings&&!t.settings.contentHandler.handler.generic.transformFormattings&&(a=!1),a&&this.transformFormattings(n),n.html()},cleanLists:function(e){e.find("ul,ol").find(">:not(li)").remove()},transformFormattings:function(n){var i,a=[];for(i=0;i<s.length;i++)o(s[i])||a.push(s[i]);n.find(a.join(",")).each(function(){"STRONG"===this.nodeName?t.Markup.transformDomObject(e(this),"b"):"EM"===this.nodeName?t.Markup.transformDomObject(e(this),"i"):"S"===this.nodeName||"STRIKE"==this.nodeName?t.Markup.transformDomObject(e(this),"del"):"U"===this.nodeName&&e(this).contents().unwrap()})},transformLinks:function(t){t.find("a").each(function(){"undefined"==typeof e(this).attr("href")&&e(this).contents().unwrap()})},removeComments:function(t){var n=this;t.contents().each(function(){8===this.nodeType?e(this).remove():n.removeComments(e(this))})},unwrapTags:function(n){n.find("span,font,div").not(".aloha-wai-lang").each(function(){"DIV"==this.nodeName?"<br>"===this.innerHTML?e(this).contents().unwrap():e(t.Markup.transformDomObject(e(this),"p").append("<br>")).contents().unwrap():e(this).contents().unwrap()})},removeStyles:function(t){var n=this;t.children("style").filter(function(){return"false"!==this.contentEditable}).remove(),t.children().filter(function(){return"false"!==this.contentEditable}).each(function(){e(this).removeAttr("style").removeClass(),n.removeStyles(e(this))})},removeNamespacedElements:function(t){t.find("*").each(function(){var t=this.prefix?this.prefix:this.scopeName?this.scopeName:void 0;if(t&&"HTML"!==t||this.nodeName.indexOf(":")>=0){var n=e(this),i=n.contents();i.length?i.unwrap():n.remove()}})}});return l}),Sanitize.REGEX_PROTOCOL=/^([A-Za-z0-9\+\-\.\&\;\*\s]*?)(?:\:|&*0*58|&*x0*3a)/i,Sanitize.RELATIVE="__relative__",Sanitize.prototype.clean_node=function(e){function t(e,t){var n,i=t.length;for(n=0;i>n;n++)if(t[n]===e)return n;return-1}function n(){var e,t,n=[],i={},a=arguments.length;for(e=0;a>e;e++)if(t=arguments[e],t&&t.length)for(var r=0,o=t.length;o>r;r++)i[t[r]]||(i[t[r]]=!0,n.push(t[r]));return n}function i(e){var t,n,i=this.filters.length;for(n=0;i>n;n++)if(!this.filters[n](e))return t=e.cloneNode(!0),void this.current_element.appendChild(t);switch(e.nodeType){case 1:a.call(this,e);break;case 3:var t=e.cloneNode(!1);this.current_element.appendChild(t);break;case 5:var t=e.cloneNode(!1);this.current_element.appendChild(t);break;case 8:if(this.config.allow_comments){var t=e.cloneNode(!1);this.current_element.appendChild(t)}}}function a(e){var a,o,s,l,d,c,u,h,p,f,g=r.call(this,e),m=(this.jQuery,Aloha.browser.msie&&"7.0"===Aloha.browser.version);if(e=g.node,l=e.nodeName.toLowerCase(),s=this.current_element,this.allowed_elements[l]||g.whitelist){for(this.current_element=this.dom.createElement(e.nodeName),s.appendChild(this.current_element),d=n(this.config.attributes[l],this.config.attributes.__ALL__,g.attr_whitelist),o=d.length,a=0;o>a;a++)u=d[a],c=e.attributes[u],c&&(f=!0,this.config.protocols[l]&&this.config.protocols[l][u]&&(h=this.config.protocols[l][u],p=c.nodeValue.toLowerCase().match(Sanitize.REGEX_PROTOCOL),f=p?-1!=t(p[1],h):-1!=t(Sanitize.RELATIVE,h)),f&&(!m||m&&"style"!==u)&&this.current_element.setAttribute(u,c.nodeValue));if(this.config.add_attributes[l])for(u in this.config.add_attributes[l])(!m||m&&"style"!==u)&&this.current_element.setAttribute(u,this.config.add_attributes[l][u])}else if(-1!=t(e,this.whitelist_nodes)){this.current_element=e.cloneNode(!0);for(var b=this.current_element.childNodes.length;b>0;)this.current_element.removeChild(this.current_element.firstChild);s.appendChild(this.current_element)}if(!this.config.remove_all_contents&&!this.config.remove_element_contents[l]){var v=e.childNodes,o=v.length;for(a=0;o>a;a++)i.call(this,v[a])}this.current_element.normalize&&this.current_element.normalize(),this.current_element=s}function r(e){var i,a,r,o,s={attr_whitelist:[],node:e,whitelist:!1},l=this.transformers.length;for(a=0;l>a;a++)if(i=this.transformers[a]({allowed_elements:this.allowed_elements,config:this.config,node:e,node_name:e.nodeName.toLowerCase(),whitelist_nodes:this.whitelist_nodes,dom:this.dom}),null!=i){if("object"!=typeof i)throw new Error("transformer output must be an object or null");if(i.whitelist_nodes&&i.whitelist_nodes instanceof Array)for(o=i.whitelist_nodes.length,r=0;o>r;r++)-1==t(i.whitelist_nodes[r],this.whitelist_nodes)&&this.whitelist_nodes.push(i.whitelist_nodes[r]);s.whitelist=i.whitelist?!0:!1,i.attr_whitelist&&(s.attr_whitelist=n(s.attr_whitelist,i.attr_whitelist)),s.node=i.node?i.node:s.node}return s}var o=this.dom.createDocumentFragment();this.current_element=o,this.whitelist_nodes=[];var s,l=e.childNodes;for(s=0,len=l.length;len>s;s++)i.call(this,l[s]);return o.normalize&&o.normalize(),o},define("vendor/sanitize",function(){}),define("contenthandler/sanitizecontenthandler",["aloha/core","jquery","aloha/contenthandlermanager","aloha/plugin","aloha/console","vendor/sanitize"],function(e,t,n){function i(n){var i=["restricted","basic","relaxed"],r=e.defaults.supports;e.settings.contentHandler.allows&&(r=e.settings.contentHandler.allows),"string"==typeof e.settings.contentHandler.sanitize&&t.inArray(e.settings.contentHandler.sanitize,i)>-1?r=e.defaults.sanitize[e.settings.contentHandler.sanitize]:"object"==typeof e.settings.contentHandler.sanitize?r=e.settings.contentHandler.sanitize:r||(r=e.defaults.sanitize.relaxed),n&&(r=n),r.filters=[function(e){return"false"!=e.contentEditable}],a=new Sanitize(r,t)}var a;e.defaults.sanitize||(e.defaults.sanitize={}),e.defaults.sanitize.restricted={elements:["b","em","i","strong","u","del","p","span","div","br"]},e.defaults.sanitize.basic={elements:["a","abbr","b","blockquote","br","cite","code","dd","del","dl","dt","em","i","li","ol","p","pre","q","small","strike","strong","sub","sup","u","ul"],attributes:{a:["href"],blockquote:["cite"],q:["cite"],abbr:["title"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}},e.defaults.sanitize.relaxed={elements:["a","abbr","b","blockquote","br","caption","cite","code","col","colgroup","dd","del","dl","dt","em","h1","h2","h3","h4","h5","h6","i","img","li","ol","p","pre","q","small","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","u","ul","span","hr","object","div"],attributes:{a:["href","title","id","class","target","data-gentics-aloha-repository","data-gentics-aloha-object-id"],div:["id","class","style"],abbr:["title"],blockquote:["cite"],br:["class"],col:["span","width"],colgroup:["span","width"],img:["align","alt","height","src","title","width","class","data-caption","data-align","data-width","data-original-image"],ol:["start","type"],p:["class","style","id"],q:["cite"],table:["summary","width"],td:["abbr","axis","colSpan","rowSpan","colspan","rowspan","width"],th:["abbr","axis","colSpan","rowSpan","colspan","rowspan","scope","width"],ul:["type"],span:["class","style","lang","xml:lang","role"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},img:{src:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}};var r=n.createHandler({handleContent:function(n,r,o){if(!o)return n;var s,l;if(e.settings.contentHandler&&e.settings.contentHandler.handler&&e.settings.contentHandler.handler.sanitize){e.settings.contentHandler.handler.sanitize&&(l=e.settings.contentHandler.handler.sanitize);var d=l["#"+o.getId()];if("undefined"!=typeof d)s=l;else for(var c=o.obj.attr("class").split(" "),u=0;u<c.length;u++)"undefined"!=typeof l["."+c[u]]&&(s=l["."+c[u]])}return("undefined"==typeof a||"undefined"!=typeof s)&&i(s),"string"==typeof n?n=t("<div>"+n+"</div>").get(0):n instanceof t&&(n=t("<div>").append(n).get(0)),t("<div>").append(a.clean_node(n)).html()}});return r}),define("contenthandler/blockelementcontenthandler",["jquery","aloha/core","aloha/contenthandlermanager","contenthandler/contenthandler-utils","util/functions","util/html","util/arrays"],function(e,t,n,i,a,r,o){function s(t,n){var i=r.findNodeRight(n.lastChild,f);i&&"br"===i.nodeName.toLowerCase()&&e(i).remove()}function l(t,n){var i=e(n);i.filter(h).remove(),e.browser.msie&&(i.filter("br.aloha-end-br").remove(),i.filter(u).each(s)),i.children(p).each(l)}function d(t,n){var i=e(n);i.filter(h).append("​"),i.children(p).each(d)}function c(t,n){var i=e(n);i.filter(h).filter(":empty").append("<br/>"),i.children(p).each(c)}var u=r.BLOCKLEVEL_ELEMENTS.join(),h=o.subtract(r.BLOCKLEVEL_ELEMENTS,r.VOID_ELEMENTS),p=":not(.aloha-block)",f=a.complement(r.isIgnorableWhitespace);return n.createHandler({handleContent:function(t,n){if(!n)return t;var a=i.wrapContent(t);if(!a)return t;switch(n.command){case"initEditable":a.children(p).each(l),e.browser.msie&&e.browser.version<=7&&a.children(p).each(d);break;case"getContents":a.children(p).each(c)}return a.html()}})}),define("contenthandler/contenthandler-plugin",["jquery","aloha/plugin","aloha/contenthandlermanager","contenthandler/wordcontenthandler","contenthandler/genericcontenthandler","contenthandler/sanitizecontenthandler","contenthandler/blockelementcontenthandler"],function(e,t,n,i,a,r,o){var s={word:i,generic:a,sanitize:r,blockelement:o},l=t.create("contenthandler",{init:function(){var e;for(e in s)s.hasOwnProperty(e)&&n.register(e,s[e])}});return l}),define("characterpicker/nls/i18n",{root:{"button.addcharacter.tooltip":"pick special characters"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("characterpicker/characterpicker-plugin",["aloha","jquery","aloha/plugin","ui/ui","ui/button","ui/floating","PubSub","i18n!characterpicker/nls/i18n"],function(e,t,n,i,a,r,o,s){function l(e){return"table"===e.$element.css("display")}function d(e){e.$element.click(function(e){e.stopPropagation()}),t("body").click(function(n){!e._overlayActive||n.target===e.$element[0]||t(n.target).is(".aloha-icon-characterpicker")||t(n.target).find(".aloha-icon-characterpicker").length||e.hide()})}function c(e){y.keyup(function(t){27===t.keyCode&&l(e)&&e.hide()})}function u(e,t,n){var i,a=function(e){return e.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()})};i=e.currentStyle?e.currentStyle[a(n)]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null).getPropertyValue(n):e.style[a(n)],i&&t.css(n,i)}function h(e,n){var i={13:function(t){e.hide(),n(t.text())},37:function(e){var t=e.prev();t.length&&(t.addClass("focused"),e.removeClass("focused"))},38:function(e){var n=e.parent().prev();if(n.length){var i=t(n.children()[e.index()]).addClass("focused");i.length&&e.removeClass("focused")}},39:function(e){var t=e.next().addClass("focused");t.length&&e.removeClass("focused")},40:function(e){var n=e.parent().next();if(n.length){var i=t(n.children()[e.index()]).addClass("focused");i.length&&e.removeClass("focused")}}};y.keydown(function(t){return t.stopPropagation(),i[t.keyCode]&&l(e)?(i[t.keyCode](e.$element.find(".focused")),!1):void 0})}function p(e,n){var i=document.createElement("textarea");i.innerHTML=n;for(var a,r=t.grep(i.value.split(" "),function(e){return""!==e}),o=["<tr>"],s=0;a=r[s];)0!==s&&0===s%15&&o.push("</tr><tr>"),o.push('<td unselectable="on">'+a+"</td>"),s++;o.push("</tr>"),e.$tbody.empty().append(o.join("")),e.$element.delegate("td","mouseover",function(){e.$element.find(".focused").removeClass("focused"),t(this).addClass("focused")}).delegate("td","mouseout",function(){t(this).removeClass("focused")}).delegate("td","click",function(){e.$element.hide(),e.onSelect(t(this).text())})}function f(e){var t=e.offset();return"fixed"===r.POSITION_STYLE&&(t.top-=_.scrollTop(),t.left-=_.scrollLeft()),t}function g(t){e.activeEditable&&(v.select(),e.execCommand("insertHTML",!1,t),v.endContainer=v.startContainer,v.endOffset=++v.startOffset,v.select())}function m(n){var i=this;i.$element=t('<table class="aloha-character-picker-overlay" unselectable="on" role="dialog"><tbody></tbody></table>'),i.$element.mousedown(function(){return!1}),i.onSelect=n,i.$tbody=i.$element.find("tbody"),i.$element.appendTo(t("body")),d(i),c(i),h(i,n),e.bind("aloha-editable-deactivated",function(){i.hide()})}function b(e,n){var i=e.getEditableConfig(n.obj);if(!i)return null;var a=t.isArray(i)?i.join(" "):i,r=w[a];return r||(r=new m(g),p(r,a),w[a]=r),r}var v,y=t(document),_=t(window),w={};m.prototype={show:function(e){var t=this;t.$element.css(f(e)).css("position",r.POSITION_STYLE).show().find(".focused").removeClass("focused"),t.$element.find("td").eq(0).addClass("focused"),t._overlayActive=!0},hide:function(){this.$element.hide(),this._overlayActive=!1}};var C=n.create("characterpicker",{settings:{},config:"&#38; &#34; &#162; &#8364; &#163; &#165; &#169; &#174; &#8482; &#8240; &#181; &#183; &#8226; &#8230; &#8242; &#8243; &#167; &#182; &#223; &#8249; &#8250; &#171; &#187; &#8216; &#8217; &#8220; &#8221; &#8218; &#8222; &#60; &#62; &#8804; &#8805; &#8211; &#8212; &#175; &#8254; &#164; &#166; &#168; &#161; &#191; &#710; &#732; &#176; &#8722; &#177; &#247; &#8260; &#215; &#185; &#178; &#179; &#188; &#189; &#190; &#402; &#8747; &#8721; &#8734; &#8730; &#8764; &#8773; &#8776; &#8800; &#8801; &#8712; &#8713; &#8715; &#8719; &#8743; &#8744; &#172; &#8745; &#8746; &#8706; &#8704; &#8707; &#8709; &#8711; &#8727; &#8733; &#8736; &#180; &#184; &#170; &#186; &#8224; &#8225; &#192; &#193; &#194; &#195; &#196; &#197; &#198; &#199; &#200; &#201; &#202; &#203; &#204; &#205; &#206; &#207; &#208; &#209; &#210; &#211; &#212; &#213; &#214; &#216; &#338; &#352; &#217; &#218; &#219; &#220; &#221; &#376; &#222; &#224; &#225; &#226; &#227; &#228; &#229; &#230; &#231; &#232; &#233; &#234; &#235; &#236; &#237; &#238; &#239; &#240; &#241; &#242; &#243; &#244; &#245; &#246; &#248; &#339; &#353; &#249; &#250; &#251; &#252; &#253; &#254; &#255; &#913; &#914; &#915; &#916; &#917; &#918; &#919; &#920; &#921; &#922; &#923; &#924; &#925; &#926; &#927; &#928; &#929; &#931; &#932; &#933; &#934; &#935; &#936; &#937; &#945; &#946; &#947; &#948; &#949; &#950; &#951; &#952; &#953; &#954; &#955; &#956; &#957; &#958; &#959; &#960; &#961; &#962; &#963; &#964; &#965; &#966; &#967; &#968; &#969; &#8501; &#982; &#8476; &#977; &#978; &#8472; &#8465; &#8592; &#8593; &#8594; &#8595; &#8596; &#8629; &#8656; &#8657; &#8658; &#8659; &#8660; &#8756; &#8834; &#8835; &#8836; &#8838; &#8839; &#8853; &#8855; &#8869; &#8901; &#8968; &#8969; &#8970; &#8971; &#9001; &#9002; &#9674; &#9824; &#9827; &#9829; &#9830;",_constructor:function(){this._super("characterpicker")},init:function(){function t(i){i<e.editables.length&&(b(n,e.editables[i]),window.setTimeout(function(){t(i+1)},100))}var n=this;e.settings.plugins&&e.settings.plugins.characterpicker&&(n.settings=e.settings.plugins.characterpicker);var r=i.adopt("characterPicker",a,{tooltip:s.t("button.addcharacter.tooltip"),icon:"aloha-icon-characterpicker",scope:"Aloha.continuoustext",click:function(){if(n.overlay){v=e.Selection.rangeObject;var t=v.startContainer.parentNode,i=n.overlay.$element;u(t,i,"font-family"),u(t,i,"font-weight"),u(t,i,"font-style"),n.overlay.show(this.element)}}});window.setTimeout(function(){t(0)},100),e.bind("aloha-editable-activated",function(e,t){n.overlay=b(n,t.editable),n.overlay?r.show():r.hide()}),o.sub("aloha.floating.changed",function(){n.overlay&&n.overlay.$element.css(f(r.element))})}});return C}),define("commands/inserthtml",["aloha/core","jquery","aloha/command","aloha/selection","util/dom","aloha/contenthandlermanager","aloha/console"],function(e,t,n,i,a,r,o){n.register("inserthtml",{action:function(n,i){function s(e){var n,r=t(e);if(!a.insertIntoDOM(r,i,d,!1)){n=r.contents(),(a.isBlockLevelElement(e)||a.isListElement(e))&&s(t("<br/>").get(0));for(var o=n.length-1;o>=0;--o)s(n[o])}}var l,d=t(a.getEditingHostOf(i.startContainer)),c=i.commonAncestorContainer,u=[];if(n=r.handleContent(n,{contenthandler:e.settings.contentHandler.insertHtml}),"string"==typeof n)n=t("<div>"+n+"</div>");else{if(!(n instanceof t))throw"INVALID_VALUE_ERR";n=t("<div>").append(n)}for(u=n.contents(),a.removeRange(i),l=u.length-1;l>=0;--l)s(u[l]);u.length>0?i=a.setCursorAfter(u.get(u.length-1)):i.select(),a.doCleanup({merge:!0,removeempty:!0},i,c);try{i.select()}catch(h){o.warn("Error:",h)}}})}),define("commands/commands-plugin",["aloha/command","./inserthtml"],function(){}),define("block/block-utils",["jquery","util/dom","util/dom2","util/html","aloha/ephemera"],function(e,t,n,i,a){function r(e){return g+"_"+e.attr("id")}function o(e){var t=document.createElement("span");return t.className=r(e),t.appendChild(document.createTextNode(" ")),a.markWhiteSpaceWrapper(t),t}function s(e){return(i.isBlock(e)||n.isTextNode(e))&&!i.isUnrenderedNode(e)}function l(e){return n.forward(e.lastChild||e)}function d(e){var a=n.findBackward(n.backward(e[0]),s,function(e){return i.isBlock(e)||t.isEditingHost(e)});a||e.before(o(e));var r=n.findForward(l(e[0]),s,function(e){return i.isBlock(e)||t.isEditingHost(e)||e.previousSibling&&t.isEditingHost(e.previousSibling)});r||e.after(o(e))}function c(t){var n=r(t);e("."+n).each(function(t,n){i.hasOnlyWhiteSpaceChildren(n)?n.parentNode.removeChild(n):e(n.childNodes).unwrap()})}function u(e){var t=e.closest(".aloha-editable");return t.length?!!t.data("block-dragdrop"):!0}function h(e){return e.parents(".aloha-editable").filter(":first")}function p(e){return f(e)?e.find("table").filter(":first"):null}function f(e){return e.hasClass("aloha-table-wrapper")}var g="aloha-caret-landing";return{pad:d,unpad:c,isDragdropEnabledForElement:u,isTable:f,getEditableByBlock:h,getTableByBlock:p}}),define("block/blockmanager",["aloha","jquery","ui/scopes","aloha/observable","aloha/registry","util/class","util/strings","util/maps","block/block-utils","table/table-plugin"],function(e,t,n,i,a,r,o,s,l){function d(e){e.$element.attr("data-aloha-block-copy-only-block","true"),u.Utils.Dom.selectDomNode(e.$element[0])}var c=t,u=window.GENTICS,h=new(r.extend(i,{defaults:{"aloha-block-type":"DefaultBlock"},blockTypes:null,blocks:null,_highlightedBlocks:null,_activeBlock:null,_dragdropEnabled:!0,_constructor:function(){n.createScope("Aloha.Block"),this.blockTypes=new a,this.blocks=new a,this._highlightedBlocks={}},registerEventHandlers:function(){var t=this;this._registerEventHandlersForDeactivatingAlohaBlock(),this._registerEventHandlersForDeterminingCurrentlyActiveBlock(),this._registerEventHandlersForBlockDeletion(),this._registerEventHandlersForCutCopyPaste(),this._registerEventHandlersForEditableActivated(),e.bind("aloha-selection-changed",function(e,n){n&&c(n.getCommonAncestorContainer()).parents(".aloha-block").length>0||t._deactivateHighlightedBlocks()})},_registerEventHandlersForDeactivatingAlohaBlock:function(){var e=this;c(document).bind("click",function(t){s.isEmpty(e._highlightedBlocks)||c(t.target).closest(".aloha-ui,.aloha-block-do-not-deactivate,.aloha-block").length>0||e._deactivateHighlightedBlocks()})},_registerEventHandlersForDeterminingCurrentlyActiveBlock:function(){var e=this;this.bind("block-selection-change",function(t){e._activeBlock=t.length>0?t[0]:null})},_registerEventHandlersForBlockDeletion:function(){var n=this;e.bind("aloha-command-will-execute",function(t,i){var a=i.commandId,r=e.getSelection(),o=r.getRangeCount(),s=r.getRangeAt(0),l=s.endContainer,d=s.startContainer,u=0===o||1===o&&l===d&&l===c("body")[0]||1===o&&l===d&&s.startOffset+1===s.endOffset;if(n._activeBlock&&("delete"===a||"forwarddelete"===a)&&u)i.preventDefault=!0,n._activeBlock.destroy();else if(!n._activeBlock&&("delete"===a||"forwarddelete"===a)&&1===o&&s.collapsed===!1){var h;h=function(e){for(var t,n=0,i=e.length;i>n;n++)if(t=e[n],1===t.domobj.nodeType){var a=c(t.domobj);"full"===t.selection&&a.is(".aloha-block")?a.remove():h(t.children)}},h(e.Selection.getSelectionTree())}}),c(window.document).keydown(function(e){if(t(e.target).closest(".aloha-ui").length>0)return!0;if(n._activeBlock&&(46===e.which||8===e.which)&&n._activeBlock._isInsideNestedEditable===!1){if(c.browser.msie&&parseInt(c.browser.version,10)<=8&&n._activeBlock.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable"))return n._activeBlock.destroy(),e.preventDefault(),!1;if(n._activeBlock.shouldDestroy())return n._activeBlock.destroy(),e.preventDefault(),!1}})},_registerEventHandlersForCutCopyPaste:function(){var t=this,n=!1,i=!1,a=null;c(window.document).keydown(function(a){e.activeEditable&&t._activeBlock&&c.contains(t._activeBlock.$element.get(0),e.activeEditable.obj.get(0))||t._activeBlock&&(a.ctrlKey||a.metaKey)&&!l.isTable(t._activeBlock.$element)&&(67===a.which?(n=!0,d(t._activeBlock)):88===a.which&&(i=!0,d(t._activeBlock)))}),c(window.document).keyup(function(e){i||!n||67!==e.which&&18!==e.which&&91!==e.which||(n=!1,t._activeBlock.$element.removeAttr("data-aloha-block-copy-only-block"),a&&(a=null)),!i||67!==e.which&&18!==e.which&&88!==e.which||(i=!1)})},_registerEventHandlersForEditableActivated:function(){var t=this;e.bind("aloha-editable-activated",function(e,n){if(n.editable){var i=t.getBlock(n.editable.obj.closest(".aloha-block"));i&&i.activate()}})},initializeBlockLevelDragDrop:function(){var t=this;c.each(e.editables,function(e,n){n.obj.data("block-dragdrop",t._dragdropEnabled)}),e.bind("aloha-editable-created",function(e,n){n.obj.data("block-dragdrop",t._dragdropEnabled)})},setDragDropState:function(e){this._dragdropEnabled=e},getDragDropState:function(){return this._dragdropEnabled},registerBlockType:function(e,t){n.createScope("Aloha.Block."+e,"Aloha.Block"),this.blockTypes.register(e,t)},_blockify:function(t,n){var i,a,r=c(t),o=e.require("block/block-plugin"),s=r[0].tagName.toLowerCase();return-1===c.inArray(s,o.settings.rootTags)?void e.Log.error("block/blockmanager","Blocks can only be created from ["+o.settings.rootTags.join(", ")+"] element. You passed "+s+"."):(i=this.getConfig(r,n),this.blockTypes.has(i["aloha-block-type"])?(a=new(this.blockTypes.get(i["aloha-block-type"]))(r,i),a.$element.addClass("aloha-block-"+i["aloha-block-type"]),void this.blocks.register(a.getId(),a)):void e.Log.error("block/blockmanager","Block Type "+i["aloha-block-type"]+" not found!"))
},_unblockify:function(e){var t=this.getBlock(e);t&&t.unblock()},getConfig:function(e,n){var i={},a=null,r=null;if(e.length>0){r=t(e[0].cloneNode(!1)),a=t.extend({},t.data(e[0]),r.data()),r.removeData();for(var s in a)a.hasOwnProperty(s)&&(i[o.camelCaseToDashes(s)]=a[s])}return c.extend({},this.defaults,n,i)},getBlock:function(e){var t,n;return"object"==typeof e?(n=c(e),n.hasClass("aloha-block-inner")&&(n=n.parent()),t=n.attr("id")):t=e,this.blocks.get(t)},_unregisterBlock:function(e){var t;t="object"==typeof e?e.getId():e,this.blocks.unregister(t)},_deactivateHighlightedBlocks:function(){c.each(c.extend({},this._highlightedBlocks),function(e){var t=h.getBlock(e);t&&t.deactivate()})},_getHighlightedBlocks:function(){var e={};return c.each(this.blocks.getEntries(),function(t,n){n.isActive()&&(e[t]=n)}),e},_setHighlighted:function(e){this._highlightedBlocks[e.id]=!0},_setUnhighlighted:function(e){delete this._highlightedBlocks[e.id]}}));return e.Block=e.Block||{},e.Block.BlockManager=h,h}),define("block/editormanager",["aloha/registry"],function(e){return new(e.extend({createEditor:function(e){if(!this.has(e.type))throw'Editor for type "'+e.type+'" not found.';var t=this.get(e.type);return new t(e)}}))}),define("block/sidebarattributeeditor",["jquery","block/blockmanager","aloha/sidebar","block/editormanager","util/class"],function(e,t,n,i,a){return new(a.extend({_sidebar:null,_blockPanels:[],init:function(){this._sidebar=n.right.show(),t.bind("block-selection-change",this._onBlockSelectionChange,this)},_onBlockSelectionChange:function(t){var n,a=this;if(this._sidebar){for(n in a._blockPanels)a._blockPanels.hasOwnProperty(n)&&(n=a._blockPanels[n],e(n.element).remove(),delete this._sidebar.panels[n.id]);this._blockPanels=[],e.each(t,function(){var t=this.getSchema(),n=this,r=[];t&&a._blockPanels.push(a._sidebar.addPanel({title:n.getTitle(),expanded:!0,onInit:function(){var a=e("<form />");a.submit(function(){return!1}),e.each(t,function(e,t){var o=i.createEditor(t);o.bind("change",function(t){n.attr(e,t)}),n.bind("change",function(){o.setValue(n.attr(e))}),a.append(o.render()),o.setValue(n.attr(e)),r.push(o)}),this.setContent(a)},deactivate:function(){e.each(r,function(e,t){t._deactivate()}),this.isActive=!1,this.effectiveElement=null}}))})}}}))}),define("block/block",["aloha","jquery","block/blockmanager","aloha/observable","ui/scopes","util/class","PubSub","block/block-utils","util/html","util/functions"],function(e,t,n,i,a,r,o,s,l,d){var c=window.GENTICS,u=r.extend(i,{title:null,id:null,$element:null,_currentlyRendering:!1,_initialized:!1,_isInsideNestedEditable:!1,_constructor:function(n,i){var a=this;if(this.$element=n,n.attr("id")?this.id=n.attr("id"):(this.id=c.Utils.guid(),n.attr("id",this.id)),n.contentEditable(!1),n.addClass("aloha-block"),this.isDraggable()){n.find("img").attr("draggable","false");try{n.find("a").attr("draggable","false")}catch(r){n.find("a").each(function(){this.setAttribute("draggable","false")})}}t.each(i,function(e,t){a._setAttribute(e,t)}),this._onElementClickHandler=function(e){t(e.target).closest(".aloha-block").get(0)===a.$element.get(0)&&(a._fixScrollPositionBugsInIE(),a.activate(e.target,e))},this._connectThisBlockToDomElement(n,function(){o.pub("aloha.block.initialized",{block:a})}),l.isInlineFormattable(n[0])&&(n.closest(".aloha-editable-active").length>0&&s.pad(a.$element),e.bind("aloha-editable-activated",function(e,t){if(t.editable){var n=t.editable.obj.find("#"+a.id);0!==n.length&&s.pad(a.$element)}}),e.bind("aloha-editable-deactivated",function(e,t){if(t.editable){var n=t.editable.obj.find("#"+a.id);0!==n.length&&s.unpad(a.$element)}})),this._initialized=!0},_onElementClickHandler:null,_preventSelectionChangedEventHandler:function(n){"dblclick"===n.type||t(n.target).is(".aloha-editable")||e.Selection.preventSelectionChanged()},_connectThisBlockToDomElement:function(e,n){var i=this,a=t(e);this._disconnectFromDomElement(),this.$element=a,this.$element.bind("click",this._onElementClickHandler),this.$element.bind("mousedown",this._preventSelectionChangedEventHandler),this.$element.bind("focus",this._preventSelectionChangedEventHandler),this.$element.bind("dblclick",this._preventSelectionChangedEventHandler),this.init(this.$element,function(){window.setTimeout(function(){i._postProcessElementIfNeeded(),n&&n()},5)})},_disconnectFromDomElement:function(){this.$element&&(this.$element.unbind("click",this._onElementClickHandler),this.$element.unbind("mousedown",this._preventSelectionChangedEventHandler),this.$element.unbind("focus",this._preventSelectionChangedEventHandler),this.$element.unbind("dblclick",this._preventSelectionChangedEventHandler))},_fixScrollPositionBugsInIE:function(){var e=t(window).scrollTop();window.setTimeout(function(){t(window).scrollTop()!==e&&t(window).scrollTop(e)},10)},init:function(e,t){t()},shouldDestroy:function(){var e=this.$element.parent().closest(".aloha-block,.aloha-editable,.aloha-block-collection");return e.hasClass("aloha-block-collection")&&"div"===this.$element[0].tagName.toLowerCase()?!0:e.hasClass("aloha-editable")},destroy:function(e){if(this.shouldDestroy()||e===!0){var t=this,i=new c.Utils.RangeObject;i.startContainer=i.endContainer=this.$element.parent()[0],i.startOffset=i.endOffset=c.Utils.Dom.getIndexInParent(this.$element[0]),s.unpad(this.$element),n.trigger("block-delete",this),this.free();var a="span"===this.$element[0].tagName.toLowerCase();this.$element.fadeOut("fast",function(){t.$element.remove(),n.trigger("block-selection-change",[]),window.setTimeout(function(){a&&i.select()},5)})}},unblock:function(){s.unpad(this.$element),this.deactivate(),this._disconnectFromDomElement(),this.$element.removeClass("aloha-block"),this.$element.children(".aloha-block-handle").remove(),this.free()},free:function(){n._unregisterBlock(this),this.unbindAll()},getId:function(){return this.id},getSchema:function(){return null},getTitle:function(){return this.title},isDraggable:function(){return"DIV"===this.$element[0].nodeName&&this.$element.parents(".aloha-editable,.aloha-block:not(.aloha-table-wrapper),.aloha-block-collection").first().hasClass("aloha-block-collection")?!0:this.$element.parents(".aloha-block:not(.aloha-table-wrapper),.aloha-editable").first().hasClass("aloha-editable")},activate:function(i,r){var o=[];t.each(n._getHighlightedBlocks(),function(){this.deactivate()}),"true"!==this.$element.attr("data-block-skip-scope")&&a.setScope("Aloha.Block."+this.attr("aloha-block-type")),this.$element.addClass("aloha-block-active"),this._highlight(),o.push(this),this.$element.parents(".aloha-block").each(function(){var e=n.getBlock(this);e&&(e._highlight(),o.push(e))}),t(i).closest(".aloha-editable,.aloha-block,.aloha-table-cell-editable,.aloha-table-cell_active").first().hasClass("aloha-block")?(this._isInsideNestedEditable=!1,e.getSelection().removeAllRanges()):(this._isInsideNestedEditable=!0,r&&e.Selection.updateSelection(r)),n.trigger("block-activate",o),n.trigger("block-selection-change",o)},deactivate:function(){var e=this,t=[this];this._unhighlight(),this.$element.parents(".aloha-block").each(function(){t.push(this),e._unhighlight()}),this.$element.removeClass("aloha-block-active"),n.trigger("block-deactivate",t),n.trigger("block-selection-change",[])},isActive:function(){return this.$element.hasClass("aloha-block-active")},_highlight:function(){this.$element.addClass("aloha-block-highlighted"),n._setHighlighted(this)},_unhighlight:function(){this.$element.removeClass("aloha-block-highlighted"),n._setUnhighlighted(this)},_update:function(){var e=this;this._currentlyRendering||this._initialized&&(this._currentlyRendering=!0,this.update(this.$element,function(){e._postProcessElementIfNeeded()}),this._currentlyRendering=!1)},update:function(e,t){t()},_postProcessElementIfNeeded:function(){if(this.createEditablesIfNeeded(),this._checkThatNestedBlocksAreStillConsistent(),this._makeNestedBlockCollectionsSortable(),this.renderBlockHandlesIfNeeded(),this.isDraggable()){var e=this.$element[0].nodeName;"SPAN"===e?(this._setupDragDropForInlineElements(),this._disableUglyInternetExplorerDragHandles()):"DIV"===e&&(this._setupDragDropForBlockElements(),this._disableUglyInternetExplorerDragHandles())}this._hideDragHandlesIfDragDropDisabled(),this._attachDropzoneHighlightEvents()},_checkThatNestedBlocksAreStillConsistent:function(){this.$element.find(".aloha-block").each(function(){var e=n.getBlock(this);e&&e.$element[0]!==this&&e._connectThisBlockToDomElement(this)})},_makeNestedBlockCollectionsSortable:function(){var e=this;this.$element.find(".aloha-block-collection").each(function(){var i=t(this);i.closest(".aloha-block").get(0)===e.$element.get(0)&&n.createBlockLevelSortableForEditableOrBlockCollection(i)})},_disableUglyInternetExplorerDragHandles:function(){if(t.browser.msie){var e=this.$element.get(0);e.onresizestart=d.returnFalse,e.oncontrolselect=d.returnFalse,e.onmovestart=d.returnFalse}},_hideDragHandlesIfDragDropDisabled:function(){this._dd_isDragdropEnabled()||this.$element.find(".aloha-block-draghandle").each(function(){var e=t(this);s.isDragdropEnabledForElement(e)||e.removeClass("aloha-block-draghandle")})},_attachDropzoneHighlightEvents:function(){var e=this;this.$element.delegate(".aloha-block-draghandle","mousedown",function(){var n=e.$element.parents(".aloha-editable").first().data("block-dropzones")||[];t.each(n,function(e,n){var i=t(n);t(i).each(function(){t(this).data("block-dragdrop")&&t(this).addClass("aloha-block-dropzone")})}),t(document).one("mouseup.aloha-block-dropzone",function(){var n=e.$element.parents(".aloha-editable").first().data("block-dropzones")||[];t.each(n,function(e,n){t(n).removeClass("aloha-block-dropzone")})})})},_setupDragDropForInlineElements:function(){var e=this,n=null,i=!1,a=null,r=null,o=function(){if(n){var o=t(n);o.is(".aloha-block-dropInlineElementIntoEmptyBlock")?(o.children().remove(),o.append(a)):o.is(".aloha-block-droppable-right")?(o.html(o.html()+" "),o.after(a)):(o.prev("[data-i]").length>0&&o.prev("[data-i]").html(o.prev("[data-i]").html()+" "),o.html(" "+o.html()),o.before(a)),a.removeClass("ui-draggable").css({left:0,top:0}),e._fixScrollPositionBugsInIE()}t(".aloha-block-dropInlineElementIntoEmptyBlock").removeClass("aloha-block-dropInlineElementIntoEmptyBlock"),r.droppable("destroy"),r=null,i=!0},s=[];this.$element.draggable({handle:".aloha-block-draghandle",scope:"aloha-block-inlinedragdrop",disabled:!this._dd_isDragdropEnabled(),revert:function(){return null===n||!i},revertDuration:250,stop:function(){t.browser.msie&&7===parseInt(t.browser.version,10)&&o(),t.each(s,function(){e._dd_traverseDomTreeAndRemoveSpans(this)}),a=null,s=[]},start:function(){i=!1,s=[],t(".aloha-editable").children("p:empty").html("&nbsp;");var l={tolerance:"pointer",addClasses:!1,scope:"aloha-block-inlinedragdrop",over:function(i,r){-1===t.inArray(this,s)&&s.push(this);var o=1===t(this).contents().length&&1===t(this).children("br").length;return a=r.draggable,t(this).is(":empty")||o||"&nbsp;"===t(this).html()?(t(this).addClass("aloha-block-dropInlineElementIntoEmptyBlock"),void(n=this)):(e._dd_traverseDomTreeAndWrapCharactersWithSpans(this),t("span[data-i]",this).droppable({tolerance:"pointer",addClasses:!1,scope:"aloha-block-inlinedragdrop",over:function(){n&&t(n).removeClass("aloha-block-droppable"),n=this,t(this).addClass("aloha-block-droppable")},out:function(){t(this).removeClass("aloha-block-droppable"),n===this&&(n=null)}}),void t.ui.ddmanager.prepareOffsets(r.draggable.data("draggable"),i))},out:function(){t(this).removeClass("aloha-block-dropInlineElementIntoEmptyBlock")},drop:function(){t.browser.msie&&7===parseInt(t.browser.version,10)||o()}};r=t(".aloha-editable.aloha-block-dropzone").children(":not(.aloha-block)"),r.droppable(l),t(".aloha-table-cell-editable").droppable(l)}})},_dd_traverseDomTreeAndWrapCharactersWithSpans:function(e){for(var t,n=0,i=e.childNodes.length;i>n;n++)if(t=e.childNodes[n],1===t.nodeType)if(~t.className.indexOf("aloha-block")||void 0!==t.attributes["data-i"]){if(t.attributes["data-i"])return}else this._dd_traverseDomTreeAndWrapCharactersWithSpans(t);else if(3===t.nodeType){var a=this._dd_insertSpans(t);n+=a,i+=a}},_dd_splitText:function(e){for(var t=e.split(/(?=\b)/),n=[],i=!1,a=0,r=t.length;r>a;a++)/[^\t\n\r ]/.test(t[a])?i?(n.push(" "+t[a]),i=!1):n.push(t[a]):i=!0;return i&&(n[n.length-1]+=" "),n},_dd_insertSpans:function(e){var n=e.nodeValue;if(!/[^\t\n\r ]/.test(n))return 0;for(var i,a,r,o,s=document.createDocumentFragment(),l=this._dd_splitText(n),d=l.length,c=0,u=0;d>u;u++)if(a=l[u],0!==a.length){r=Math.floor(a.length/2);var h=parseInt(t.browser.version,10);!t.browser.msie||7!==h&&8!==h||(r=0),r>0&&(i=document.createElement("span"),i.appendChild(document.createTextNode(a.substr(0,r))),i.setAttribute("data-i",u),s.appendChild(i),c++),i=document.createElement("span"),o=a.substr(r),i.appendChild(document.createTextNode(o)),i.setAttribute("data-i",u),i.setAttribute("class","aloha-block-droppable-right"),s.appendChild(i),c++}return e.parentNode.replaceChild(s,e),c-1},_dd_traverseDomTreeAndRemoveSpans:function(e){var t,n=[];(t=function(e){for(var i,a,r,o=!1,s=0,l=e.childNodes.length;l>s;s++)r=e.childNodes[s],1===r.nodeType&&(void 0!==r.attributes["data-i"]?(o||(o=!0,i="",a=void 0),o&&(i+=r.firstChild.nodeValue,a&&n.push(a),a=r)):(o&&(o=!1,a.parentNode.replaceChild(document.createTextNode(i),a)),~r.className.indexOf("aloha-block")||t(r)));o&&a.parentNode.replaceChild(document.createTextNode(i),a)})(e);for(var i=0,a=n.length;a>i;i++)n[i].parentNode.removeChild(n[i])},_dd_isDragdropEnabled:function(){return s.isDragdropEnabledForElement(this.$element.parent())},_setupDragDropForBlockElements:function(){this.$element.find(".aloha-block-draghandle").addClass("aloha-block-draghandle-blocklevel")},createEditablesIfNeeded:function(){this.$element.find(".aloha-editable").aloha()},renderBlockHandlesIfNeeded:function(){this.isDraggable()&&0===this.$element.children(".aloha-block-draghandle").length&&this.$element.prepend('<span class="aloha-block-handle aloha-block-draghandle aloha-cleanme"></span>')},attr:function(n,i,a){var r=this,o=!1;if(arguments.length>=2){if("aloha-block-"===n.substr(0,12))return void e.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+n+")");this._getAttribute(n)!==i&&(o=!0),this._setAttribute(n,i)}else{if("object"!=typeof n)return"string"==typeof n?this._getAttribute(n):this._getAttributes();t.each(n,function(t,n){return"aloha-block-"===t.substr(0,12)?void e.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+t+")"):(r._getAttribute(t)!==n&&(o=!0),void r._setAttribute(t,n))})}return o&&!a&&(this._update(),this.trigger("change"),e.activeEditable&&e.activeEditable.smartContentChange({type:"block-change"})),null},_setAttribute:function(e,t){this.$element.attr("data-"+e.toLowerCase(),t)},_getAttribute:function(e){return this.$element.attr("data-"+e.toLowerCase())},_getAttributes:function(){var e={};return t.each(this.$element[0].attributes,function(t,n){"data-"===n.name.substr(0,5)&&(e[n.name.substr(5).toLowerCase()]=n.value)}),e}}),h=u.extend({update:function(e,t){t()}}),p=u.extend({title:"Debugging",init:function(e,t){this.update(e,t)},update:function(e,n){e.css({display:"block"});var i='<table class="debug-block">';t.each(this.attr(),function(e,t){i+="<tr><th>"+e+"</th><td>"+t+"</td></tr>"}),i+="</table>",e.html(i),n()}}),f=u.extend({title:"EmptyBlock",init:function(){},activate:function(){},deactivate:function(){},renderBlockHandlesIfNeeded:function(){},_preventSelectionChangedEventHandler:function(){}});return{AbstractBlock:u,DefaultBlock:h,DebugBlock:p,EmptyBlock:f}}),define("block/blockcontenthandler",["jquery","aloha/contenthandlermanager","block/blockmanager"],function(e,t,n){var i=t.createHandler({handleContent:function(t){return"string"==typeof t?t=e("<div>"+t+"</div>"):t instanceof e&&(t=e("<div>").append(t)),t.find('.aloha-block[data-aloha-block-copy-only-block="true"]').length>0&&(t.find(".aloha-block:not([id])").remove(),t.find(".aloha-block + span:empty").remove(),t.find("div:empty").remove(),t.find("br.Apple-interchange-newline").remove(),t.find(".aloha-block").prev("br").remove(),t.find("div > br:only-child").parent().remove()),t.find(".aloha-block").each(function(){var t=e(this),i={},a={};e.each(t[0].attributes,function(e,t){"id"!==t.nodeName&&(t.nodeName.match(/^data-/)?a[t.nodeName.substr(5)]=t.nodeValue:i[t.nodeName]=t.nodeValue)});var r=GENTICS.Utils.guid(),o=e("<"+this.tagName+"/>").attr(i).attr("id",r).removeClass("aloha-block-active").removeClass("aloha-block").html(t.html());t.replaceWith(o),window.setTimeout(function(){n._blockify(e("#"+r),a)},50)}),t.html()}});return i}),define("block/editor",["jquery","aloha/observable","util/class"],function(e,t,n){var i=n.extend(t,{schema:null,_constructor:function(e){this.schema=e},render:function(){},getValue:function(){},setValue:function(){},destroy:function(){},_deactivate:function(){this.trigger("change",this.getValue()),this.destroy()}}),a=i.extend({formInputElementDefinition:null,_$formInputElement:null,render:function(){var t=e('<div class="aloha-block-editor" />'),n=GENTICS.Utils.guid();return t.append(this.renderLabel().attr("id",n)),t.append(this.renderFormElement().attr("id",n)),t},renderLabel:function(){var t=e("<label />");return t.html(this.schema.label),t},renderFormElement:function(){var t=this;return this._$formInputElement=e(this.formInputElementDefinition),this.afterRenderFormElement(this._$formInputElement),this._$formInputElement.change(function(){t.trigger("change",t.getValue())}),this._$formInputElement},afterRenderFormElement:function(){},getValue:function(){return this._$formInputElement.val()},setValue:function(e){this._$formInputElement.val(e)},destroy:function(){this._$formInputElement.remove()}}),r=a.extend({formInputElementDefinition:'<input type="text" />'}),o=a.extend({formInputElementDefinition:'<input type="range" />',afterRenderFormElement:function(e){this.schema.range&&(this.schema.range.min&&e.attr("min",this.schema.range.min),this.schema.range.max&&e.attr("max",this.schema.range.max),this.schema.range.step&&e.attr("step",this.schema.range.step))}}),s=a.extend({formInputElementDefinition:'<input type="url" />'}),l=a.extend({formInputElementDefinition:'<input type="email" />'}),d=a.extend({formInputElementDefinition:"<select />",afterRenderFormElement:function(t){e.each(this.schema.values,function(){var n=this;t.append(e("<option />").attr("value",n.key).html(n.label))})}}),c=a.extend({formInputElementDefinition:"<button />",afterRenderFormElement:function(e){var t=this;e.html(this.schema.buttonLabel),e.click(function(){t.schema.callback()})}});return{AbstractEditor:i,AbstractFormElementEditor:a,StringEditor:r,NumberEditor:o,UrlEditor:s,EmailEditor:l,SelectEditor:d,ButtonEditor:c}}),define("block/dragbehavior",["aloha/jquery","aloha","PubSub","aloha/copypaste","block/block-utils"],function(e,t,n,i,a){function r(e,t){return e&&t&&0!==e.parents("table").length&&a.isTable(t)}function o(e,t){return!e||!(e.is(".ui-draggable-dragging")||e.closest(t).length>0)}function s(e){this.blockObject=e,this.$element=e.$element,this.insertBeforeOrAfterMode=!1,this.setDraggable()}function l(e){if(1===e.nodeType){if("inherit"===e.contentEditable)for(;"inherit"===e.contentEditable;)e=e.parentNode;return"true"===e.contentEditable}return!1}var d=["TABLE","TR","HR","TBODY","UL","OL","DL","B","STRONG","A","EM","I","PRE","CODE","SUP","SUB"],c=[".aloha-block",".aloha-block-handle",".aloha-table-selectrow","p","span","h1","h2","h3","h4","h5","h6","br"],u=[".aloha-table-selectcolumn",".aloha-ui",".ui-draggable-dragging"];n.sub("aloha.block.initialized",function(e){s.follow(e.block)}),s.follow=function(t){if(e(">.aloha-block-draghandle",t.$element).length>0){new s(t)}};var h=function(){var t=null,n=0,a=0;return e.browser.msie?{save:function(){n=window.scrollX||document.documentElement.scrollLeft,a=window.scrollY||document.documentElement.scrollTop,t=i.getRange()},restore:function(){if(t){var e=i.getEditableAt(t);e&&e.obj.focus();try{i.setSelectionAt(t)}catch(r){Console.warn(r)}window.scrollTo(n,a)}}}:{save:function(){},restore:function(){}}}();s.prototype.setDraggable=function(){var t=this,n=e(">.aloha-block-draghandle",this.$element),i=this.$element.get(0);i.onselectstart=function(){window.event.cancelBubble=!0},i.ondragstart=function(e){e?"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0:window.event.cancelBubble=!0},n.on("mousedown",function(){h.save()}).on("mouseup",function(){t._getHiglightElement().hide(),t.stopListenMouseOver()}),this.$element.draggable({handle:">.aloha-block-draghandle",helper:"clone",cursorAt:{left:-10,top:-10},start:function(e,n){n.helper.css("zIndex",1e5),t.listenMouseOver(),e.stopImmediatePropagation()},drag:function(e){e.stopImmediatePropagation()},stop:function(e,n){return t._getHiglightElement().hide(),t.stopListenMouseOver(),t.onDragStop(),n.helper.remove(),h.restore(),!0}})},s.prototype._getEditableChilds=function(){var n,i,a=[];for(n=0;n<t.editables.length;n++)i=t.editables[n],a=a.concat(e("*:not("+d.join(",")+")",i.obj).toArray());return e(a)},s.prototype.listenMouseOver=function(){var e=this,t=this._getEditableChilds();t.bind("mouseover.blockbehavior",function(t){return e.onMouseover(this,t)})},s.prototype.stopListenMouseOver=function(){var e=this._getEditableChilds();e.unbind(".blockbehavior")},s.prototype.onMouseover=function(t,n){return this.disableInsertBeforeOrAfter(this.$overElement),this.$overElement=e(t),this._isAllowedOverElement(t)?(this.highlightElement(t),n.stopImmediatePropagation(),!1):(this.enableInsertBeforeOrAfter(t),!0)},s.prototype.highlightElement=function(t){"DIV"===t.nodeName&&"TD"===t.parentNode.nodeName&&t.parentNode.firstChild===t&&t.parentNode.lastChild===t&&(t=t.parentNode);var n=e(t),i=this._getHiglightElement().show();i.css("zIndex",parseInt(n.zIndex(),10)+1).offset(n.offset()).width(n.outerWidth()).height(n.outerHeight())},s.prototype.enableInsertBeforeOrAfter=function(t){var n=e(t),i=this,a=n.offset().top,r=n.outerHeight()/2;o(n,this.$element)&&n.bind("mousemove.brIBOA",function(e){var t=e.pageY-a;i.insertBeforeOrAfterMode=t>=r?"AFTER":"BEFORE",i.highlightEdge(this)})},s.prototype.disableInsertBeforeOrAfter=function(e){this.insertBeforeOrAfterMode=!1,e&&e.unbind(".brIBOA")},s.prototype.highlightEdge=function(t){var n,i=e(t),a=this._getHiglightElement().show();"BEFORE"===this.insertBeforeOrAfterMode?a.css("zIndex",parseInt(i.zIndex(),10)+1).offset(i.offset()).width(i.outerWidth()).height(10):(n=i.offset(),n.top=n.top+i.outerHeight()-10,a.css("zIndex",parseInt(i.zIndex(),10)+1).offset(n).width(i.outerWidth()).height(10))},s.prototype._isAllowedOverElement=function(t){if(e.inArray(t.nodeName,d)<0){if(!l(t))return!1;var n=e(t);return n.parents(u.join(",")).length>0?!1:n.is(c.join(","))?!1:r(n,this.$element)?!1:!0}return!1},s.prototype.onDragStop=function(){o(this.$overElement,this.$element)&&(this.$overElement&&!this._isAllowedOverElement(this.$overElement[0])&&this.enableInsertBeforeOrAfter(this.$overElement[0]),this.insertBeforeOrAfterMode!==!1?"BEFORE"===this.insertBeforeOrAfterMode?this.$overElement.before(this.$element):this.$overElement.after(this.$element):this.$element.appendTo(this.$overElement)),this.disableInsertBeforeOrAfter(this.$overElement)},s.prototype._getHiglightElement=function(){return void 0===this.$hElm&&(this.$hElm=0===e("#aloha-highlight-element").length?e("<div>").attr("id","aloha-highlight-element").appendTo("body").css({position:"absolute",opacity:.5,background:"blue"}).hide():e("#aloha-highlight-element")),this.$hElm}}),define("block/nls/i18n",{root:{"button.toggledragdrop.tooltip":"Toggle Drag & Drop"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("block/block-plugin",["aloha","aloha/plugin","jquery","aloha/contenthandlermanager","block/blockmanager","block/sidebarattributeeditor","block/block","block/editormanager","block/blockcontenthandler","block/editor","block/dragbehavior","ui/ui","ui/toggleButton","i18n!block/nls/i18n","i18n!aloha/nls/i18n","jqueryui"],function(e,t,n,i,a,r,o,s,l,d,c,u,h,p){var f=["div","span"],g=t.create("block",{config:[],settings:{},init:function(){var t=this;this.settings.rootTags||(this.settings.rootTags=f),a.registerBlockType("DebugBlock",o.DebugBlock),a.registerBlockType("DefaultBlock",o.DefaultBlock),a.registerBlockType("EmptyBlock",o.EmptyBlock),s.register("string",d.StringEditor),s.register("number",d.NumberEditor),s.register("url",d.UrlEditor),s.register("email",d.EmailEditor),s.register("select",d.SelectEditor),s.register("button",d.ButtonEditor),i.register("block",l),a.setDragDropState(t.isDragDropEnabled()),a.registerEventHandlers(),a.initializeBlockLevelDragDrop(),e.bind("aloha-plugins-loaded",function(){t._createBlocks(),!1!==t.settings.sidebarAttributeEditor&&r.init()}),this.createButtons(),e.bind("aloha-editable-created",function(e,n){t.setDropzones(n.obj)}),e.bind("aloha-editable-activated",function(e,n){t.applyButtonConfig(n.editable)})},applyButtonConfig:function(e){this._isDragdropToggleEnabled(e)?(this._toggleDragDropButton.show(),this._toggleDragDropButton.setState(this._getDragdropState(e))):this._toggleDragDropButton.hide()},_isDragdropToggleEnabled:function(e){var t=this.getEditableConfig(e.obj),n=function(){return"toggleDragdrop"===t[0]||1==t.toggleDragdrop||"true"==t.toggleDragdrop||1==t.toggleDragdrop||"1"==t.toggleDragdrop},i=this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal||n();return i&&this.isDragDropEnabled()},_getDragdropState:function(e){return this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal?a.getDragDropState():e.obj.data("block-dragdrop")},_toggleDragdropState:function(t){if(this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal){var n=!a.getDragDropState();a.setDragDropState(n);for(var i=0;i<e.editables.length;i++){var t=e.editables[i];this._setDragDropStateForEditable(t.obj,n)}}else{var r=!t.obj.data("block-dragdrop");this._setDragDropStateForEditable(t.obj,r)}},createButtons:function(){var t=this;this._toggleDragDropButton=u.adopt("toggleDragDrop",h,{tooltip:p.t("button.toggledragdrop.tooltip"),icon:"aloha-icon aloha-icon-toggledragdrop",scope:"Aloha.continuoustext",click:function(){t._toggleDragdropState(e.activeEditable)}})},setDropzones:function(e){var t=this,n=t.getEditableConfig(e),i=n&&n.dropzones||t.settings.dropzones;i?e.data("block-dropzones",i):e.data("block-dropzones",[".aloha-editable"])},isDragDropEnabled:function(){return this.settings&&"undefined"!=typeof this.settings.dragdrop?this.settings.dragdrop===!0||"true"===this.settings.dragdrop||1===this.settings.dragdrop||"1"===this.settings.dragdrop:!0},_createBlocks:function(){this.settings.defaults||(this.settings.defaults={}),n.each(this.settings.defaults,function(e,t){n(e).alohaBlock(t)})},_setDragDropStateForEditable:function(e,t){e.data("block-dragdrop",t),e.hasClass("ui-sortable")&&e.sortable("option","disabled",!t),e.find(".aloha-block.ui-draggable").each(function(){n(this).draggable("option","disabled",!t)}),e.find(".aloha-block-handle").each(function(){t?n(this).addClass("aloha-block-draghandle"):n(this).removeClass("aloha-block-draghandle")})}});return n.fn.alohaBlock=function(e){return e=e||{},n(this).each(function(t,n){a._blockify(n,e)}),n(this)},n.fn.mahaloBlock=function(){n(this).each(function(e,t){a._unblockify(t)})},g}),define("align/nls/i18n",{root:{"button.alignright.tooltip":"Align to the right","button.alignleft.tooltip":"Align to the left","button.aligncenter.tooltip":"Center","button.alignjustify.tooltip":"Justify","button.aligntop.tooltip":"Align to the top","button.alignmiddle.tooltip":"Align to the middle","button.alignbottom.tooltip":"Align to the bottom"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("align/align-plugin",["aloha","aloha/plugin","util/html","util/dom","ui/ui","ui/toggleButton","i18n!align/nls/i18n","i18n!aloha/nls/i18n","jquery","PubSub"],function(e,t,n,i,a,r,o,s,l,d){function c(){var t=e.Selection.getRangeObject(),a=t.getRangeTree(),r=t.getCommonAncestorContainer(),o=[];return l.each(a,function(){var e=this.domobj;if("none"!==this.type){if(n.isBlock(e))return void o.push(e);for(;e&&!n.isBlock(e)&&!(n.isBlock(r)&&r===e.parentNode||i.isEditingHost(e.parentNode));)e=e.parentNode;n.isBlock(e)&&o.push(e)}}),0===o.length&&a.length>0&&n.isBlock(r)&&!i.isEditingHost(r)&&o.push(r),o}return t.create("align",{_constructor:function(){this._super("align")},config:{alignment:["right","left","center","justify","top","middle","bottom"]},alignment:"",verticalAlignment:"",lastAlignment:"",lastVerticalAlignment:"",init:function(){this.createButtons();var t=this;e.bind("aloha-editable-activated",function(e,n){t.applyButtonConfig(n.editable.obj)}),d.sub("aloha.selection.context-change",function(n){var i=n.range;e.activeEditable&&t.buttonPressed(i)})},buttonPressed:function(e){this.horizontalButtonPressed(e),this.verticalButtonPressed(e)},horizontalButtonPressed:function(t){var n=this;if(this.lastAlignment=this.alignment,this.alignment="",t.findMarkup(function(){return""!==this.style.textAlign?(n.alignment=this.style.textAlign,!0):void(n.alignment=l(this).css("text-align"))},e.activeEditable.obj),this.alignment!=this.lastAlignment)switch(this._alignRightButton.setState(!1),this._alignLeftButton.setState(!1),this._alignCenterButton.setState(!1),this._alignJustifyButton.setState(!1),this.alignment){case"right":this._alignRightButton.setState(!0);break;case"center":this._alignCenterButton.setState(!0);break;case"justify":this._alignJustifyButton.setState(!0);break;default:this._alignLeftButton.setState(!0),this.alignment="left"}},verticalButtonPressed:function(t){var n=this;if(this.lastVerticalAlignment=this.verticalAlignment,this.verticalAlignment="",t.findMarkup(function(){return""!==this.style.verticalAlign?(n.verticalAlignment=this.style.verticalAlign,!0):void(n.verticalAlignment=l(this).css("vertical-align"))},e.activeEditable.obj),this.verticalAlignment!=this.lastVerticalAlignment)switch(this._alignTopButton.setState(!1),this._alignMiddleButton.setState(!1),this._alignBottomButton.setState(!1),this.verticalAlignment){case"top":this._alignTopButton.setState(!0);break;case"middle":this._alignMiddleButton.setState(!0);break;case"bottom":this._alignBottomButton.setState(!0);break;default:this._alignTopButton.setState(!0),this.verticalAlignment="top"}},applyButtonConfig:function(e){var t=this.getEditableConfig(e);t&&t.alignment&&!this.settings.alignment?t=t:t[0]&&t[0].alignment?t=t[0]:this.settings.alignment&&(t.alignment=this.settings.alignment),"undefined"==typeof t.alignment&&(t=this.config),this._alignRightButton.show(-1!=l.inArray("right",t.alignment)?!0:!1),this._alignLeftButton.show(-1!=l.inArray("left",t.alignment)?!0:!1),this._alignCenterButton.show(-1!=l.inArray("center",t.alignment)?!0:!1),this._alignJustifyButton.show(-1!=l.inArray("justify",t.alignment)?!0:!1),this._alignTopButton.show(-1!=l.inArray("top",t.alignment)?!0:!1),this._alignMiddleButton.show(-1!=l.inArray("middle",t.alignment)?!0:!1),this._alignBottomButton.show(-1!=l.inArray("bottom",t.alignment)?!0:!1)},createButtons:function(){var e=this;this._alignLeftButton=a.adopt("alignLeft",r,{tooltip:o.t("button.alignleft.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-left",scope:"Aloha.continuoustext",click:function(){e.align("left")}}),this._alignCenterButton=a.adopt("alignCenter",r,{tooltip:o.t("button.aligncenter.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-center",scope:"Aloha.continuoustext",click:function(){e.align("center")}}),this._alignRightButton=a.adopt("alignRight",r,{tooltip:o.t("button.alignright.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-right",scope:"Aloha.continuoustext",click:function(){e.align("right")
}}),this._alignJustifyButton=a.adopt("alignJustify",r,{tooltip:o.t("button.alignjustify.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-justify",scope:"Aloha.continuoustext",click:function(){e.align("justify")}}),this._alignTopButton=a.adopt("alignTop",r,{tooltip:o.t("button.aligntop.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-top",scope:"table.cell",click:function(){e.verticalAlign("top")}}),this._alignMiddleButton=a.adopt("alignMiddle",r,{tooltip:o.t("button.alignmiddle.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-middle",scope:"table.cell",click:function(){e.verticalAlign("middle")}}),this._alignBottomButton=a.adopt("alignBottom",r,{tooltip:o.t("button.alignbottom.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-bottom",scope:"table.cell",click:function(){e.verticalAlign("bottom")}})},verticalAlign:function(t){var n=this,i=e.Selection.getRangeObject();this.lastVerticalAlignment=this.verticalAlignment,this.verticalAlignment=t;var a=this.getSelectedCells(i);if(a&&n.toggleAlign(a,"vertical-align"),this.verticalAlignment!=this.lastVerticalAlignment)switch(this.lastVerticalAlignment){case"top":this._alignTopButton.setState(!1);break;case"middle":this._alignMiddleButton.setState(!1);break;case"bottom":this._alignBottomButton.setState(!1)}i.select()},align:function(e){this.lastAlignment=this.alignment,this.alignment=e;var t=c();if(this.toggleAlign(t),this.alignment!==this.lastAlignment)switch(this.lastAlignment){case"right":this._alignRightButton.setState(!1);break;case"left":this._alignLeftButton.setState(!1);break;case"center":this._alignCenterButton.setState(!1);break;case"justify":this._alignJustifyButton.setState(!1)}},getSelectedCells:function(t){var n,i=t.findMarkup(function(){return l(this).is("td,th")&&(n=this),l(this).is("table.aloha-table")},e.activeEditable.obj),a=l(i).find(".aloha-cell-selected");return a.length?a:n},toggleAlign:function(e,t){var n=this;t=t||"text-align";var i="vertical-align"===t?n.verticalAlignment:n.alignment,a=!0;l(e).each(function(){var e=l(this).css(t);return e!=i?(a=!1,!1):void 0}),l(e).each(function(){var e=l(this).css(t);e==i&&a?l(this).css(t,""):l(this).css(t,i)})}})}),define("abbr/nls/i18n",{root:{"floatingmenu.tab.abbr":"Abbreviation","button.addabbr.tooltip":"insert abbreviation","button.remabbr.tooltip":"remove abbreviation","button.abbr.tooltip":"format as abbreviation","newabbr.defaulttext":"Abbr"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("abbr/abbr-plugin",["aloha","jquery","aloha/plugin","ui/ui","ui/toggleButton","ui/button","ui/scopes","ui/port-helper-attribute-field","i18n!abbr/nls/i18n","i18n!aloha/nls/i18n"],function(e,t,n,i,a,r,o,s,l){function d(e,t){for(var n=e.findAllMarkupByTagName("ABBR",e),i=0,a=n.length;a>i;i++)t.addAdditionalTargetObject(n[i])}var c=window.GENTICS;return n.create("abbr",{config:["abbr"],init:function(){this.createButtons(),this.subscribeEvents(),this.bindInteractions()},createButtons:function(){var e=this;this._formatAbbrButton=i.adopt("formatAbbr",a,{tooltip:l.t("button.abbr.tooltip"),icon:"aloha-icon aloha-icon-abbr",scope:"Aloha.continuoustext",click:function(){e.formatAbbr()}}),this._insertAbbrButton=i.adopt("insertAbbr",r,{tooltip:l.t("button.addabbr.tooltip"),icon:"aloha-icon aloha-icon-abbr",scope:"Aloha.continuoustext",click:function(){e.insertAbbr(!1)}}),this.abbrField=new s({width:320,name:"abbrText",scope:"Aloha.continuoustext"}),this.remAbbrButton=i.adopt("removeAbbr",r,{tooltip:l.t("button.remabbr.tooltip"),icon:"aloha-icon aloha-icon-abbr-rem",scope:"Aloha.continuoustext",click:function(){e.removeAbbr()}})},bindInteractions:function(){var t=this;this.abbrField.addListener("blur",function(){""==this.getValue()&&t.removeAbbr()});for(var n=0;n<e.editables.length;n++)e.editables[n].obj.keydown(function(e){return e.metaKey&&71==e.which?(t.findAbbrMarkup()?(t.abbrField.foreground(),t.abbrField.focus()):t.insertAbbr(),e.stopPropagation(),e.preventDefault(),!1):void 0})},subscribeEvents:function(){var n=this,i={};e.bind("aloha-editable-activated",function(){if(e.activeEditable&&e.activeEditable.obj){var a=n.getEditableConfig(e.activeEditable.obj);i[e.activeEditable.getId()]=-1!==t.inArray("abbr",a)}}),e.bind("aloha-editable-destroyed",function(){e.activeEditable&&e.activeEditable.obj&&delete i[e.activeEditable.getId()]}),e.bind("aloha-selection-changed",function(t,a){if(e.activeEditable){if(!i[e.activeEditable.getId()])return n._formatAbbrButton.hide(),void n._insertAbbrButton.hide();n._formatAbbrButton.show(),n._insertAbbrButton.show();var r=n.findAbbrMarkup(a);r?(n._insertAbbrButton.hide(),n._formatAbbrButton.setState(!0),n.abbrField.show(),n.remAbbrButton.show(),o.enterScope(n.name,"abbr"),n.abbrField.setTargetObject(r,"title"),d(a,n.abbrField)):(n.abbrField.hide(),n.remAbbrButton.hide(),o.leaveScope(n.name,"abbr",!0),n._formatAbbrButton.setState(!1),n.abbrField.setTargetObject(null))}})},findAbbrMarkup:function(t){return"undefined"==typeof t&&(t=e.Selection.getRangeObject()),e.activeEditable?t.findMarkup(function(){return"abbr"==this.nodeName.toLowerCase()},e.activeEditable.obj):null},formatAbbr:function(){var t=e.Selection.getRangeObject();e.activeEditable&&(this.findAbbrMarkup(t)?this.removeAbbr():this.insertAbbr())},insertAbbr:function(n){var i=e.Selection.getRangeObject();if(!this.findAbbrMarkup(i)){if(i.isCollapsed()&&0!=n&&c.Utils.Dom.extendToWord(i),i.isCollapsed()){var a=l.t("newabbr.defaulttext"),r=t('<abbr title="">'+a+"</abbr>");c.Utils.Dom.insertIntoDOM(r,i,t(e.activeEditable.obj)),i.startContainer=i.endContainer=r.contents().get(0),i.startOffset=0,i.endOffset=a.length}else{var r=t('<abbr title=""></abbr>');c.Utils.Dom.addMarkup(i,r,!1)}i.select(),this.abbrField.foreground(),this.abbrField.focus()}},removeAbbr:function(){var t=e.Selection.getRangeObject(),n=this.findAbbrMarkup();n&&(c.Utils.Dom.removeFromDOM(n,t,!0),t.select())},makeClean:function(){},toString:function(){return"abbr"}})}),define("horizontalruler/nls/i18n",{root:{"button.addhr.tooltip":"Add a horizontal ruler"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("horizontalruler/horizontalruler-plugin",["aloha","jquery","aloha/plugin","ui/ui","ui/button","i18n!horizontalruler/nls/i18n","i18n!aloha/nls/i18n"],function(e,t,n,i,a,r){var o=window.GENTICS;return n.create("horizontalruler",{_constructor:function(){this._super("horizontalruler")},config:["hr"],init:function(){var n=this;this._insertHorizontalRuleButton=i.adopt("insertHorizontalRule",a,{tooltip:r.t("button.addhr.tooltip"),iconOnly:!0,icon:"aloha-icon-horizontalruler",scope:"Aloha.continuoustext",click:function(){n.insertHR()}}),e.bind("aloha-editable-activated",function(){if(e.activeEditable){if(n.cfg=n.getEditableConfig(e.activeEditable.obj),-1==t.inArray("hr",n.cfg))return void n._insertHorizontalRuleButton.show(!1);n._insertHorizontalRuleButton.show(!0)}})},insertHR:function(){var n=e.Selection.getRangeObject();if(e.activeEditable){var i=t("<hr>");o.Utils.Dom.insertIntoDOM(i,n,t(e.activeEditable.obj),!0),n.select()}}})}),define("paste/paste-plugin",["jquery","aloha/core","aloha/plugin","aloha/command","contenthandler/contenthandler-utils","aloha/console","aloha/copypaste","aloha/contenthandlermanager"],function(e,t,n,i,a,r,o,s){function l(e){var t=o.getEditableAt(e);t&&t.obj.focus(),o.setSelectionAt(e),window.scrollTo(C.x,C.y)}function d(e,t){var n=200;t.css({top:b.scrollTop(),left:b.scrollLeft()-n,width:n,overflow:"hidden"}).contents().remove();var i=o.getEditableAt(e);i&&i.obj.blur(),o.setSelectionAt({startContainer:t[0],endContainer:t[0],startOffset:0,endOffset:0}),t.focus()}function c(e){var t=e.startContainer;return 1===t.nodeType?"p"===t.nodeName.toLowerCase()&&a.isProppedParagraph(t.outerHTML):3===t.nodeType&&"p"===t.parentNode.nodeName.toLowerCase()&&1===t.parentNode.childNodes.length&&y.test(window.escape(t.data))}function u(e){c(e)&&(3===e.startContainer.nodeType?e.startContainer.data="":e.startContainer.innerHTML=" ",e.startOffset=0,e.endContainer===e.startContainer&&(e.endOffset=0))}function h(e,t){return e.replace(t,"")}function p(e){var t,n,i=/^<h\d+.*?>/i.exec(e);return null===i?e:(t=i[0],n="</"+t.substr(1),h(h(e,t),n))}function f(e,n,i){if(n){var a=p(e.html()),o=s.get("formatless");a=o?o.handleContent(a):a,v&&/^&nbsp;/.test(a)&&(a=a.substring(6)),l(n),u(n),t.queryCommandSupported("insertHTML")?t.execCommand("insertHTML",!1,a):r.error("Common.Paste",'Command "insertHTML" not available. Enable the plugin "common/commands".'),e.contents().remove(),"function"==typeof i&&i()}}function g(e,n,i){e.metaKey=null,e.stopPropagation(),window.setTimeout(function(){f(_,n,i),t.activeEditable.smartContentChange(e)},10)}function m(e){v?e.bind("beforepaste",function(e){C.x=window.scrollX||document.documentElement.scrollLeft,C.y=window.scrollY||document.documentElement.scrollTop,w=o.getRange(),d(w,_),e.stopPropagation()}):e.bind("paste",function(e){C.x=window.scrollX||document.documentElement.scrollLeft,C.y=window.scrollY||document.documentElement.scrollTop;var t=o.getRange();if(d(t,_),v){var n=document.selection.createRange();n.execCommand("paste")}g(e,t)})}var b=e(window),v=!!t.browser.msie,y=/^(\s|%A0)$/,_=e('<div style="position:absolute; clip:rect(0px,0px,0px,0px); width:1px; height:1px;"></div>').contentEditable(!0),w=null,C={x:0,y:0};return n.create("paste",{settings:{},init:function(){e("body").append(_);var n=!this.settings.noclipboardaccess;t.bind("aloha-editable-created",function(e,t){m(t.obj,n)}),v&&_.bind("paste",function(e){g(e,w,function(){w=null})})},register:function(){r.deprecated("Plugins.Paste","register() for pasteHandler is deprecated.  Use the ContentHandler Plugin instead.")}})}),define("autoparagraph/autoparagraph-plugin",["jquery","aloha/plugin","aloha/core","util/html","util/dom"],function(e,t,n,i,a){function r(t){if(t){var r=t.obj;if(r){var o,s,l=r[0],d=n.Selection.rangeObject,c=!1;if(a.allowsNesting(l,e("<p></p>")[0])){var u,h=[];for(r.contents().each(function(){i.isBlock(this)?u=null:(u||(u={objs:[]},h.push(u)),u.objs.push(this))}),o=0;o<h.length;o++){var p=h[o],f=a.getIndexInParent(p.objs[0]),g=a.getIndexInParent(p.objs[p.objs.length-1]),m=e("<p></p>");for(d.startContainer===l&&(d.startOffset>f&&d.startOffset<=g?(d.startContainer=m[0],d.startOffset-=f):d.startOffset>g&&(d.startOffset-=g-f)),d.endContainer===l&&(d.endOffset>f&&d.endOffset<=g?(d.endContainer=m[0],d.endOffset-=f):d.endOffset>g&&(d.endOffset-=g-f)),e(p.objs[0]).before(m),s=0;s<p.objs.length;s++)m[0].appendChild(p.objs[s]);c=!0}c&&t.isActive&&d.select()}}}}function o(t){return"array"===e.type(t)&&-1!==e.inArray(s,t)}var s="autoparagraph",l=t.create(s,{config:[s],init:function(){var e=this;n.bind("aloha-editable-created",function(t,n){var i=e.getEditableConfig(n.obj);o(i)&&r(n)}),n.bind("aloha-smart-content-changed",function(t,n){var i=e.getEditableConfig(n.editable.obj);o(i)&&r(n.editable)})}});return l}),define("toc/nls/i18n",{root:{"button.addtoc.tooltip":"Table of contents"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("toc/toc-plugin",["aloha","aloha/plugin","jquery","ui/ui","ui/button","i18n!toc/nls/i18n","i18n!aloha/nls/i18n","aloha/console"],function(e,t,n,i,a,r){function o(e){return e[e.length-1]}function s(e){return e[0]}function l(e){return e.slice(1)}function d(e,t){return c(e,function(e){return e===t})}function c(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n];return null}function u(e,t){for(var n=[],i=0;i<e.length;i++)n.push(t(e[i]));return n}function h(e,t){u(e,t)}function p(){return n(u(e.editables,function(e){return document.getElementById(e.getId())}))}function f(e,t){return t?e.find('a[href $= "#'+t+'"]'):n()}function g(e){var t;"object"==typeof e?t=n(e).text().replace(/[^a-zA-Z-]+/g,"-").replace(/^[^a-zA-Z]+/,""):e&&(t=e);for(var i=0;;i++){var a=t;i&&(a+="-"+i);var r=document.getElementById(a);if(!r||"object"==typeof e&&r===e)return a}}var m=window.GENTICS,b="toc",v=null,y=[];return t.create(b,{minEntries:0,updateInterval:5e3,config:["toc"],init:function(){var t=this;"undefined"==typeof this.settings.minEntries&&(this.settings.minEntries=this.minEntries),"undefined"==typeof this.settings.updateInterval&&(this.settings.updateInterval=this.updateInterval),e.bind("aloha-editable-activated",function(){if(e.activeEditable){if(t.cfg=t.getEditableConfig(e.activeEditable.obj),-1==n.inArray("toc",t.cfg))return void t._insertTocButton.show(!1);t._insertTocButton.show(!0)}}),this.initButtons(),n(document).ready(function(){t.spawn()})},initButtons:function(){var e=this;this._insertTocButton=i.adopt("insertToc",a,{tooltip:r.t("button.addtoc.tooltip"),icon:"aloha-icon aloha-icon-orderedlist",scope:"Aloha.continuoustext",click:function(){e.insertAtSelection(v)}})},register:function(e){v=e},insertAtSelection:function(t){t=t||p();var i=g("toc"),a=n("<ol class='toc_root'></ol>").attr("id",i).attr("contentEditable","false"),r=e.Selection.getRangeObject(),o=e.activeEditable,s=n(document.getElementById(o.getId()));m.Utils.Dom.insertIntoDOM(a,r,s),this.create(i).register(t).update().tickTock()},spawn:function(e,t){e=e||n("body"),t=t||p(),e.find("ol.toc_root").each(function(){var e=n(this).attr("id");e||(e=g("toc"),n(this).attr("id",e)),that.create(e).register(t).tickTock()})},create:function(e){return y.push(this),{id:e,$containers:n(),settings:this.settings,root:function(){return n(document.getElementById(this.id))},register:function(e){var t=this;return t.$containers=t.$containers.add(e),t.$containers.filter(function(){return!n(this).data(b+"."+t.id+".listening")}).each(function(){var e=n(this);e.data(b+"."+t.id+".listening",!0),e.bind("blur",function(){t.cleanupIds(e.get(0)),t.update(e)})}),t},tickTock:function(e){var t=this;return(e=e||this.settings.updateInterval)?(window.setInterval(function(){t.register(p()),t.update()},e),t):void 0},cleanupIds:function(e){var t=[];return this.headings(this.$containers).each(function(){var i=n(this).attr("id");(i&&-1!=n.inArray(i,t)||e&&(n.contains(e,this)||e===this))&&n(this).attr("id",g(this)),t.push(i)}),this},update:function(e){var t=this;e=e||t.$containers;var n=this.outline(t.$containers),i=[t.root()];o(i).empty(),function r(e){var n=[];h(e,function(e){var a=s(e),o=t.linkSection(a,i,n);i.push(o),r(l(e)),i.pop(),n.push(o)})}(l(n));var a=t.root().attr("data-TOC-minEntries")||this.settings.minEntries;return t.root().find("li").length>=a?t.root().show():t.root().hide(),this},linkSection:function(e,t,i){var a=e.eq(0).attr("id");a||(a=g(e.get(0)),e.eq(0).attr("id",a));var r=this.root(),s=f(r,a);if(s.length||(s=n("<li><a/></li>")),s.find("a").attr("href","#"+a).text(e.eq(0).text()),o(i))o(i).after(s);else if(o(t).get(0)==r.get(0))r.append(s);else{var l=n("<ol/>").append(s);o(t).append(l)}return s},outline:function(e){var t=[n()],i=[t];return this.headings(e).each(function(){var e=n(this),t=this.nodeName.toLowerCase(),a=["h6","h5","h4","h3","h2","h1"],r=n.inArray(t,a),o=a.slice(r).join(","),s=e.nextUntil(o).andSelf(),l=[s],u=c(i,function(t){var i=t[0];return!i.length||c(i,function(t){return e.get(0)===t||n.contains(t,e.get(0))})});u.push(l),i.splice(0,d(i,u),l)}),t},headings:function(e){return e.find(":header").add(e.filter(":header"))}}}})}),define("cite/nls/i18n",{root:{"cite.button.add.quote":"Format selection as quote","cite.button.add.blockquote":"Format selection as blockquote"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("cite/cite-plugin",["aloha","jquery","aloha/plugin","ui/ui","ui/toggleButton","format/format-plugin","util/dom","PubSub","i18n!cite/nls/i18n","i18n!aloha/nls/i18n"],function(e,t,n,i,a,r,o,s,l){function d(e,t){return e.replace(/\{([a-z0-9\-\_]+)\}/gi,function(e,n){var i=t[n]||e;return"function"==typeof i?i():i})}function c(e){return"string"==typeof e?d(e,g):e}function u(){var e=[],n=p;return t.each(arguments,function(){e.push("."+(""===this?n:n+"-"+this))}),t.trim(e.join(" "))}function h(){var e=[],n=p;return t.each(arguments,function(){e.push(""===this?n:n+"-"+this)}),t.trim(e.join(" "))}var p="aloha-cite",f=(new Date).getTime(),g={quote:h("quote"),blockquote:h("blockquote"),"panel-label":h("panel-label"),"panel-field":h("panel-field"),"panel-btns":h("panel-btns"),"link-field":h("link-field"),"note-field":h("note-field"),references:h("references")};return n.create("cite",{citations:[],referenceContainer:null,settings:null,sidebar:null,config:["quote","blockquote"],init:function(){var n=this;if(e.settings&&e.settings.plugins&&e.settings.plugins.cite){var o=t(e.settings.plugins.cite.referenceContainer);o.length&&(n.referenceContainer=o),"undefined"!=typeof e.settings.plugins.cite&&(n.settings=e.settings.plugins.cite),"undefined"==typeof n.settings.sidebar&&(n.settings.sidebar={}),"undefined"==typeof n.settings.sidebar.open&&(n.settings.sidebar.open=!0),"string"==typeof n.settings.sidebar.open&&(n.settings.sidebar.open=n.settings.sidebar.open.toLowerCase(),n.settings.sidebar.open="false"===n.settings.sidebar.open||"0"===n.settings.sidebar.open?!1:!0)}this._quoteButton=i.adopt("quote",a,{tooltip:l.t("cite.button.add.quote"),icon:h("button","inline-button"),scope:"Aloha.continuoustext",click:function(){n.addInlineQuote()}}),r.multiSplitButton.pushItem({name:"blockquote",tooltip:l.t("cite.button.add.blockquote"),icon:h("button","block-button"),click:function(){n.addBlockQuote()}});var d=this;e.ready(function(){d.sidebar=e.Sidebar.right.show(),d.sidebar.addPanel({id:h("sidebar-panel"),title:"Citation",content:"",expanded:!0,activeOn:"q, blockquote",onInit:function(){var e=this,t="";d.referenceContainer&&(t='<label class="{panel-label}" for="{note-field}-textarea">Note</label> <div class="{panel-field} {note-field}" style="margin: 5px;"><textarea id="{note-field}-textarea"></textarea></div>');var n=this.setContent(c('<label class="{panel-label}" for="{link-field}-input">Link</label><div class="{panel-field} {link-field}" style="margin: 5px;"><input type="text" id="{link-field}-input" /></div>'+t)).content;n.find("input, textarea").bind("keypress change",function(){d.addCiteDetails(e.content.attr("data-cite-id"),e.content.find(u("link-field input")).val(),e.content.find(u("note-field textarea")).val())})},onActivate:function(e){var t=e.attr("data-cite-id");if(!t){t=++f;var i=[h("wrapper")].join(" ");e.addClass(i),e.attr("data-cite-id",t)}var a=n.getIndexOfCitation(t);-1===a&&(a=n.citations.push({uid:t,link:null,notes:null})-1),this.content.attr("data-cite-id",t),this.content.find(u("link-field input")).val(e.attr("cite")),this.content.find(u("note-field textarea")).val(n.citations[a].note)}})}),e.bind("aloha-editable-activated",function(e,i){var a=n.getEditableConfig(i.editable.obj);a&&(n._quoteButton.show(-1!==t.inArray("quote",a)?!0:!1),-1!==t.inArray("blockquote",a)?r.multiSplitButton.showItem("blockquote"):r.multiSplitButton.hideItem("blockquote"))}),s.sub("aloha.selection.context-change",function(i){for(var a,o=i.range,s=!1,l=!1,d=o.markupEffectiveAtStart,c=d.length;c;)a=d[--c].nodeName,"Q"===a?s=!0:"BLOCKQUOTE"===a&&(l=!0);n._quoteButton.setState(s),l&&r.multiSplitButton.setActiveItem("blockquote");var u=[];e.activeEditable&&(u=n.getEditableConfig(e.activeEditable.obj)),n._quoteButton.show(-1!==t.inArray("quote",u)?!0:!1),-1!==t.inArray("blockquote",u)?r.multiSplitButton.showItem("blockquote"):r.multiSplitButton.hideItem("blockquote")})},getIndexOfCitation:function(e){for(var t,n,i=this.citations,a=i.length,r=0;a>r;){if(t=r+a>>1,n=i[t].uid,n==e)return t;n>e?a=t:e>n&&(r=t+1)}return-1},addBlockQuote:function(){var n=[h("wrapper"),h(++f)].join(" "),i=t(d('<blockquote class="{classes}" data-cite-id="{uid}"></blockquote>',{uid:f,classes:n}));e.activeEditable&&t(e.activeEditable.obj[0]).click(),e.Selection.changeMarkupOnSelection(i),this.referenceContainer&&this.addCiteToReferences(f),this.sidebar&&this.settings&&this.settings.sidebar&&this.settings.sidebar.open&&this.sidebar.open()},addInlineQuote:function(){var n,i=[h("wrapper"),h(++f)].join(" "),a=t(d('<q class="{classes}" data-cite-id="{uid}"></q>',{uid:f,classes:i})),r=e.Selection.rangeObject;return e.activeEditable&&t(e.activeEditable.obj[0]).click(),n=r.findMarkup(function(){return this.nodeName&&a.length&&"string"==typeof this.nodeName&&"string"==typeof a[0].nodeName?this.nodeName.toLowerCase()===a[0].nodeName.toLowerCase():!1},e.activeEditable.obj),n?r.isCollapsed()?o.removeFromDOM(n,r,!0):o.removeMarkup(r,a,e.activeEditable.obj):(r.isCollapsed()&&o.extendToWord(r),o.addMarkup(r,a)),r.select(),this.referenceContainer&&this.addCiteToReferences(f),this.sidebar&&this.settings&&this.settings.sidebar&&this.settings.sidebar.open&&this.sidebar.open(),!1},addCiteToReferences:function(e){var n=this.getIndexOfCitation(e);if(-1!==n){var i=t(".aloha-editable-active "+u(e)),a="cite-note-"+e,r="cite-ref-"+e;i.append(d('<sup id="{ref}" contenteditable="false"><a href="#{note}">[{count}]</a></sup>',{ref:r,note:a,count:n+1})),0===this.referenceContainer.find("ol.references").length&&this.referenceContainer.append("<h2>References</h2>").append('<ol class="references"></ol>'),this.referenceContainer.find("ol.references").append(d('<li id="{note}"><a href="#{ref}">^</a> &nbsp; <span></span></li>',{ref:r,note:a}))}},addCiteDetails:function(e,n,i){if(this.citations[this.getIndexOfCitation(e)]={uid:e,link:n,note:i},n){t(u(e)).attr("cite",n)}this.referenceContainer&&t("li#cite-note-"+e+" span").html(d(n?'<a class="external" target="_blank" href="{url}">{url}</a>':"",{url:n})+(i?". "+i:""))},toString:function(){return"aloha-citiation-plugin"},makeClean:function(e){e.find("q, blockquote").each(function(){""===t.trim(t(this).attr("class"))&&t(this).removeAttr("class"),this.referenceContainer||(t(this).removeClass("aloha-cite-"+t(this).attr("data-cite-id")),null!=t(this).attr("data-cite-id")&&t(this).removeAttr("data-cite-id")),t(this).removeClass("aloha-cite-wrapper")})}})}),define("numerated-headers/nls/i18n",{root:{"headerids.label.target":"Target","headerids.button.reset":"Reset","headerids.button.set":"Set","button.numeratedHeaders.tooltip":"Toggle header numeration"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("numerated-headers/numerated-headers-plugin",["aloha/core","jquery","aloha/plugin","ui/ui","ui/toggleButton","i18n!numerated-headers/nls/i18n","i18n!aloha/nls/i18n"],function(e,t,n,i,a,r){var o={};return e.bind("aloha-editable-destroyed",function(e,t){delete o[t.getId()]}),n.create("numerated-headers",{config:{numeratedactive:!0,headingselector:"h1, h2, h3, h4, h5, h6",trailingdot:!1},init:function(){var t=this;this._formatNumeratedHeadersButton=i.adopt("formatNumeratedHeaders",a,{tooltip:r.t("button.numeratedHeaders.tooltip"),icon:"aloha-icon aloha-icon-numerated-headers",scope:"Aloha.continuoustext",click:function(){var e=t._formatNumeratedHeadersButton.getState();e?t.createNumeratedHeaders():t.removeNumerations()}}),e.bind("aloha-smart-content-changed",function(){t.cleanNumerations(),t.showNumbers()&&t.createNumeratedHeaders()}),e.bind("aloha-format-block",function(){t.cleanNumerations(),t.showNumbers()&&t.createNumeratedHeaders()}),e.bind("aloha-editable-activated",function(){t.isNumeratingOn()?(t._formatNumeratedHeadersButton.show(),t.initForEditable(e.activeEditable.obj)):t._formatNumeratedHeadersButton.hide()})},initForEditable:function(e){var t=e.attr("aloha-numerated-headers");"true"!==t&&"false"!==t&&(t=!0===this.getCurrentConfig().numeratedactive?"true":"false",e.attr("aloha-numerated-headers",t)),"true"===t?(this.createNumeratedHeaders(),this._formatNumeratedHeadersButton.setState(!0)):this._formatNumeratedHeadersButton.setState(!1)},getCurrentConfig:function(){var n=this.getEditableConfig(e.activeEditable.obj);return n.numeratedactive=n.numeratedactive===!0||"true"===n.numeratedactive||"1"===n.numeratedactive?!0:!1,"string"!=typeof n.headingselector&&(n.headingselector="h1, h2, h3, h4, h5, h6"),n.headingselector=t.trim(n.headingselector),n.trailingdot=n.trailingdot===!0||"true"===n.trailingdot||"1"===n.trailingdot?!0:!1,n},isNumeratingOn:function(){return""!==this.getCurrentConfig().headingselector},showNumbers:function(){return e.activeEditable&&this.isNumeratingOn()&&"true"===e.activeEditable.obj.attr("aloha-numerated-headers")},cleanNumerations:function(){var e=this.getBaseElement();e&&this._saveRemoveAnnotations(t(e).find("span[role=annotation]"))},_saveRemoveAnnotations:function(n){var i=this,a=e.Selection.getRangeObject(),r=!1;n.each(function(){(a.startContainer===this||t.inArray(this,t(a.startContainer).parents())>-1)&&(a.startContainer=i._prevNode(this),a.startOffset=0,r=!0),a.startContainer===this.parentNode&&a.startOffset>=t(this).index()&&a.startOffset>0&&(a.startOffset--,r=!0),(a.endContainer===this||t.inArray(this,t(a.endContainer).parents())>-1)&&(a.endContainer=i._prevNode(this),a.endOffset=0,r=!0),a.endContainer===this.parentNode&&a.endOffset>=t(this).index()&&a.endOffset>0&&(a.endOffset--,r=!0),t(this).remove()}),r===!0&&(a.update(),a.select())},_prependAnnotation:function(n,i){var a=e.Selection.getRangeObject(),r=!1;a.startContainer===i&&(a.startOffset++,r=!0),a.endContainer===i&&(a.endOffset++,r=!0),t(i).prepend('<span role="annotation">'+n+"</span>"),r===!0&&(a.update(),a.select())},_prevNode:function(e){var t=e.previousSibling;if(!t)return e.parentNode;for(;t.lastChild;)t=t.lastChild;return t},removeNumerations:function(){t(e.activeEditable.obj).attr("aloha-numerated-headers","false"),this.cleanNumerations()},getBaseElement:function(){return"undefined"!=typeof this.baseobjectSelector?t(this.baseobjectSelector).length>0?t(this.baseobjectSelector):null:e.activeEditable?e.activeEditable.obj:null},hasNote:function(e){return!e||t(e).length<=0?!1:t(e).find("span[role=annotation]").length>0},hasContent:function(e){if(!e||0===t(e).length)return!1;var n=t(e).clone().find("span[role=annotation]").remove().end();return t.trim(n.text()).length>0},createNumeratedHeaders:function(){var n=this.getBaseElement();if(n){var i=this.getCurrentConfig(),a=i.headingselector,r=n.find(a);if(e.activeEditable.obj.attr("aloha-numerated-headers","true"),"undefined"!=typeof r&&0!==r.length){var o=7,s=this;if(r.each(function(){if(s.hasContent(this)){var e=parseInt(this.nodeName.substr(1),10);o>e&&(o=e)}}),!(o>6)){var l,d=null,c=[],u=0;for(l=0;6-o+1>l;l++)c[l]=0;r.each(function(){if(s.hasContent(this)){var e=parseInt(this.nodeName.substr(1),10);if(null===d&&e!==o)return void s._saveRemoveAnnotations(t(this).find("span[role=annotation]"));if(null===d)c[u]++;else if(e>d)c[++u]++;else if(e===d)c[u]++;else if(d>e){var n,a=e-o;for(n=u;n>a;n--)c[n]=0;u=a,c[u]++}d=e;var r,l="";if(i.trailingdot===!0)for(l="",r=0;r<c.length;r++)0!==c[r]&&(l+=c[r]+".");else for(l=c[0],r=1;r<c.length;r++)0!==c[r]&&(l+="."+c[r]);l+="&nbsp;",s.hasNote(this)?t(this).find("span[role=annotation]").html(l):s._prependAnnotation(l,this)}else s.hasNote(this)&&s._saveRemoveAnnotations(t(this).find("span[role=annotation]"))})}}}}})}),define("formatlesspaste/formatlesshandler",["aloha","jquery","aloha/contenthandlermanager"],function(e,t,n){function i(e,n){e.find(n.join(",")).each(function(){0===t(this).contents().length?t(this).remove():t(this).contents().unwrap()})}var a=n.createHandler({enabled:!1,handleContent:function(e){var n;return"string"==typeof e?n=t("<div>"+e+"</div>"):e instanceof t&&(n=t("<div>").append(e)),n.find(".aloha-block").length?void 0:(this.enabled&&i(n,this.strippedElements),n.html())}});return a}),define("formatlesspaste/nls/i18n",{root:{"button.formatlessPaste.tooltip":"Toggle Formatless Pasting"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("formatlesspaste/formatlesspaste-plugin",["aloha/core","aloha/plugin","jquery","ui/ui","ui/toggleButton","formatlesspaste/formatlesshandler","aloha/contenthandlermanager","i18n!formatlesspaste/nls/i18n","util/html"],function(e,t,n,i,a,r,o,s,l){function d(e){return e?"string"==typeof e?"0"!==e&&"false"!==e.toLowerCase():!0:!1}function c(e){var t={};return"undefined"!=typeof e.formatlessPasteOption&&(t.formatlessPasteOption=d(e.formatlessPasteOption)),"undefined"!=typeof e.strippedElements&&(t.strippedElements=e.strippedElements),"undefined"!=typeof e.button&&(t.button=d(e.button)),t}function u(e,t){n.extend(e,t)}function h(e,t){o.register("formatless",r),r.strippedElements=t.strippedElements||l.TEXT_LEVEL_SEMANTIC_ELEMENTS,e._toggleFormatlessPasteButton=i.adopt("toggleFormatlessPaste",a,{tooltip:s.t("button.formatlessPaste.tooltip"),icon:"aloha-icon aloha-icon-formatless-paste",scope:"Aloha.continuoustext",click:function(){r.enabled=!r.enabled}}),e._toggleFormatlessPasteButton.show(e.button),!0===e.formatlessPasteOption?(e._toggleFormatlessPasteButton.setState(!0),r.enabled=!0):!1===e.formatlessPasteOption&&(e._toggleFormatlessPasteButton.setState(!1),r.enabled=!1)}function p(e,t){var n=t.getId();if(!n)return null;if(g[n])return g[n];var i=e.getEditableConfig(t.obj);return i?(g[n]=c(i),g[n]):null}function f(e){var t=e.getId();t&&g[t]&&delete g[t]}var g={};return e.bind("aloha-editable-destroyed",function(e,t){f(t)}),t.create("formatlesspaste",{formatlessPasteOption:!1,button:!0,init:function(){var t=this,n=t.settings.config||t.settings,i=c(n);u(t,i),h(t,i),e.bind("aloha-editable-activated",function(e,n){var i=p(t,n.editable);if(i){var a=t._toggleFormatlessPasteButton;!0===i.formatlessPasteOption?(a.setState(!0),r.enabled=!0):!1===i.formatlessPasteOption&&(a.setState(!1),r.enabled=!1),a.show(!1!==i.button)}})}})}),function(){var e=!1,t=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(){function n(){!e&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;e=!0;var a=new this;e=!1;for(var r=0;r<arguments.length;r++){var o=arguments[r];for(var s in o)a[s]="function"==typeof o[s]&&"function"==typeof i[s]&&t.test(o[s])?function(e,t){return function(){var n=this._super;this._super=i[e];var a=t.apply(this,arguments);return this._super=n,a}}(s,o[s]):o[s]}return n.prototype=a,n.constructor=n,n.extend=arguments.callee,n}}(),"function"==typeof define&&define("Class",[],function(){return Class}),define("jstree",["jquery"],function(e){!function(){if(!e||!e.jstree){var t=!1,n=!1,i=!1;!function(e){e.vakata={},e.vakata.css={get_css:function(e,t,n){e=e.toLowerCase();var i=n.cssRules||n.rules,a=0;do{if(i.length&&a>i.length+5)return!1;if(i[a].selectorText&&i[a].selectorText.toLowerCase()==e)return t===!0?(n.removeRule&&n.removeRule(a),n.deleteRule&&n.deleteRule(a),!0):i[a]}while(i[++a]);return!1},add_css:function(t,n){return e.jstree.css.get_css(t,!1,n)?!1:(n.insertRule?n.insertRule(t+" { }",0):n.addRule(t,null,0),e.vakata.css.get_css(t))},remove_css:function(t,n){return e.vakata.css.get_css(t,!0,n)},add_sheet:function(t){var n=!1,i=!0;if(t.str)return t.title&&(n=e("style[id='"+t.title+"-stylesheet']")[0]),n?i=!1:(n=document.createElement("style"),n.setAttribute("type","text/css"),t.title&&n.setAttribute("id",t.title+"-stylesheet")),n.styleSheet?i?(document.getElementsByTagName("head")[0].appendChild(n),n.styleSheet.cssText=t.str):n.styleSheet.cssText=n.styleSheet.cssText+" "+t.str:(n.appendChild(document.createTextNode(t.str)),document.getElementsByTagName("head")[0].appendChild(n)),n.sheet||n.styleSheet;if(t.url){if(!document.createStyleSheet)return n=document.createElement("link"),n.rel="stylesheet",n.type="text/css",n.media="all",n.href=t.url,document.getElementsByTagName("head")[0].appendChild(n),n.styleSheet;try{n=document.createStyleSheet(t.url)}catch(a){}}}};var a=[],r=-1,o={},s={};e.fn.jstree=function(t){var n="string"==typeof t,i=Array.prototype.slice.call(arguments,1),r=this;if(n){if("_"==t.substring(0,1))return r;this.each(function(){var n=a[e.data(this,"jstree-instance-id")],o=n&&e.isFunction(n[t])?n[t].apply(n,i):n;return"undefined"!=typeof o&&(0===t.indexOf("is_")||o!==!0&&o!==!1)?(r=o,!1):void 0})}else this.each(function(){var n=e.data(this,"jstree-instance-id"),r=[],s=t?e.extend({},!0,t):{},l=e(this),d=!1,c=[];r=r.concat(i),l.data("jstree")&&r.push(l.data("jstree")),s=r.length?e.extend.apply(null,[!0,s].concat(r)):s,"undefined"!=typeof n&&a[n]&&a[n].destroy(),n=parseInt(a.push({}),10)-1,e.data(this,"jstree-instance-id",n),s.plugins=e.isArray(s.plugins)?s.plugins:e.jstree.defaults.plugins.slice(),s.plugins.unshift("core"),s.plugins=s.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),d=e.extend(!0,{},e.jstree.defaults,s),d.plugins=s.plugins,e.each(o,function(t){-1===e.inArray(t,d.plugins)?(d[t]=null,delete d[t]):c.push(t)
}),d.plugins=c,a[n]=new e.jstree._instance(n,e(this).addClass("jstree jstree-"+n),d),e.each(a[n]._get_settings().plugins,function(e,t){a[n].data[t]={}}),e.each(a[n]._get_settings().plugins,function(e,t){o[t]&&o[t].__init.apply(a[n])}),setTimeout(function(){a[n].init()},0)});return r},e.jstree={defaults:{plugins:[]},_focused:function(){return a[r]||null},_reference:function(t){if(a[t])return a[t];var n=e(t);return n.length||"string"!=typeof t||(n=e("#"+t)),n.length?a[n.closest(".jstree").data("jstree-instance-id")]||null:null},_instance:function(t,n,i){this.data={core:{}},this.get_settings=function(){return e.extend(!0,{},i)},this._get_settings=function(){return i},this.get_index=function(){return t},this.get_container=function(){return n},this.get_container_ul=function(){return n.children("ul:eq(0)")},this._set_settings=function(t){i=e.extend(!0,{},i,t)}},_fn:{},plugin:function(t,n){n=e.extend({},{__init:e.noop,__destroy:e.noop,_fn:{},defaults:!1},n),o[t]=n,e.jstree.defaults[t]=n.defaults,e.each(n._fn,function(n,i){i.plugin=t,i.old=e.jstree._fn[n],e.jstree._fn[n]=function(){var t,a=i,r=Array.prototype.slice.call(arguments),o=new e.Event("before.jstree"),s=!1;if(this.data.core.locked!==!0||"unlock"===n||"is_locked"===n){do{if(a&&a.plugin&&-1!==e.inArray(a.plugin,this._get_settings().plugins))break;a=a.old}while(a);if(a){if(0===n.indexOf("_"))t=a.apply(this,r);else{if(t=this.get_container().triggerHandler(o,{func:n,inst:this,args:r,plugin:a.plugin}),t===!1)return;"undefined"!=typeof t&&(r=t),t=a.apply(e.extend({},this,{__callback:function(e){this.get_container().triggerHandler(n+".jstree",{inst:this,args:r,rslt:e,rlbk:s})},__rollback:function(){return s=this.get_rollback()},__call_old:function(e){return a.old.apply(this,e?Array.prototype.slice.call(arguments,1):r)}}),r)}return t}}},e.jstree._fn[n].old=i.old,e.jstree._fn[n].plugin=t})},rollback:function(t){t&&(e.isArray(t)||(t=[t]),e.each(t,function(e,t){a[t.i].set_rollback(t.h,t.d)}))}},e.jstree._fn=e.jstree._instance.prototype={},e(function(){var a=navigator.userAgent.toLowerCase(),r=(a.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],o=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(/msie/.test(a)&&6==parseInt(r,10)){t=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(s){}o+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(a)&&7==parseInt(r,10)&&(n=!0,o+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "),!/compatible/.test(a)&&/mozilla/.test(a)&&parseFloat(r,10)<1.9&&(i=!0,o+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } "),e.vakata.css.add_sheet({str:o,title:"jstree"})}),e.jstree.plugin("core",{__init:function(){this.data.core.locked=!1,this.data.core.to_open=this.get_settings().core.initially_open,this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus(),this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl"),this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>"),this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18,this.get_container().delegate("li > ins","click.jstree",e.proxy(function(t){var n=e(t.target);n.is("ins")&&t.pageY-n.offset().top<this.data.core.li_height&&this.toggle_node(n)},this)).bind("mousedown.jstree",e.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(){var e;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){e=window.getSelection();try{e.removeAllRanges(),e.collapse()}catch(t){}}}),this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",e.proxy(function(t,n){var i=this._get_node(n.rslt.obj),a=this;-1===i&&(i=this.get_container_ul()),i.length&&i.find("li").each(function(){var t=e(this);t.data("jstree")&&e.each(t.data("jstree"),function(n,i){a.data[n]&&e.isFunction(a["_"+n+"_notify"])&&a["_"+n+"_notify"].call(a,t,i)})})},this)),this._get_settings().core.load_open&&this.get_container().bind("load_node.jstree",e.proxy(function(t,n){var i=this._get_node(n.rslt.obj),a=this;-1===i&&(i=this.get_container_ul()),i.length&&i.find("li.jstree-open:not(:has(ul))").each(function(){a.load_node(this,e.noop,e.noop)})},this)),this.__callback(),this.load_node(-1,function(){this.loaded(),this.reload_nodes()})},destroy:function(){var t,n=this.get_index(),i=this._get_settings(),s=this;if(e.each(i.plugins,function(e,t){try{o[t].__destroy.apply(s)}catch(n){}}),this.__callback(),this.is_focused())for(t in a)if(a.hasOwnProperty(t)&&t!=n){a[t].set_focus();break}n===r&&(r=-1),this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree-instance-id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),e(document).unbind(".jstree-"+n).undelegate(".jstree-"+n),a[n]=null,delete a[n]},_core_notify:function(e,t){t.opened&&this.open_node(e,!1,!0)},lock:function(){this.data.core.locked=!0,this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7"),this.__callback({})},unlock:function(){this.data.core.locked=!1,this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1"),this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var e=this;this.data.core.to_open=[],this.get_container_ul().find("li.jstree-open").each(function(){this.id&&e.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(e.data.core.to_open)},save_loaded:function(){},reload_nodes:function(t){var n=this,i=!0,a=[],r=[];t||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=e.map(e.makeArray(this.data.core.to_open),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=e.map(e.makeArray(this.data.core.to_load),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open))),this.data.core.to_load.length&&(e.each(this.data.core.to_load,function(t,n){return"#"==n?!0:void(e(n).length?a.push(n):r.push(n))}),a.length&&(this.data.core.to_load=r,e.each(a,function(e,t){n._is_loaded(t)||(n.load_node(t,function(){n.reload_nodes(!0)},function(){n.reload_nodes(!0)}),i=!1)}))),this.data.core.to_open.length&&e.each(this.data.core.to_open,function(e,t){n.open_node(t,!1,!0)}),i&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){n.__callback({},n)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var t=this;this.data.core.to_open.length&&e.each(this.data.core.to_open,function(e,n){t.open_node(n,!1,!0)}),this.__callback({})},refresh:function(e){var t=this;this.save_opened(),e||(e=-1),e=this._get_node(e),e||(e=-1),-1!==e?e.children("UL").remove():this.get_container_ul().empty(),this.load_node(e,function(){t.__callback({obj:e}),t.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(!this.is_focused()){var t=e.jstree._focused();t&&t.unset_focus(),this.get_container().addClass("jstree-focused"),r=this.get_index(),this.__callback()}},is_focused:function(){return r==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),r=-1),this.__callback()},_get_node:function(t){var n=e(t,this.get_container());return n.is(".jstree")||-1==t?-1:(n=n.closest("li",this.get_container()),n.length?n:!1)},_get_next:function(e,t){return e=this._get_node(e),-1===e?this.get_container().find("> ul > li:first-child"):e.length?t?e.nextAll("li").size()>0?e.nextAll("li:eq(0)"):!1:e.hasClass("jstree-open")?e.find("li:eq(0)"):e.nextAll("li").size()>0?e.nextAll("li:eq(0)"):e.parentsUntil(".jstree","li").next("li").eq(0):!1},_get_prev:function(e,t){if(e=this._get_node(e),-1===e)return this.get_container().find("> ul > li:last-child");if(!e.length)return!1;if(t)return e.prevAll("li").length>0?e.prevAll("li:eq(0)"):!1;if(e.prev("li").length){for(e=e.prev("li").eq(0);e.hasClass("jstree-open");)e=e.children("ul:eq(0)").children("li:last");return e}var n=e.parentsUntil(".jstree","li:eq(0)");return n.length?n:!1},_get_parent:function(e){if(e=this._get_node(e),-1==e||!e.length)return!1;var t=e.parentsUntil(".jstree","li:eq(0)");return t.length?t:-1},_get_children:function(e){return e=this._get_node(e),-1===e?this.get_container().children("ul:eq(0)").children("li"):e.length?e.children("ul:eq(0)").children("li"):!1},get_path:function(e,t){var n=[],i=this;return e=this._get_node(e),-1!==e&&e&&e.length?(e.parentsUntil(".jstree","li").each(function(){n.push(t?this.id:i.get_text(this))}),n.reverse(),n.push(t?e.attr("id"):this.get_text(e)),n):!1},_get_string:function(e){return this._get_settings().core.strings[e]||e},is_open:function(e){return e=this._get_node(e),e&&-1!==e&&e.hasClass("jstree-open")},is_closed:function(e){return e=this._get_node(e),e&&-1!==e&&e.hasClass("jstree-closed")},is_leaf:function(e){return e=this._get_node(e),e&&-1!==e&&e.hasClass("jstree-leaf")},correct_state:function(e){return e=this._get_node(e),e&&-1!==e?(e.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove(),void this.__callback({obj:e})):!1},open_node:function(e,n,i){if(e=this._get_node(e),!e.length)return!1;if(!e.hasClass("jstree-closed"))return n&&n.call(),!1;var a=i||t?0:this._get_settings().core.animation,r=this;this._is_loaded(e)?(this._get_settings().core.open_parents&&e.parentsUntil(".jstree",".jstree-closed").each(function(){r.open_node(this,!1,!0)}),a&&e.children("ul").css("display","none"),e.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),a?e.children("ul").stop(!0,!0).slideDown(a,function(){this.style.display="",r.after_open(e)}):r.after_open(e),this.__callback({obj:e}),n&&n.call()):(e.children("a").addClass("jstree-loading"),this.load_node(e,function(){r.open_node(e,n,i)},n))},after_open:function(e){this.__callback({obj:e})},close_node:function(e,n){e=this._get_node(e);var i=n||t?0:this._get_settings().core.animation,a=this;return e.length&&e.hasClass("jstree-open")?(i&&e.children("ul").attr("style","display:block !important"),e.removeClass("jstree-open").addClass("jstree-closed"),i?e.children("ul").stop(!0,!0).slideUp(i,function(){this.style.display="",a.after_close(e)}):a.after_close(e),void this.__callback({obj:e})):!1},after_close:function(e){this.__callback({obj:e})},toggle_node:function(e){return e=this._get_node(e),e.hasClass("jstree-closed")?this.open_node(e):e.hasClass("jstree-open")?this.close_node(e):void 0},open_all:function(e,t,n){e=e?this._get_node(e):-1,e&&-1!==e||(e=this.get_container_ul()),n?e=e.find("li.jstree-closed"):(n=e,e=e.is(".jstree-closed")?e.find("li.jstree-closed").andSelf():e.find("li.jstree-closed"));var i=this;e.each(function(){var e=this;i._is_loaded(this)?i.open_node(this,!1,!t):i.open_node(this,function(){i.open_all(e,t,n)},!t)}),0===n.find("li.jstree-closed").length&&this.__callback({obj:n})},close_all:function(e,t){var n=this;e=e?this._get_node(e):this.get_container(),e&&-1!==e||(e=this.get_container_ul()),e.find("li.jstree-open").andSelf().each(function(){n.close_node(this,!t)}),this.__callback({obj:e})},clean_node:function(t){t=t&&-1!=t?e(t):this.get_container_ul(),t=t.is("li")?t.find("li").andSelf():t.find("li"),t.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed"),t.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:t})},get_rollback:function(){return this.__callback(),{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(e,t){this.get_container().empty().append(e),this.data=t,this.__callback()},load_node:function(e){this.__callback({obj:e})},_is_loaded:function(){return!0},create_node:function(t,n,i,a,r){t=this._get_node(t),n="undefined"==typeof n?"last":n;var o,s=e("<li />"),l=this._get_settings().core;if(-1!==t&&!t.length)return!1;if(!r&&!this._is_loaded(t))return this.load_node(t,function(){this.create_node(t,n,i,a,!0)}),!1;switch(this.__rollback(),"string"==typeof i&&(i={data:i}),i||(i={}),i.attr&&s.attr(i.attr),i.metadata&&s.data(i.metadata),i.state&&s.addClass("jstree-"+i.state),i.data||(i.data=this._get_string("new_node")),e.isArray(i.data)||(o=i.data,i.data=[],i.data.push(o)),e.each(i.data,function(t,n){o=e("<a />"),e.isFunction(n)&&(n=n.call(this,i)),"string"==typeof n?o.attr("href","#")[l.html_titles?"html":"text"](n):(n.attr||(n.attr={}),n.attr.href||(n.attr.href="#"),o.attr(n.attr)[l.html_titles?"html":"text"](n.title),n.language&&o.addClass(n.language)),o.prepend("<ins class='jstree-icon'>&#160;</ins>"),n.icon&&(-1===n.icon.indexOf("/")?o.children("ins").addClass(n.icon):o.children("ins").css("background","url('"+n.icon+"') center center no-repeat")),s.append(o)}),s.prepend("<ins class='jstree-icon'>&#160;</ins>"),-1===t&&(t=this.get_container(),"before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":t.before(s),o=this._get_parent(t);break;case"after":t.after(s),o=this._get_parent(t);break;case"inside":case"first":t.children("ul").length||t.append("<ul />"),t.children("ul").prepend(s),o=t;break;case"last":t.children("ul").length||t.append("<ul />"),t.children("ul").append(s),o=t;break;default:t.children("ul").length||t.append("<ul />"),n||(n=0),o=t.children("ul").children("li").eq(n),o.length?o.before(s):t.children("ul").append(s),o=t}return(-1===o||o.get(0)===this.get_container().get(0))&&(o=-1),this.clean_node(o),this.__callback({obj:s,parent:o}),a&&a.call(this,s),s},get_text:function(e){if(e=this._get_node(e),!e.length)return!1;var t=this._get_settings().core.html_titles;return e=e.children("a:eq(0)"),t?(e=e.clone(),e.children("INS").remove(),e.html()):(e=e.contents().filter(function(){return 3==this.nodeType})[0],e.nodeValue)},set_text:function(e,t){if(e=this._get_node(e),!e.length)return!1;if(e=e.children("a:eq(0)"),this._get_settings().core.html_titles){var n=e.children("INS").clone();return e.html(t).prepend(n),this.__callback({obj:e,name:t}),!0}return e=e.contents().filter(function(){return 3==this.nodeType})[0],this.__callback({obj:e,name:t}),e.nodeValue=t},rename_node:function(e,t){e=this._get_node(e),this.__rollback(),e&&e.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))&&this.__callback({obj:e,name:t})},delete_node:function(t){if(t=this._get_node(t),!t.length)return!1;this.__rollback();var n=this._get_parent(t),i=e([]),a=this;return t.each(function(){i=i.add(a._get_prev(this))}),t=t.detach(),-1!==n&&0===n.find("> ul > li").length&&n.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),this.clean_node(n),this.__callback({obj:t,prev:i,parent:n}),t},prepare_move:function(t,n,i,a,r){var o={};if(o.ot=e.jstree._reference(t)||this,o.o=o.ot._get_node(t),o.r=-1===n?-1:this._get_node(n),o.p="undefined"==typeof i||i===!1?"last":i,!r&&s.o&&s.o[0]===o.o[0]&&s.r[0]===o.r[0]&&s.p===o.p)return this.__callback(s),void(a&&a.call(this,s));if(o.ot=e.jstree._reference(o.o)||this,o.rt=e.jstree._reference(o.r)||this,-1!==o.r&&o.r){if(!/^(before|after)$/.test(o.p)&&!this._is_loaded(o.r))return this.load_node(o.r,function(){this.prepare_move(t,n,i,a,!0)});switch(o.p){case"before":o.cp=o.r.index(),o.cr=o.rt._get_parent(o.r);break;case"after":o.cp=o.r.index()+1,o.cr=o.rt._get_parent(o.r);break;case"inside":case"first":o.cp=0,o.cr=o.r;break;case"last":o.cp=o.r.find(" > ul > li").length,o.cr=o.r;break;default:o.cp=o.p,o.cr=o.r}}else switch(o.cr=-1,o.p){case"first":case"before":case"inside":o.cp=0;break;case"after":case"last":o.cp=o.rt.get_container().find(" > ul > li").length;break;default:o.cp=o.p}o.np=-1==o.cr?o.rt.get_container():o.cr,o.op=o.ot._get_parent(o.o),o.cop=o.o.index(),-1===o.op&&(o.op=o.ot?o.ot.get_container():this.get_container()),!/^(before|after)$/.test(o.p)&&o.op&&o.np&&o.op[0]===o.np[0]&&o.o.index()<o.cp&&o.cp++,o.or=o.np.find(" > ul > li:nth-child("+(o.cp+1)+")"),s=o,this.__callback(s),a&&a.call(this,s)},check_move:function(){var e=s,t=!0,n=-1===e.r?this.get_container():e.r;return e&&e.o&&e.or[0]!==e.o[0]?e.op&&e.np&&e.op[0]===e.np[0]&&e.cp-1===e.o.index()?!1:(e.o.each(function(){return-1!==n.parentsUntil(".jstree","li").andSelf().index(this)?(t=!1,!1):void 0}),t):!1},move_node:function(t,n,i,a,r,o){if(!r)return this.prepare_move(t,n,i,function(e){this.move_node(e,!1,!1,a,!0,o)});if(a&&(s.cy=!0),!o&&!this.check_move())return!1;this.__rollback();var l=!1;a?(l=t.o.clone(!0),l.find("*[id]").andSelf().each(function(){this.id&&(this.id="copy_"+this.id)})):l=t.o,t.or.length?t.or.before(l):(t.np.children("ul").length||e("<ul />").appendTo(t.np),t.np.children("ul:eq(0)").append(l));try{t.ot.clean_node(t.op),t.rt.clean_node(t.np),t.op.find("> ul > li").length||t.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(d){}return a&&(s.cy=!0,s.oc=l),this.__callback(s),s},_get_move:function(){return s}}})}(e),function(e){var t,n,i;e(function(){/msie/.test(navigator.userAgent.toLowerCase())?(n=e('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),i=e('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),t=n.width()-i.width(),n.add(i).remove()):(n=e("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200}),t=100-n.width(),n.parent().remove())}),e.jstree.plugin("ui",{__init:function(){this.data.ui.selected=e(),this.data.ui.last_selected=!1,this.data.ui.hovered=null,this.data.ui.to_select=this.get_settings().ui.initially_select,this.get_container().delegate("a","click.jstree",e.proxy(function(t){t.preventDefault(),t.currentTarget.blur(),e(t.currentTarget).hasClass("jstree-loading")||this.select_node(t.currentTarget,!0,t)},this)).delegate("a","mouseenter.jstree",e.proxy(function(t){e(t.currentTarget).hasClass("jstree-loading")||this.hover_node(t.target)},this)).delegate("a","mouseleave.jstree",e.proxy(function(t){e(t.currentTarget).hasClass("jstree-loading")||this.dehover_node(t.target)},this)).bind("reopen.jstree",e.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",e.proxy(function(){this.dehover_node(),this.save_selected()},this)).bind("set_rollback.jstree",e.proxy(function(){this.reselect()},this)).bind("close_node.jstree",e.proxy(function(t,n){var i=this._get_settings().ui,a=this._get_node(n.rslt.obj),r=a&&a.length?a.children("ul").find("a.jstree-clicked"):e(),o=this;i.selected_parent_close!==!1&&r.length&&r.each(function(){o.deselect_node(this),"select_parent"===i.selected_parent_close&&o.select_node(a)})},this)).bind("delete_node.jstree",e.proxy(function(e,t){var n=this._get_settings().ui.select_prev_on_delete,i=this._get_node(t.rslt.obj),a=i&&i.length?i.find("a.jstree-clicked"):[],r=this;a.each(function(){r.deselect_node(this)}),n&&a.length&&t.rslt.prev.each(function(){return this.parentNode?(r.select_node(this),!1):void 0})},this)).bind("move_node.jstree",e.proxy(function(e,t){t.rslt.cy&&t.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(t,n){if("undefined"==typeof t||null===t)return n?this.data.ui.selected:this.data.ui.last_selected;var i=e(t,this.get_container());return i.is(".jstree")||-1==t?-1:(i=i.closest("li",this.get_container()),i.length?i:!1)},_ui_notify:function(e,t){t.selected&&this.select_node(e,!1)},save_selected:function(){var e=this;this.data.ui.to_select=[],this.data.ui.selected.each(function(){this.id&&e.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(this.data.ui.to_select)},reselect:function(){var t=this,n=this.data.ui.to_select;n=e.map(e.makeArray(n),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),e.each(n,function(e,n){n&&"#"!==n&&t.select_node(n)}),this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode}),this.__callback()},refresh:function(){return this.save_selected(),this.__call_old()},hover_node:function(e){return e=this._get_node(e),e.length?(e.hasClass("jstree-hovered")||this.dehover_node(),this.data.ui.hovered=e.children("a").addClass("jstree-hovered").parent(),this._fix_scroll(e),void this.__callback({obj:e})):!1},dehover_node:function(){var e,t=this.data.ui.hovered;return t&&t.length?(e=t.children("a").removeClass("jstree-hovered").parent(),this.data.ui.hovered[0]===e[0]&&(this.data.ui.hovered=null),void this.__callback({obj:t})):!1},select_node:function(e,t,n){if(e=this._get_node(e),-1==e||!e||!e.length)return!1;var i=this._get_settings().ui,a="on"==i.select_multiple_modifier||i.select_multiple_modifier!==!1&&n&&n[i.select_multiple_modifier+"Key"],r=i.select_range_modifier!==!1&&n&&n[i.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==e[0]&&this.data.ui.last_selected.parent()[0]===e.parent()[0],o=this.is_selected(e),s=!0,l=this;if(t){if(i.disable_selecting_children&&a&&(e.parentsUntil(".jstree","li").children("a.jstree-clicked").length||e.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;switch(s=!1,!0){case r:this.data.ui.last_selected.addClass("jstree-last-selected"),e=e[e.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf(),-1==i.select_limit||e.length<i.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==l.data.ui.last_selected[0]&&l.deselect_node(this)}),o=!1,s=!0):s=!1;break;case o&&!a:this.deselect_all(),o=!1,s=!0;break;case!o&&!a:(-1==i.select_limit||i.select_limit>0)&&(this.deselect_all(),s=!0);break;case o&&a:this.deselect_node(e);break;case!o&&a:(-1==i.select_limit||this.data.ui.selected.length+1<=i.select_limit)&&(s=!0)}}s&&!o&&(r||(this.data.ui.last_selected=e),e.children("a").addClass("jstree-clicked"),i.selected_parent_open&&e.parents(".jstree-closed").each(function(){l.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(e),this._fix_scroll(e.eq(0)),this.__callback({obj:e,e:n}))},_fix_scroll:function(e){var n,i=this.get_container()[0];if(i.scrollHeight>i.offsetHeight){if(e=this._get_node(e),!e||-1===e||!e.length||!e.is(":visible"))return;n=e.offset().top-this.get_container().offset().top,0>n&&(i.scrollTop=i.scrollTop+n-1),n+this.data.core.li_height+(i.scrollWidth>i.offsetWidth?t:0)>i.offsetHeight&&(i.scrollTop=i.scrollTop+(n-i.offsetHeight+this.data.core.li_height+1+(i.scrollWidth>i.offsetWidth?t:0)))}},deselect_node:function(e){return e=this._get_node(e),e.length?void(this.is_selected(e)&&(e.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(e),this.data.ui.last_selected.get(0)===e.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:e}))):!1},toggle_select:function(e){return e=this._get_node(e),e.length?void(this.is_selected(e)?this.deselect_node(e):this.select_node(e)):!1},is_selected:function(e){return this.data.ui.selected.index(this._get_node(e))>=0},get_selected:function(t){return t?e(t).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(t){var n=t?e(t).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();n.children("a.jstree-clicked").removeClass("jstree-clicked"),this.data.ui.selected=e([]),this.data.ui.last_selected=!1,this.__callback({obj:n})}}}),e.jstree.defaults.plugins.push("ui")}(e),function(e){e.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",e.proxy(function(e,t){if(this._get_settings().crrm.move.open_onmove){var n=this;t.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){n.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(){return!0}}},_fn:{_show_input:function(t,n){t=this._get_node(t);var i=this._get_settings().core.rtl,a=this._get_settings().crrm.input_width_limit,r=t.children("ins").width(),o=t.find("> a:visible > ins").width()*t.find("> a:visible > ins").length,s=this.get_text(t),l=e("<div />",{css:{position:"absolute",top:"-200px",left:i?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),d=t.css("position","relative").append(e("<input />",{value:s,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:i?"auto":r+o+4+"px",right:i?r+o+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:e.proxy(function(){var e=t.children(".jstree-rename-input"),i=e.val();""===i&&(i=s),l.remove(),e.remove(),this.set_text(t,s),this.rename_node(t,i),n.call(this,t,i,s),t.css("position","")},this),keyup:function(e){var t=e.keyCode||e.which;return 27==t?(this.value=s,void this.blur()):13==t?void this.blur():void d.width(Math.min(l.text("pW"+this.value).width(),a))},keypress:function(e){var t=e.keyCode||e.which;return 13==t?!1:void 0}})).children(".jstree-rename-input");this.set_text(t,""),l.css({fontFamily:d.css("fontFamily")||"",fontSize:d.css("fontSize")||"",fontWeight:d.css("fontWeight")||"",fontStyle:d.css("fontStyle")||"",fontStretch:d.css("fontStretch")||"",fontVariant:d.css("fontVariant")||"",letterSpacing:d.css("letterSpacing")||"",wordSpacing:d.css("wordSpacing")||""}),d.width(Math.min(l.text("pW"+d[0].value).width(),a))[0].select()},rename:function(e){e=this._get_node(e),this.__rollback();var t=this.__callback;this._show_input(e,function(e,n,i){t.call(this,{obj:e,new_name:n,old_name:i})})},create:function(t,n,i,a,r){var o,s=this;return t=this._get_node(t),t||(t=-1),this.__rollback(),o=this.create_node(t,n,i,function(t){var n=this._get_parent(t),i=e(t).index();a&&a.call(this,t),n.length&&n.hasClass("jstree-closed")&&this.open_node(n,!1,!0),r?s.__callback({obj:t,name:this.get_text(t),parent:n,position:i}):this._show_input(t,function(e,t){s.__callback({obj:e,name:t,parent:n,position:i})})})},remove:function(e){e=this._get_node(e,!0);var t=this._get_parent(e),n=this._get_prev(e);this.__rollback(),e=this.delete_node(e),e!==!1&&this.__callback({obj:e,prev:n,parent:t})},check_move:function(){if(!this.__call_old())return!1;var e=this._get_settings().crrm.move;return e.check_move.call(this,this._get_move())?!0:!1},move_node:function(e,t,n,i,a,r){var o=this._get_settings().crrm.move;return a?((o.always_copy===!0||"multitree"===o.always_copy&&e.rt.get_index()!==e.ot.get_index())&&(i=!0),void this.__call_old(!0,e,t,n,i,!0,r)):("undefined"==typeof n&&(n=o.default_position),"inside"!==n||o.default_position.match(/^(before|after)$/)||(n=o.default_position),this.__call_old(!0,e,t,n,i,!1,r))},cut:function(e){return e=this._get_node(e,!0),e&&e.length?(this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=e,void this.__callback({obj:e})):!1},copy:function(e){return e=this._get_node(e,!0),e&&e.length?(this.data.crrm.ct_nodes=!1,this.data.crrm.cp_nodes=e,void this.__callback({obj:e})):!1},paste:function(e){if(e=this._get_node(e),!e||!e.length)return!1;var t=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;return this.data.crrm.ct_nodes||this.data.crrm.cp_nodes?(this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,e),this.data.crrm.ct_nodes=!1),this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,e,!1,!0),void this.__callback({obj:e,nodes:t})):!1}}})}(e),function(e){var t=[];e.jstree._themes=!1,e.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",e.proxy(function(){var e=this._get_settings().themes;this.data.themes.dots=e.dots,this.data.themes.icons=e.icons,this.set_theme(e.theme,e.url)},this)).bind("loaded.jstree",e.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(n,i){return n?(i||(i=e.jstree._themes+n+"/style.css"),-1==e.inArray(i,t)&&(e.vakata.css.add_sheet({url:i}),t.push(i)),this.data.themes.theme!=n&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=n),this.get_container().addClass("jstree-"+n),this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons(),void this.__callback()):!1},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0,this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1,this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0,this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1,this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}}),e(function(){e.jstree._themes===!1&&e("script").each(function(){return this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)?(e.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1):void 0}),e.jstree._themes===!1&&(e.jstree._themes="themes/")
}),e.jstree.defaults.plugins.push("themes")}(e),function(e){function t(t,n){var i,a=e.jstree._focused();return a&&a.data&&a.data.hotkeys&&a.data.hotkeys.enabled&&(i=a._get_settings().hotkeys[t])?i.call(a,n):void 0}var n=[];e.jstree.plugin("hotkeys",{__init:function(){if("undefined"==typeof e.hotkeys)throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";e.each(this._get_settings().hotkeys,function(i,a){a!==!1&&-1==e.inArray(i,n)&&(e(document).bind("keydown",i,function(e){return t(i,e)}),n.push(i))}),this.get_container().bind("lock.jstree",e.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",e.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this)),this.enable_hotkeys()},defaults:{up:function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},"ctrl+up":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},"shift+up":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},down:function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},"ctrl+down":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},"shift+down":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},left:function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},"ctrl+left":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},"shift+left":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},right:function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},"ctrl+right":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},"shift+right":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},space:function(){return this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click(),!1},"ctrl+space":function(e){return e.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(e),!1},"shift+space":function(e){return e.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(e),!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})}(e),function(e){e.jstree.plugin("json_data",{__init:function(){var e=this._get_settings().json_data;e.progressive_unload&&this.get_container().bind("after_close.jstree",function(e,t){t.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(e,t,n){var i=this;this.load_node_json(e,function(){i.__callback({obj:i._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){var n=this._get_settings().json_data;return t=this._get_node(t),-1==t||!t||!n.ajax&&!n.progressive_render&&!e.isFunction(n.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").length>0},refresh:function(t){t=this._get_node(t);var n=this._get_settings().json_data;return t&&-1!==t&&n.progressive_unload&&(e.isFunction(n.data)||n.ajax)&&t.removeData("jstree-children"),this.__call_old()},load_node_json:function(t,n,i){var a,r=this.get_settings().json_data,o=function(){},s=function(){};if(t=this._get_node(t),t&&-1!==t&&(r.progressive_render||r.progressive_unload)&&!t.is(".jstree-open, .jstree-leaf")&&0===t.children("ul").children("li").length&&t.data("jstree-children"))return a=this._parse_json(t.data("jstree-children"),t),a&&(t.append(a),r.progressive_unload||t.removeData("jstree-children")),this.clean_node(t),void(n&&n.call(this));if(t&&-1!==t){if(t.data("jstree-is-loading"))return;t.data("jstree-is-loading",!0)}switch(!0){case!r.data&&!r.ajax:throw"Neither data nor ajax settings supplied.";case e.isFunction(r.data):r.data.call(this,t,e.proxy(function(e){e=this._parse_json(e,t),e?(-1!==t&&t?(t.append(e).children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading")):this.get_container().children("ul").empty().append(e.children()),this.clean_node(t),n&&n.call(this)):(-1!==t&&t?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading"),r.correct_state&&this.correct_state(t)):r.correct_state&&this.get_container().children("ul").empty(),i&&i.call(this))},this));break;case!!r.data&&!r.ajax||!!r.data&&!!r.ajax&&(!t||-1===t):t&&-1!=t||(a=this._parse_json(r.data,t),a?(this.get_container().children("ul").empty().append(a.children()),this.clean_node()):r.correct_state&&this.get_container().children("ul").empty()),n&&n.call(this);break;case!r.data&&!!r.ajax||!!r.data&&!!r.ajax&&t&&-1!==t:o=function(e,n,a){var o=this.get_settings().json_data.ajax.error;o&&o.call(this,e,n,a),-1!=t&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading"),"success"===n&&r.correct_state&&this.correct_state(t)):"success"===n&&r.correct_state&&this.get_container().children("ul").empty(),i&&i.call(this)},s=function(i,a,s){var l=this.get_settings().json_data.ajax.success;return l&&(i=l.call(this,i,a,s)||i),""===i||i&&i.toString&&""===i.toString().replace(/^[\s\n]+$/,"")||!e.isArray(i)&&!e.isPlainObject(i)?o.call(this,s,a,""):(i=this._parse_json(i,t),void(i?(-1!==t&&t?(t.append(i).children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading")):this.get_container().children("ul").empty().append(i.children()),this.clean_node(t),n&&n.call(this)):-1!==t&&t?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading"),r.correct_state&&(this.correct_state(t),n&&n.call(this))):r.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))))},r.ajax.context=this,r.ajax.error=o,r.ajax.success=s,r.ajax.dataType||(r.ajax.dataType="json"),e.isFunction(r.ajax.url)&&(r.ajax.url=r.ajax.url.call(this,t)),e.isFunction(r.ajax.data)&&(r.ajax.data=r.ajax.data.call(this,t)),e.ajax(r.ajax)}},_parse_json:function(t,n,i){var a,r,o,s,l,d=!1,c=this._get_settings(),u=c.json_data,h=c.core.html_titles;if(!t)return d;if(u.progressive_unload&&n&&-1!==n&&n.data("jstree-children",d),e.isArray(t)){if(d=e(),!t.length)return!1;for(r=0,o=t.length;o>r;r++)a=this._parse_json(t[r],n,!0),a.length&&(d=d.add(a))}else{if("string"==typeof t&&(t={data:t}),!t.data&&""!==t.data)return d;d=e("<li />"),t.attr&&d.attr(t.attr),t.metadata&&d.data(t.metadata),t.state&&d.addClass("jstree-"+t.state),e.isArray(t.data)||(a=t.data,t.data=[],t.data.push(a)),e.each(t.data,function(n,i){a=e("<a />"),e.isFunction(i)&&(i=i.call(this,t)),"string"==typeof i?a.attr("href","#")[h?"html":"text"](i):(i.attr||(i.attr={}),i.attr.href||(i.attr.href="#"),a.attr(i.attr)[h?"html":"text"](i.title),i.language&&a.addClass(i.language)),a.prepend("<ins class='jstree-icon'>&#160;</ins>"),!i.icon&&t.icon&&(i.icon=t.icon),i.icon&&(-1===i.icon.indexOf("/")?a.children("ins").addClass(i.icon):a.children("ins").css("background","url('"+i.icon+"') center center no-repeat")),d.append(a)}),d.prepend("<ins class='jstree-icon'>&#160;</ins>"),t.children&&(u.progressive_render&&"open"!==t.state?d.addClass("jstree-closed").data("jstree-children",t.children):(u.progressive_unload&&d.data("jstree-children",t.children),e.isArray(t.children)&&t.children.length&&(a=this._parse_json(t.children,n,!0),a.length&&(l=e("<ul />"),l.append(a),d.append(l)))))}return i||(s=e("<ul />"),s.append(d),d=s),d},get_json:function(t,n,i,a){var r,o,s,l,d,c,u=[],h=this._get_settings(),p=this;return t=this._get_node(t),t&&-1!==t||(t=this.get_container().find("> ul > li")),n=e.isArray(n)?n:["id","class"],!a&&this.data.types&&n.push(h.types.type_attr),i=e.isArray(i)?i:[],t.each(function(){s=e(this),r={data:[]},n.length&&(r.attr={}),e.each(n,function(e,t){o=s.attr(t),o&&o.length&&o.replace(/jstree[^ ]*/gi,"").length&&(r.attr[t]=(" "+o).replace(/ jstree[^ ]*/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,""))}),s.hasClass("jstree-open")&&(r.state="open"),s.hasClass("jstree-closed")&&(r.state="closed"),s.data()&&(r.metadata=s.data()),l=s.children("a"),l.each(function(){d=e(this),i.length||-1!==e.inArray("languages",h.plugins)||d.children("ins").get(0).style.backgroundImage.length||d.children("ins").get(0).className&&d.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").length?(c=!1,-1!==e.inArray("languages",h.plugins)&&e.isArray(h.languages)&&h.languages.length&&e.each(h.languages,function(e,t){return d.hasClass(t)?(c=t,!1):void 0}),o={attr:{},title:p.get_text(d,c)},e.each(i,function(e,t){o.attr[t]=(" "+(d.attr(t)||"")).replace(/ jstree[^ ]*/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,"")}),-1!==e.inArray("languages",h.plugins)&&e.isArray(h.languages)&&h.languages.length&&e.each(h.languages,function(e,t){return d.hasClass(t)?(o.language=t,!0):void 0}),d.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").replace(/^\s+$/gi,"").length&&(o.icon=d.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,"")),d.children("ins").get(0).style.backgroundImage.length&&(o.icon=d.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))):o=p.get_text(d),l.length>1?r.data.push(o):r.data=o}),s=s.find("> ul > li"),s.length&&(r.children=p.get_json(s,n,i,!0)),u.push(r)}),u}}})}(e),function(e){e.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(t){var n=this._get_settings().languages,i=!1,a=".jstree-"+this.get_index()+" a";if(!e.isArray(n)||0===n.length)return!1;if(-1==e.inArray(t,n)){if(!n[t])return!1;t=n[t]}return t==this.data.languages.current_language?!0:(i=e.vakata.css.get_css(a+"."+this.data.languages.current_language,!1,this.data.languages.language_css),i!==!1&&(i.style.display="none"),i=e.vakata.css.get_css(a+"."+t,!1,this.data.languages.language_css),i!==!1&&(i.style.display=""),this.data.languages.current_language=t,this.__callback(t),!0)},get_lang:function(){return this.data.languages.current_language},_get_string:function(t,n){var i=this._get_settings().languages,a=this._get_settings().core.strings;return e.isArray(i)&&i.length&&(n=n&&-1!=e.inArray(n,i)?n:this.data.languages.current_language),a[n]&&a[n][t]?a[n][t]:a[t]?a[t]:t},get_text:function(t,n){if(t=this._get_node(t)||this.data.ui.last_selected,!t.size())return!1;var i=this._get_settings().languages,a=this._get_settings().core.html_titles;return e.isArray(i)&&i.length?(n=n&&-1!=e.inArray(n,i)?n:this.data.languages.current_language,t=t.children("a."+n)):t=t.children("a:eq(0)"),a?(t=t.clone(),t.children("INS").remove(),t.html()):(t=t.contents().filter(function(){return 3==this.nodeType})[0],t.nodeValue)},set_text:function(t,n,i){if(t=this._get_node(t)||this.data.ui.last_selected,!t.size())return!1;var a,r=this._get_settings().languages,o=this._get_settings().core.html_titles;return e.isArray(r)&&r.length?(i=i&&-1!=e.inArray(i,r)?i:this.data.languages.current_language,t=t.children("a."+i)):t=t.children("a:eq(0)"),o?(a=t.children("INS").clone(),t.html(n).prepend(a),this.__callback({obj:t,name:n,lang:i}),!0):(t=t.contents().filter(function(){return 3==this.nodeType})[0],this.__callback({obj:t,name:n,lang:i}),t.nodeValue=n)},_load_css:function(){var t,n=this._get_settings().languages,i="/* languages css */",a=".jstree-"+this.get_index()+" a";if(e.isArray(n)&&n.length){for(this.data.languages.current_language=n[0],t=0;t<n.length;t++)i+=a+"."+n[t]+" {",n[t]!=this.data.languages.current_language&&(i+=" display:none; "),i+=" } ";this.data.languages.language_css=e.vakata.css.add_sheet({str:i,title:"jstree-languages"})}},create_node:function(t,n,i,a){var r=this.__call_old(!0,t,n,i,function(t){var n,i=this._get_settings().languages,r=t.children("a");if(e.isArray(i)&&i.length){for(n=0;n<i.length;n++)r.is("."+i[n])||t.append(r.eq(0).clone().removeClass(i.join(" ")).addClass(i[n]));r.not("."+i.join(", .")).remove()}a&&a.call(this,t)});return r}}})}(e),function(e){e.jstree.plugin("cookies",{__init:function(){if("undefined"==typeof e.cookie)throw"jsTree cookie: jQuery cookie plugin not included.";var t,n=this._get_settings().cookies;n.save_loaded&&(t=e.cookie(n.save_loaded),t&&t.length&&(this.data.core.to_load=t.split(","))),n.save_opened&&(t=e.cookie(n.save_opened),t&&t.length&&(this.data.core.to_open=t.split(","))),n.save_selected&&(t=e.cookie(n.save_selected),t&&t.length&&this.data.ui&&(this.data.ui.to_select=t.split(","))),this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",e.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",e.proxy(function(e){this._get_settings().cookies.auto_save&&this.save_cookie((e.handleObj.namespace+e.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(t){if(!this.data.core.refreshing){var n=this._get_settings().cookies;if(!t)return n.save_loaded&&(this.save_loaded(),e.cookie(n.save_loaded,this.data.core.to_load.join(","),n.cookie_options)),n.save_opened&&(this.save_opened(),e.cookie(n.save_opened,this.data.core.to_open.join(","),n.cookie_options)),void(n.save_selected&&this.data.ui&&(this.save_selected(),e.cookie(n.save_selected,this.data.ui.to_select.join(","),n.cookie_options)));switch(t){case"open_node":case"close_node":n.save_opened&&(this.save_opened(),e.cookie(n.save_opened,this.data.core.to_open.join(","),n.cookie_options)),n.save_loaded&&(this.save_loaded(),e.cookie(n.save_loaded,this.data.core.to_load.join(","),n.cookie_options));break;case"select_node":case"deselect_node":n.save_selected&&this.data.ui&&(this.save_selected(),e.cookie(n.save_selected,this.data.ui.to_select.join(","),n.cookie_options))}}}}})}(e),function(e){e.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",e.proxy(function(e,t){var n=this._get_node(t.rslt.obj);n=-1===n?this.get_container().children("ul"):n.children("ul"),this.sort(n)},this)).bind("rename_node.jstree create_node.jstree create.jstree",e.proxy(function(e,t){this.sort(t.rslt.obj.parent())},this)).bind("move_node.jstree",e.proxy(function(e,t){var n=-1==t.rslt.np?this.get_container():t.rslt.np;this.sort(n.children("ul"))},this))},defaults:function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},_fn:{sort:function(t){var n=this._get_settings().sort,i=this;t.append(e.makeArray(t.children("li")).sort(e.proxy(n,i))),t.find("> li > ul").each(function(){i.sort(e(this))}),this.clean_node(t)}}})}(e),function(e){var t=!1,n=!1,i=!1,a=!1,r=!1,o=!1,s=!1,l=!1,d=!1;e.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(t,n,i){e.vakata.dnd.is_drag&&e.vakata.drag_stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.MozUserSelect="none")}catch(a){}return e.vakata.dnd.init_x=t.pageX,e.vakata.dnd.init_y=t.pageY,e.vakata.dnd.user_data=n,e.vakata.dnd.is_down=!0,e.vakata.dnd.helper=e("<div id='vakata-dragged' />").html(i),e(document).bind("mousemove",e.vakata.dnd.drag),e(document).bind("mouseup",e.vakata.dnd.drag_stop),!1},drag:function(t){if(e.vakata.dnd.is_down){if(!e.vakata.dnd.is_drag){if(!(Math.abs(t.pageX-e.vakata.dnd.init_x)>5||Math.abs(t.pageY-e.vakata.dnd.init_y)>5))return;e.vakata.dnd.helper.appendTo("body"),e.vakata.dnd.is_drag=!0,e(document).triggerHandler("drag_start.vakata",{event:t,data:e.vakata.dnd.user_data})}if("mousemove"===t.type){var n=e(document),i=n.scrollTop(),a=n.scrollLeft();t.pageY-i<20?(o&&"down"===s&&(clearInterval(o),o=!1),o||(s="up",o=setInterval(function(){e(document).scrollTop(e(document).scrollTop()-e.vakata.dnd.scroll_spd)},150))):o&&"up"===s&&(clearInterval(o),o=!1),e(window).height()-(t.pageY-i)<20?(o&&"up"===s&&(clearInterval(o),o=!1),o||(s="down",o=setInterval(function(){e(document).scrollTop(e(document).scrollTop()+e.vakata.dnd.scroll_spd)},150))):o&&"down"===s&&(clearInterval(o),o=!1),t.pageX-a<20?(r&&"right"===l&&(clearInterval(r),r=!1),r||(l="left",r=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()-e.vakata.dnd.scroll_spd)},150))):r&&"left"===l&&(clearInterval(r),r=!1),e(window).width()-(t.pageX-a)<20?(r&&"left"===l&&(clearInterval(r),r=!1),r||(l="right",r=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()+e.vakata.dnd.scroll_spd)},150))):r&&"right"===l&&(clearInterval(r),r=!1)}e.vakata.dnd.helper.css({left:t.pageX+e.vakata.dnd.helper_left+"px",top:t.pageY+e.vakata.dnd.helper_top+"px"}),e(document).triggerHandler("drag.vakata",{event:t,data:e.vakata.dnd.user_data})}},drag_stop:function(t){r&&clearInterval(r),o&&clearInterval(o),e(document).unbind("mousemove",e.vakata.dnd.drag),e(document).unbind("mouseup",e.vakata.dnd.drag_stop),e(document).triggerHandler("drag_stop.vakata",{event:t,data:e.vakata.dnd.user_data}),e.vakata.dnd.helper.remove(),e.vakata.dnd.init_x=0,e.vakata.dnd.init_y=0,e.vakata.dnd.user_data={},e.vakata.dnd.is_down=!1,e.vakata.dnd.is_drag=!1}},e(function(){var t="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";e.vakata.css.add_sheet({str:t,title:"vakata"})}),e.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1},this.get_container().bind("mouseenter.jstree",e.proxy(function(n){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&(this.data.themes&&(i.attr("class","jstree-"+this.data.themes.theme),a&&a.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),n.currentTarget===n.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==n.target)){var r,o=e.jstree._reference(n.target);o.data.dnd.foreign?(r=o._get_settings().dnd.drag_check.call(this,{o:t,r:o.get_container(),is_root:!0}),(r===!0||r.inside===!0||r.before===!0||r.after===!0)&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(o.prepare_move(t,o.get_container(),"last"),o.check_move()&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"))}},this)).bind("mouseup.jstree",e.proxy(function(n){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&n.currentTarget===n.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==n.target){var i,a=e.jstree._reference(n.currentTarget);a.data.dnd.foreign?(i=a._get_settings().dnd.drag_check.call(this,{o:t,r:a.get_container(),is_root:!0}),(i===!0||i.inside===!0||i.before===!0||i.after===!0)&&a._get_settings().dnd.drag_finish.call(this,{o:t,r:a.get_container(),is_root:!0})):a.move_node(t,a.get_container(),"last",n[a._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",e.proxy(function(t){return t.relatedTarget&&t.relatedTarget.id&&"jstree-marker-line"===t.relatedTarget.id?!1:void(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")))},this)).bind("mousemove.jstree",e.proxy(function(t){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){var n=this.get_container()[0];t.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft+=e.vakata.dnd.scroll_spd},n),100)):t.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft-=e.vakata.dnd.scroll_spd},n),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1),t.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop+=e.vakata.dnd.scroll_spd},n),100)):t.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop-=e.vakata.dnd.scroll_spd},n),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",e.proxy(function(){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&i&&a&&(i.hide(),a.hide())},this)).delegate("a","mousedown.jstree",e.proxy(function(e){return 1===e.which?(this.start_drag(e.currentTarget,e),!1):void 0},this)).delegate("a","mouseenter.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_enter(t.currentTarget)},this)).delegate("a","mousemove.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&(n&&n.length&&n.children("a")[0]===t.currentTarget||this.dnd_enter(t.currentTarget),"undefined"==typeof this.data.dnd.off.top&&(this.data.dnd.off=e(t.target).offset()),this.data.dnd.w=(t.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,this.data.dnd.w<0&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",e.proxy(function(t){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){if(t.relatedTarget&&t.relatedTarget.id&&"jstree-marker-line"===t.relatedTarget.id)return!1;i&&i.hide(),a&&a.hide(),this.data.dnd.mto=setTimeout(function(e){return function(){e.dnd_leave(t)}}(this),0)}},this)).delegate("a","mouseup.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_finish(t)},this)),e(document).bind("drag_stop.vakata",e.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,this.data.dnd.off=!1,this.data.dnd.prepared=!1,this.data.dnd.w=!1,this.data.dnd.to1=!1,this.data.dnd.to2=!1,this.data.dnd.i1=!1,this.data.dnd.i2=!1,this.data.dnd.active=!1,this.data.dnd.foreign=!1,i&&i.css({top:"-2000px"}),a&&a.css({top:"-2000px"})},this)).bind("drag_start.vakata",e.proxy(function(t,n){if(n.data.jstree){var i=e(n.event.target);i.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(i)}},this));var r=this._get_settings().dnd;r.drag_target&&e(document).delegate(r.drag_target,"mousedown.jstree-"+this.get_index(),e.proxy(function(n){t=n.target,e.vakata.dnd.drag_start(n,{jstree:!0,obj:n.target},"<ins class='jstree-icon'></ins>"+e(n.target).text()),this.data.themes&&(i&&i.attr("class","jstree-"+this.data.themes.theme),a&&a.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var r=this.get_container();this.data.dnd.cof=r.offset(),this.data.dnd.cw=parseInt(r.width(),10),this.data.dnd.ch=parseInt(r.height(),10),this.data.dnd.foreign=!0,n.preventDefault()},this)),r.drop_target&&e(document).delegate(r.drop_target,"mouseenter.jstree-"+this.get_index(),e.proxy(function(n){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:t,r:e(n.target),e:n})&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(r.drop_target,"mouseleave.jstree-"+this.get_index(),e.proxy(function(){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(r.drop_target,"mouseup.jstree-"+this.get_index(),e.proxy(function(n){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:t,r:e(n.target),e:n})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(){return!0},drop_finish:e.noop,drag_target:".jstree-draggable",drag_finish:e.noop,drag_check:function(){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(n&&n.length){if(this.data.dnd.off=n.offset(),this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+n.width()),this.data.dnd.foreign){var e=this._get_settings().dnd.drag_check.call(this,{o:t,r:n});return this.data.dnd.after=e.after,this.data.dnd.before=e.before,this.data.dnd.inside=e.inside,this.data.dnd.prepared=!0,this.dnd_show()}return this.prepare_move(t,n,"before"),this.data.dnd.before=this.check_move(),this.prepare_move(t,n,"after"),this.data.dnd.after=this.check_move(),this._is_loaded(n)?(this.prepare_move(t,n,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1,this.data.dnd.prepared=!0,this.dnd_show()}},dnd_show:function(){if(this.data.dnd.prepared){var t,n=["before","inside","after"],r=!1,o=this._get_settings().core.rtl;switch(n=this.data.dnd.w<this.data.core.li_height/3?["before","inside","after"]:this.data.dnd.w<=2*this.data.core.li_height/3?this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:["after","inside","before"],e.each(n,e.proxy(function(t,n){return this.data.dnd[n]?(e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),r=n,!1):void 0},this)),r===!1&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),t=o?this.data.dnd.off.right-18:this.data.dnd.off.left+10,r){case"before":i.css({left:t+"px",top:this.data.dnd.off.top-6+"px"}).show(),a&&a.css({left:t+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case"after":i.css({left:t+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show(),a&&a.css({left:t+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case"inside":i.css({left:t+(o?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show(),a&&a.hide();break;default:i.hide(),a&&a.hide()}return d=r,r}},dnd_open:function(){this.data.dnd.to2=!1,this.open_node(n,e.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(e){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:t,r:n,p:d}):(this.dnd_prepare(),this.move_node(t,n,d,e[this._get_settings().dnd.copy_modifier+"Key"])),t=!1,n=!1,i.hide(),a&&a.hide()},dnd_enter:function(t){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=!1);var i=this._get_settings().dnd;this.data.dnd.prepared=!1,n=this._get_node(t),i.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(e.proxy(this.dnd_prepare,this),i.check_timeout)):this.dnd_prepare(),i.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),n&&n.length&&n.hasClass("jstree-closed")&&(this.data.dnd.to2=setTimeout(e.proxy(this.dnd_open,this),i.open_timeout))):n&&n.length&&n.hasClass("jstree-closed")&&this.dnd_open()},dnd_leave:function(t){this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),i.hide(),a&&a.hide(),n&&n[0]===t.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1))},start_drag:function(n,r){t=this._get_node(n),this.data.ui&&this.is_selected(t)&&(t=this._get_node(null,!0));var o=t.length>1?this._get_string("multiple_selection"):this.get_text(t),s=this.get_container();this._get_settings().core.html_titles||(o=o.replace(/</gi,"&lt;").replace(/>/gi,"&gt;")),e.vakata.dnd.drag_start(r,{jstree:!0,obj:t},"<ins class='jstree-icon'></ins>"+o),this.data.themes&&(i&&i.attr("class","jstree-"+this.data.themes.theme),a&&a.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),this.data.dnd.cof=s.offset(),this.data.dnd.cw=parseInt(s.width(),10),this.data.dnd.ch=parseInt(s.height(),10),this.data.dnd.active=!0}}}),e(function(){var t="#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }";e.vakata.css.add_sheet({str:t,title:"jstree"}),i=e("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(e){return i.hide(),a.hide(),e.preventDefault(),e.stopImmediatePropagation(),!1}).appendTo("body"),a=e("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(e){return n&&n.length?(n.children("a").trigger(e),e.preventDefault(),e.stopImmediatePropagation(),!1):void 0}).bind("mouseleave",function(t){var r=e(t.relatedTarget);return(r.is(".jstree")||0===r.closest(".jstree").length)&&n&&n.length?(n.children("a").trigger(t),i.hide(),a.hide(),t.preventDefault(),t.stopImmediatePropagation(),!1):void 0}).appendTo("body"),e(document).bind("drag_start.vakata",function(e,t){t.data.jstree&&(i.show(),a&&a.show())}),e(document).bind("drag_stop.vakata",function(e,t){t.data.jstree&&(i.hide(),a&&a.hide())})})}(e),function(e){e.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui,this.data.ui&&this.data.checkbox.noui&&(this.select_node=this.deselect_node=this.deselect_all=e.noop,this.get_selected=this.get_checked),this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",e.proxy(function(e,t){this._prepare_checkboxes(t.rslt.obj)},this)).bind("loaded.jstree",e.proxy(function(){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",e.proxy(function(e){return e.preventDefault(),this._get_node(e.target).hasClass("jstree-checked")?this.uncheck_node(e.target):this.check_node(e.target),this.data.ui&&this.data.checkbox.noui?(this.save_selected(),void(this.data.cookies&&this.save_cookie("select_node"))):(e.stopImmediatePropagation(),!1)
},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(e){return["check_"+(e[0].id||Math.ceil(1e4*Math.random())),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(e,t){t.checked&&this.check_node(e,!1)},_prepare_checkboxes:function(t){if(t=t&&-1!=t?this._get_node(t):this.get_container().find("> ul > li"),t!==!1){var n,i,a=this,r=this._get_settings().checkbox.two_state,o=this._get_settings().checkbox.real_checkboxes,s=this._get_settings().checkbox.real_checkboxes_names;t.each(function(){i=e(this),n=i.is("li")&&(i.hasClass("jstree-checked")||o&&i.children(":checked").length)?"jstree-checked":"jstree-unchecked",i.find("li").andSelf().each(function(){var t,i=e(this);i.children("a"+(a.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(r?"jstree-unchecked":n),o&&(i.children(":checkbox").length?i.children(":checkbox").addClass("jstree-real-checkbox"):(t=s.call(a,i),i.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+t[0]+"' name='"+t[0]+"' value='"+t[1]+"' />")),"jstree-checked"===n&&i.children(":checkbox").attr("checked","checked")),"jstree-checked"!==n||r||i.find("li").addClass("jstree-checked")})}),r||(1===t.length&&t.is("li")&&this._repair_state(t),t.is("li")?t.each(function(){a._repair_state(this)}):t.find("> ul > li").each(function(){a._repair_state(this)}),t.find(".jstree-checked").parent().parent().each(function(){a._repair_state(this)}))}},change_state:function(t,n){t=this._get_node(t);var i=!1,a=this._get_settings().checkbox.real_checkboxes;if(!t||-1===t)return!1;if(n=n===!1||n===!0?n:t.hasClass("jstree-checked"),this._get_settings().checkbox.two_state)n?(t.removeClass("jstree-checked").addClass("jstree-unchecked"),a&&t.children(":checkbox").removeAttr("checked")):(t.removeClass("jstree-unchecked").addClass("jstree-checked"),a&&t.children(":checkbox").attr("checked","checked"));else{if(n){if(i=t.find("li").andSelf(),!i.filter(".jstree-checked, .jstree-undetermined").length)return!1;i.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),a&&i.children(":checkbox").removeAttr("checked")}else{if(i=t.find("li").andSelf(),!i.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;i.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),a&&i.children(":checkbox").attr("checked","checked"),this.data.ui&&(this.data.ui.last_selected=t),this.data.checkbox.last_selected=t}t.parentsUntil(".jstree","li").each(function(){var t=e(this);if(n){if(t.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return t.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),a&&t.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"),!1;t.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),a&&t.children(":checkbox").removeAttr("checked")}else{if(t.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return t.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),a&&t.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"),!1;t.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),a&&t.children(":checkbox").attr("checked","checked")}})}return this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked()),this.__callback(t),!0},check_node:function(e){if(this.change_state(e,!1)){if(e=this._get_node(e),this._get_settings().checkbox.checked_parent_open){var t=this;e.parents(".jstree-closed").each(function(){t.open_node(this,!1,!0)})}this.__callback({obj:e})}},uncheck_node:function(e){this.change_state(e,!0)&&this.__callback({obj:this._get_node(e)})},check_all:function(){var e=this,t=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");t.each(function(){e.change_state(this,!1)}),this.__callback()},uncheck_all:function(){var e=this,t=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");t.each(function(){e.change_state(this,!0)}),this.__callback()},is_checked:function(e){return e=this._get_node(e),e.length?e.is(".jstree-checked"):!1},get_checked:function(e,t){return e=e&&-1!==e?this._get_node(e):this.get_container(),e.find(t||this._get_settings().checkbox.two_state?".jstree-checked":"> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(e,t){return e=e&&-1!==e?this._get_node(e):this.get_container(),e.find(t||this._get_settings().checkbox.two_state?".jstree-unchecked":"> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(e){if(e=this._get_node(e),e.length){var t=this._get_settings().checkbox.real_checkboxes,n=e.find("> ul > .jstree-checked").length,i=e.find("> ul > .jstree-undetermined").length,a=e.find("> ul > li").length;0===a?e.hasClass("jstree-undetermined")&&this.change_state(e,!1):0===n&&0===i?this.change_state(e,!0):n===a?this.change_state(e,!1):(e.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),t&&e.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"))}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var t=this,n=this.data.ui.to_select;n=e.map(e.makeArray(n),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.deselect_all(),e.each(n,function(e,n){t.check_node(n)}),this.__callback()}else this.__call_old()},save_loaded:function(){var e=this;this.data.core.to_load=[],this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&e.data.core.to_load.push("#"+this.id)})}}}),e(function(){var t=".jstree .jstree-real-checkbox { display:none; } ";e.vakata.css.add_sheet({str:t,title:"jstree"})})}(e),function(e){e.vakata.xslt=function(t,n,i){var a,r,o,s,l="";return document.recalc?(a=document.createElement("xml"),r=document.createElement("xml"),a.innerHTML=t,r.innerHTML=n,e("body").append(a).append(r),setTimeout(function(t,n,i){return function(){i.call(null,t.transformNode(n.XMLDocument)),setTimeout(function(t,n){return function(){e(t).remove(),e(n).remove()}}(t,n),200)}}(a,r,i),100),!0):("undefined"!=typeof window.DOMParser&&"undefined"!=typeof window.XMLHttpRequest&&"undefined"==typeof window.XSLTProcessor&&(t=(new DOMParser).parseFromString(t,"text/xml"),n=(new DOMParser).parseFromString(n,"text/xml")),"undefined"!=typeof window.DOMParser&&"undefined"!=typeof window.XMLHttpRequest&&"undefined"!=typeof window.XSLTProcessor?(o=new XSLTProcessor,(s=e.isFunction(o.transformDocument)?"undefined"!=typeof window.XMLSerializer:!0)?(t=(new DOMParser).parseFromString(t,"text/xml"),n=(new DOMParser).parseFromString(n,"text/xml"),e.isFunction(o.transformDocument)?(l=document.implementation.createDocument("","",null),o.transformDocument(t,n,l,null),i.call(null,(new XMLSerializer).serializeToString(l)),!0):(o.importStylesheet(n),l=o.transformToFragment(t,document),i.call(null,e("<div />").append(l).html()),!0)):!1):!1)};var t={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:attribute name="class">				<xsl:if test="position() = last()">jstree-last </xsl:if>				<xsl:choose>					<xsl:when test="@state = \'open\'">jstree-open </xsl:when>					<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>					<xsl:otherwise>jstree-leaf </xsl:otherwise>				</xsl:choose>				<xsl:value-of select="@class" />			</xsl:attribute>			<xsl:for-each select="@*">				<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>				</xsl:if>			</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>			<xsl:for-each select="content/name">				<a>				<xsl:attribute name="href">					<xsl:choose>					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>					<xsl:otherwise>#</xsl:otherwise>					</xsl:choose>				</xsl:attribute>				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>				<xsl:for-each select="@*">					<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>					</xsl:if>				</xsl:for-each>					<ins>						<xsl:attribute name="class">jstree-icon 							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>						</xsl:attribute>						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>						<xsl:text>&#xa0;</xsl:text>					</ins>					<xsl:copy-of select="./child::node()" />				</a>			</xsl:for-each>			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />			<xsl:with-param name="is_last" select="number(position() = last())" />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:param name="is_last" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>	<xsl:attribute name="class">		<xsl:if test="$is_last = true()">jstree-last </xsl:if>		<xsl:choose>			<xsl:when test="@state = \'open\'">jstree-open </xsl:when>			<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>			<xsl:otherwise>jstree-leaf </xsl:otherwise>		</xsl:choose>		<xsl:value-of select="@class" />	</xsl:attribute>	<xsl:for-each select="@*">		<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>		</xsl:if>	</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>	<xsl:for-each select="content/name">		<a>		<xsl:attribute name="href">			<xsl:choose>			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>			<xsl:otherwise>#</xsl:otherwise>			</xsl:choose>		</xsl:attribute>		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>		<xsl:for-each select="@*">			<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>			<ins>				<xsl:attribute name="class">jstree-icon 					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>				</xsl:attribute>				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>				<xsl:text>&#xa0;</xsl:text>			</ins>			<xsl:copy-of select="./child::node()" />		</a>	</xsl:for-each>	<xsl:if test="$children">		<ul>		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">			<xsl:call-template name="nodes">				<xsl:with-param name="node" select="." />				<xsl:with-param name="is_last" select="number(position() = last())" />			</xsl:call-template>		</xsl:for-each>		</ul>	</xsl:if>	</li></xsl:template></xsl:stylesheet>'},n=function(e){return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};e.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(e,t,n){var i=this;this.load_node_xml(e,function(){i.__callback({obj:i._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){var n=this._get_settings().xml_data;return t=this._get_node(t),-1==t||!t||!n.ajax&&!e.isFunction(n.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").size()>0},load_node_xml:function(t,n,i){var a=this.get_settings().xml_data,r=function(){},o=function(){};if(t=this._get_node(t),t&&-1!==t){if(t.data("jstree-is-loading"))return;t.data("jstree-is-loading",!0)}switch(!0){case!a.data&&!a.ajax:throw"Neither data nor ajax settings supplied.";case e.isFunction(a.data):a.data.call(this,t,e.proxy(function(i){this.parse_xml(i,e.proxy(function(i){i&&(i=i.replace(/ ?xmlns="[^"]*"/gi,""),i.length>10?(i=e(i),-1!==t&&t?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(i),t.removeData("jstree-is-loading")):this.get_container().children("ul").empty().append(i.children()),a.clean_node&&this.clean_node(t),n&&n.call(this)):t&&-1!==t?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading"),a.correct_state&&(this.correct_state(t),n&&n.call(this))):a.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)))},this))},this));break;case!!a.data&&!a.ajax||!!a.data&&!!a.ajax&&(!t||-1===t):t&&-1!=t||this.parse_xml(a.data,e.proxy(function(i){i?(i=i.replace(/ ?xmlns="[^"]*"/gi,""),i.length>10&&(i=e(i),this.get_container().children("ul").empty().append(i.children()),a.clean_node&&this.clean_node(t),n&&n.call(this))):a.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},this));break;case!a.data&&!!a.ajax||!!a.data&&!!a.ajax&&t&&-1!==t:r=function(e,n,r){var o=this.get_settings().xml_data.ajax.error;o&&o.call(this,e,n,r),-1!==t&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading"),"success"===n&&a.correct_state&&this.correct_state(t)):"success"===n&&a.correct_state&&this.get_container().children("ul").empty(),i&&i.call(this)},o=function(i,o,s){i=s.responseText;var l=this.get_settings().xml_data.ajax.success;return l&&(i=l.call(this,i,o,s)||i),""===i||i&&i.toString&&""===i.toString().replace(/^[\s\n]+$/,"")?r.call(this,s,o,""):void this.parse_xml(i,e.proxy(function(i){i&&(i=i.replace(/ ?xmlns="[^"]*"/gi,""),i.length>10?(i=e(i),-1!==t&&t?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(i),t.removeData("jstree-is-loading")):this.get_container().children("ul").empty().append(i.children()),a.clean_node&&this.clean_node(t),n&&n.call(this)):t&&-1!==t?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading"),a.correct_state&&(this.correct_state(t),n&&n.call(this))):a.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)))},this))},a.ajax.context=this,a.ajax.error=r,a.ajax.success=o,a.ajax.dataType||(a.ajax.dataType="xml"),e.isFunction(a.ajax.url)&&(a.ajax.url=a.ajax.url.call(this,t)),e.isFunction(a.ajax.data)&&(a.ajax.data=a.ajax.data.call(this,t)),e.ajax(a.ajax)}},parse_xml:function(n,i){var a=this._get_settings().xml_data;e.vakata.xslt(n,t[a.xsl],i)},get_xml:function(t,i,a,r,o){var s,l,d,c,u,h="",p=this._get_settings(),f=this;return t||(t="flat"),o||(o=0),i=this._get_node(i),i&&-1!==i||(i=this.get_container().find("> ul > li")),a=e.isArray(a)?a:["id","class"],!o&&this.data.types&&-1===e.inArray(p.types.type_attr,a)&&a.push(p.types.type_attr),r=e.isArray(r)?r:[],o||(p.xml_data.get_include_preamble&&(h+='<?xml version="1.0" encoding="UTF-8"?>'),h+="<root>"),i.each(function(){h+="<item",d=e(this),e.each(a,function(e,t){var i=d.attr(t);p.xml_data.get_skip_empty&&"undefined"==typeof i||(h+=" "+t+'="'+n((" "+(i||"")).replace(/ jstree[^ ]*/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,""))+'"')}),d.hasClass("jstree-open")&&(h+=' state="open"'),d.hasClass("jstree-closed")&&(h+=' state="closed"'),"flat"===t&&(h+=' parent_id="'+n(o)+'"'),h+=">",h+="<content>",c=d.children("a"),c.each(function(){s=e(this),u=!1,h+="<name",-1!==e.inArray("languages",p.plugins)&&e.each(p.languages,function(e,t){return s.hasClass(t)?(h+=' lang="'+n(t)+'"',u=t,!1):void 0}),r.length&&e.each(r,function(e,t){var i=s.attr(t);p.xml_data.get_skip_empty&&"undefined"==typeof i||(h+=" "+t+'="'+n((" "+i||"").replace(/ jstree[^ ]*/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,""))+'"')}),s.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").replace(/^\s+$/gi,"").length&&(h+=' icon="'+n(s.children("ins").get(0).className.replace(/jstree[^ ]*|$/gi,"").replace(/\s+$/gi," ").replace(/^ /,"").replace(/ $/,""))+'"'),s.children("ins").get(0).style.backgroundImage.length&&(h+=' icon="'+n(s.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/gi,"").replace(/"/gi,""))+'"'),h+=">",h+="<![CDATA["+f.get_text(s,u)+"]]>",h+="</name>"}),h+="</content>",l=d[0].id||!0,d=d.find("> ul > li"),l=d.length?f.get_xml(t,d,a,r,l):"","nest"==t&&(h+=l),h+="</item>","flat"==t&&(h+=l)}),o||(h+="</root>"),h}}})}(e),function(e){e.expr[":"].jstree_contains=function(e,t,n){return(e.textContent||e.innerText||"").toLowerCase().indexOf(n[3].toLowerCase())>=0},e.expr[":"].jstree_title_contains=function(e,t,n){return(e.getAttribute("title")||"").toLowerCase().indexOf(n[3].toLowerCase())>=0},e.jstree.plugin("search",{__init:function(){this.data.search.str="",this.data.search.result=e(),this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",function(t,n){e(this).children("ul").find("li").hide().removeClass("jstree-last"),n.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){e(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){e(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(t,n){if(""===e.trim(t))return void this.clear_search();var i=this.get_settings().search,a=this,r=function(){},o=function(){};return this.data.search.str=t,!n&&i.ajax!==!1&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0?(this.search.supress_callback=!0,r=function(){},o=function(e,t,n){var i=this.get_settings().search.ajax.success;i&&(e=i.call(this,e,t,n)||e),this.data.search.to_open=e,this._search_open()},i.ajax.context=this,i.ajax.error=r,i.ajax.success=o,e.isFunction(i.ajax.url)&&(i.ajax.url=i.ajax.url.call(this,t)),e.isFunction(i.ajax.data)&&(i.ajax.data=i.ajax.data.call(this,t)),i.ajax.data||(i.ajax.data={search_string:t}),(!i.ajax.dataType||/^json/.exec(i.ajax.dataType))&&(i.ajax.dataType="json"),void e.ajax(i.ajax)):(this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+i.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){a.open_node(this,!1,!0)}),void this.__callback({nodes:this.data.search.result,str:t}))},clear_search:function(){this.data.search.result.removeClass("jstree-search"),this.__callback(this.data.search.result),this.data.search.result=e()},_search_open:function(){var t=this,n=!0,i=[],a=[];this.data.search.to_open.length&&(e.each(this.data.search.to_open,function(t,n){return"#"==n?!0:void(e(n).length&&e(n).is(".jstree-closed")?i.push(n):a.push(n))}),i.length&&(this.data.search.to_open=a,e.each(i,function(e,n){t.open_node(n,function(){t._search_open(!0)})}),n=!1)),n&&this.search(this.data.search.str,!0)}}})}(e),function(e){e.vakata.context={hide_on_mouseleave:!1,cnt:e("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(t,n,i,a,r,o,s){e.vakata.context.rtl=!!s;var l,d,c=e.vakata.context.parse(t);c&&(e.vakata.context.vis=!0,e.vakata.context.tgt=n,e.vakata.context.par=o||n||null,e.vakata.context.data=r||null,e.vakata.context.cnt.html(c).css({visibility:"hidden",display:"block",left:0,top:0}),e.vakata.context.hide_on_mouseleave&&e.vakata.context.cnt.one("mouseleave",function(){e.vakata.context.hide()}),l=e.vakata.context.cnt.height(),d=e.vakata.context.cnt.width(),i+d>e(document).width()&&(i=e(document).width()-(d+5),e.vakata.context.cnt.find("li > ul").addClass("right")),a+l>e(document).height()&&(a-=l+n[0].offsetHeight,e.vakata.context.cnt.find("li > ul").addClass("bottom")),e.vakata.context.cnt.css({left:i,top:a}).find("li:has(ul)").bind("mouseenter",function(){var t=e(document).width(),n=e(document).height(),i=e(this).children("ul").show();t!==e(document).width()&&i.toggleClass("right"),n!==e(document).height()&&i.toggleClass("bottom")}).bind("mouseleave",function(){e(this).children("ul").hide()}).end().css({visibility:"visible"}).show(),e(document).triggerHandler("context_show.vakata"))},hide:function(){e.vakata.context.vis=!1,e.vakata.context.cnt.attr("class","").css({visibility:"hidden"}),e(document).triggerHandler("context_hide.vakata")},parse:function(t,n){if(!t)return!1;var i="",a=!1,r=!0;return n||(e.vakata.context.func={}),i+="<ul>",e.each(t,function(t,n){return n?(e.vakata.context.func[t]=n.action,!r&&n.separator_before&&(i+="<li class='vakata-separator vakata-separator-before'></li>"),r=!1,i+="<li class='"+(n._class||"")+(n._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ",n.icon&&-1===n.icon.indexOf("/")&&(i+=" class='"+n.icon+"' "),n.icon&&-1!==n.icon.indexOf("/")&&(i+=" style='background:url("+n.icon+") center center no-repeat;' "),i+=">&#160;</ins><a href='#' rel='"+t+"'>",n.submenu&&(i+="<span style='float:"+(e.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"),i+=n.label+"</a>",n.submenu&&(a=e.vakata.context.parse(n.submenu,!0),a&&(i+=a)),i+="</li>",void(n.separator_after&&(i+="<li class='vakata-separator vakata-separator-after'></li>",r=!0))):!0}),i=i.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,""),i+="</ul>",e(document).triggerHandler("context_parse.vakata"),i.length>10?i:!1},exec:function(t){return e.isFunction(e.vakata.context.func[t])?(e.vakata.context.func[t].call(e.vakata.context.data,e.vakata.context.par),!0):!1}},e(function(){var t="#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";e.vakata.css.add_sheet({str:t,title:"vakata"}),e.vakata.context.cnt.delegate("a","click",function(e){e.preventDefault()}).delegate("a","mouseup",function(){!e(this).parent().hasClass("jstree-contextmenu-disabled")&&e.vakata.context.exec(e(this).attr("rel"))?e.vakata.context.hide():e(this).blur()}).delegate("a","mouseover",function(){e.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body"),e(document).bind("mousedown",function(t){e.vakata.context.vis&&!e.contains(e.vakata.context.cnt[0],t.target)&&e.vakata.context.hide()}),"undefined"!=typeof e.hotkeys&&e(document).bind("keydown","up",function(t){if(e.vakata.context.vis){var n=e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();n.length||(n=e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()),n.addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault()}}).bind("keydown","down",function(t){if(e.vakata.context.vis){var n=e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();n.length||(n=e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()),n.addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault()}}).bind("keydown","right",function(t){e.vakata.context.vis&&(e.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","left",function(t){e.vakata.context.vis&&(e.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","esc",function(t){e.vakata.context.hide(),t.preventDefault()}).bind("keydown","space",function(t){e.vakata.context.cnt.find(".vakata-hover").last().children("a").click(),t.preventDefault()})}),e.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",e.proxy(function(t){t.preventDefault(),e(t.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(t.currentTarget,t.pageX,t.pageY)},this)).delegate("a","click.jstree",e.proxy(function(){this.data.contextmenu&&e.vakata.context.hide()},this)).bind("destroy.jstree",e.proxy(function(){this.data.contextmenu&&e.vakata.context.hide()},this)),e(document).bind("context_hide.vakata",e.proxy(function(){this.data.contextmenu=!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(e){this.create(e)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(e){this.rename(e)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(e){this.is_selected(e)?this.remove():this.remove(e)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(e){this.cut(e)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(e){this.copy(e)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(e){this.paste(e)}}}}}},_fn:{show_contextmenu:function(t,n,i){t=this._get_node(t);var a=this.get_settings().contextmenu,r=t.children("a:visible:eq(0)"),o=!1,s=!1;a.select_node&&this.data.ui&&!this.is_selected(t)&&(this.deselect_all(),this.select_node(t,!0)),(a.show_at_node||"undefined"==typeof n||"undefined"==typeof i)&&(o=r.offset(),n=o.left,i=o.top+this.data.core.li_height),s=t.data("jstree")&&t.data("jstree").contextmenu?t.data("jstree").contextmenu:a.items,e.isFunction(s)&&(s=s.call(this,t)),this.data.contextmenu=!0,e.vakata.context.show(s,r,n,i,this,t,this._get_settings().core.rtl),this.data.themes&&e.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})}(e),function(e){e.jstree.plugin("types",{__init:function(){var n=this._get_settings().types;this.data.types.attach_to=[],this.get_container().bind("init.jstree",e.proxy(function(){var t=n.types,i=n.type_attr,a="",r=this;e.each(t,function(t,n){return e.each(n,function(e){/^(max_depth|max_children|icon|valid_children)$/.test(e)||r.data.types.attach_to.push(e)}),n.icon?void((n.icon.image||n.icon.position)&&(a+="default"==t?".jstree-"+r.get_index()+" a > .jstree-icon { ":".jstree-"+r.get_index()+" li["+i+'="'+t+'"] > a > .jstree-icon { ',n.icon.image&&(a+=" background-image:url("+n.icon.image+"); "),a+=n.icon.position?" background-position:"+n.icon.position+"; ":" background-position:0 0; ",a+="} ")):!0}),""!==a&&e.vakata.css.add_sheet({str:a,title:"jstree-types"})},this)).bind("before.jstree",e.proxy(function(t,n){var i,a,r=this._get_settings().types.use_data?this._get_node(n.args[0]):!1,o=r&&-1!==r&&r.length?r.data("jstree"):!1;if(o&&o.types&&o.types[n.func]===!1)return t.stopImmediatePropagation(),!1;if(-1!==e.inArray(n.func,this.data.types.attach_to)){if(!n.args[0]||!n.args[0].tagName&&!n.args[0].jquery)return;if(i=this._get_settings().types.types,a=this._get_type(n.args[0]),(i[a]&&"undefined"!=typeof i[a][n.func]||i["default"]&&"undefined"!=typeof i["default"][n.func])&&this._check(n.func,n.args[0])===!1)return t.stopImmediatePropagation(),!1}},this)),t&&this.get_container().bind("load_node.jstree set_type.jstree",e.proxy(function(t,n){var i=n&&n.rslt&&n.rslt.obj&&-1!==n.rslt.obj?this._get_node(n.rslt.obj).parent():this.get_container_ul(),a=!1,r=this._get_settings().types;e.each(r.types,function(e,t){t.icon&&(t.icon.image||t.icon.position)&&(a=i.find("default"===e?"li > a > .jstree-icon":"li["+r.type_attr+"='"+e+"'] > a > .jstree-icon"),t.icon.image&&a.css("backgroundImage","url("+t.icon.image+")"),a.css("backgroundPosition",t.icon.position||"0 0"))})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(e,t){t.type&&this._get_settings().types.use_data&&this.set_type(t.type,e)},_get_type:function(e){return e=this._get_node(e),e&&e.length?e.attr(this._get_settings().types.type_attr)||"default":!1},set_type:function(e,t){t=this._get_node(t);var n=t.length&&e?t.attr(this._get_settings().types.type_attr,e):!1;return n&&this.__callback({obj:t,type:e}),n},_check:function(t,n,i){n=this._get_node(n);var a=!1,r=this._get_type(n),o=0,s=this,l=this._get_settings().types,d=!1;if(-1===n){if(!l[t])return;a=l[t]}else{if(r===!1)return;d=l.use_data?n.data("jstree"):!1,d&&d.types&&"undefined"!=typeof d.types[t]?a=d.types[t]:l.types[r]&&"undefined"!=typeof l.types[r][t]?a=l.types[r][t]:l.types["default"]&&"undefined"!=typeof l.types["default"][t]&&(a=l.types["default"][t])
}return e.isFunction(a)&&(a=a.call(this,n)),"max_depth"===t&&-1!==n&&i!==!1&&-2!==l.max_depth&&0!==a&&n.children("a:eq(0)").parentsUntil(".jstree","li").each(function(e){return-1!==l.max_depth&&l.max_depth-(e+1)<=0?(a=0,!1):(o=0===e?a:s._check(t,this,!1),-1!==o&&0>=o-(e+1)?(a=0,!1):(o>=0&&(a>o-(e+1)||0>a)&&(a=o-(e+1)),void(l.max_depth>=0&&(l.max_depth-(e+1)<a||0>a)&&(a=l.max_depth-(e+1)))))}),a},check_move:function(){if(!this.__call_old())return!1;var t,n=this._get_move(),i=n.rt._get_settings().types,a=n.rt._check("max_children",n.cr),r=n.rt._check("max_depth",n.cr),o=n.rt._check("valid_children",n.cr),s=0,l=1;if("none"===o)return!1;if(e.isArray(o)&&n.ot&&n.ot._get_type&&(n.o.each(function(){return-1===e.inArray(n.ot._get_type(this),o)?(l=!1,!1):void 0}),l===!1))return!1;if(-2!==i.max_children&&-1!==a&&(s=-1===n.cr?this.get_container().find("> ul > li").not(n.o).length:n.cr.find("> ul > li").not(n.o).length,s+n.o.length>a))return!1;if(-2!==i.max_depth&&-1!==r){if(l=0,0===r)return!1;if("undefined"==typeof n.o.d){for(t=n.o;t.length>0;)t=t.find("> ul > li"),l++;n.o.d=l}if(r-n.o.d<0)return!1}return!0},create_node:function(t,n,i,a,r,o){if(!o&&(r||this._is_loaded(t))){var s,l="string"==typeof n&&n.match(/^before|after$/i)&&-1!==t?this._get_parent(t):this._get_node(t),d=this._get_settings().types,c=this._check("max_children",l),u=this._check("max_depth",l),h=this._check("valid_children",l);if("string"==typeof i&&(i={data:i}),i||(i={}),"none"===h)return!1;if(e.isArray(h))if(i.attr&&i.attr[d.type_attr]){if(-1===e.inArray(i.attr[d.type_attr],h))return!1}else i.attr||(i.attr={}),i.attr[d.type_attr]=h[0];if(-2!==d.max_children&&-1!==c&&(s=-1===l?this.get_container().find("> ul > li").length:l.find("> ul > li").length,s+1>c))return!1;if(-2!==d.max_depth&&-1!==u&&0>u-1)return!1}return this.__call_old(!0,t,n,i,a,r,o)}}})}(e),function(e){e.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0),this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return 3==this.nodeType}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(e,t,n){var i=this;this.load_node_html(e,function(){i.__callback({obj:i._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){return t=this._get_node(t),-1==t||!t||!this._get_settings().html_data.ajax&&!e.isFunction(this._get_settings().html_data.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").size()>0},load_node_html:function(t,n,i){var a,r=this.get_settings().html_data,o=function(){},s=function(){};if(t=this._get_node(t),t&&-1!==t){if(t.data("jstree-is-loading"))return;t.data("jstree-is-loading",!0)}switch(!0){case e.isFunction(r.data):r.data.call(this,t,e.proxy(function(i){i&&""!==i&&i.toString&&""!==i.toString().replace(/^[\s\n]+$/,"")?(i=e(i),i.is("ul")||(i=e("<ul />").append(i)),-1!=t&&t?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(i).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),t.removeData("jstree-is-loading")):this.get_container().children("ul").empty().append(i.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node(t),n&&n.call(this)):t&&-1!==t?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading"),r.correct_state&&(this.correct_state(t),n&&n.call(this))):r.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},this));break;case!r.data&&!r.ajax:t&&-1!=t||(this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node()),n&&n.call(this);break;case!!r.data&&!r.ajax||!!r.data&&!!r.ajax&&(!t||-1===t):t&&-1!=t||(a=e(r.data),a.is("ul")||(a=e("<ul />").append(a)),this.get_container().children("ul").empty().append(a.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node()),n&&n.call(this);break;case!r.data&&!!r.ajax||!!r.data&&!!r.ajax&&t&&-1!==t:t=this._get_node(t),o=function(e,n,a){var o=this.get_settings().html_data.ajax.error;o&&o.call(this,e,n,a),-1!=t&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading"),"success"===n&&r.correct_state&&this.correct_state(t)):"success"===n&&r.correct_state&&this.get_container().children("ul").empty(),i&&i.call(this)},s=function(i,a,s){var l=this.get_settings().html_data.ajax.success;return l&&(i=l.call(this,i,a,s)||i),""===i||i&&i.toString&&""===i.toString().replace(/^[\s\n]+$/,"")?o.call(this,s,a,""):void(i?(i=e(i),i.is("ul")||(i=e("<ul />").append(i)),-1!=t&&t?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(i).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),t.removeData("jstree-is-loading")):this.get_container().children("ul").empty().append(i.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||"INS"!==this.firstChild.tagName}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node(t),n&&n.call(this)):t&&-1!==t?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree-is-loading"),r.correct_state&&(this.correct_state(t),n&&n.call(this))):r.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)))},r.ajax.context=this,r.ajax.error=o,r.ajax.success=s,r.ajax.dataType||(r.ajax.dataType="html"),e.isFunction(r.ajax.url)&&(r.ajax.url=r.ajax.url.call(this,t)),e.isFunction(r.ajax.data)&&(r.ajax.data=r.ajax.data.call(this,t)),e.ajax(r.ajax)}}}}),e.jstree.defaults.plugins.push("html_data")}(e),function(e){e.jstree.plugin("themeroller",{__init:function(){var t=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(n){e(n.currentTarget).hasClass("jstree-loading")||e(this).addClass(t.item_h)}).delegate("a","mouseleave.jstree",function(){e(this).removeClass(t.item_h)}).bind("init.jstree",e.proxy(function(e,t){t.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh"),this._themeroller(t.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",e.proxy(function(){this._themeroller()},this)).bind("close_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.obj)},this)).bind("delete_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.parent)},this)).bind("correct_state.jstree",e.proxy(function(e,n){n.rslt.obj.children("ins.jstree-icon").removeClass(t.opened+" "+t.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return-1===this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")}).removeClass(t.item_open+" "+t.item_clsd).addClass(t.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",e.proxy(function(e,n){n.rslt.obj.children("a").addClass(t.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",e.proxy(function(){this.get_container().find("a."+t.item_a).removeClass(t.item_a).end().find("a.jstree-clicked").addClass(t.item_a)},this)).bind("dehover_node.jstree",e.proxy(function(e,n){n.rslt.obj.children("a").removeClass(t.item_h)},this)).bind("hover_node.jstree",e.proxy(function(e,n){this.get_container().find("a."+t.item_h).not(n.rslt.obj).removeClass(t.item_h),n.rslt.obj.children("a").addClass(t.item_h)},this)).bind("move_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.o),this._themeroller(t.rslt.op)},this))},__destroy:function(){var t=this._get_settings().themeroller,n=["ui-icon"];e.each(t,function(e,t){t=t.split(" "),t.length&&(n=n.concat(t))}),this.get_container().removeClass("ui-widget-content").find("."+n.join(", .")).removeClass(n.join(" "))},_fn:{_themeroller:function(e){var t=this._get_settings().themeroller;e=e&&-1!=e?this._get_node(e).parent():this.get_container_ul(),e.find("li.jstree-closed").children("ins.jstree-icon").removeClass(t.opened).addClass("ui-icon "+t.closed).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")}).removeClass(t.item_leaf+" "+t.item_open).addClass(t.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(t.closed).addClass("ui-icon "+t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")}).removeClass(t.item_leaf+" "+t.item_clsd).addClass(t.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(t.closed+" ui-icon "+t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")}).removeClass(t.item_clsd+" "+t.item_open).addClass(t.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}}),e(function(){var t=".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }";e.vakata.css.add_sheet({str:t,title:"jstree"})})}(e),function(e){e.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",e.proxy(function(t,n){var i,a,r=[],o=!0;return"move_node"==n.func&&n.args[4]===!0&&n.args[0].o&&n.args[0].o.length&&(n.args[0].o.children("a").each(function(){r.push(e(this).text().replace(/^\s+/g,""))}),o=this._check_unique(r,n.args[0].np.find("> ul > li").not(n.args[0].o),"move_node")),"create_node"==n.func&&(n.args[4]||this._is_loaded(n.args[0]))&&(i=this._get_node(n.args[0]),!n.args[1]||"before"!==n.args[1]&&"after"!==n.args[1]||(i=this._get_parent(n.args[0]),i&&-1!==i||(i=this.get_container())),r.push("string"==typeof n.args[2]?n.args[2]:n.args[2]&&n.args[2].data?n.args[2].data:this._get_string("new_node")),o=this._check_unique(r,i.find("> ul > li"),"create_node")),"rename_node"==n.func&&(r.push(n.args[1]),a=this._get_node(n.args[0]),i=this._get_parent(a),i&&-1!==i||(i=this.get_container()),o=this._check_unique(r,i.find("> ul > li").not(a),"rename_node")),o?void 0:(t.stopPropagation(),!1)},this))},defaults:{error_callback:e.noop},_fn:{_check_unique:function(t,n,i){var a=[];return n.children("a").each(function(){a.push(e(this).text().replace(/^\s+/g,""))}),a.length&&t.length?(a=a.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),a.length+t.length!=a.concat(t).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length?(this._get_settings().unique.error_callback.call(null,t,n,i),!1):!0):!0},check_move:function(){if(!this.__call_old())return!1;var t=this._get_move(),n=[];return t.o&&t.o.length?(t.o.children("a").each(function(){n.push(e(this).text().replace(/^\s+/g,""))}),this._check_unique(n,t.np.find("> ul > li").not(t.o),"check_move")):!0}}})}(e),function(e){e.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1,this.data.wholerow.to=!1,this.get_container().bind("init.jstree",e.proxy(function(){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",e.proxy(function(e,t){this._prepare_wholerow_span(t&&t.rslt&&t.rslt.obj?t.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",e.proxy(function(e,t){this.data.to&&clearTimeout(this.data.to),this.data.to=setTimeout(function(e,t){return function(){e._prepare_wholerow_ul(t)}}(this,t&&t.rslt&&t.rslt.obj?t.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",e.proxy(function(){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",e.proxy(function(t,n){n.rslt.obj.each(function(){var t=n.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((e(this).offset().top-n.inst.get_container().offset().top+n.inst.get_container()[0].scrollTop)/n.inst.data.core.li_height,10)+")");t.children("a").attr("class",n.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){if(this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:"")),"hover_node"===e.type){var n=this.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((t.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")");n.children("a").attr("class",t.rslt.obj.children(".jstree-hovered").attr("class"))}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(t){var n=e(t.currentTarget);"A"===t.target.tagName||"INS"===t.target.tagName&&n.closest("li").is(".jstree-open, .jstree-closed")||(n.closest("li").children("a:visible:eq(0)").click(),t.stopImmediatePropagation())}).delegate("li","mouseover.jstree",e.proxy(function(t){return t.stopImmediatePropagation(),e(t.currentTarget).children(".jstree-hovered, .jstree-clicked").length?!1:(this.hover_node(t.currentTarget),!1)},this)).delegate("li","mouseleave.jstree",e.proxy(function(t){e(t.currentTarget).children("a").hasClass("jstree-hovered").length||this.dehover_node(t.currentTarget)},this)),(n||t)&&e.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove(),this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(t){t=t&&-1!=t?this._get_node(t):this.get_container().find("> ul > li"),t!==!1&&t.each(function(){e(this).find("li").andSelf().each(function(){var t=e(this);return t.children(".jstree-wholerow-span").length?!0:void t.prepend("<span class='jstree-wholerow-span' style='width:"+18*t.parentsUntil(".jstree","li").length+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var e=this.get_container().children("ul").eq(0),t=e.html();e.addClass("jstree-wholerow-real"),this.data.wholerow.last_html!==t&&(this.data.wholerow.last_html=t,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(e.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(e.parent()[0].scrollWidth).css("top",-1*(e.height()+(n?5:0))).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}}),e(function(){var a=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";i&&(a+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } "),(n||t)&&(a+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } "),e.vakata.css.add_sheet({str:a,title:"jstree"})})}(e),function(e){var t=["getChildren","getChildrenCount","getAttr","getName","getProps"],n=function(t,n){var i=!0;return t=t||{},n=[].concat(n),e.each(n,function(n,a){return e.isFunction(t[a])?void 0:(i=!1,!1)}),i};e.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(i,a){var r=-1==i?this._get_settings().model.object:i.data("jstree_model");return n(r,t)?void(this._get_settings().model.async?r.getChildren(e.proxy(function(e){this.model_done(e,a)},this)):this.model_done(r.getChildren(),a)):a.call(null,!1)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(t,n){var i=[],a=this._get_settings(),r=this;e.isArray(t)||(t=[t]),e.each(t,function(t,n){var o=n.getProps()||{};o.attr=n.getAttr()||{},n.getChildrenCount()&&(o.state="closed"),o.data=n.getName(),e.isArray(o.data)||(o.data=[o.data]),r.data.types&&e.isFunction(n.getType)&&(o.attr[a.types.type_attr]=n.getType()),o.attr.id&&a.model.id_prefix&&(o.attr.id=a.model.id_prefix+o.attr.id),o.metadata||(o.metadata={}),o.metadata.jstree_model=n,i.push(o)}),n.call(null,i)}}})}(e)}}()}),define("jqgrid",["jquery","jqgrid-locale-"+(window&&window.__DEPS__&&window.__DEPS__.lang||"en"),"jqueryui"],function(jQuery){function tableToGrid(e,t){jQuery(e).each(function(){if(!this.grid){jQuery(this).width("99%");var e=jQuery(this).width(),n=jQuery("input[type=checkbox]:first",jQuery(this)),i=jQuery("input[type=radio]:first",jQuery(this));n=n.length>0,i=!n&&i.length>0;var a=n||i,r=[],o=[];jQuery("th",jQuery(this)).each(function(){0===r.length&&a?(r.push({name:"__selection__",index:"__selection__",width:0,hidden:!0}),o.push("__selection__")):(r.push({name:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),index:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),width:jQuery(this).width()||150}),o.push(jQuery(this).html()))});var s=[],l=[],d=[];for(jQuery("tbody > tr",jQuery(this)).each(function(){var e={},t=0;jQuery("td",jQuery(this)).each(function(){if(0===t&&a){var n=jQuery("input",jQuery(this)),i=n.attr("value");l.push(i||s.length),n.attr("checked")&&d.push(i),e[r[t].name]=n.attr("value")}else e[r[t].name]=jQuery(this).html();t++}),t>0&&s.push(e)}),jQuery(this).empty(),jQuery(this).addClass("scroll"),jQuery(this).jqGrid(jQuery.extend({datatype:"local",width:e,colNames:o,colModel:r,multiselect:n},t||{})),e=0;e<s.length;e++)i=null,l.length>0&&(i=l[e])&&i.replace&&(i=encodeURIComponent(i).replace(/[.\-%]/g,"_")),null===i&&(i=e+1),jQuery(this).jqGrid("addRowData",i,s[e]);for(e=0;e<d.length;e++)jQuery(this).jqGrid("setSelection",d[e])}})}var $=jQuery;!function(b){b.jgrid=b.jgrid||{},b.extend(b.jgrid,{htmlDecode:function(e){return e&&("&nbsp;"==e||"&#160;"==e||1==e.length&&160==e.charCodeAt(0))?"":e?String(e).replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"'):e},htmlEncode:function(e){return e?String(e).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\"/g,"&quot;"):e},format:function(e){var t=b.makeArray(arguments).slice(1);return void 0===e&&(e=""),e.replace(/\{(\d+)\}/g,function(e,n){return t[n]})},getCellIndex:function(e){return e=b(e),e.is("tr")?-1:(e=(e.is("td")||e.is("th")?e:e.closest("td,th"))[0],b.browser.msie?b.inArray(e,e.parentNode.cells):e.cellIndex)},stripHtml:function(e){e+="";var t=/<("[^"]*"|'[^']*'|[^'">])*>/gi;return e?(e=e.replace(t,""))&&"&nbsp;"!==e&&"&#160;"!==e?e.replace(/\"/g,"'"):"":e},stringToDoc:function(e){var t;if("string"!=typeof e)return e;try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(n){t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e)}return t&&t.documentElement&&"parsererror"!=t.documentElement.tagName?t:null},parse:function(f){return"while(1);"==f.substr(0,9)&&(f=f.substr(9)),"/*"==f.substr(0,2)&&(f=f.substr(2,f.length-4)),f||(f="{}"),b.jgrid.useJSON===!0&&"object"==typeof JSON&&"function"==typeof JSON.parse?JSON.parse(f):eval("("+f+")")},parseDate:function(e,t){var n,i,a,r={m:1,d:1,y:1970,h:0,i:0,s:0};if(n=/[\\\/:_;.,\t\T\s-]/,t&&null!==t&&void 0!==t){t=b.trim(t),t=t.split(n),e=e.split(n);var o=b.jgrid.formatter.date.monthNames,s=b.jgrid.formatter.date.AmPm,l=function(e,t){return 0===e?12==t&&(t=0):12!=t&&(t+=12),t};for(n=0,i=e.length;i>n;n++)"M"==e[n]&&(a=b.inArray(t[n],o),-1!==a&&12>a&&(t[n]=a+1)),"F"==e[n]&&(a=b.inArray(t[n],o),-1!==a&&a>11&&(t[n]=a+1-12)),"a"==e[n]&&(a=b.inArray(t[n],s),-1!==a&&2>a&&t[n]==s[a]&&(t[n]=a,r.h=l(t[n],r.h))),"A"==e[n]&&(a=b.inArray(t[n],s),-1!==a&&a>1&&t[n]==s[a]&&(t[n]=a-2,r.h=l(t[n],r.h))),void 0!==t[n]&&(r[e[n].toLowerCase()]=parseInt(t[n],10));r.m=parseInt(r.m,10)-1,n=r.y,n>=70&&99>=n?r.y=1900+r.y:n>=0&&69>=n&&(r.y=2e3+r.y)}return new Date(r.y,r.m,r.d,r.h,r.i,r.s,0)},jqID:function(e){return e+="",e.replace(/([\.\:\[\]])/g,"\\$1")},guid:1,uidPref:"jqg",randId:function(e){return(e?e:b.jgrid.uidPref)+b.jgrid.guid++},getAccessor:function(e,t){var n,i,a,r=[];if("function"==typeof t)return t(e);if(n=e[t],void 0===n)try{if("string"==typeof t&&(r=t.split(".")),a=r.length)for(n=e;n&&a--;)i=r.shift(),n=n[i]}catch(o){}return n},ajaxOptions:{},from:function(f){return new function(j,h){"string"==typeof j&&(j=b.data(j));var c=this,g=j,k=!0,l=!1,a=h,r=/[\$,%]/g,v=null,z=null,E=!1,P="",K=[],O=!0;if("object"!=typeof j||!j.push)throw"data provides is not an array";return j.length>0&&(O="object"!=typeof j[0]?!1:!0),this._hasData=function(){return null===g?!1:0===g.length?!1:!0},this._getStr=function(e){var t=[];return l&&t.push("jQuery.trim("),t.push("String("+e+")"),l&&t.push(")"),k||t.push(".toLowerCase()"),t.join("")},this._strComp=function(e){return"string"==typeof e?".toString()":""},this._group=function(e,t){return{field:e.toString(),unique:t,items:[]}},this._toStr=function(e){return l&&(e=b.trim(e)),k||(e=e.toLowerCase()),e=e.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"')},this._funcLoop=function(e){var t=[];return b.each(g,function(n,i){t.push(e(i))}),t},this._append=function(e){null===a?a="":a+=""===P?" && ":P,E&&(a+="!"),a+="("+e+")",E=!1,P=""},this._setCommand=function(e,t){v=e,z=t},this._resetNegate=function(){E=!1},this._repeatCommand=function(e,t){return null===v?c:null!==e&&null!==t?v(e,t):null===z?v(e):O?v(z,e):v(e)},this._equals=function(e,t){return 0===c._compare(e,t,1)},this._compare=function(e,t,n){return void 0===n&&(n=1),void 0===e&&(e=null),void 0===t&&(t=null),null===e&&null===t?0:null===e&&null!==t?1:null!==e&&null===t?-1:(k||"number"==typeof e||"number"==typeof t||(e=String(e).toLowerCase(),t=String(t).toLowerCase()),t>e?-n:e>t?n:0)},this._performSort=function(){0!==K.length&&(g=c._doSort(g,0))},this._doSort=function(e,t){var n=K[t].by,i=K[t].dir,a=K[t].type,r=K[t].datefmt;if(t==K.length-1)return c._getOrder(e,n,i,a,r);for(t++,n=c._getGroup(e,n,i,a,r),i=[],a=0;a<n.length;a++){r=c._doSort(n[a].items,t);for(var o=0;o<r.length;o++)i.push(r[o])}return i},this._getOrder=function(e,t,n,i,a){var o,s,l=[],d=[],u="a"==n?1:-1;void 0===i&&(i="text"),s="float"==i||"number"==i||"currency"==i||"numeric"==i?function(e){return e=parseFloat(String(e).replace(r,"")),isNaN(e)?0:e}:"int"==i||"integer"==i?function(e){return e?parseFloat(String(e).replace(r,"")):0}:"date"==i||"datetime"==i?function(e){return b.jgrid.parseDate(a,e).getTime()}:b.isFunction(i)?i:function(e){return e||(e=""),b.trim(String(e).toUpperCase())},b.each(e,function(e,n){o=""!==t?b.jgrid.getAccessor(n,t):n,void 0===o&&(o=""),o=s(o,n),d.push({vSort:o,index:e})}),d.sort(function(e,t){return e=e.vSort,t=t.vSort,c._compare(e,t,u)}),i=0;for(var h=e.length;h>i;)n=d[i].index,l.push(e[n]),i++;return l},this._getGroup=function(e,t,n,i,a){var r,o=[],s=null,l=null;return b.each(c._getOrder(e,t,n,i,a),function(e,n){r=b.jgrid.getAccessor(n,t),void 0===r&&(r=""),c._equals(l,r)||(l=r,null!==s&&o.push(s),s=c._group(t,r)),s.items.push(n)}),null!==s&&o.push(s),o},this.ignoreCase=function(){return k=!1,c},this.useCase=function(){return k=!0,c},this.trim=function(){return l=!0,c},this.noTrim=function(){return l=!1,c},this.execute=function(){var m=a,o=[];return null===m?c:(b.each(g,function(){eval(m)&&o.push(this)}),g=o,c)},this.data=function(){return g},this.select=function(e){if(c._performSort(),!c._hasData())return[];if(c.execute(),b.isFunction(e)){var t=[];return b.each(g,function(n,i){t.push(e(i))}),t}return g},this.hasMatch=function(){return c._hasData()?(c.execute(),g.length>0):!1},this.andNot=function(e,t,n){return E=!E,c.and(e,t,n)},this.orNot=function(e,t,n){return E=!E,c.or(e,t,n)},this.not=function(e,t,n){return c.andNot(e,t,n)},this.and=function(e,t,n){return P=" && ",void 0===e?c:c._repeatCommand(e,t,n)},this.or=function(e,t,n){return P=" || ",void 0===e?c:c._repeatCommand(e,t,n)},this.isNot=function(e){return E=!E,c.is(e)},this.is=function(e){return c._append("this."+e),c._resetNegate(),c},this._compareValues=function(e,t,n,i,a){var o;o=O?"jQuery.jgrid.getAccessor(this,'"+t+"')":"this",void 0===n&&(n=null);var s=n,l=void 0===a.stype?"text":a.stype;if(null!==n)switch(l){case"int":case"integer":s=isNaN(Number(s))||""===s?"0":s,o="parseInt("+o+",10)",s="parseInt("+s+",10)";break;case"float":case"number":case"numeric":s=String(s).replace(r,""),s=isNaN(Number(s))||""===s?"0":s,o="parseFloat("+o+")",s="parseFloat("+s+")";break;case"date":case"datetime":s=String(b.jgrid.parseDate(a.newfmt||"Y-m-d",s).getTime()),o='jQuery.jgrid.parseDate("'+a.srcfmt+'",'+o+").getTime()";break;default:o=c._getStr(o),s=c._getStr('"'+c._toStr(s)+'"')}return c._append(o+" "+i+" "+s),c._setCommand(e,t),c._resetNegate(),c},this.equals=function(e,t,n){return c._compareValues(c.equals,e,t,"==",n)},this.notEquals=function(e,t,n){return c._compareValues(c.equals,e,t,"!==",n)},this.isNull=function(e,t,n){return c._compareValues(c.equals,e,null,"===",n)},this.greater=function(e,t,n){return c._compareValues(c.greater,e,t,">",n)},this.less=function(e,t,n){return c._compareValues(c.less,e,t,"<",n)},this.greaterOrEquals=function(e,t,n){return c._compareValues(c.greaterOrEquals,e,t,">=",n)},this.lessOrEquals=function(e,t,n){return c._compareValues(c.lessOrEquals,e,t,"<=",n)},this.startsWith=function(e,t){var n=void 0===t||null===t?e:t;return n=l?b.trim(n.toString()).length:n.toString().length,O?c._append(c._getStr("jQuery.jgrid.getAccessor(this,'"+e+"')")+".substr(0,"+n+") == "+c._getStr('"'+c._toStr(t)+'"')):(n=l?b.trim(t.toString()).length:t.toString().length,c._append(c._getStr("this")+".substr(0,"+n+") == "+c._getStr('"'+c._toStr(e)+'"'))),c._setCommand(c.startsWith,e),c._resetNegate(),c},this.endsWith=function(e,t){var n=void 0===t||null===t?e:t;return n=l?b.trim(n.toString()).length:n.toString().length,c._append(O?c._getStr("jQuery.jgrid.getAccessor(this,'"+e+"')")+".substr("+c._getStr("jQuery.jgrid.getAccessor(this,'"+e+"')")+".length-"+n+","+n+') == "'+c._toStr(t)+'"':c._getStr("this")+".substr("+c._getStr("this")+'.length-"'+c._toStr(e)+'".length,"'+c._toStr(e)+'".length) == "'+c._toStr(e)+'"'),c._setCommand(c.endsWith,e),c._resetNegate(),c},this.contains=function(e,t){return c._append(O?c._getStr("jQuery.jgrid.getAccessor(this,'"+e+"')")+'.indexOf("'+c._toStr(t)+'",0) > -1':c._getStr("this")+'.indexOf("'+c._toStr(e)+'",0) > -1'),c._setCommand(c.contains,e),c._resetNegate(),c},this.groupBy=function(e,t,n,i){return c._hasData()?c._getGroup(g,e,t,n,i):null},this.orderBy=function(e,t,n,i){return t=void 0===t||null===t?"a":b.trim(t.toString().toLowerCase()),(null===n||void 0===n)&&(n="text"),(null===i||void 0===i)&&(i="Y-m-d"),("desc"==t||"descending"==t)&&(t="d"),("asc"==t||"ascending"==t)&&(t="a"),K.push({by:e,dir:t,type:n,datefmt:i}),c},c}(f,null)},extend:function(e){b.extend(b.fn.jqGrid,e),this.no_legacy_api||b.fn.extend(e)}}),b.fn.jqGrid=function(e){if("string"==typeof e){var t=b.jgrid.getAccessor(b.fn.jqGrid,e);if(!t)throw"jqGrid - No such method: "+e;var n=b.makeArray(arguments).slice(1);return t.apply(this,n)}return this.each(function(){if(!this.grid){var t=b.extend(!0,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:!0,pginput:!0,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:!1,selarrrow:[],savedRow:[],shrinkToFit:!0,xmlReader:{},jsonReader:{},subGrid:!1,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,onHeaderClick:null,viewrecords:!1,loadonce:!1,multiselect:!1,multikey:!1,editurl:null,search:!1,caption:"",hidegrid:!0,hiddengrid:!1,postData:{},userData:{},treeGrid:!1,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:!1,gridstate:"visible",cellEdit:!1,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[!1,""],scroll:!1,multiboxonly:!1,deselectAfterSort:!0,scrollrows:!1,autowidth:!1,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:!1,rownumWidth:25,rownumbers:!1,pagerpos:"center",recordpos:"right",footerrow:!1,userDataOnFooter:!1,hoverrows:!0,altclass:"ui-priority-secondary",viewsortcols:[!1,"vertical",!0],resizeclass:"",autoencode:!1,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:!1,headertitles:!1,scrollTimeout:40,data:[],_index:{},grouping:!1,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:!1,sortitems:[],sortnames:[],groupDataSorted:!1,summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus"},ignoreCase:!1,cmTemplate:{}},b.jgrid.defaults,e||{}),n={headers:[],cols:[],footers:[],dragStart:function(e,n,i){this.resizing={idx:e,startX:n.clientX,sOL:i[0]},this.hDiv.style.cursor="col-resize",this.curGbox=b("#rs_m"+b.jgrid.jqID(t.id),"#gbox_"+b.jgrid.jqID(t.id)),this.curGbox.css({display:"block",left:i[0],top:i[1],height:i[2]}),b.isFunction(t.resizeStart)&&t.resizeStart.call(this,n,e),document.onselectstart=function(){return!1
}},dragMove:function(e){if(this.resizing){var n=e.clientX-this.resizing.startX;e=this.headers[this.resizing.idx];var i,a="ltr"===t.direction?e.width+n:e.width-n;a>33&&(this.curGbox.css({left:this.resizing.sOL+n}),t.forceFit===!0?(i=this.headers[this.resizing.idx+t.nv],n="ltr"===t.direction?i.width-n:i.width+n,n>33&&(e.newWidth=a,i.newWidth=n)):(this.newWidth="ltr"===t.direction?t.tblwidth+n:t.tblwidth-n,e.newWidth=a))}},dragEnd:function(){if(this.hDiv.style.cursor="default",this.resizing){var e=this.resizing.idx,n=this.headers[e].newWidth||this.headers[e].width;n=parseInt(n,10),this.resizing=!1,b("#rs_m"+b.jgrid.jqID(t.id)).css("display","none"),t.colModel[e].width=n,this.headers[e].width=n,this.headers[e].el.style.width=n+"px",this.cols[e].style.width=n+"px",this.footers.length>0&&(this.footers[e].style.width=n+"px"),t.forceFit===!0?(n=this.headers[e+t.nv].newWidth||this.headers[e+t.nv].width,this.headers[e+t.nv].width=n,this.headers[e+t.nv].el.style.width=n+"px",this.cols[e+t.nv].style.width=n+"px",this.footers.length>0&&(this.footers[e+t.nv].style.width=n+"px"),t.colModel[e+t.nv].width=n):(t.tblwidth=this.newWidth||t.tblwidth,b("table:first",this.bDiv).css("width",t.tblwidth+"px"),b("table:first",this.hDiv).css("width",t.tblwidth+"px"),this.hDiv.scrollLeft=this.bDiv.scrollLeft,t.footerrow&&(b("table:first",this.sDiv).css("width",t.tblwidth+"px"),this.sDiv.scrollLeft=this.bDiv.scrollLeft)),b.isFunction(t.resizeStop)&&t.resizeStop.call(this,n,e)}this.curGbox=null,document.onselectstart=function(){return!0}},populateVisible:function(){n.timer&&clearTimeout(n.timer),n.timer=null;var e=b(n.bDiv).height();if(e){var i,a,r=b("table:first",n.bDiv);if(r[0].rows.length)try{a=(i=r[0].rows[1])?b(i).outerHeight()||n.prevRowHeight:n.prevRowHeight}catch(o){a=n.prevRowHeight}if(a){n.prevRowHeight=a;var s=t.rowNum;i=n.scrollTop=n.bDiv.scrollTop;var l=Math.round(r.position().top)-i,d=l+r.height();a*=s;var c,u,h;e>d&&0>=l&&(void 0===t.lastpage||parseInt((d+i+a-1)/a,10)<=t.lastpage)&&(u=parseInt((e-d+a-1)/a,10),d>=0||2>u||t.scroll===!0?(c=Math.round((d+i)/a)+1,l=-1):l=1),l>0&&(c=parseInt(i/a,10)+1,u=parseInt((i+e)/a,10)+2-c,h=!0),u&&(t.lastpage&&c>t.lastpage||1==t.lastpage||c===t.page&&c===t.lastpage||(n.hDiv.loading?n.timer=setTimeout(n.populateVisible,t.scrollTimeout):(t.page=c,h&&(n.selectionPreserver(r[0]),n.emptyRows(n.bDiv,!1,!1)),n.populate(u))))}}},scrollGrid:function(e){if(t.scroll){var i=n.bDiv.scrollTop;void 0===n.scrollTop&&(n.scrollTop=0),i!=n.scrollTop&&(n.scrollTop=i,n.timer&&clearTimeout(n.timer),n.timer=setTimeout(n.populateVisible,t.scrollTimeout))}n.hDiv.scrollLeft=n.bDiv.scrollLeft,t.footerrow&&(n.sDiv.scrollLeft=n.bDiv.scrollLeft),e.stopPropagation()},selectionPreserver:function(e){var t=e.p,n=t.selrow,i=t.selarrrow?b.makeArray(t.selarrrow):null,a=e.grid.bDiv.scrollLeft,r=t.gridComplete;t.gridComplete=function(){if(t.selrow=null,t.selarrrow=[],t.multiselect&&i&&i.length>0)for(var o=0;o<i.length;o++)i[o]!=n&&b(e).jqGrid("setSelection",i[o],!1);n&&b(e).jqGrid("setSelection",n,!1),e.grid.bDiv.scrollLeft=a,t.gridComplete=r,t.gridComplete&&r()}}};if("TABLE"!=this.tagName)alert("Element is not a table");else{b(this).empty().attr("tabindex","1"),this.p=t;var i,a,r;if(0===this.p.colNames.length)for(i=0;i<this.p.colModel.length;i++)this.p.colNames[i]=this.p.colModel[i].label||this.p.colModel[i].name;if(this.p.colNames.length!==this.p.colModel.length)alert(b.jgrid.errors.model);else{var o,s=b("<div class='ui-jqgrid-view'></div>"),l=b.browser.msie?!0:!1,d=b.browser.webkit||b.browser.safari?!0:!1;r=this,r.p.direction=b.trim(r.p.direction.toLowerCase()),-1==b.inArray(r.p.direction,["ltr","rtl"])&&(r.p.direction="ltr"),a=r.p.direction,b(s).insertBefore(this),b(this).appendTo(s).removeClass("scroll");var c=b("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");b(c).insertBefore(s).attr({id:"gbox_"+this.id,dir:a}),b(s).appendTo(c).attr("id","gview_"+this.id),o=l&&b.browser.version<=6?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"",b("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").append(o).insertBefore(s),b("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(s),b(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var u=function(e,t){return e=parseInt(e,10),isNaN(e)?t?t:0:e},h=function(e,t,i,a,o,s){var l=r.p.colModel[e],d=l.align,c='style="',u=l.classes,h=l.name,p=[];return d&&(c+="text-align:"+d+";"),l.hidden===!0&&(c+="display:none;"),0===t?c+="width: "+n.headers[e].width+"px;":l.cellattr&&b.isFunction(l.cellattr)&&(e=l.cellattr.call(r,o,i,a,l,s))&&"string"==typeof e&&(e=e.replace(/style/i,"style").replace(/title/i,"title"),e.indexOf("title")>-1&&(l.title=!1),e.indexOf("class")>-1&&(u=void 0),p=e.split("style"),2===p.length?(p[1]=b.trim(p[1].replace("=","")),(0===p[1].indexOf("'")||0===p[1].indexOf('"'))&&(p[1]=p[1].substring(1)),c+=p[1].replace(/'/gi,'"')):c+='"'),p.length||(p[0]="",c+='"'),c+=(void 0!==u?' class="'+u+'"':"")+(l.title&&i?' title="'+b.jgrid.stripHtml(i)+'"':""),c+=' aria-describedby="'+r.p.id+"_"+h+'"',c+p[0]},p=function(e){return void 0===e||null===e||""===e?"&#160;":r.p.autoencode?b.jgrid.htmlEncode(e):e+""},f=function(e,t,n,i,a){var o=r.p.colModel[n];return"undefined"!=typeof o.formatter?(e={rowId:e,colModel:o,gid:r.p.id,pos:n},t=b.isFunction(o.formatter)?o.formatter.call(r,t,e,i,a):b.fmatter?b.fn.fmatter(o.formatter,t,e,i,a):p(t)):t=p(t),t},g=function(e,t,n,i,a){return t=f(e,t,n,a,"add"),'<td role="gridcell" '+h(n,i,t,a,e,!0)+">"+t+"</td>"},m=function(e,t,n){var i='<input role="checkbox" type="checkbox" id="jqg_'+r.p.id+"_"+e+'" class="cbox" name="jqg_'+r.p.id+"_"+e+'"/>';return'<td role="gridcell" '+h(t,n,"",null,e,!0)+">"+i+"</td>"},v=function(e,t,n,i){return n=(parseInt(n,10)-1)*parseInt(i,10)+1+t,'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+h(e,t,n,null,t,!0)+">"+n+"</td>"},y=function(e){var t,n,i=[],a=0;for(n=0;n<r.p.colModel.length;n++)t=r.p.colModel[n],"cb"!==t.name&&"subgrid"!==t.name&&"rn"!==t.name&&(i[a]="local"==e?t.name:"xml"==e?t.xmlmap||t.name:t.jsonmap||t.name,a++);return i},_=function(e){var t=r.p.remapColumns;return t&&t.length||(t=b.map(r.p.colModel,function(e,t){return t})),e&&(t=b.map(t,function(t){return e>t?null:t-e})),t},w=function(e,t,n){if(r.p.deepempty)b("#"+b.jgrid.jqID(r.p.id)+" tbody:first tr:gt(0)").remove();else{var i=b("#"+b.jgrid.jqID(r.p.id)+" tbody:first tr:first")[0];b("#"+b.jgrid.jqID(r.p.id)+" tbody:first").empty().append(i)}t&&r.p.scroll&&(b(">div:first",e).css({height:"auto"}).children("div:first").css({height:0,display:"none"}),e.scrollTop=0),n===!0&&r.p.treeGrid===!0&&(r.p.data=[],r.p._index={})},C=function(){var e,t,n,i=r.p.data.length;for(e=r.p.rownumbers===!0?1:0,t=r.p.multiselect===!0?1:0,n=r.p.subGrid===!0?1:0,e=r.p.keyIndex===!1||r.p.loadonce===!0?r.p.localReader.id:r.p.colModel[r.p.keyIndex+t+n+e].name,t=0;i>t;t++)n=b.jgrid.getAccessor(r.p.data[t],e),r.p._index[n]=t},k=function(e,t,n,i,a){var o=new Date,s="local"!=r.p.datatype&&r.p.loadonce||"xmlstring"==r.p.datatype,l="local"==r.p.datatype?"local":"xml";if(s&&(r.p.data=[],r.p._index={},r.p.localReader.id="_id_"),r.p.reccount=0,b.isXMLDoc(e)){-1!==r.p.treeANode||r.p.scroll?n=n>1?n:1:(w(t,!1,!0),n=1);var d,c,u,h,p,f,C,k=0,x=0,S=0,j=0,N=[],T={},E=[],A=r.p.altRows===!0?" "+r.p.altclass:"";r.p.xmlReader.repeatitems||(N=y(l)),h=r.p.keyIndex===!1?r.p.xmlReader.id:r.p.keyIndex,N.length>0&&!isNaN(h)&&(r.p.remapColumns&&r.p.remapColumns.length&&(h=b.inArray(h,r.p.remapColumns)),h=N[h]),l=-1===(h+"").indexOf("[")?N.length?function(e,t){return b(h,e).text()||t}:function(e,t){return b(r.p.xmlReader.cell,e).eq(h).text()||t}:function(e,t){return e.getAttribute(h.replace(/[\[\]]/g,""))||t},r.p.userData={},b(r.p.xmlReader.page,e).each(function(){r.p.page=this.textContent||this.text||0}),b(r.p.xmlReader.total,e).each(function(){r.p.lastpage=this.textContent||this.text,void 0===r.p.lastpage&&(r.p.lastpage=1)}),b(r.p.xmlReader.records,e).each(function(){r.p.records=this.textContent||this.text||0}),b(r.p.xmlReader.userdata,e).each(function(){r.p.userData[this.getAttribute("name")]=this.textContent||this.text}),(e=b(r.p.xmlReader.root+" "+r.p.xmlReader.row,e))||(e=[]);var D,O=e.length,I=0,M={};if(e&&O){D=parseInt(r.p.rowNum,10);var R=r.p.scroll?b.jgrid.randId():1;a&&(D*=a+1),a=b.isFunction(r.p.afterInsertRow);var P="";for(r.p.grouping&&r.p.groupingView.groupCollapse===!0&&(P=' style="display:none;"');O>I;){if(f=e[I],C=l(f,R+I),d=0===n?0:n+1,d=(d+I)%2==1?A:"",E.push("<tr"+P+' id="'+C+'" tabindex="-1" role="row" class ="ui-widget-content jqgrow ui-row-'+r.p.direction+d+'">'),r.p.rownumbers===!0&&(E.push(v(0,I,r.p.page,r.p.rowNum)),j=1),r.p.multiselect===!0&&(E.push(m(C,j,I)),x=1),r.p.subGrid===!0&&(E.push(b(r).jqGrid("addSubGridCell",x+j,I+n)),S=1),r.p.xmlReader.repeatitems){p||(p=_(x+S+j));var F=b(r.p.xmlReader.cell,f);b.each(p,function(e){var t=F[this];return t?(u=t.textContent||t.text,T[r.p.colModel[e+x+S+j].name]=u,void E.push(g(C,u,e+x+S+j,I+n,f))):!1})}else for(d=0;d<N.length;d++)u=b(N[d],f).text(),T[r.p.colModel[d+x+S+j].name]=u,E.push(g(C,u,d+x+S+j,I+n,f));if(E.push("</tr>"),r.p.grouping){d=r.p.groupingView.groupField.length;for(var z=[],B=0;d>B;B++)z.push(T[r.p.groupingView.groupField[B]]);M=b(r).jqGrid("groupingPrepare",E,z,M,T),E=[]}if((s||r.p.treeGrid===!0)&&(T._id_=C,r.p.data.push(T),r.p._index[C]=r.p.data.length-1),r.p.gridview===!1&&(b("tbody:first",t).append(E.join("")),a&&r.p.afterInsertRow.call(r,C,T,f),E=[]),T={},k++,I++,k==D)break}}if(r.p.gridview===!0&&(c=r.p.treeANode>-1?r.p.treeANode:0,r.p.grouping?(b(r).jqGrid("groupingRender",M,r.p.colModel.length),M=null):r.p.treeGrid===!0&&c>0?b(r.rows[c]).after(E.join("")):b("tbody:first",t).append(E.join(""))),r.p.subGrid===!0)try{b(r).jqGrid("addSubGrid",x+j)}catch(L){}if(r.p.totaltime=new Date-o,k>0&&0===r.p.records&&(r.p.records=O),E=null,r.p.treeGrid===!0)try{b(r).jqGrid("setTreeNode",c+1,k+c+1)}catch(q){}if(r.p.treeGrid||r.p.scroll||(r.grid.bDiv.scrollTop=0),r.p.reccount=k,r.p.treeANode=-1,r.p.userDataOnFooter&&b(r).jqGrid("footerData","set",r.p.userData,!0),s&&(r.p.records=O,r.p.lastpage=Math.ceil(O/D)),i||r.updatepager(!1,!0),s)for(;O>k;){if(f=e[k],C=l(f,k),r.p.xmlReader.repeatitems){p||(p=_(x+S+j));var H=b(r.p.xmlReader.cell,f);b.each(p,function(e){var t=H[this];return t?(u=t.textContent||t.text,void(T[r.p.colModel[e+x+S+j].name]=u)):!1})}else for(d=0;d<N.length;d++)u=b(N[d],f).text(),T[r.p.colModel[d+x+S+j].name]=u;T._id_=C,r.p.data.push(T),r.p._index[C]=r.p.data.length-1,T={},k++}}},x=function(e,t,n,i,a){var o=new Date;if(e){-1!==r.p.treeANode||r.p.scroll?n=n>1?n:1:(w(t,!1,!0),n=1);var s,l="local"!=r.p.datatype&&r.p.loadonce||"jsonstring"==r.p.datatype;l&&(r.p.data=[],r.p._index={},r.p.localReader.id="_id_"),r.p.reccount=0,"local"==r.p.datatype?(t=r.p.localReader,s="local"):(t=r.p.jsonReader,s="json");var d,c,u,h,p,f,C,k=0,x=[],S=0,j=0,N=0,T={},E=[],A=r.p.altRows===!0?" "+r.p.altclass:"";r.p.page=b.jgrid.getAccessor(e,t.page)||0,h=b.jgrid.getAccessor(e,t.total),r.p.lastpage=void 0===h?1:h,r.p.records=b.jgrid.getAccessor(e,t.records)||0,r.p.userData=b.jgrid.getAccessor(e,t.userdata)||{},t.repeatitems||(u=x=y(s)),s=r.p.keyIndex===!1?t.id:r.p.keyIndex,x.length>0&&!isNaN(s)&&(r.p.remapColumns&&r.p.remapColumns.length&&(s=b.inArray(s,r.p.remapColumns)),s=x[s]),(p=b.jgrid.getAccessor(e,t.root))||(p=[]),h=p.length,e=0;var D=parseInt(r.p.rowNum,10),O=r.p.scroll?b.jgrid.randId():1;a&&(D*=a+1);var I=b.isFunction(r.p.afterInsertRow),M={},R="";for(r.p.grouping&&r.p.groupingView.groupCollapse===!0&&(R=' style="display:none;"');h>e;){for(a=p[e],C=b.jgrid.getAccessor(a,s),void 0===C&&(C=O+e,0===x.length&&t.cell&&(C=b.jgrid.getAccessor(a,t.cell)[s]||C)),d=1===n?0:n,d=(d+e)%2==1?A:"",E.push("<tr"+R+' id="'+C+'" tabindex="-1" role="row" class= "ui-widget-content jqgrow ui-row-'+r.p.direction+d+'">'),r.p.rownumbers===!0&&(E.push(v(0,e,r.p.page,r.p.rowNum)),N=1),r.p.multiselect&&(E.push(m(C,N,e)),S=1),r.p.subGrid&&(E.push(b(r).jqGrid("addSubGridCell",S+N,e+n)),j=1),t.repeatitems&&(t.cell&&(a=b.jgrid.getAccessor(a,t.cell)),u||(u=_(S+j+N))),c=0;c<u.length;c++)d=b.jgrid.getAccessor(a,u[c]),E.push(g(C,d,c+S+j+N,e+n,a)),T[r.p.colModel[c+S+j+N].name]=d;if(E.push("</tr>"),r.p.grouping){d=r.p.groupingView.groupField.length,c=[];for(var P=0;d>P;P++)c.push(T[r.p.groupingView.groupField[P]]);M=b(r).jqGrid("groupingPrepare",E,c,M,T),E=[]}if((l||r.p.treeGrid===!0)&&(T._id_=C,r.p.data.push(T),r.p._index[C]=r.p.data.length-1),r.p.gridview===!1&&(b("#"+b.jgrid.jqID(r.p.id)+" tbody:first").append(E.join("")),I&&r.p.afterInsertRow.call(r,C,T,a),E=[]),T={},k++,e++,k==D)break}if(r.p.gridview===!0&&(f=r.p.treeANode>-1?r.p.treeANode:0,r.p.grouping?b(r).jqGrid("groupingRender",M,r.p.colModel.length):r.p.treeGrid===!0&&f>0?b(r.rows[f]).after(E.join("")):b("#"+b.jgrid.jqID(r.p.id)+" tbody:first").append(E.join(""))),r.p.subGrid===!0)try{b(r).jqGrid("addSubGrid",S+N)}catch(F){}if(r.p.totaltime=new Date-o,k>0&&0===r.p.records&&(r.p.records=h),r.p.treeGrid===!0)try{b(r).jqGrid("setTreeNode",f+1,k+f+1)}catch(z){}if(r.p.treeGrid||r.p.scroll||(r.grid.bDiv.scrollTop=0),r.p.reccount=k,r.p.treeANode=-1,r.p.userDataOnFooter&&b(r).jqGrid("footerData","set",r.p.userData,!0),l&&(r.p.records=h,r.p.lastpage=Math.ceil(h/D)),i||r.updatepager(!1,!0),l)for(;h>k&&p[k];){if(a=p[k],C=b.jgrid.getAccessor(a,s),void 0===C&&(C=O+k,0===x.length&&t.cell&&(C=b.jgrid.getAccessor(a,t.cell)[s]||C)),a){for(t.repeatitems&&(t.cell&&(a=b.jgrid.getAccessor(a,t.cell)),u||(u=_(S+j+N))),c=0;c<u.length;c++)d=b.jgrid.getAccessor(a,u[c]),T[r.p.colModel[c+S+j+N].name]=d;T._id_=C,r.p.data.push(T),r.p._index[C]=r.p.data.length-1,T={}}k++}}},S=function(){function e(t){var n,i,a,r=0;if(void 0!==t.groups)for(n=0;n<t.groups.length;n++){try{e(t.groups[n])}catch(o){alert(o)}r++}if(void 0!==t.rules){if(r>0){var l=h.select();h=b.jgrid.from(l)}try{for(n=0;n<t.rules.length;n++)a=t.rules[n],i=t.groupOp.toString().toUpperCase(),u[a.op]&&a.field&&(r>0&&i&&"OR"===i&&(h=h.or()),h=u[a.op](h,i)(a.field,a.data,s[a.field])),r++}catch(d){alert(d)}}}var t,n,i,a,o=!1,s={},l=[],d=[];if(b.isArray(r.p.data)){var c=r.p.grouping?r.p.groupingView:!1;if(b.each(r.p.colModel,function(){if(i=this.sorttype||"text","date"==i||"datetime"==i?(this.formatter&&"string"==typeof this.formatter&&"date"==this.formatter?(n=this.formatoptions&&this.formatoptions.srcformat?this.formatoptions.srcformat:b.jgrid.formatter.date.srcformat,a=this.formatoptions&&this.formatoptions.newformat?this.formatoptions.newformat:b.jgrid.formatter.date.newformat):n=a=this.datefmt||"Y-m-d",s[this.name]={stype:i,srcfmt:n,newfmt:a}):s[this.name]={stype:i,srcfmt:"",newfmt:""},r.p.grouping&&this.name==c.groupField[0]){var e=this.name;"undefined"!=typeof this.index&&(e=this.index),l[0]=s[e],d.push(e)}o||this.index!=r.p.sortname&&this.name!=r.p.sortname||(t=this.name,o=!0)}),!r.p.treeGrid){var u={eq:function(e){return e.equals},ne:function(e){return e.notEquals},lt:function(e){return e.less},le:function(e){return e.lessOrEquals},gt:function(e){return e.greater},ge:function(e){return e.greaterOrEquals},cn:function(e){return e.contains},nc:function(e,t){return"OR"===t?e.orNot().contains:e.andNot().contains},bw:function(e){return e.startsWith},bn:function(e,t){return"OR"===t?e.orNot().startsWith:e.andNot().startsWith},en:function(e,t){return"OR"===t?e.orNot().endsWith:e.andNot().endsWith},ew:function(e){return e.endsWith},ni:function(e,t){return"OR"===t?e.orNot().equals:e.andNot().equals},"in":function(e){return e.equals},nu:function(e){return e.isNull},nn:function(e,t){return"OR"===t?e.orNot().isNull:e.andNot().isNull}},h=b.jgrid.from(r.p.data);if(r.p.ignoreCase&&(h=h.ignoreCase()),r.p.search===!0){var p=r.p.postData.filters;if(p)"string"==typeof p&&(p=b.jgrid.parse(p)),e(p);else try{h=u[r.p.postData.searchOper](h)(r.p.postData.searchField,r.p.postData.searchString,s[r.p.postData.searchField])}catch(f){}}r.p.grouping&&(h.orderBy(d,c.groupOrder[0],l[0].stype,l[0].srcfmt),c.groupDataSorted=!0),t&&r.p.sortorder&&o&&("DESC"==r.p.sortorder.toUpperCase()?h.orderBy(r.p.sortname,"d",s[t].stype,s[t].srcfmt):h.orderBy(r.p.sortname,"a",s[t].stype,s[t].srcfmt)),p=h.select();var g=parseInt(r.p.rowNum,10),m=p.length,v=parseInt(r.p.page,10),y=Math.ceil(m/g),_={};return p=p.slice((v-1)*g,v*g),s=h=null,_[r.p.localReader.total]=y,_[r.p.localReader.page]=v,_[r.p.localReader.records]=m,_[r.p.localReader.root]=p,p=null,_}b(r).jqGrid("SortTree",t,r.p.sortorder,s[t].stype,s[t].srcfmt)}},j=function(){if(r.grid.hDiv.loading=!0,!r.p.hiddengrid)switch(r.p.loadui){case"enable":b("#load_"+b.jgrid.jqID(r.p.id)).show();break;case"block":b("#lui_"+b.jgrid.jqID(r.p.id)).show(),b("#load_"+b.jgrid.jqID(r.p.id)).show()}},N=function(){switch(r.grid.hDiv.loading=!1,r.p.loadui){case"enable":b("#load_"+b.jgrid.jqID(r.p.id)).hide();break;case"block":b("#lui_"+b.jgrid.jqID(r.p.id)).hide(),b("#load_"+b.jgrid.jqID(r.p.id)).hide()}},T=function(e){if(!r.grid.hDiv.loading){var t,n=r.p.scroll&&e===!1,i={},a=r.p.prmNames;r.p.page<=0&&(r.p.page=1),null!==a.search&&(i[a.search]=r.p.search),null!==a.nd&&(i[a.nd]=(new Date).getTime()),null!==a.rows&&(i[a.rows]=r.p.rowNum),null!==a.page&&(i[a.page]=r.p.page),null!==a.sort&&(i[a.sort]=r.p.sortname),null!==a.order&&(i[a.order]=r.p.sortorder),null!==r.p.rowTotal&&null!==a.totalrows&&(i[a.totalrows]=r.p.rowTotal);var o=r.p.loadComplete,s=b.isFunction(o);s||(o=null);var l=0;e=e||1,e>1?null!==a.npage?(i[a.npage]=e,l=e-1,e=1):o=function(t){r.p.page++,r.grid.hDiv.loading=!1,s&&r.p.loadComplete.call(r,t),T(e-1)}:null!==a.npage&&delete r.p.postData[a.npage],r.p.grouping&&(b(r).jqGrid("groupingSetup"),r.p.groupingView.groupDataSorted===!0&&(i[a.sort]=r.p.groupingView.groupField[0]+" "+r.p.groupingView.groupOrder[0]+", "+i[a.sort])),b.extend(r.p.postData,i);var d=r.p.scroll?r.rows.length-1:1;if(b.isFunction(r.p.datatype))r.p.datatype.call(r,r.p.postData,"load_"+r.p.id);else switch(b.isFunction(r.p.beforeRequest)&&r.p.beforeRequest.call(r),t=r.p.datatype.toLowerCase()){case"json":case"jsonp":case"xml":case"script":b.ajax(b.extend({url:r.p.url,type:r.p.mtype,dataType:t,data:b.isFunction(r.p.serializeGridData)?r.p.serializeGridData.call(r,r.p.postData):r.p.postData,success:function(i){"xml"===t?k(i,r.grid.bDiv,d,e>1,l):x(i,r.grid.bDiv,d,e>1,l),o&&o.call(r,i),n&&r.grid.populateVisible(),(r.p.loadonce||r.p.treeGrid)&&(r.p.datatype="local"),N()},error:function(e,t,n){b.isFunction(r.p.loadError)&&r.p.loadError.call(r,e,t,n),N()},beforeSend:function(e){j(),b.isFunction(r.p.loadBeforeSend)&&r.p.loadBeforeSend.call(r,e)}},b.jgrid.ajaxOptions,r.p.ajaxGridOptions));break;case"xmlstring":j(),i=b.jgrid.stringToDoc(r.p.datastr),k(i,r.grid.bDiv),s&&r.p.loadComplete.call(r,i),r.p.datatype="local",r.p.datastr=null,N();break;case"jsonstring":j(),i="string"==typeof r.p.datastr?b.jgrid.parse(r.p.datastr):r.p.datastr,x(i,r.grid.bDiv),s&&r.p.loadComplete.call(r,i),r.p.datatype="local",r.p.datastr=null,N();break;case"local":case"clientside":j(),r.p.datatype="local",i=S(),x(i,r.grid.bDiv,d,e>1,l),o&&o.call(r,i),n&&r.grid.populateVisible(),N()}}};o=function(e,t){var n,i,o,s,l="",d="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",c="",h=function(e){var t;return b.isFunction(r.p.onPaging)&&(t=r.p.onPaging.call(r,e)),r.p.selrow=null,r.p.multiselect&&(r.p.selarrrow=[],b("#cb_"+b.jgrid.jqID(r.p.id),r.grid.hDiv).attr("checked",!1)),r.p.savedRow=[],"stop"==t?!1:!0};if(e=e.substr(1),n="pg_"+e,i=e+"_left",o=e+"_center",s=e+"_right",b("#"+b.jgrid.jqID(e)).append("<div id='"+n+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+i+"' align='left'></td><td id='"+o+"' align='center' style='white-space:pre;'></td><td id='"+s+"' align='right'></td></tr></tbody></table></div>").attr("dir","ltr"),r.p.rowList.length>0){for(c="<td dir='"+a+"'>",c+="<select class='ui-pg-selbox' role='listbox'>",i=0;i<r.p.rowList.length;i++)c+='<option role="option" value="'+r.p.rowList[i]+'"'+(r.p.rowNum==r.p.rowList[i]?' selected="selected"':"")+">"+r.p.rowList[i]+"</option>";c+="</select></td>"}"rtl"==a&&(d+=c),r.p.pginput===!0&&(l="<td dir='"+a+"'>"+b.jgrid.format(r.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1'></span>")+"</td>"),r.p.pgbuttons===!0?(i=["first"+t,"prev"+t,"next"+t,"last"+t],"rtl"==a&&i.reverse(),d+="<td id='"+i[0]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>",d+="<td id='"+i[1]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>",d+=""!==l?"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>"+l+"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>":"",d+="<td id='"+i[2]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>",d+="<td id='"+i[3]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>"):""!==l&&(d+=l),"ltr"==a&&(d+=c),d+="</tr></tbody></table>",r.p.viewrecords===!0&&b("td#"+e+"_"+r.p.recordpos,"#"+n).append("<div dir='"+a+"' style='text-align:"+r.p.recordpos+"' class='ui-paging-info'></div>"),b("td#"+e+"_"+r.p.pagerpos,"#"+n).append(d),c=b(".ui-jqgrid").css("font-size")||"11px",b(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+c+";visibility:hidden;' ></div>"),d=b(d).clone().appendTo("#testpg").width(),b("#testpg").remove(),d>0&&(""!==l&&(d+=50),b("td#"+e+"_"+r.p.pagerpos,"#"+n).width(d)),r.p._nvtd=[],r.p._nvtd[0]=Math.floor(d?(r.p.width-d)/2:r.p.width/3),r.p._nvtd[1]=0,d=null,b(".ui-pg-selbox","#"+n).bind("change",function(){return r.p.page=Math.round(r.p.rowNum*(r.p.page-1)/this.value-.5)+1,r.p.rowNum=this.value,t?b(".ui-pg-selbox",r.p.pager).val(this.value):r.p.toppager&&b(".ui-pg-selbox",r.p.toppager).val(this.value),h("records")?(T(),!1):!1}),r.p.pgbuttons===!0&&(b(".ui-pg-button","#"+n).hover(function(){b(this).hasClass("ui-state-disabled")?this.style.cursor="default":(b(this).addClass("ui-state-hover"),this.style.cursor="pointer")},function(){b(this).hasClass("ui-state-disabled")||(b(this).removeClass("ui-state-hover"),this.style.cursor="default")}),b("#first"+t+", #prev"+t+", #next"+t+", #last"+t,"#"+e).click(function(){var e=u(r.p.page,1),n=u(r.p.lastpage,1),i=!1,a=!0,o=!0,s=!0,l=!0;if(0===n||1===n?l=s=o=a=!1:n>1&&e>=1?1===e?o=a=!1:e>1&&n>e||e===n&&(l=s=!1):n>1&&0===e&&(l=s=!1,e=n-1),this.id==="first"+t&&a&&(r.p.page=1,i=!0),this.id==="prev"+t&&o&&(r.p.page=e-1,i=!0),this.id==="next"+t&&s&&(r.p.page=e+1,i=!0),this.id==="last"+t&&l&&(r.p.page=n,i=!0),i){if(!h(this.id))return!1;T()}return!1})),r.p.pginput===!0&&b("input.ui-pg-input","#"+n).keypress(function(e){return 13==(e.charCode?e.charCode:e.keyCode?e.keyCode:0)?(r.p.page=b(this).val()>0?b(this).val():r.p.page,h("user")?(T(),!1):!1):this})};var E=function(e,t,n,i){if(r.p.colModel[t].sortable&&!(r.p.savedRow.length>0)){if(n||(r.p.lastsort==t?"asc"==r.p.sortorder?r.p.sortorder="desc":"desc"==r.p.sortorder&&(r.p.sortorder="asc"):r.p.sortorder=r.p.colModel[t].firstsortorder||"asc",r.p.page=1),i){if(r.p.lastsort==t&&r.p.sortorder==i&&!n)return;r.p.sortorder=i}if(n=b("thead:first",r.grid.hDiv).get(0),b("tr th:eq("+r.p.lastsort+") span.ui-grid-ico-sort",n).addClass("ui-state-disabled"),b("tr th:eq("+r.p.lastsort+")",n).attr("aria-selected","false"),b("tr th:eq("+t+") span.ui-icon-"+r.p.sortorder,n).removeClass("ui-state-disabled"),b("tr th:eq("+t+")",n).attr("aria-selected","true"),r.p.viewsortcols[0]||r.p.lastsort!=t&&(b("tr th:eq("+r.p.lastsort+") span.s-ico",n).hide(),b("tr th:eq("+t+") span.s-ico",n).show()),e=e.substring(5),r.p.sortname=r.p.colModel[t].index||e,n=r.p.sortorder,b.isFunction(r.p.onSortCol)&&"stop"==r.p.onSortCol.call(r,e,t,n))return void(r.p.lastsort=t);"local"==r.p.datatype?r.p.deselectAfterSort&&b(r).jqGrid("resetSelection"):(r.p.selrow=null,r.p.multiselect&&b("#cb_"+b.jgrid.jqID(r.p.id),r.grid.hDiv).attr("checked",!1),r.p.selarrrow=[],r.p.savedRow=[]),r.p.scroll&&(n=r.grid.bDiv.scrollLeft,w(r.grid.bDiv,!0,!1),r.grid.hDiv.scrollLeft=n),r.p.subGrid&&"local"==r.p.datatype&&b("td.sgexpanded","#"+b.jgrid.jqID(r.p.id)).each(function(){b(this).trigger("click")}),T(),r.p.lastsort=t,r.p.sortname!=e&&t&&(r.p.lastsort=t)}},A=function(e){var t,n={},i=d?0:r.p.cellLayout;for(t=n[0]=n[1]=n[2]=0;e>=t;t++)r.p.colModel[t].hidden===!1&&(n[0]+=r.p.colModel[t].width+i);return"rtl"==r.p.direction&&(n[0]=r.p.width-n[0]),n[0]-=r.grid.bDiv.scrollLeft,b(r.grid.cDiv).is(":visible")&&(n[1]+=b(r.grid.cDiv).height()+parseInt(b(r.grid.cDiv).css("padding-top"),10)+parseInt(b(r.grid.cDiv).css("padding-bottom"),10)),r.p.toolbar[0]!==!0||"top"!=r.p.toolbar[1]&&"both"!=r.p.toolbar[1]||(n[1]+=b(r.grid.uDiv).height()+parseInt(b(r.grid.uDiv).css("border-top-width"),10)+parseInt(b(r.grid.uDiv).css("border-bottom-width"),10)),r.p.toppager&&(n[1]+=b(r.grid.topDiv).height()+parseInt(b(r.grid.topDiv).css("border-bottom-width"),10)),n[2]+=b(r.grid.bDiv).height()+b(r.grid.hDiv).height(),n};for(this.p.id=this.id,-1==b.inArray(r.p.multikey,["shiftKey","altKey","ctrlKey"])&&(r.p.multikey=!1),r.p.keyIndex=!1,i=0;i<r.p.colModel.length;i++)r.p.colModel[i]=b.extend(!0,{},r.p.cmTemplate,r.p.colModel[i].template||{},r.p.colModel[i]),r.p.keyIndex===!1&&r.p.colModel[i].key===!0&&(r.p.keyIndex=i);if(r.p.sortorder=r.p.sortorder.toLowerCase(),r.p.grouping===!0&&(r.p.scroll=!1,r.p.rownumbers=!1,r.p.subGrid=!1,r.p.treeGrid=!1,r.p.gridview=!0),this.p.treeGrid===!0){try{b(this).jqGrid("setTreeGrid")}catch(D){}"local"!=r.p.datatype&&(r.p.localReader={id:"_id_"})}if(this.p.subGrid)try{b(r).jqGrid("setSubGrid")}catch(O){}this.p.multiselect&&(this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>"),this.p.colModel.unshift({name:"cb",width:d?r.p.multiselectWidth+r.p.cellLayout:r.p.multiselectWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0})),this.p.rownumbers&&(this.p.colNames.unshift(""),this.p.colModel.unshift({name:"rn",width:r.p.rownumWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0})),r.p.xmlReader=b.extend(!0,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:!0,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:!0,cell:"cell"}},r.p.xmlReader),r.p.jsonReader=b.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!0,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},r.p.jsonReader),r.p.localReader=b.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},r.p.localReader),r.p.scroll&&(r.p.pgbuttons=!1,r.p.pginput=!1,r.p.rowList=[]),r.p.data.length&&C();var I,M,R,P,F,z,B,L,q="<thead><tr class='ui-jqgrid-labels' role='rowheader'>";if(M=L="",r.p.shrinkToFit===!0&&r.p.forceFit===!0)for(i=r.p.colModel.length-1;i>=0;i--)if(!r.p.colModel[i].hidden){r.p.colModel[i].resizable=!1;break}for("horizontal"==r.p.viewsortcols[1]&&(L=" ui-i-asc",M=" ui-i-desc"),I=l?"class='ui-th-div-ie'":"",L="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+L+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+a+"'></span>",L+="<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+M+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+a+"'></span></span>",i=0;i<this.p.colNames.length;i++)M=r.p.headertitles?' title="'+b.jgrid.stripHtml(r.p.colNames[i])+'"':"",q+="<th id='"+r.p.id+"_"+r.p.colModel[i].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+a+"'"+M+">",M=r.p.colModel[i].index||r.p.colModel[i].name,q+="<div id='jqgh_"+r.p.colModel[i].name+"' "+I+">"+r.p.colNames[i],r.p.colModel[i].width=r.p.colModel[i].width?parseInt(r.p.colModel[i].width,10):150,"boolean"!=typeof r.p.colModel[i].title&&(r.p.colModel[i].title=!0),M==r.p.sortname&&(r.p.lastsort=i),q+=L+"</div></th>";if(q+="</tr></thead>",L=null,b(this).append(q),b("thead tr:first th",this).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")}),this.p.multiselect){var H,$=[];b("#cb_"+b.jgrid.jqID(r.p.id),this).bind("click",function(){r.p.selarrrow=[],this.checked?(b(r.rows).each(function(e){e>0&&(b(this).hasClass("subgrid")||b(this).hasClass("jqgroup")||b(this).hasClass("ui-state-disabled")||(b("#jqg_"+b.jgrid.jqID(r.p.id)+"_"+b.jgrid.jqID(this.id)).attr("checked","checked"),b(this).addClass("ui-state-highlight").attr("aria-selected","true"),r.p.selarrrow.push(this.id),r.p.selrow=this.id))}),H=!0,$=[]):(b(r.rows).each(function(e){e>0&&(b(this).hasClass("subgrid")||b(this).hasClass("ui-state-disabled")||(b("#jqg_"+b.jgrid.jqID(r.p.id)+"_"+b.jgrid.jqID(this.id)).removeAttr("checked"),b(this).removeClass("ui-state-highlight").attr("aria-selected","false"),$.push(this.id)))}),r.p.selrow=null,H=!1),b.isFunction(r.p.onSelectAll)&&r.p.onSelectAll.call(r,H?r.p.selarrrow:$,H)})}r.p.autowidth===!0&&(q=b(c).innerWidth(),r.p.width=q>0?q:"nw"),function(){var e,t,i,a,o=0,s=d?0:r.p.cellLayout,l=0,c=r.p.scrollOffset,h=!1,p=0,f=0;b.each(r.p.colModel,function(){"undefined"==typeof this.hidden&&(this.hidden=!1),this.widthOrg=t=u(this.width,0),this.hidden===!1&&(o+=t+s,this.fixed?p+=t+s:l++,f++)}),isNaN(r.p.width)?r.p.width=n.width=o:n.width=r.p.width,r.p.tblwidth=o,r.p.shrinkToFit===!1&&r.p.forceFit===!0&&(r.p.forceFit=!1),r.p.shrinkToFit===!0&&l>0&&(i=n.width-s*l-p,isNaN(r.p.height)||(i-=c,h=!0),o=0,b.each(r.p.colModel,function(n){this.hidden!==!1||this.fixed||(this.width=t=Math.round(i*this.width/(r.p.tblwidth-s*l-p)),o+=t,e=n)}),a=0,h?n.width-p-(o+s*l)!==c&&(a=n.width-p-(o+s*l)-c):h||1===Math.abs(n.width-p-(o+s*l))||(a=n.width-p-(o+s*l)),r.p.colModel[e].width+=a,r.p.tblwidth=o+a+s*l+p,r.p.tblwidth>r.p.width&&(r.p.colModel[e].width-=r.p.tblwidth-parseInt(r.p.width,10),r.p.tblwidth=r.p.width))}(),b(c).css("width",n.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+r.p.id+"'>&#160;</div>"),b(s).css("width",n.width+"px"),q=b("thead:first",r).get(0);var W="";r.p.footerrow&&(W+="<table role='grid' style='width:"+r.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+a+"'>"),s=b("tr:first",q);var G="<tr class='jqgfirstrow' role='row' style='height:auto'>";if(r.p.disableClick=!1,b("th",s).each(function(e){R=r.p.colModel[e].width,"undefined"==typeof r.p.colModel[e].resizable&&(r.p.colModel[e].resizable=!0),r.p.colModel[e].resizable?(P=document.createElement("span"),b(P).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+a),b.browser.opera||b(P).css("cursor","col-resize"),b(this).addClass(r.p.resizeclass)):P="",b(this).css("width",R+"px").prepend(P);var t="";r.p.colModel[e].hidden&&(b(this).css("display","none"),t="display:none;"),G+="<td role='gridcell' style='height:0px;width:"+R+"px;"+t+"'></td>",n.headers[e]={width:R,el:this},F=r.p.colModel[e].sortable,"boolean"!=typeof F&&(F=r.p.colModel[e].sortable=!0),t=r.p.colModel[e].name,"cb"==t||"subgrid"==t||"rn"==t||r.p.viewsortcols[2]&&b("div",this).addClass("ui-jqgrid-sortable"),F&&(r.p.viewsortcols[0]?(b("div span.s-ico",this).show(),e==r.p.lastsort&&b("div span.ui-icon-"+r.p.sortorder,this).removeClass("ui-state-disabled")):e==r.p.lastsort&&(b("div span.s-ico",this).show(),b("div span.ui-icon-"+r.p.sortorder,this).removeClass("ui-state-disabled"))),r.p.footerrow&&(W+="<td role='gridcell' "+h(e,0,"",null,"",!1)+">&#160;</td>")
}).mousedown(function(e){if(1==b(e.target).closest("th>span.ui-jqgrid-resize").length){var t=b.jgrid.getCellIndex(this);if(r.p.forceFit===!0){var i,a=r.p,o=t;for(i=t+1;i<r.p.colModel.length;i++)if(r.p.colModel[i].hidden!==!0){o=i;break}a.nv=o-t}return n.dragStart(t,e,A(t)),!1}}).click(function(e){if(r.p.disableClick)return r.p.disableClick=!1;var t,n,i="th>div.ui-jqgrid-sortable";return r.p.viewsortcols[2]||(i="th>div>span>span.ui-grid-ico-sort"),e=b(e.target).closest(i),1==e.length?(i=b.jgrid.getCellIndex(this),r.p.viewsortcols[2]||(t=!0,n=e.attr("sort")),E(b("div",this)[0].id,i,t,n),!1):void 0}),r.p.sortable&&b.fn.sortable)try{b(r).jqGrid("sortableColumns",s)}catch(U){}r.p.footerrow&&(W+="</tr></tbody></table>"),G+="</tr>",this.appendChild(document.createElement("tbody")),b(this).addClass("ui-jqgrid-btable").append(G),G=null,s=b("<table class='ui-jqgrid-htable' style='width:"+r.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(q);var K=r.p.caption&&r.p.hiddengrid===!0?!0:!1;i=b("<div class='ui-jqgrid-hbox"+("rtl"==a?"-rtl":"")+"'></div>"),q=null,n.hDiv=document.createElement("div"),b(n.hDiv).css({width:n.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(i),b(i).append(s),s=null,K&&b(n.hDiv).hide(),r.p.pager&&("string"==typeof r.p.pager?"#"!=r.p.pager.substr(0,1)&&(r.p.pager="#"+r.p.pager):r.p.pager="#"+b(r.p.pager).attr("id"),b(r.p.pager).css({width:n.width+"px"}).appendTo(c).addClass("ui-state-default ui-jqgrid-pager ui-corner-bottom"),K&&b(r.p.pager).hide(),o(r.p.pager,"")),r.p.cellEdit===!1&&r.p.hoverrows===!0&&b(r).bind("mouseover",function(e){return B=b(e.target).closest("tr.jqgrow"),"subgrid"!==b(B).attr("class")&&b(B).addClass("ui-state-hover"),!1}).bind("mouseout",function(e){return B=b(e.target).closest("tr.jqgrow"),b(B).removeClass("ui-state-hover"),!1});var V,Y;b(r).before(n.hDiv).click(function(e){if(z=e.target,B=b(z,r.rows).closest("tr.jqgrow"),0===b(B).length||B[0].className.indexOf("ui-state-disabled")>-1)return this;var t=b(z).hasClass("cbox"),n=!0;if(b.isFunction(r.p.beforeSelectRow)&&(n=r.p.beforeSelectRow.call(r,B[0].id,e)),"A"==z.tagName||("INPUT"==z.tagName||"TEXTAREA"==z.tagName||"OPTION"==z.tagName||"SELECT"==z.tagName)&&!t)return this;if(n!==!0)return this;if(r.p.cellEdit===!0)if(r.p.multiselect&&t)b(r).jqGrid("setSelection",B[0].id,!0);else{V=B[0].rowIndex,Y=b.jgrid.getCellIndex(z);try{b(r).jqGrid("editCell",V,Y,!0)}catch(i){}}else r.p.multikey?e[r.p.multikey]?b(r).jqGrid("setSelection",B[0].id,!0):r.p.multiselect&&t&&(t=b("[id^=jqg_"+b.jgrid.jqID(r.p.id)+"_]").attr("checked"),b("[id^=jqg_"+b.jgrid.jqID(r.p.id)+"_]").attr("checked",!t)):(r.p.multiselect&&r.p.multiboxonly&&(t||(b(r.p.selarrrow).each(function(e,t){var n=r.rows.namedItem(t);b(n).removeClass("ui-state-highlight"),b("#jqg_"+b.jgrid.jqID(r.p.id)+"_"+b.jgrid.jqID(t)).attr("checked",!1)}),r.p.selarrrow=[],b("#cb_"+b.jgrid.jqID(r.p.id),r.grid.hDiv).attr("checked",!1))),b(r).jqGrid("setSelection",B[0].id,!0));b.isFunction(r.p.onCellSelect)&&(V=B[0].id,Y=b.jgrid.getCellIndex(z),r.p.onCellSelect.call(r,V,Y,b(z).html(),e)),e.stopPropagation()}).bind("reloadGrid",function(e,t){if(r.p.treeGrid===!0&&(r.p.datatype=r.p.treedatatype),t&&t.current&&r.grid.selectionPreserver(r),"local"==r.p.datatype?(b(r).jqGrid("resetSelection"),r.p.data.length&&C()):r.p.treeGrid||(r.p.selrow=null,r.p.multiselect&&(r.p.selarrrow=[],b("#cb_"+b.jgrid.jqID(r.p.id),r.grid.hDiv).attr("checked",!1)),r.p.savedRow=[]),r.p.scroll&&w(r.grid.bDiv,!0,!1),t&&t.page){var n=t.page;n>r.p.lastpage&&(n=r.p.lastpage),1>n&&(n=1),r.p.page=n,r.grid.bDiv.scrollTop=r.grid.prevRowHeight?(n-1)*r.grid.prevRowHeight*r.p.rowNum:0}return r.grid.prevRowHeight&&r.p.scroll?(delete r.p.lastpage,r.grid.populateVisible()):r.grid.populate(),!1}),b.isFunction(this.p.ondblClickRow)&&b(this).dblclick(function(e){return z=e.target,B=b(z,r.rows).closest("tr.jqgrow"),0===b(B).length?!1:(V=B[0].rowIndex,Y=b.jgrid.getCellIndex(z),r.p.ondblClickRow.call(r,b(B).attr("id"),V,Y,e),!1)}),b.isFunction(this.p.onRightClickRow)&&b(this).bind("contextmenu",function(e){return z=e.target,B=b(z,r.rows).closest("tr.jqgrow"),0===b(B).length?!1:(r.p.multiselect||b(r).jqGrid("setSelection",B[0].id,!0),V=B[0].rowIndex,Y=b.jgrid.getCellIndex(z),r.p.onRightClickRow.call(r,b(B).attr("id"),V,Y,e),!1)}),n.bDiv=document.createElement("div"),l&&"auto"===String(r.p.height).toLowerCase()&&(r.p.height="100%"),b(n.bDiv).append(b('<div style="position:relative;'+(l&&b.browser.version<8?"height:0.01%;":"")+'"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:r.p.height+(isNaN(r.p.height)?"":"px"),width:n.width+"px"}).scroll(n.scrollGrid),b("table:first",n.bDiv).css({width:r.p.tblwidth+"px"}),l?(2==b("tbody",this).size()&&b("tbody:gt(0)",this).remove(),r.p.multikey&&b(n.bDiv).bind("selectstart",function(){return!1})):r.p.multikey&&b(n.bDiv).bind("mousedown",function(){return!1}),K&&b(n.bDiv).hide(),n.cDiv=document.createElement("div");var X=r.p.hidegrid===!0?b("<a role='link' href='javascript:void(0)'/>").addClass("ui-jqgrid-titlebar-close HeaderButton").hover(function(){X.addClass("ui-state-hover")},function(){X.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css("rtl"==a?"left":"right","0px"):"";if(b(n.cDiv).append(X).append("<span class='ui-jqgrid-title"+("rtl"==a?"-rtl":"")+"'>"+r.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header ui-corner-top ui-helper-clearfix"),b(n.cDiv).insertBefore(n.hDiv),r.p.toolbar[0]&&(n.uDiv=document.createElement("div"),"top"==r.p.toolbar[1]?b(n.uDiv).insertBefore(n.hDiv):"bottom"==r.p.toolbar[1]&&b(n.uDiv).insertAfter(n.hDiv),"both"==r.p.toolbar[1]?(n.ubDiv=document.createElement("div"),b(n.uDiv).insertBefore(n.hDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id),b(n.ubDiv).insertAfter(n.hDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id),K&&b(n.ubDiv).hide()):b(n.uDiv).width(n.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id),K&&b(n.uDiv).hide()),r.p.toppager&&(r.p.toppager=b.jgrid.jqID(r.p.id)+"_toppager",n.topDiv=b("<div id='"+r.p.toppager+"'></div>")[0],r.p.toppager="#"+r.p.toppager,b(n.topDiv).insertBefore(n.hDiv).addClass("ui-state-default ui-jqgrid-toppager").width(n.width),o(r.p.toppager,"_t")),r.p.footerrow&&(n.sDiv=b("<div class='ui-jqgrid-sdiv'></div>")[0],i=b("<div class='ui-jqgrid-hbox"+("rtl"==a?"-rtl":"")+"'></div>"),b(n.sDiv).append(i).insertAfter(n.hDiv).width(n.width),b(i).append(W),n.footers=b(".ui-jqgrid-ftable",n.sDiv)[0].rows[0].cells,r.p.rownumbers&&(n.footers[0].className="ui-state-default jqgrid-rownum"),K&&b(n.sDiv).hide()),i=null,r.p.caption){var Q=r.p.datatype;r.p.hidegrid===!0&&(b(".ui-jqgrid-titlebar-close",n.cDiv).click(function(e){var t,i=b.isFunction(r.p.onHeaderClick),a=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",o=this;return r.p.toolbar[0]===!0&&("both"==r.p.toolbar[1]&&(a+=", #"+b(n.ubDiv).attr("id")),a+=", #"+b(n.uDiv).attr("id")),t=b(a,"#gview_"+b.jgrid.jqID(r.p.id)).length,"visible"==r.p.gridstate?b(a,"#gbox_"+b.jgrid.jqID(r.p.id)).slideUp("fast",function(){t--,0===t&&(b("span",o).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),r.p.gridstate="hidden",b("#gbox_"+b.jgrid.jqID(r.p.id)).hasClass("ui-resizable")&&b(".ui-resizable-handle","#gbox_"+b.jgrid.jqID(r.p.id)).hide(),i&&(K||r.p.onHeaderClick.call(r,r.p.gridstate,e)))}):"hidden"==r.p.gridstate&&b(a,"#gbox_"+b.jgrid.jqID(r.p.id)).slideDown("fast",function(){t--,0===t&&(b("span",o).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),K&&(r.p.datatype=Q,T(),K=!1),r.p.gridstate="visible",b("#gbox_"+b.jgrid.jqID(r.p.id)).hasClass("ui-resizable")&&b(".ui-resizable-handle","#gbox_"+b.jgrid.jqID(r.p.id)).show(),i&&(K||r.p.onHeaderClick.call(r,r.p.gridstate,e)))}),!1}),K&&(r.p.datatype="local",b(".ui-jqgrid-titlebar-close",n.cDiv).trigger("click")))}else b(n.cDiv).hide();b(n.hDiv).after(n.bDiv).mousemove(function(e){return n.resizing?(n.dragMove(e),!1):void 0}),b(".ui-jqgrid-labels",n.hDiv).bind("selectstart",function(){return!1}),b(document).mouseup(function(){return n.resizing?(n.dragEnd(),!1):!0}),r.formatCol=h,r.sortData=E,r.updatepager=function(e,t){var n,i,a,o,s,l,d,c="";a=parseInt(r.p.page,10)-1,0>a&&(a=0),a*=parseInt(r.p.rowNum,10),s=a+r.p.reccount,r.p.scroll&&(n=b("tbody:first > tr:gt(0)",r.grid.bDiv),a=s-n.length,r.p.reccount=n.length,(i=n.outerHeight()||r.grid.prevRowHeight)&&(n=a*i,i*=parseInt(r.p.records,10),b(">div:first",r.grid.bDiv).css({height:i}).children("div:first").css({height:n,display:n?"":"none"})),r.grid.bDiv.scrollLeft=r.grid.hDiv.scrollLeft),c=r.p.pager?r.p.pager:"",c+=r.p.toppager?c?","+r.p.toppager:r.p.toppager:"",c&&(d=b.jgrid.formatter.integer||{},n=u(r.p.page),i=u(r.p.lastpage),b(".selbox",c).attr("disabled",!1),r.p.pginput===!0&&(b(".ui-pg-input",c).val(r.p.page),b("#sp_1",c).html(b.fmatter?b.fmatter.util.NumberFormat(r.p.lastpage,d):r.p.lastpage)),r.p.viewrecords&&(0===r.p.reccount?b(".ui-paging-info",c).html(r.p.emptyrecords):(o=a+1,l=r.p.records,b.fmatter&&(o=b.fmatter.util.NumberFormat(o,d),s=b.fmatter.util.NumberFormat(s,d),l=b.fmatter.util.NumberFormat(l,d)),b(".ui-paging-info",c).html(b.jgrid.format(r.p.recordtext,o,s,l)))),r.p.pgbuttons===!0&&(0>=n&&(n=i=0),1==n||0===n?(b("#first, #prev",r.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover"),r.p.toppager&&b("#first_t, #prev_t",r.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")):(b("#first, #prev",r.p.pager).removeClass("ui-state-disabled"),r.p.toppager&&b("#first_t, #prev_t",r.p.toppager).removeClass("ui-state-disabled")),n==i||0===n?(b("#next, #last",r.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover"),r.p.toppager&&b("#next_t, #last_t",r.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")):(b("#next, #last",r.p.pager).removeClass("ui-state-disabled"),r.p.toppager&&b("#next_t, #last_t",r.p.toppager).removeClass("ui-state-disabled")))),e===!0&&r.p.rownumbers===!0&&b("td.jqgrid-rownum",r.rows).each(function(e){b(this).html(a+1+e)}),t&&r.p.jqgdnd&&b(r).jqGrid("gridDnD","updateDnD"),b.isFunction(r.p.gridComplete)&&r.p.gridComplete.call(r)},r.refreshIndex=C,r.formatter=function(e,t,n,i,a){return f(e,t,n,i,a)},b.extend(n,{populate:T,emptyRows:w}),this.grid=n,r.addXmlData=function(e){k(e,r.grid.bDiv)},r.addJSONData=function(e){x(e,r.grid.bDiv)},this.grid.cols=this.rows[0].cells,T(),r.p.hiddengrid=!1,b(window).unload(function(){r=null})}}}})},b.jgrid.extend({getGridParam:function(e){var t=this[0];return t&&t.grid?e?"undefined"!=typeof t.p[e]?t.p[e]:null:t.p:void 0},setGridParam:function(e){return this.each(function(){this.grid&&"object"==typeof e&&b.extend(!0,this.p,e)})},getDataIDs:function(){var e,t=[],n=0,i=0;return this.each(function(){if((e=this.rows.length)&&e>0)for(;e>n;)b(this.rows[n]).hasClass("jqgrow")&&(t[i]=this.rows[n].id,i++),n++}),t},setSelection:function(e,t){return this.each(function(){function n(e){var t=b(o.grid.bDiv)[0].clientHeight,n=b(o.grid.bDiv)[0].scrollTop,i=o.rows[e].offsetTop;e=o.rows[e].clientHeight,i+e>=t+n?b(o.grid.bDiv)[0].scrollTop=i-(t+n)+e+n:t+n>i&&n>i&&(b(o.grid.bDiv)[0].scrollTop=i)}var i,a,r,o=this;void 0!==e&&(t=t===!1?!1:!0,a=o.rows.namedItem(e+""),!a||a.className.indexOf("ui-state-disabled")>-1||(o.p.scrollrows===!0&&(i=o.rows.namedItem(e).rowIndex,i>=0&&n(i)),o.p.multiselect?(o.p.selrow=a.id,r=b.inArray(o.p.selrow,o.p.selarrrow),-1===r?("ui-subgrid"!==a.className&&b(a).addClass("ui-state-highlight").attr("aria-selected","true"),i=!0,b("#jqg_"+b.jgrid.jqID(o.p.id)+"_"+b.jgrid.jqID(o.p.selrow)).attr("checked",i),o.p.selarrrow.push(o.p.selrow)):("ui-subgrid"!==a.className&&b(a).removeClass("ui-state-highlight").attr("aria-selected","false"),i=!1,b("#jqg_"+b.jgrid.jqID(o.p.id)+"_"+b.jgrid.jqID(o.p.selrow)).attr("checked",i),o.p.selarrrow.splice(r,1),r=o.p.selarrrow[0],o.p.selrow=void 0===r?null:r),o.p.onSelectRow&&t&&o.p.onSelectRow.call(o,a.id,i)):"ui-subgrid"!==a.className&&(o.p.selrow!=a.id?(b(o.rows.namedItem(o.p.selrow)).removeClass("ui-state-highlight").attr({"aria-selected":"false",tabindex:"-1"}),b(a).addClass("ui-state-highlight").attr({"aria-selected":!0,tabindex:"0"}),i=!0):i=!1,o.p.selrow=a.id,o.p.onSelectRow&&t&&o.p.onSelectRow.call(o,a.id,i))))})},resetSelection:function(e){return this.each(function(){var t,n,i=this;"undefined"!=typeof e?(n=e===i.p.selrow?i.p.selrow:e,b("#"+b.jgrid.jqID(i.p.id)+" tbody:first tr#"+b.jgrid.jqID(n)).removeClass("ui-state-highlight").attr("aria-selected","false"),i.p.multiselect&&(b("#jqg_"+b.jgrid.jqID(i.p.id)+"_"+b.jgrid.jqID(n)).attr("checked",!1),b("#cb_"+b.jgrid.jqID(i.p.id)).attr("checked",!1)),n=null):i.p.multiselect?(b(i.p.selarrrow).each(function(e,n){t=i.rows.namedItem(n),b(t).removeClass("ui-state-highlight").attr("aria-selected","false"),b("#jqg_"+b.jgrid.jqID(i.p.id)+"_"+b.jgrid.jqID(n)).attr("checked",!1)}),b("#cb_"+b.jgrid.jqID(i.p.id)).attr("checked",!1),i.p.selarrrow=[]):i.p.selrow&&(b("#"+b.jgrid.jqID(i.p.id)+" tbody:first tr#"+b.jgrid.jqID(i.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false"),i.p.selrow=null),i.p.savedRow=[]})},getRowData:function(e){var t,n,i={},a=!1,r=0;return this.each(function(){var o,s,l=this;if("undefined"==typeof e)a=!0,t=[],n=l.rows.length;else{if(s=l.rows.namedItem(e),!s)return i;n=2}for(;n>r;)a&&(s=l.rows[r]),b(s).hasClass("jqgrow")&&(b("td",s).each(function(e){if(o=l.p.colModel[e].name,"cb"!==o&&"subgrid"!==o&&"rn"!==o)if(l.p.treeGrid===!0&&o==l.p.ExpandColumn)i[o]=b.jgrid.htmlDecode(b("span:first",this).html());else try{i[o]=b.unformat(this,{rowId:s.id,colModel:l.p.colModel[e]},e)}catch(t){i[o]=b.jgrid.htmlDecode(b(this).html())}}),a&&(t.push(i),i={})),r++}),t?t:i},delRowData:function(e){var t,n,i=!1;return this.each(function(){if(!(t=this.rows.namedItem(e)))return!1;if(b(t).remove(),this.p.records--,this.p.reccount--,this.updatepager(!0,!1),i=!0,this.p.multiselect&&(n=b.inArray(e,this.p.selarrrow),-1!=n&&this.p.selarrrow.splice(n,1)),e==this.p.selrow&&(this.p.selrow=null),"local"==this.p.datatype){var a=this.p._index[e];"undefined"!=typeof a&&(this.p.data.splice(a,1),this.refreshIndex())}if(this.p.altRows===!0&&i){var r=this.p.altclass;b(this.rows).each(function(e){e%2==1?b(this).addClass(r):b(this).removeClass(r)})}}),i},setRowData:function(e,t,n){var i,a,r=!0;return this.each(function(){if(!this.grid)return!1;var o,s,l=this,d=typeof n,c={};if(s=l.rows.namedItem(e),!s)return!1;if(t)try{if(b(this.p.colModel).each(function(n){i=this.name,void 0!==t[i]&&(c[i]=this.formatter&&"string"==typeof this.formatter&&"date"==this.formatter?b.unformat.date(t[i],this):t[i],o=l.formatter(e,t[i],n,t,"edit"),a=this.title?{title:b.jgrid.stripHtml(o)}:{},l.p.treeGrid===!0&&i==l.p.ExpandColumn?b("td:eq("+n+") > span:first",s).html(o).attr(a):b("td:eq("+n+")",s).html(o).attr(a))}),"local"==l.p.datatype){var u=l.p._index[e];if(l.p.treeGrid)for(var h in l.p.treeReader)c.hasOwnProperty(l.p.treeReader[h])&&delete c[l.p.treeReader[h]];"undefined"!=typeof u&&(l.p.data[u]=b.extend(!0,l.p.data[u],c)),c=null}}catch(p){r=!1}r&&("string"===d?b(s).addClass(n):"object"===d&&b(s).css(n))}),r},addRowData:function(e,t,n,i){n||(n="last");var a,r,o,s,l,d,c,u,h,p,f,g,m,v=!1,y="";return t&&(b.isArray(t)?(h=!0,n="last",p=e):(t=[t],h=!1),this.each(function(){var _=t.length;l=this.p.rownumbers===!0?1:0,o=this.p.multiselect===!0?1:0,s=this.p.subGrid===!0?1:0,h||("undefined"!=typeof e?e+="":(e=b.jgrid.randId(),this.p.keyIndex!==!1&&(p=this.p.colModel[this.p.keyIndex+o+s+l].name,"undefined"!=typeof t[0][p]&&(e=t[0][p])))),f=this.p.altclass;for(var w=0,C="",k={},x=b.isFunction(this.p.afterInsertRow)?!0:!1;_>w;){if(g=t[w],r="",h){try{e=g[p]}catch(S){e=b.jgrid.randId()}C=this.p.altRows===!0&&(this.rows.length-1)%2===0?f:""}for(l&&(y=this.formatCol(0,1,"",null,e,!0),r+='<td role="gridcell" aria-describedby="'+this.p.id+'_rn" class="ui-state-default jqgrid-rownum" '+y+">0</td>"),o&&(u='<input role="checkbox" type="checkbox" id="jqg_'+this.p.id+"_"+e+'" class="cbox"/>',y=this.formatCol(l,1,"",null,e,!0),r+='<td role="gridcell" aria-describedby="'+this.p.id+'_cb" '+y+">"+u+"</td>"),s&&(r+=b(this).jqGrid("addSubGridCell",o+l,1)),c=o+s+l;c<this.p.colModel.length;c++)m=this.p.colModel[c],a=m.name,k[a]=m.formatter&&"string"==typeof m.formatter&&"date"==m.formatter?b.unformat.date(g[a],m):g[a],u=this.formatter(e,b.jgrid.getAccessor(g,a),c,g,"edit"),y=this.formatCol(c,1,u,e,g,!0),r+='<td role="gridcell" aria-describedby="'+this.p.id+"_"+a+'" '+y+">"+u+"</td>";if(r='<tr id="'+e+'" role="row" tabindex="-1" class="ui-widget-content jqgrow ui-row-'+this.p.direction+" "+C+'">'+r+"</tr>",this.p.subGrid===!0&&(r=b(r)[0],b(this).jqGrid("addSubGrid",r,o+l)),0===this.rows.length)b("table:first",this.grid.bDiv).append(r);else switch(n){case"last":b(this.rows[this.rows.length-1]).after(r);break;case"first":b(this.rows[0]).after(r);break;case"after":(d=this.rows.namedItem(i))&&(b(this.rows[d.rowIndex+1]).hasClass("ui-subgrid")?b(this.rows[d.rowIndex+1]).after(r):b(d).after(r));break;case"before":(d=this.rows.namedItem(i))&&(b(d).before(r),d=d.rowIndex)}this.p.records++,this.p.reccount++,x&&this.p.afterInsertRow.call(this,e,g,g),w++,"local"==this.p.datatype&&(k[this.p.localReader.id]=e,this.p._index[e]=this.p.data.length,this.p.data.push(k),k={})}this.p.altRows!==!0||h||("last"==n?(this.rows.length-1)%2==1&&b(this.rows[this.rows.length-1]).addClass(f):b(this.rows).each(function(e){e%2==1?b(this).addClass(f):b(this).removeClass(f)})),this.updatepager(!0,!0),v=!0})),v},footerData:function(e,t,n){function i(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var a,r,o=!1,s={};return"undefined"==typeof e&&(e="get"),"boolean"!=typeof n&&(n=!0),e=e.toLowerCase(),this.each(function(){var l,d=this;return d.grid&&d.p.footerrow?"set"==e&&i(t)?!1:(o=!0,void b(this.p.colModel).each(function(i){a=this.name,"set"==e?void 0!==t[a]&&(l=n?d.formatter("",t[a],i,t,"edit"):t[a],r=this.title?{title:b.jgrid.stripHtml(l)}:{},b("tr.footrow td:eq("+i+")",d.grid.sDiv).html(l).attr(r),o=!0):"get"==e&&(s[a]=b("tr.footrow td:eq("+i+")",d.grid.sDiv).html())})):!1}),"get"==e?s:o},showHideCol:function(e,t){return this.each(function(){var n,i=this,a=!1,r=b.browser.webkit||b.browser.safari?0:i.p.cellLayout;if(i.grid){"string"==typeof e&&(e=[e]),t="none"!=t?"":"none";var o=""===t?!0:!1;b(this.p.colModel).each(function(s){-1!==b.inArray(this.name,e)&&this.hidden===o&&(b("tr",i.grid.hDiv).each(function(){b(this).children("th:eq("+s+")").css("display",t)}),b(i.rows).each(function(){b(this).children("td:eq("+s+")").css("display",t)}),i.p.footerrow&&b(i.grid.sDiv).children("td:eq("+s+")").css("display",t),n=this.widthOrg?this.widthOrg:parseInt(this.width,10),"none"===t?i.p.tblwidth-=n+r:i.p.tblwidth+=n+r,this.hidden=!o,a=!0)}),a===!0&&i.grid.width!==i.p.tblwidth&&b(i).jqGrid("setGridWidth",i.p.shrinkToFit===!0?i.grid.width:i.p.tblwidth,!0)}})},hideCol:function(e){return this.each(function(){b(this).jqGrid("showHideCol",e,"none")})},showCol:function(e){return this.each(function(){b(this).jqGrid("showHideCol",e,"")})},remapColumns:function(e,t,n){function i(t){var n;n=t.length?b.makeArray(t):b.extend({},t),b.each(e,function(e){t[e]=n[this]})}function a(t,n){b(">tr"+(n||""),t).each(function(){var t=this,n=b.makeArray(t.cells);b.each(e,function(){var e=n[this];e&&t.appendChild(e)})})}var r=this.get(0);i(r.p.colModel),i(r.p.colNames),i(r.grid.headers),a(b("thead:first",r.grid.hDiv),n&&":not(.ui-jqgrid-labels)"),t&&a(b("#"+b.jgrid.jqID(r.p.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot"),r.p.footerrow&&a(b("tbody:first",r.grid.sDiv)),r.p.remapColumns&&(r.p.remapColumns.length?i(r.p.remapColumns):r.p.remapColumns=b.makeArray(e)),r.p.lastsort=b.inArray(r.p.lastsort,e),r.p.treeGrid&&(r.p.expColInd=b.inArray(r.p.expColInd,e))},setGridWidth:function(e,t){return this.each(function(){if(this.grid){var n,i,a,r,o=this,s=0,l=b.browser.webkit||b.browser.safari?0:o.p.cellLayout,d=0,c=!1,u=o.p.scrollOffset,h=0,p=0;if("boolean"!=typeof t&&(t=o.p.shrinkToFit),!isNaN(e)&&(e=parseInt(e,10),o.grid.width=o.p.width=e,b("#gbox_"+b.jgrid.jqID(o.p.id)).css("width",e+"px"),b("#gview_"+b.jgrid.jqID(o.p.id)).css("width",e+"px"),b(o.grid.bDiv).css("width",e+"px"),b(o.grid.hDiv).css("width",e+"px"),o.p.pager&&b(o.p.pager).css("width",e+"px"),o.p.toppager&&b(o.p.toppager).css("width",e+"px"),o.p.toolbar[0]===!0&&(b(o.grid.uDiv).css("width",e+"px"),"both"==o.p.toolbar[1]&&b(o.grid.ubDiv).css("width",e+"px")),o.p.footerrow&&b(o.grid.sDiv).css("width",e+"px"),t===!1&&o.p.forceFit===!0&&(o.p.forceFit=!1),t===!0&&(b.each(o.p.colModel,function(){this.hidden===!1&&(n=this.widthOrg?this.widthOrg:parseInt(this.width,10),s+=n+l,this.fixed?h+=n+l:d++,p++)}),0!==d))){o.p.tblwidth=s,a=e-l*d-h,isNaN(o.p.height)||(b(o.grid.bDiv)[0].clientHeight<b(o.grid.bDiv)[0].scrollHeight||1===o.rows.length)&&(c=!0,a-=u),s=0;var f=o.grid.cols.length>0;b.each(o.p.colModel,function(e){this.hidden!==!1||this.fixed||(n=this.widthOrg?this.widthOrg:parseInt(this.width,10),n=Math.round(a*n/(o.p.tblwidth-l*d-h)),0>n||(this.width=n,s+=n,o.grid.headers[e].width=n,o.grid.headers[e].el.style.width=n+"px",o.p.footerrow&&(o.grid.footers[e].style.width=n+"px"),f&&(o.grid.cols[e].style.width=n+"px"),i=e))}),r=0,c?e-h-(s+l*d)!==u&&(r=e-h-(s+l*d)-u):1!==Math.abs(e-h-(s+l*d))&&(r=e-h-(s+l*d)),o.p.colModel[i].width+=r,o.p.tblwidth=s+r+l*d+h,o.p.tblwidth>e?(c=o.p.tblwidth-parseInt(e,10),o.p.tblwidth=e,n=o.p.colModel[i].width-=c):n=o.p.colModel[i].width,o.grid.headers[i].width=n,o.grid.headers[i].el.style.width=n+"px",f&&(o.grid.cols[i].style.width=n+"px"),b("table:first",o.grid.bDiv).css("width",o.p.tblwidth+"px"),b("table:first",o.grid.hDiv).css("width",o.p.tblwidth+"px"),o.grid.hDiv.scrollLeft=o.grid.bDiv.scrollLeft,o.p.footerrow&&(o.grid.footers[i].style.width=n+"px",b("table:first",o.grid.sDiv).css("width",o.p.tblwidth+"px"))}}})},setGridHeight:function(e){return this.each(function(){this.grid&&(b(this.grid.bDiv).css({height:e+(isNaN(e)?"":"px")}),this.p.height=e,this.p.scroll&&this.grid.populateVisible())})},setCaption:function(e){return this.each(function(){this.p.caption=e,b("span.ui-jqgrid-title",this.grid.cDiv).html(e),b(this.grid.cDiv).show()})},setLabel:function(e,t,n,i){return this.each(function(){var a=-1;if(this.grid&&(isNaN(e)?b(this.p.colModel).each(function(t){return this.name==e?(a=t,!1):void 0}):a=parseInt(e,10),a>=0)){var r=b("tr.ui-jqgrid-labels th:eq("+a+")",this.grid.hDiv);if(t){var o=b(".s-ico",r);b("[id^=jqgh_]",r).empty().html(t).append(o),this.p.colNames[a]=t}n&&("string"==typeof n?b(r).addClass(n):b(r).css(n)),"object"==typeof i&&b(r).attr(i)}})},setCell:function(e,t,n,i,a,r){return this.each(function(){var o,s,l=-1;if(this.grid&&(isNaN(t)?b(this.p.colModel).each(function(e){return this.name==t?(l=e,!1):void 0}):l=parseInt(t,10),l>=0&&(o=this.rows.namedItem(e)))){var d=b("td:eq("+l+")",o);(""!==n||r===!0)&&(o=this.formatter(e,n,l,o,"edit"),s=this.p.colModel[l].title?{title:b.jgrid.stripHtml(o)}:{},this.p.treeGrid&&b(".tree-wrap",b(d)).length>0?b("span",b(d)).html(o).attr(s):b(d).html(o).attr(s),"local"==this.p.datatype&&(o=this.p.colModel[l],n=o.formatter&&"string"==typeof o.formatter&&"date"==o.formatter?b.unformat.date(n,o):n,s=this.p._index[e],"undefined"!=typeof s&&(this.p.data[s][o.name]=n))),"string"==typeof i?b(d).addClass(i):i&&b(d).css(i),"object"==typeof a&&b(d).attr(a)}})},getCell:function(e,t){var n=!1;return this.each(function(){var i=-1;if(this.grid&&(isNaN(t)?b(this.p.colModel).each(function(e){return this.name===t?(i=e,!1):void 0}):i=parseInt(t,10),i>=0)){var a=this.rows.namedItem(e);if(a)try{n=b.unformat(b("td:eq("+i+")",a),{rowId:a.id,colModel:this.p.colModel[i]},i)}catch(r){n=b.jgrid.htmlDecode(b("td:eq("+i+")",a).html())}}}),n},getCol:function(e,t,n){var i,a,r=[],o=0,s=0,l=0;return t="boolean"!=typeof t?!1:t,"undefined"==typeof n&&(n=!1),this.each(function(){var d=-1;if(this.grid&&(isNaN(e)?b(this.p.colModel).each(function(t){return this.name===e?(d=t,!1):void 0}):d=parseInt(e,10),d>=0)){var c=this.rows.length,u=0;if(c&&c>0){for(;c>u;){if(b(this.rows[u]).hasClass("jqgrow")){try{i=b.unformat(b(this.rows[u].cells[d]),{rowId:this.rows[u].id,colModel:this.p.colModel[d]},d)}catch(h){i=b.jgrid.htmlDecode(this.rows[u].cells[d].innerHTML)}n?(a=parseFloat(i),o+=a,s=Math.min(s,a),l=Math.max(s,a)):r.push(t?{id:this.rows[u].id,value:i}:i)}u++}if(n)switch(n.toLowerCase()){case"sum":r=o;break;case"avg":r=o/c;break;case"count":r=c;break;case"min":r=s;break;case"max":r=l}}}}),r},clearGridData:function(e){return this.each(function(){if(this.grid){if("boolean"!=typeof e&&(e=!1),this.p.deepempty)b("#"+b.jgrid.jqID(this.p.id)+" tbody:first tr:gt(0)").remove();else{var t=b("#"+b.jgrid.jqID(this.p.id)+" tbody:first tr:first")[0];b("#"+b.jgrid.jqID(this.p.id)+" tbody:first").empty().append(t)}this.p.footerrow&&e&&b(".ui-jqgrid-ftable td",this.grid.sDiv).html("&#160;"),this.p.selrow=null,this.p.selarrrow=[],this.p.savedRow=[],this.p.records=0,this.p.page=1,this.p.lastpage=0,this.p.reccount=0,this.p.data=[],this.p_index={},this.updatepager(!0,!1)}})},getInd:function(e,t){var n,i=!1;return this.each(function(){(n=this.rows.namedItem(e))&&(i=t===!0?n:n.rowIndex)}),i},bindKeys:function(e){var t=b.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:!0},e||{});return this.each(function(){var e=this;b("body").is("[role]")||b("body").attr("role","application"),e.p.scrollrows=t.scrollingRows,b(e).keydown(function(n){var i,a,r,o=b(e).find("tr[tabindex=0]")[0],s=e.p.treeReader.expanded_field;if(o){if(r=e.p._index[o.id],37===n.keyCode||38===n.keyCode||39===n.keyCode||40===n.keyCode){if(38===n.keyCode){if(a=o.previousSibling,i="",a)if(b(a).is(":hidden")){for(;a;)if(a=a.previousSibling,!b(a).is(":hidden")&&b(a).hasClass("jqgrow")){i=a.id;break}}else i=a.id;b(e).jqGrid("setSelection",i)}if(40===n.keyCode){if(a=o.nextSibling,i="",a)if(b(a).is(":hidden")){for(;a;)if(a=a.nextSibling,!b(a).is(":hidden")&&b(a).hasClass("jqgrow")){i=a.id;break}}else i=a.id;b(e).jqGrid("setSelection",i)}return 37===n.keyCode&&(e.p.treeGrid&&e.p.data[r][s]&&b(o).find("div.treeclick").trigger("click"),b.isFunction(t.onLeftKey)&&t.onLeftKey.call(e,e.p.selrow)),39===n.keyCode&&(e.p.treeGrid&&!e.p.data[r][s]&&b(o).find("div.treeclick").trigger("click"),b.isFunction(t.onRightKey)&&t.onRightKey.call(e,e.p.selrow)),!1}if(13===n.keyCode)return b.isFunction(t.onEnter)&&t.onEnter.call(e,e.p.selrow),!1;if(32===n.keyCode)return b.isFunction(t.onSpace)&&t.onSpace.call(e,e.p.selrow),!1}})})},unbindKeys:function(){return this.each(function(){b(this).unbind("keydown")})},getLocalRow:function(e){var t,n=!1;return this.each(function(){"undefined"!=typeof e&&(t=this.p._index[e],t>=0&&(n=this.p.data[t]))}),n}})}(jQuery),function(e){e.fmatter={},e.extend(e.fmatter,{isBoolean:function(e){return"boolean"==typeof e},isObject:function(t){return t&&("object"==typeof t||e.isFunction(t))||!1},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isNull:function(e){return null===e},isUndefined:function(e){return"undefined"==typeof e},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isEmpty:function(t){return!this.isString(t)&&this.isValue(t)?!1:this.isValue(t)?(t=e.trim(t).replace(/\&nbsp\;/gi,"").replace(/\&#160\;/gi,""),""===t):!0}}),e.fn.fmatter=function(t,n,i,a,r){var o=n;return i=e.extend({},e.jgrid.formatter,i),e.fn.fmatter[t]&&(o=e.fn.fmatter[t](n,i,a,r)),o},e.fmatter.util={NumberFormat:function(t,n){if(e.fmatter.isNumber(t)||(t*=1),e.fmatter.isNumber(t)){var i,a=0>t,r=t+"",o=n.decimalSeparator?n.decimalSeparator:".";if(e.fmatter.isNumber(n.decimalPlaces)){var s=n.decimalPlaces;if(r=Math.pow(10,s),r=Math.round(t*r)/r+"",i=r.lastIndexOf("."),s>0)for(0>i?(r+=o,i=r.length-1):"."!==o&&(r=r.replace(".",o));r.length-1-i<s;)r+="0"}if(n.thousandsSeparator){s=n.thousandsSeparator,i=r.lastIndexOf(o),i=i>-1?i:r.length,o=r.substring(i);for(var l=-1,d=i;d>0;d--)l++,l%3===0&&d!==i&&(!a||d>1)&&(o=s+o),o=r.charAt(d-1)+o;r=o}return r=n.prefix?n.prefix+r:r,r=n.suffix?r+n.suffix:r}return t},DateFormat:function(t,n,i,a){var r=/^\/Date\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\)\/$/,o="string"==typeof n?n.match(r):null;r=function(e,t){for(e=String(e),t=parseInt(t,10)||2;e.length<t;)e="0"+e;return e};var s,l={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},d=0,c=["i18n"];if(c.i18n={dayNames:a.dayNames,monthNames:a.monthNames},t in a.masks&&(t=a.masks[t]),n.constructor===Number)"u"==String(t).toLowerCase()&&(n*=1e3),d=new Date(n);else if(n.constructor===Date)d=n;else if(null!==o)d=new Date(parseInt(o[1],10)),o[3]&&(t=60*Number(o[5])+Number(o[6]),t*="-"==o[4]?1:-1,t-=d.getTimezoneOffset(),d.setTime(Number(Number(d)+6e4*t)));else{for(n=String(n).split(/[\\\/:_;.,\t\T\s-]/),t=t.split(/[\\\/:_;.,\t\T\s-]/),o=0,s=t.length;s>o;o++)"M"==t[o]&&(d=e.inArray(n[o],c.i18n.monthNames),-1!==d&&12>d&&(n[o]=d+1)),"F"==t[o]&&(d=e.inArray(n[o],c.i18n.monthNames),-1!==d&&d>11&&(n[o]=d+1-12)),n[o]&&(l[t[o].toLowerCase()]=parseInt(n[o],10));if(l.f&&(l.m=l.f),0===l.m&&0===l.y&&0===l.d)return"&#160;";l.m=parseInt(l.m,10)-1,d=l.y,d>=70&&99>=d?l.y=1900+l.y:d>=0&&69>=d&&(l.y=2e3+l.y),d=new Date(l.y,l.m,l.d,l.h,l.i,l.s,l.u)}i in a.masks?i=a.masks[i]:i||(i="Y-m-d"),t=d.getHours(),n=d.getMinutes(),l=d.getDate(),o=d.getMonth()+1,s=d.getTimezoneOffset();var u=d.getSeconds(),h=d.getMilliseconds(),p=d.getDay(),f=d.getFullYear(),g=(p+6)%7+1,m=(new Date(f,o-1,l)-new Date(f,0,1))/864e5,b={d:r(l),D:c.i18n.dayNames[p],j:l,l:c.i18n.dayNames[p+7],N:g,S:a.S(l),w:p,z:m,W:5>g?Math.floor((m+g-1)/7)+1:Math.floor((m+g-1)/7)||((new Date(f-1,0,1).getDay()+6)%7<4?53:52),F:c.i18n.monthNames[o-1+12],m:r(o),M:c.i18n.monthNames[o-1],n:o,t:"?",L:"?",o:"?",Y:f,y:String(f).substring(2),a:12>t?a.AmPm[0]:a.AmPm[1],A:12>t?a.AmPm[2]:a.AmPm[3],B:"?",g:t%12||12,G:t,h:r(t%12||12),H:r(t),i:r(n),s:r(u),u:h,e:"?",I:"?",O:(s>0?"-":"+")+r(100*Math.floor(Math.abs(s)/60)+Math.abs(s)%60,4),P:"?",T:(String(d).match(/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g)||[""]).pop().replace(/[^-+\dA-Z]/g,""),Z:"?",c:"?",r:"?",U:Math.floor(d/1e3)};return i.replace(/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,function(e){return e in b?b[e]:e.substring(1)})}},e.fn.fmatter.defaultFormat=function(t,n){return e.fmatter.isValue(t)&&""!==t?t:n.defaultValue?n.defaultValue:"&#160;"},e.fn.fmatter.email=function(t,n){return e.fmatter.isEmpty(t)?e.fn.fmatter.defaultFormat(t,n):'<a href="mailto:'+t+'">'+t+"</a>"},e.fn.fmatter.checkbox=function(t,n){var i,a=e.extend({},n.checkbox);return e.fmatter.isUndefined(n.colModel.formatoptions)||(a=e.extend({},a,n.colModel.formatoptions)),i=a.disabled===!0?'disabled="disabled"':"",(e.fmatter.isEmpty(t)||e.fmatter.isUndefined(t))&&(t=e.fn.fmatter.defaultFormat(t,a)),t+="",t=t.toLowerCase(),'<input type="checkbox" '+(t.search(/(false|0|no|off)/i)<0?" checked='checked' ":"")+' value="'+t+'" offval="no" '+i+"/>"},e.fn.fmatter.link=function(t,n){var i={target:n.target},a="";return e.fmatter.isUndefined(n.colModel.formatoptions)||(i=e.extend({},i,n.colModel.formatoptions)),i.target&&(a="target="+i.target),e.fmatter.isEmpty(t)?e.fn.fmatter.defaultFormat(t,n):"<a "+a+' href="'+t+'">'+t+"</a>"},e.fn.fmatter.showlink=function(t,n){var i={baseLinkUrl:n.baseLinkUrl,showAction:n.showAction,addParam:n.addParam||"",target:n.target,idName:n.idName},a="";return e.fmatter.isUndefined(n.colModel.formatoptions)||(i=e.extend({},i,n.colModel.formatoptions)),i.target&&(a="target="+i.target),i=i.baseLinkUrl+i.showAction+"?"+i.idName+"="+n.rowId+i.addParam,e.fmatter.isString(t)||e.fmatter.isNumber(t)?"<a "+a+' href="'+i+'">'+t+"</a>":e.fn.fmatter.defaultFormat(t,n)},e.fn.fmatter.integer=function(t,n){var i=e.extend({},n.integer);return e.fmatter.isUndefined(n.colModel.formatoptions)||(i=e.extend({},i,n.colModel.formatoptions)),e.fmatter.isEmpty(t)?i.defaultValue:e.fmatter.util.NumberFormat(t,i)
},e.fn.fmatter.number=function(t,n){var i=e.extend({},n.number);return e.fmatter.isUndefined(n.colModel.formatoptions)||(i=e.extend({},i,n.colModel.formatoptions)),e.fmatter.isEmpty(t)?i.defaultValue:e.fmatter.util.NumberFormat(t,i)},e.fn.fmatter.currency=function(t,n){var i=e.extend({},n.currency);return e.fmatter.isUndefined(n.colModel.formatoptions)||(i=e.extend({},i,n.colModel.formatoptions)),e.fmatter.isEmpty(t)?i.defaultValue:e.fmatter.util.NumberFormat(t,i)},e.fn.fmatter.date=function(t,n,i,a){return i=e.extend({},n.date),e.fmatter.isUndefined(n.colModel.formatoptions)||(i=e.extend({},i,n.colModel.formatoptions)),i.reformatAfterEdit||"edit"!=a?e.fmatter.isEmpty(t)?e.fn.fmatter.defaultFormat(t,n):e.fmatter.util.DateFormat(i.srcformat,t,i.newformat,i):e.fn.fmatter.defaultFormat(t,n)},e.fn.fmatter.select=function(t,n){t+="";var i=!1,a=[];if(e.fmatter.isUndefined(n.colModel.formatoptions)?e.fmatter.isUndefined(n.colModel.editoptions)||(i=n.colModel.editoptions.value):i=n.colModel.formatoptions.value,i){var r,o=n.colModel.editoptions.multiple===!0?!0:!1,s=[];if(o&&(s=t.split(","),s=e.map(s,function(t){return e.trim(t)})),e.fmatter.isString(i)){for(var l=i.split(";"),d=0,c=0;c<l.length;c++)if(r=l[c].split(":"),r.length>2&&(r[1]=jQuery.map(r,function(e,t){return t>0?e:void 0}).join(":")),o)jQuery.inArray(r[0],s)>-1&&(a[d]=r[1],d++);else if(e.trim(r[0])==e.trim(t)){a[0]=r[1];break}}else e.fmatter.isObject(i)&&(o?a=jQuery.map(s,function(e){return i[e]}):a[0]=i[t]||"")}return t=a.join(", "),""===t?e.fn.fmatter.defaultFormat(t,n):t},e.fn.fmatter.rowactions=function(t,n,i,a){var r={keys:!1,editbutton:!0,delbutton:!0,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{oper:"edit"},url:null,delOptions:{}};a=e("#"+n)[0].p.colModel[a],e.fmatter.isUndefined(a.formatoptions)||(r=e.extend(r,a.formatoptions)),a=function(i){r.afterSave&&r.afterSave(i),e("tr#"+t+" div.ui-inline-edit, tr#"+t+" div.ui-inline-del","#"+n).show(),e("tr#"+t+" div.ui-inline-save, tr#"+t+" div.ui-inline-cancel","#"+n).hide()};var o=function(i){r.afterRestore&&r.afterRestore(i),e("tr#"+t+" div.ui-inline-edit, tr#"+t+" div.ui-inline-del","#"+n).show(),e("tr#"+t+" div.ui-inline-save, tr#"+t+" div.ui-inline-cancel","#"+n).hide()};switch(i){case"edit":e("#"+n).jqGrid("editRow",t,r.keys,r.onEdit,r.onSuccess,r.url,r.extraparam,a,r.onError,o),e("tr#"+t+" div.ui-inline-edit, tr#"+t+" div.ui-inline-del","#"+n).hide(),e("tr#"+t+" div.ui-inline-save, tr#"+t+" div.ui-inline-cancel","#"+n).show();break;case"save":e("#"+n).jqGrid("saveRow",t,r.onSuccess,r.url,r.extraparam,a,r.onError,o)&&(e("tr#"+t+" div.ui-inline-edit, tr#"+t+" div.ui-inline-del","#"+n).show(),e("tr#"+t+" div.ui-inline-save, tr#"+t+" div.ui-inline-cancel","#"+n).hide());break;case"cancel":e("#"+n).jqGrid("restoreRow",t,o),e("tr#"+t+" div.ui-inline-edit, tr#"+t+" div.ui-inline-del","#"+n).show(),e("tr#"+t+" div.ui-inline-save, tr#"+t+" div.ui-inline-cancel","#"+n).hide();break;case"del":e("#"+n).jqGrid("delGridRow",t,r.delOptions)}},e.fn.fmatter.actions=function(t,n){var i={keys:!1,editbutton:!0,delbutton:!0};e.fmatter.isUndefined(n.colModel.formatoptions)||(i=e.extend(i,n.colModel.formatoptions));var a,r=n.rowId,o="";return"undefined"==typeof r||e.fmatter.isEmpty(r)?"":(i.editbutton&&(a="onclick=$.fn.fmatter.rowactions('"+r+"','"+n.gid+"','edit',"+n.pos+");",o=o+"<div style='margin-left:8px;'><div title='"+e.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+a+"><span class='ui-icon ui-icon-pencil'></span></div>"),i.delbutton&&(a="onclick=$.fn.fmatter.rowactions('"+r+"','"+n.gid+"','del',"+n.pos+");",o=o+"<div title='"+e.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+a+"><span class='ui-icon ui-icon-trash'></span></div>"),a="onclick=$.fn.fmatter.rowactions('"+r+"','"+n.gid+"','save',"+n.pos+");",o=o+"<div title='"+e.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save'><span class='ui-icon ui-icon-disk' "+a+"></span></div>",a="onclick=$.fn.fmatter.rowactions('"+r+"','"+n.gid+"','cancel',"+n.pos+");",o=o+"<div title='"+e.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel'><span class='ui-icon ui-icon-cancel' "+a+"></span></div></div>")},e.unformat=function(t,n,i,a){var r,o=n.colModel.formatter,s=n.colModel.formatoptions||{},l=/([\.\*\_\'\(\)\{\}\+\?\\])/g,d=n.colModel.unformat||e.fn.fmatter[o]&&e.fn.fmatter[o].unformat;if("undefined"!=typeof d&&e.isFunction(d))r=d(e(t).text(),n,t);else if(!e.fmatter.isUndefined(o)&&e.fmatter.isString(o))switch(r=e.jgrid.formatter||{},o){case"integer":s=e.extend({},r.integer,s),n=s.thousandsSeparator.replace(l,"\\$1"),r=e(t).text().replace(RegExp(n,"g"),"");break;case"number":s=e.extend({},r.number,s),n=s.thousandsSeparator.replace(l,"\\$1"),r=e(t).text().replace(RegExp(n,"g"),"").replace(s.decimalSeparator,".");break;case"currency":s=e.extend({},r.currency,s),n=s.thousandsSeparator.replace(l,"\\$1"),r=e(t).text().replace(RegExp(n,"g"),"").replace(s.decimalSeparator,".").replace(s.prefix,"").replace(s.suffix,"");break;case"checkbox":s=n.colModel.editoptions?n.colModel.editoptions.value.split(":"):["Yes","No"],r=e("input",t).attr("checked")?s[0]:s[1];break;case"select":r=e.unformat.select(t,n,i,a);break;case"actions":return"";default:r=e(t).text()}return r?r:a===!0?e(t).text():e.jgrid.htmlDecode(e(t).html())},e.unformat.select=function(t,n,i,a){if(i=[],t=e(t).text(),a===!0)return t;if(n=e.extend({},n.colModel.editoptions),n.value){var r=n.value;n=n.multiple===!0?!0:!1,a=[];var o;if(n&&(a=t.split(","),a=e.map(a,function(t){return e.trim(t)})),e.fmatter.isString(r)){for(var s=r.split(";"),l=0,d=0;d<s.length;d++)if(o=s[d].split(":"),o.length>2&&(o[1]=jQuery.map(o,function(e,t){return t>0?e:void 0}).join(":")),n)jQuery.inArray(o[1],a)>-1&&(i[l]=o[0],l++);else if(e.trim(o[1])==e.trim(t)){i[0]=o[0];break}}else(e.fmatter.isObject(r)||e.isArray(r))&&(n||(a[0]=t),i=jQuery.map(a,function(t){var n;return e.each(r,function(e,i){return i==t?(n=e,!1):void 0}),"undefined"!=typeof n?n:void 0}));return i.join(", ")}return t||""},e.unformat.date=function(t,n){var i=e.jgrid.formatter.date||{};return e.fmatter.isUndefined(n.formatoptions)||(i=e.extend({},i,n.formatoptions)),e.fmatter.isEmpty(t)?e.fn.fmatter.defaultFormat(t,n):e.fmatter.util.DateFormat(i.newformat,t,i.srcformat,i)}}(jQuery),function(e){e.jgrid.extend({getColProp:function(e){var t={},n=this[0];if(!n.grid)return!1;n=n.p.colModel;for(var i=0;i<n.length;i++)if(n[i].name==e){t=n[i];break}return t},setColProp:function(t,n){return this.each(function(){if(this.grid&&n)for(var i=this.p.colModel,a=0;a<i.length;a++)if(i[a].name==t){e.extend(this.p.colModel[a],n);break}})},sortGrid:function(e,t,n){return this.each(function(){var i=-1;if(this.grid){e||(e=this.p.sortname);for(var a=0;a<this.p.colModel.length;a++)if(this.p.colModel[a].index==e||this.p.colModel[a].name==e){i=a;break}-1!=i&&(a=this.p.colModel[i].sortable,"boolean"!=typeof a&&(a=!0),"boolean"!=typeof t&&(t=!1),a&&this.sortData("jqgh_"+e,i,t,n))}})},GridDestroy:function(){return this.each(function(){if(this.grid){this.p.pager&&e(this.p.pager).remove();var t=this.id;try{e("#gbox_"+t).remove()}catch(n){}}})},GridUnload:function(){return this.each(function(){if(this.grid){var t={id:e(this).attr("id"),cl:e(this).attr("class")};this.p.pager&&e(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom");var n=document.createElement("table");e(n).attr({id:t.id}),n.className=t.cl,t=this.id,e(n).removeClass("ui-jqgrid-btable"),1===e(this.p.pager).parents("#gbox_"+t).length?(e(n).insertBefore("#gbox_"+t).show(),e(this.p.pager).insertBefore("#gbox_"+t)):e(n).insertBefore("#gbox_"+t).show(),e("#gbox_"+t).remove()}})},setGridState:function(t){return this.each(function(){this.grid&&("hidden"==t?(e(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+this.p.id).slideUp("fast"),this.p.pager&&e(this.p.pager).slideUp("fast"),this.p.toppager&&e(this.p.toppager).slideUp("fast"),this.p.toolbar[0]===!0&&("both"==this.p.toolbar[1]&&e(this.grid.ubDiv).slideUp("fast"),e(this.grid.uDiv).slideUp("fast")),this.p.footerrow&&e(".ui-jqgrid-sdiv","#gbox_"+this.p.id).slideUp("fast"),e(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),this.p.gridstate="hidden"):"visible"==t&&(e(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+this.p.id).slideDown("fast"),this.p.pager&&e(this.p.pager).slideDown("fast"),this.p.toppager&&e(this.p.toppager).slideDown("fast"),this.p.toolbar[0]===!0&&("both"==this.p.toolbar[1]&&e(this.grid.ubDiv).slideDown("fast"),e(this.grid.uDiv).slideDown("fast")),this.p.footerrow&&e(".ui-jqgrid-sdiv","#gbox_"+this.p.id).slideDown("fast"),e(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),this.p.gridstate="visible"))})},filterToolbar:function(t){return t=e.extend({autosearch:!0,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw"},t||{}),this.each(function(){function n(t,n){var i=e(t);i[0]&&jQuery.each(n,function(){void 0!==this.data?i.bind(this.type,this.data,this.fn):i.bind(this.type,this.fn)})}var i=this;if(!this.ftoolbar){var a,r=function(){var n,a,r,o={},s=0,l={};e.each(i.p.colModel,function(){switch(a=this.index||this.name,this.stype){case"select":if(r=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"eq",n=e("#gs_"+e.jgrid.jqID(a),i.grid.hDiv).val())o[a]=n,l[a]=r,s++;else try{delete i.p.postData[a]}catch(d){}break;case"text":if(r=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:t.defaultSearch,n=e("#gs_"+e.jgrid.jqID(a),i.grid.hDiv).val())o[a]=n,l[a]=r,s++;else try{delete i.p.postData[a]}catch(c){}}});var d=s>0?!0:!1;if(t.stringResult===!0||"local"==i.p.datatype){var c='{"groupOp":"'+t.groupOp+'","rules":[',u=0;e.each(o,function(e,t){u>0&&(c+=","),c+='{"field":"'+e+'",',c+='"op":"'+l[e]+'",',t+="",c+='"data":"'+t.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',u++}),c+="]}",e.extend(i.p.postData,{filters:c}),e.each(["searchField","searchString","searchOper"],function(e,t){i.p.postData.hasOwnProperty(t)&&delete i.p.postData[t]})}else e.extend(i.p.postData,o);var h;i.p.searchurl&&(h=i.p.url,e(i).jqGrid("setGridParam",{url:i.p.searchurl}));var p=!1;e.isFunction(t.beforeSearch)&&(p=t.beforeSearch.call(i)),p||e(i).jqGrid("setGridParam",{search:d}).trigger("reloadGrid",[{page:1}]),h&&e(i).jqGrid("setGridParam",{url:h}),e.isFunction(t.afterSearch)&&t.afterSearch()},o=e("<tr class='ui-search-toolbar' role='rowheader'></tr>");e.each(i.p.colModel,function(){var s,l,d,c,u=this;if(l=e("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+i.p.direction+"'></th>"),s=e("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>"),this.hidden===!0&&e(l).css("display","none"),this.search=this.search===!1?!1:!0,"undefined"==typeof this.stype&&(this.stype="text"),d=e.extend({},this.searchoptions||{}),this.search)switch(this.stype){case"select":if(c=this.surl||d.dataUrl)e.ajax(e.extend({url:c,dataType:"html",complete:function(i){void 0!==d.buildSelect?(i=d.buildSelect(i))&&e(s).append(i):e(s).append(i.responseText),d.defaultValue&&e("select",s).val(d.defaultValue),e("select",s).attr({name:u.index||u.name,id:"gs_"+u.name}),d.attr&&e("select",s).attr(d.attr),e("select",s).css({width:"100%"}),void 0!==d.dataInit&&d.dataInit(e("select",s)[0]),void 0!==d.dataEvents&&n(e("select",s)[0],d.dataEvents),t.autosearch===!0&&e("select",s).change(function(){return r(),!1}),i=null}},e.jgrid.ajaxOptions,i.p.ajaxSelectOptions||{}));else{var h;if(u.searchoptions&&u.searchoptions.value?h=u.searchoptions.value:u.editoptions&&u.editoptions.value&&(h=u.editoptions.value),h){c=document.createElement("select"),c.style.width="100%",e(c).attr({name:u.index||u.name,id:"gs_"+u.name});var p,f;if("string"==typeof h){h=h.split(";");for(var g=0;g<h.length;g++)p=h[g].split(":"),f=document.createElement("option"),f.value=p[0],f.innerHTML=p[1],c.appendChild(f)}else if("object"==typeof h)for(p in h)h.hasOwnProperty(p)&&(f=document.createElement("option"),f.value=p,f.innerHTML=h[p],c.appendChild(f));d.defaultValue&&e(c).val(d.defaultValue),d.attr&&e(c).attr(d.attr),void 0!==d.dataInit&&d.dataInit(c),void 0!==d.dataEvents&&n(c,d.dataEvents),e(s).append(c),t.autosearch===!0&&e(c).change(function(){return r(),!1})}}break;case"text":c=d.defaultValue?d.defaultValue:"",e(s).append("<input type='text' style='width:95%;padding:0px;' name='"+(u.index||u.name)+"' id='gs_"+u.name+"' value='"+c+"'/>"),d.attr&&e("input",s).attr(d.attr),void 0!==d.dataInit&&d.dataInit(e("input",s)[0]),void 0!==d.dataEvents&&n(e("input",s)[0],d.dataEvents),t.autosearch===!0&&(t.searchOnEnter?e("input",s).keypress(function(e){return 13==(e.charCode?e.charCode:e.keyCode?e.keyCode:0)?(r(),!1):this}):e("input",s).keydown(function(e){switch(e.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:a&&clearTimeout(a),a=setTimeout(function(){r()},500)}}))}e(l).append(s),e(o).append(l)}),e("table thead",i.grid.hDiv).append(o),this.ftoolbar=!0,this.triggerToolbar=r,this.clearToolbar=function(n){var a,r,o={},s=0;n="boolean"!=typeof n?!0:n,e.each(i.p.colModel,function(){switch(a=this.searchoptions&&this.searchoptions.defaultValue?this.searchoptions.defaultValue:"",r=this.index||this.name,this.stype){case"select":var t;if(e("#gs_"+e.jgrid.jqID(r)+" option",i.grid.hDiv).each(function(n){return 0===n&&(this.selected=!0),e(this).text()==a?(this.selected=!0,t=e(this).val(),!1):void 0}),t)o[r]=t,s++;else try{delete i.p.postData[r]}catch(n){}break;case"text":if(e("#gs_"+e.jgrid.jqID(r),i.grid.hDiv).val(a),a)o[r]=a,s++;else try{delete i.p.postData[r]}catch(l){}}});var l=s>0?!0:!1;if(t.stringResult===!0||"local"==i.p.datatype){var d='{"groupOp":"'+t.groupOp+'","rules":[',c=0;e.each(o,function(e,t){c>0&&(d+=","),d+='{"field":"'+e+'",',d+='"op":"eq",',t+="",d+='"data":"'+t.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',c++}),d+="]}",e.extend(i.p.postData,{filters:d}),e.each(["searchField","searchString","searchOper"],function(e,t){i.p.postData.hasOwnProperty(t)&&delete i.p.postData[t]})}else e.extend(i.p.postData,o);var u;i.p.searchurl&&(u=i.p.url,e(i).jqGrid("setGridParam",{url:i.p.searchurl}));var h=!1;e.isFunction(t.beforeClear)&&(h=t.beforeClear.call(i)),h||n&&e(i).jqGrid("setGridParam",{search:l}).trigger("reloadGrid",[{page:1}]),u&&e(i).jqGrid("setGridParam",{url:u}),e.isFunction(t.afterClear)&&t.afterClear()},this.toggleToolbar=function(){var t=e("tr.ui-search-toolbar",i.grid.hDiv);"none"==t.css("display")?t.show():t.hide()}}})}})}(jQuery),function(e){e.extend(e.jgrid,{showModal:function(e){e.w.show()},closeModal:function(e){e.w.hide().attr("aria-hidden","true"),e.o&&e.o.remove()},hideModal:function(t,n){if(n=e.extend({jqm:!0,gb:""},n||{}),n.onClose){var i=n.onClose(t);if("boolean"==typeof i&&!i)return}if(e.fn.jqm&&n.jqm===!0)e(t).attr("aria-hidden","true").jqmHide();else{if(""!==n.gb)try{e(".jqgrid-overlay:first",n.gb).hide()}catch(a){}e(t).hide().attr("aria-hidden","true")}},findPos:function(e){var t=0,n=0;if(e.offsetParent)do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return[t,n]},createModal:function(t,n,i,a,r,o,s){var l,d=document.createElement("div"),c=this;s=e.extend({},s||{}),l="rtl"==e(i.gbox).attr("dir")?!0:!1,d.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog",d.id=t.themodal;var u=document.createElement("div");u.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix",u.id=t.modalhead,e(u).append("<span class='ui-jqdialog-title'>"+i.caption+"</span>");var h=e("<a href='javascript:void(0)' class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){h.addClass("ui-state-hover")},function(){h.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-closethick'></span>");e(u).append(h),l?(d.dir="rtl",e(".ui-jqdialog-title",u).css("float","right"),e(".ui-jqdialog-titlebar-close",u).css("left","0.3em")):(d.dir="ltr",e(".ui-jqdialog-title",u).css("float","left"),e(".ui-jqdialog-titlebar-close",u).css("right","0.3em"));var p=document.createElement("div");if(e(p).addClass("ui-jqdialog-content ui-widget-content").attr("id",t.modalcontent),e(p).append(n),d.appendChild(p),e(d).prepend(u),o===!0?e("body").append(d):"string"==typeof o?e(o).append(d):e(d).insertBefore(a),e(d).css(s),"undefined"==typeof i.jqModal&&(i.jqModal=!0),n={},e.fn.jqm&&i.jqModal===!0?(0===i.left&&0===i.top&&i.overlay&&(s=[],s=this.findPos(r),i.left=s[0]+4,i.top=s[1]+4),n.top=i.top+"px",n.left=i.left):(0!==i.left||0!==i.top)&&(n.left=i.left,n.top=i.top+"px"),e("a.ui-jqdialog-titlebar-close",u).click(function(){var n=e("#"+t.themodal).data("onClose")||i.onClose,a=e("#"+t.themodal).data("gbox")||i.gbox;return c.hideModal("#"+t.themodal,{gb:a,jqm:i.jqModal,onClose:n}),!1}),0!==i.width&&i.width||(i.width=300),0!==i.height&&i.height||(i.height=200),i.zIndex||(a=e(a).parents("*[role=dialog]").filter(":first").css("z-index"),i.zIndex=a?parseInt(a,10)+1:950),a=0,l&&n.left&&!o&&(a=e(i.gbox).width()-(isNaN(i.width)?0:parseInt(i.width,10))-8,n.left=parseInt(n.left,10)+parseInt(a,10)),n.left&&(n.left+="px"),e(d).css(e.extend({width:isNaN(i.width)?"auto":i.width+"px",height:isNaN(i.height)?"auto":i.height+"px",zIndex:i.zIndex,overflow:"hidden"},n)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":t.modalhead,"aria-hidden":"true"}),"undefined"==typeof i.drag&&(i.drag=!0),"undefined"==typeof i.resize&&(i.resize=!0),i.drag)if(e(u).css("cursor","move"),e.fn.jqDrag)e(d).jqDrag(u);else try{e(d).draggable({handle:e("#"+u.id)})}catch(f){}if(i.resize)if(e.fn.jqResize)e(d).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se'></div>"),e("#"+t.themodal).jqResize(".jqResize",t.scrollelm?"#"+t.scrollelm:!1);else try{e(d).resizable({handles:"se, sw",alsoResize:t.scrollelm?"#"+t.scrollelm:!1})}catch(g){}i.closeOnEscape===!0&&e(d).keydown(function(n){27==n.which&&(n=e("#"+t.themodal).data("onClose")||i.onClose,c.hideModal(this,{gb:i.gbox,jqm:i.jqModal,onClose:n}))})},viewModal:function(t,n){if(n=e.extend({toTop:!0,overlay:10,modal:!1,onShow:this.showModal,onHide:this.closeModal,gbox:"",jqm:!0,jqM:!0},n||{}),e.fn.jqm&&n.jqm===!0)n.jqM?e(t).attr("aria-hidden","false").jqm(n).jqmShow():e(t).attr("aria-hidden","false").jqmShow();else{""!==n.gbox&&(e(".jqgrid-overlay:first",n.gbox).show(),e(t).data("gbox",n.gbox)),e(t).show().attr("aria-hidden","false");try{e(":input:visible",t)[0].focus()}catch(i){}}},info_dialog:function(t,n,i,a){var r={width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,caption:"<b>"+t+"</b>",left:250,top:170,zIndex:1e3,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]};e.extend(r,a||{});var o=r.jqModal,s=this;if(e.fn.jqm&&!o&&(o=!1),t="",r.buttons.length>0)for(a=0;a<r.buttons.length;a++)"undefined"==typeof r.buttons[a].id&&(r.buttons[a].id="info_button_"+a),t+="<a href='javascript:void(0)' id='"+r.buttons[a].id+"' class='fm-button ui-state-default ui-corner-all'>"+r.buttons[a].text+"</a>";a=isNaN(r.dataheight)?r.dataheight:r.dataheight+"px";var l="<div id='info_id'>";l+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+a+";"+("text-align:"+r.align+";")+"'>"+n+"</div>",l+=i?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+r.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+i+"</a>"+t+"</div>":""!==t?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+r.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+t+"</div>":"",l+="</div>";try{"false"==e("#info_dialog").attr("aria-hidden")&&this.hideModal("#info_dialog",{jqm:o}),e("#info_dialog").remove()}catch(d){}this.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},l,r,"","",!0),t&&e.each(r.buttons,function(t){e("#"+this.id,"#info_id").bind("click",function(){return r.buttons[t].onClick.call(e("#info_dialog")),!1})}),e("#closedialog","#info_id").click(function(){return s.hideModal("#info_dialog",{jqm:o}),!1}),e(".fm-button","#info_dialog").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),e.isFunction(r.beforeOpen)&&r.beforeOpen(),this.viewModal("#info_dialog",{onHide:function(e){e.w.hide().remove(),e.o&&e.o.remove()},modal:r.modal,jqm:o}),e.isFunction(r.afterOpen)&&r.afterOpen();try{e("#info_dialog").focus()}catch(c){}},createEl:function(t,n,i,a,r){function o(t,n){return e.isFunction(n.dataInit)&&n.dataInit(t),n.dataEvents&&e.each(n.dataEvents,function(){void 0!==this.data?e(t).bind(this.type,this.data,this.fn):e(t).bind(this.type,this.fn)}),n}function s(t,n){var i=["dataInit","dataEvents","dataUrl","buildSelect","sopt","searchhidden","defaultValue","attr"];e.each(n,function(n,a){-1===e.inArray(n,i)&&e(t).attr(n,a)}),n.hasOwnProperty("id")||e(t).attr("id",e.jgrid.randId())}var l="";switch(t){case"textarea":l=document.createElement("textarea"),a?n.cols||e(l).css({width:"98%"}):n.cols||(n.cols=20),n.rows||(n.rows=2),("&nbsp;"==i||"&#160;"==i||1==i.length&&160==i.charCodeAt(0))&&(i=""),l.value=i,s(l,n),n=o(l,n),e(l).attr({role:"textbox",multiline:"true"});break;case"checkbox":l=document.createElement("input"),l.type="checkbox",n.value?(t=n.value.split(":"),i===t[0]&&(l.checked=!0,l.defaultChecked=!0),l.value=t[0],e(l).attr("offval",t[1])):(t=i.toLowerCase(),t.search(/(false|0|no|off|undefined)/i)<0&&""!==t?(l.checked=!0,l.defaultChecked=!0,l.value=i):l.value="on",e(l).attr("offval","off")),s(l,n),n=o(l,n),e(l).attr("role","checkbox");break;case"select":if(l=document.createElement("select"),l.setAttribute("role","select"),a=[],n.multiple===!0?(t=!0,l.multiple="multiple",e(l).attr("aria-multiselectable","true")):t=!1,"undefined"!=typeof n.dataUrl)e.ajax(e.extend({url:n.dataUrl,type:"GET",dataType:"html",context:{elem:l,options:n,vl:i},success:function(t){var n=[],i=this.elem,a=this.vl,r=e.extend({},this.options),l=r.multiple===!0;"undefined"!=typeof r.buildSelect&&(t=r.buildSelect(t)),(t=e(t).html())&&(e(i).append(t),s(i,r),r=o(i,r),"undefined"==typeof r.size&&(r.size=l?3:1),l?(n=a.split(","),n=e.map(n,function(t){return e.trim(t)})):n[0]=e.trim(a),setTimeout(function(){e("option",i).each(function(){e(this).attr("role","option"),(e.inArray(e.trim(e(this).text()),n)>-1||e.inArray(e.trim(e(this).val()),n)>-1)&&(this.selected="selected")})},0))}},r||{}));else if(n.value){var d;t?(a=i.split(","),a=e.map(a,function(t){return e.trim(t)}),"undefined"==typeof n.size&&(n.size=3)):n.size=1,"function"==typeof n.value&&(n.value=n.value());var c,u;if("string"==typeof n.value)for(c=n.value.split(";"),d=0;d<c.length;d++)u=c[d].split(":"),u.length>2&&(u[1]=e.map(u,function(e,t){return t>0?e:void 0}).join(":")),r=document.createElement("option"),r.setAttribute("role","option"),r.value=u[0],r.innerHTML=u[1],t||e.trim(u[0])!=e.trim(i)&&e.trim(u[1])!=e.trim(i)||(r.selected="selected"),t&&(e.inArray(e.trim(u[1]),a)>-1||e.inArray(e.trim(u[0]),a)>-1)&&(r.selected="selected"),l.appendChild(r);else if("object"==typeof n.value){c=n.value;for(d in c)c.hasOwnProperty(d)&&(r=document.createElement("option"),r.setAttribute("role","option"),r.value=d,r.innerHTML=c[d],t||e.trim(d)!=e.trim(i)&&e.trim(c[d])!=e.trim(i)||(r.selected="selected"),t&&(e.inArray(e.trim(c[d]),a)>-1||e.inArray(e.trim(d),a)>-1)&&(r.selected="selected"),l.appendChild(r))}s(l,n),n=o(l,n)}break;case"text":case"password":case"button":d="button"==t?"button":"textbox",l=document.createElement("input"),l.type=t,l.value=i,s(l,n),n=o(l,n),"button"!=t&&(a?n.size||e(l).css({width:"98%"}):n.size||(n.size=20)),e(l).attr("role",d);break;case"image":case"file":l=document.createElement("input"),l.type=t,s(l,n),n=o(l,n);break;case"custom":l=document.createElement("span");try{if(!e.isFunction(n.custom_element))throw"e1";if(!(c=n.custom_element.call(this,i,n)))throw"e2";c=e(c).addClass("customelement").attr({id:n.id,name:n.name}),e(l).empty().append(c)}catch(h){"e1"==h&&this.info_dialog(e.jgrid.errors.errcap,"function 'custom_element' "+e.jgrid.edit.msg.nodefined,e.jgrid.edit.bClose),"e2"==h?this.info_dialog(e.jgrid.errors.errcap,"function 'custom_element' "+e.jgrid.edit.msg.novalue,e.jgrid.edit.bClose):this.info_dialog(e.jgrid.errors.errcap,"string"==typeof h?h:h.message,e.jgrid.edit.bClose)}}return l},checkDate:function(e,t){var n,i={};if(e=e.toLowerCase(),n=-1!=e.indexOf("/")?"/":-1!=e.indexOf("-")?"-":-1!=e.indexOf(".")?".":"/",e=e.split(n),t=t.split(n),3!=t.length)return!1;n=-1;for(var a,r=-1,o=-1,s=0;s<e.length;s++)a=isNaN(t[s])?0:parseInt(t[s],10),i[e[s]]=a,a=e[s],-1!=a.indexOf("y")&&(n=s),-1!=a.indexOf("m")&&(o=s),-1!=a.indexOf("d")&&(r=s);a="y"==e[n]||"yyyy"==e[n]?4:"yy"==e[n]?2:-1,s=function(e){for(var t=1;e>=t;t++)this[t]=31,(4==t||6==t||9==t||11==t)&&(this[t]=30),2==t&&(this[t]=29);return this}(12);var l;return-1===n?!1:(l=i[e[n]].toString(),2==a&&1==l.length&&(a=1),l.length!=a||0===i[e[n]]&&"00"!=t[n]?!1:-1===o?!1:(l=i[e[o]].toString(),l.length<1||i[e[o]]<1||i[e[o]]>12?!1:-1===r?!1:(l=i[e[r]].toString(),l.length<1||i[e[r]]<1||i[e[r]]>31||2==i[e[o]]&&i[e[r]]>(i[e[n]]%4!==0||i[e[n]]%100===0&&i[e[n]]%400!==0?28:29)||i[e[r]]>s[i[e[o]]]?!1:!0)))},isEmpty:function(e){return e.match(/^\s+$/)||""===e?!0:!1},checkTime:function(e){var t=/^(\d{1,2}):(\d{2})([ap]m)?$/;if(!this.isEmpty(e)){if(!(e=e.match(t)))return!1;if(e[3]){if(e[1]<1||e[1]>12)return!1}else if(e[1]>23)return!1;if(e[2]>59)return!1}return!0},checkValues:function(t,n,i,a,r){var o,s;if("undefined"==typeof a)if("string"==typeof n){for(a=0,r=i.p.colModel.length;r>a;a++)if(i.p.colModel[a].name==n){o=i.p.colModel[a].editrules,n=a;try{s=i.p.colModel[a].formoptions.label}catch(l){}break}}else n>=0&&(o=i.p.colModel[n].editrules);else o=a,s=void 0===r?"_":r;if(o){if(s||(s=i.p.colNames[n]),o.required===!0&&this.isEmpty(t))return[!1,s+": "+e.jgrid.edit.msg.required,""];if(a=o.required===!1?!1:!0,o.number===!0&&(a!==!1||!this.isEmpty(t))&&isNaN(t))return[!1,s+": "+e.jgrid.edit.msg.number,""];if("undefined"!=typeof o.minValue&&!isNaN(o.minValue)&&parseFloat(t)<parseFloat(o.minValue))return[!1,s+": "+e.jgrid.edit.msg.minValue+" "+o.minValue,""];if("undefined"!=typeof o.maxValue&&!isNaN(o.maxValue)&&parseFloat(t)>parseFloat(o.maxValue))return[!1,s+": "+e.jgrid.edit.msg.maxValue+" "+o.maxValue,""];if(o.email===!0&&!(a===!1&&this.isEmpty(t)||(r=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,r.test(t))))return[!1,s+": "+e.jgrid.edit.msg.email,""];if(o.integer===!0&&(a!==!1||!this.isEmpty(t))){if(isNaN(t))return[!1,s+": "+e.jgrid.edit.msg.integer,""];if(t%1!==0||-1!=t.indexOf("."))return[!1,s+": "+e.jgrid.edit.msg.integer,""]}if(o.date===!0&&!(a===!1&&this.isEmpty(t)||(n=i.p.colModel[n].formatoptions&&i.p.colModel[n].formatoptions.newformat?i.p.colModel[n].formatoptions.newformat:i.p.colModel[n].datefmt||"Y-m-d",this.checkDate(n,t))))return[!1,s+": "+e.jgrid.edit.msg.date+" - "+n,""];if(o.time===!0&&!(a===!1&&this.isEmpty(t)||this.checkTime(t)))return[!1,s+": "+e.jgrid.edit.msg.date+" - hh:mm (am/pm)",""];if(o.url===!0&&!(a===!1&&this.isEmpty(t)||(r=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,r.test(t))))return[!1,s+": "+e.jgrid.edit.msg.url,""];if(o.custom===!0&&(a!==!1||!this.isEmpty(t)))return e.isFunction(o.custom_func)?(t=o.custom_func.call(i,t,s),e.isArray(t)?t:[!1,e.jgrid.edit.msg.customarray,""]):[!1,e.jgrid.edit.msg.customfcheck,""]}return[!0,"",""]}})}(jQuery),function(e){var t=null;e.jgrid.extend({searchGrid:function(t){return t=e.extend({recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,jqModal:!0,modal:!1,resize:!1,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,toTop:!0,overlay:10,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null},e.jgrid.search,t||{}),this.each(function(){function n(){e.isFunction(t.beforeShowSearch)&&(r=t.beforeShowSearch(e("#"+a)),"undefined"==typeof r&&(r=!0)),r&&(e.jgrid.viewModal("#"+o.themodal,{gbox:"#gbox_"+a,jqm:t.jqModal,modal:t.modal,overlay:t.overlay,toTop:t.toTop}),e.isFunction(t.afterShowSearch)&&t.afterShowSearch(e("#"+a)))}var i=this;if(i.grid){var a="fbox_"+i.p.id,r=!0,o={themodal:"searchmod"+a,modalhead:"searchhd"+a,modalcontent:"searchcnt"+a,scrollelm:a},s=i.p.postData[t.sFilter];if("string"==typeof s&&(s=e.jgrid.parse(s)),t.recreateFilter===!0&&e("#"+o.themodal).remove(),null!==e("#"+o.themodal).html())n();else{var l=e("<span><div id='"+a+"' class='searchFilter' style='overflow:auto'></div></span>").insertBefore("#gview_"+i.p.id);e.isFunction(t.onInitializeSearch)&&t.onInitializeSearch(e("#"+a));var d,c=e.extend([],i.p.colModel),u="<a href='javascript:void(0)' id='"+a+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+t.Find+"</a>",h="<a href='javascript:void(0)' id='"+a+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+t.Reset+"</a>",p="",f="",g=!1;t.showQuery&&(p="<a href='javascript:void(0)' id='"+a+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>"),t.columns.length?c=t.columns:e.each(c,function(e,t){if(t.label||(t.label=i.p.colNames[e]),!g){var n="undefined"==typeof t.search?!0:t.search,a=t.hidden===!0;(t.searchoptions&&t.searchoptions.searchhidden===!0&&n||n&&!a)&&(g=!0,d=t.index||t.name)}}),(!s&&d||t.multipleSearch===!1)&&(s={groupOp:"AND",rules:[{field:d,op:"eq",data:""}]}),g=!1,t.tmplNames&&t.tmplNames.length&&(g=!0,f=t.tmplLabel,f+="<select class='ui-template'>",f+="<option value='default'>Default</option>",e.each(t.tmplNames,function(e,t){f+="<option value='"+e+"'>"+t+"</option>"}),f+="</select>"),u="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+a+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:left'>"+h+f+"</td><td class='EditButton'>"+p+u+"</td></tr></tbody></table>",e("#"+a).jqFilter({columns:c,filter:t.loadDefaults?s:null,showQuery:t.showQuery,errorcheck:t.errorcheck,sopt:t.sopt,groupButton:t.multipleGroup,_gridsopt:e.jgrid.search.odata,onChange:function(){this.p.showQuery&&e(".query",this).html(this.toUserFriendlyString())
}}),l.append(u),g&&t.tmplFilters&&t.tmplFilters.length&&e(".ui-template",l).bind("change",function(){var n=e(this).val();return"default"==n?e("#"+a).jqFilter("addFilter",s):e("#"+a).jqFilter("addFilter",t.tmplFilters[parseInt(n,10)]),!1}),t.multipleSearch===!1&&(e(".add-rule","#"+a).hide(),e(".delete-rule","#"+a).hide()),e.isFunction(t.onInitializeSearch)&&t.onInitializeSearch(e("#"+a)),t.layer?e.jgrid.createModal(o,l,t,"#gview_"+i.p.id,e("#gbox_"+i.p.id)[0],"#"+t.layer,{position:"relative"}):e.jgrid.createModal(o,l,t,"#gview_"+i.p.id,e("#gbox_"+i.p.id)[0]),p&&e("#"+a+"_query").bind("click",function(){return e(".queryresult",l).toggle(),!1}),void 0===t.stringResult&&(t.stringResult=t.multipleSearch),e("#"+a+"_search").bind("click",function(){var n,r=e("#"+a),s={},l=r.jqFilter("filterData");if(t.errorcheck&&(r[0].hideError(),t.showQuery||r.jqFilter("toSQLString"),r[0].p.error))return r[0].showError(),!1;if(t.stringResult){try{n=xmlJsonClass.toJson(l,"","",!1)}catch(d){try{n=JSON.stringify(l)}catch(c){}}"string"==typeof n&&(s[t.sFilter]=n,e.each([t.sField,t.sValue,t.sOper],function(){s[this]=""}))}else t.multipleSearch?(s[t.sFilter]=l,e.each([t.sField,t.sValue,t.sOper],function(){s[this]=""})):(s[t.sField]=l.rules[0].field,s[t.sValue]=l.rules[0].data,s[t.sOper]=l.rules[0].op,s[t.sFilter]="");return i.p.search=!0,e.extend(i.p.postData,s),e.isFunction(t.onSearch)&&t.onSearch(),e(i).trigger("reloadGrid",[{page:1}]),t.closeAfterSearch&&e.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+i.p.id,jqm:t.jqModal,onClose:t.onClose}),!1}),e("#"+a+"_reset").bind("click",function(){var n={},r=e("#"+a);return i.p.search=!1,t.multipleSearch===!1?n[t.sField]=n[t.sValue]=n[t.sOper]="":n[t.sFilter]="",r[0].resetFilter(),g&&e(".ui-template",l).val("default"),e.extend(i.p.postData,n),e.isFunction(t.onReset)&&t.onReset(),e(i).trigger("reloadGrid",[{page:1}]),!1}),n(),e(".fm-button:not(.ui-state-disabled)",l).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")})}}})},editGridRow:function(n,a){return t=a=e.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0},e.jgrid.edit,a||{}),this.each(function(){function r(){return e(".FormElement","#"+C).each(function(){var t=e(".customelement",this);if(t.length){var n=e(t[0]).attr("name");e.each(g.p.colModel,function(){if(this.name===n&&this.editoptions&&e.isFunction(this.editoptions.custom_value)){try{if(m[n]=this.editoptions.custom_value(e("#"+e.jgrid.jqID(n),"#"+C),"get"),void 0===m[n])throw"e1"}catch(t){"e1"===t?e.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose):e.jgrid.info_dialog(jQuery.jgrid.errors.errcap,t.message,jQuery.jgrid.edit.bClose)}return!0}})}else{switch(e(this).get(0).type){case"checkbox":e(this).attr("checked")?m[this.name]=e(this).val():(t=e(this).attr("offval"),m[this.name]=t);break;case"select-one":m[this.name]=e("option:selected",this).val(),b[this.name]=e("option:selected",this).text();break;case"select-multiple":m[this.name]=e(this).val(),m[this.name]=m[this.name]?m[this.name].join(","):"";var i=[];e("option:selected",this).each(function(t,n){i[t]=e(n).text()}),b[this.name]=i.join(",");break;case"password":case"text":case"textarea":case"button":m[this.name]=e(this).val()}g.p.autoencode&&(m[this.name]=e.jgrid.htmlEncode(m[this.name]))}}),!0}function o(n,i,a,r){var o,s,l,d,c,u,h,p=0,f=[],m=!1,b="";for(h=1;r>=h;h++)b+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";return"_empty"!=n&&(m=e(i).jqGrid("getInd",n)),e(i.p.colModel).each(function(h){if(o=this.name,c=(s=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1)?"style='display:none'":"","cb"!==o&&"subgrid"!==o&&this.editable===!0&&"rn"!==o){if(m===!1)d="";else if(o==i.p.ExpandColumn&&i.p.treeGrid===!0)d=e("td:eq("+h+")",i.rows[m]).text();else try{d=e.unformat(e("td:eq("+h+")",i.rows[m]),{rowId:n,colModel:this},h)}catch(v){d=e("td:eq("+h+")",i.rows[m]).text()}var y=e.extend({},this.editoptions||{},{id:o,name:o}),_=e.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),w=parseInt(_.rowpos,10)||p+1,C=parseInt(2*(parseInt(_.colpos,10)||1),10);"_empty"==n&&y.defaultValue&&(d=e.isFunction(y.defaultValue)?y.defaultValue():y.defaultValue),this.edittype||(this.edittype="text"),g.p.autoencode&&(d=e.jgrid.htmlDecode(d)),u=e.jgrid.createEl(this.edittype,y,d,!1,e.extend({},e.jgrid.ajaxOptions,i.p.ajaxSelectOptions||{})),""===d&&"checkbox"==this.edittype&&(d=e(u).attr("offval")),""===d&&"select"==this.edittype&&(d=e("option:eq(0)",u).text()),(t.checkOnSubmit||t.checkOnUpdate)&&(t._savedData[o]=d),e(u).addClass("FormElement"),("text"==this.edittype||"textarea"==this.edittype)&&e(u).addClass("ui-widget-content ui-corner-all"),l=e(a).find("tr[rowpos="+w+"]"),_.rowabove&&(y=e("<tr><td class='contentinfo' colspan='"+2*r+"'>"+_.rowcontent+"</td></tr>"),e(a).append(y),y[0].rp=w),0===l.length&&(l=e("<tr "+c+" rowpos='"+w+"'></tr>").addClass("FormData").attr("id","tr_"+o),e(l).append(b),e(a).append(l),l[0].rp=w),e("td:eq("+(C-2)+")",l[0]).html("undefined"==typeof _.label?i.p.colNames[h]:_.label),e("td:eq("+(C-1)+")",l[0]).append(_.elmprefix).append(u).append(_.elmsuffix),f[p]=h,p++}}),p>0&&(h=e("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*r-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+i.p.id+"_id' value='"+n+"'/></td></tr>"),h[0].rp=p+999,e(a).append(h),(t.checkOnSubmit||t.checkOnUpdate)&&(t._savedData[i.p.id+"_id"]=n)),f}function s(n,i,a){var r,o,s,l,d,c,u=0;(t.checkOnSubmit||t.checkOnUpdate)&&(t._savedData={},t._savedData[i.p.id+"_id"]=n);var h=i.p.colModel;if("_empty"==n)e(h).each(function(){r=this.name,l=e.extend({},this.editoptions||{}),(s=e("#"+e.jgrid.jqID(r),"#"+a))&&null!==s[0]&&(d="",l.defaultValue?(d=e.isFunction(l.defaultValue)?l.defaultValue():l.defaultValue,"checkbox"==s[0].type?(c=d.toLowerCase(),c.search(/(false|0|no|off|undefined)/i)<0&&""!==c?(s[0].checked=!0,s[0].defaultChecked=!0,s[0].value=d):s.attr({checked:"",defaultChecked:""})):s.val(d)):"checkbox"==s[0].type?(s[0].checked=!1,s[0].defaultChecked=!1,d=e(s).attr("offval")):s[0].type&&"select"==s[0].type.substr(0,6)?s[0].selectedIndex=0:s.val(d),(t.checkOnSubmit===!0||t.checkOnUpdate)&&(t._savedData[r]=d))}),e("#id_g","#"+a).val(n);else{var p=e(i).jqGrid("getInd",n,!0);p&&(e("td",p).each(function(s){if(r=h[s].name,"cb"!==r&&"subgrid"!==r&&"rn"!==r&&h[s].editable===!0){if(r==i.p.ExpandColumn&&i.p.treeGrid===!0)o=e(this).text();else try{o=e.unformat(e(this),{rowId:n,colModel:h[s]},s)}catch(l){o=e(this).text()}switch(g.p.autoencode&&(o=e.jgrid.htmlDecode(o)),(t.checkOnSubmit===!0||t.checkOnUpdate)&&(t._savedData[r]=o),r=e.jgrid.jqID(r),h[s].edittype){case"password":case"text":case"button":case"image":e("#"+r,"#"+a).val(o);break;case"textarea":("&nbsp;"==o||"&#160;"==o||1==o.length&&160==o.charCodeAt(0))&&(o=""),e("#"+r,"#"+a).val(o);break;case"select":var d=o.split(",");d=e.map(d,function(t){return e.trim(t)}),e("#"+r+" option","#"+a).each(function(){this.selected=h[s].editoptions.multiple||d[0]!=e.trim(e(this).text())&&d[0]!=e.trim(e(this).val())?h[s].editoptions.multiple&&(e.inArray(e.trim(e(this).text()),d)>-1||e.inArray(e.trim(e(this).val()),d)>-1)?!0:!1:!0});break;case"checkbox":o+="",h[s].editoptions&&h[s].editoptions.value?h[s].editoptions.value.split(":")[0]==o?(e("#"+r,"#"+a).attr("checked",!0),e("#"+r,"#"+a).attr("defaultChecked",!0)):(e("#"+r,"#"+a).attr("checked",!1),e("#"+r,"#"+a).attr("defaultChecked","")):(o=o.toLowerCase(),o.search(/(false|0|no|off|undefined)/i)<0&&""!==o?(e("#"+r,"#"+a).attr("checked",!0),e("#"+r,"#"+a).attr("defaultChecked",!0)):(e("#"+r,"#"+a).attr("checked",!1),e("#"+r,"#"+a).attr("defaultChecked","")));break;case"custom":try{if(!h[s].editoptions||!e.isFunction(h[s].editoptions.custom_value))throw"e1";h[s].editoptions.custom_value(e("#"+r,"#"+a),"set",o)}catch(c){"e1"==c?e.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose):e.jgrid.info_dialog(jQuery.jgrid.errors.errcap,c.message,jQuery.jgrid.edit.bClose)}}u++}}),u>0&&e("#id_g","#"+C).val(n))}}function l(){var n,r,o,l,d,c=[!0,"",""],u={},h=g.p.prmNames;if(e.isFunction(t.beforeCheckValues)){var p=t.beforeCheckValues(m,e("#"+w),"_empty"==m[g.p.id+"_id"]?h.addoper:h.editoper);p&&"object"==typeof p&&(m=p)}for(l in m)if(m.hasOwnProperty(l)&&(c=e.jgrid.checkValues(m[l],l,g),c[0]===!1))break;if(c[0]&&(e.isFunction(t.onclickSubmit)&&(u=t.onclickSubmit(t,m)||{}),e.isFunction(t.beforeSubmit)&&(c=t.beforeSubmit(m,e("#"+w)))),c[0]&&!t.processing){if(t.processing=!0,e("#sData","#"+C+"_2").addClass("ui-state-active"),o=h.oper,r=h.id,m[o]="_empty"==e.trim(m[g.p.id+"_id"])?h.addoper:h.editoper,m[o]!=h.addoper?m[r]=m[g.p.id+"_id"]:void 0===m[r]&&(m[r]=m[g.p.id+"_id"]),delete m[g.p.id+"_id"],m=e.extend(m,t.editData,u),g.p.treeGrid===!0){m[o]==h.addoper&&(d=e(g).jqGrid("getGridParam","selrow"),m["adjacency"==g.p.treeGridModel?g.p.treeReader.parent_id_field:"parent_id"]=d);for(i in g.p.treeReader)u=g.p.treeReader[i],m.hasOwnProperty(u)&&(m[o]==h.addoper&&"parent_id_field"===i||delete m[u])}u=e.extend({url:t.url?t.url:e(g).jqGrid("getGridParam","editurl"),type:t.mtype,data:e.isFunction(t.serializeEditData)?t.serializeEditData(m):m,complete:function(i,l){if("success"!=l?(c[0]=!1,c[1]=e.isFunction(t.errorTextFormat)?t.errorTextFormat(i):l+" Status: '"+i.statusText+"'. Error code: "+i.status):e.isFunction(t.afterSubmit)&&(c=t.afterSubmit(i,m)),c[0]===!1)e("#FormError>td","#"+C).html(c[1]),e("#FormError","#"+C).show();else if(e.each(g.p.colModel,function(){if(b[this.name]&&this.formatter&&"select"==this.formatter)try{delete b[this.name]}catch(e){}}),m=e.extend(m,b),g.p.autoencode&&e.each(m,function(t,n){m[t]=e.jgrid.htmlDecode(n)}),t.reloadAfterSubmit=t.reloadAfterSubmit&&"local"!=g.p.datatype,m[o]==h.addoper?(c[2]||(c[2]=e.jgrid.randId()),m[r]=c[2],t.closeAfterAdd?(t.reloadAfterSubmit?e(g).trigger("reloadGrid"):g.p.treeGrid===!0?e(g).jqGrid("addChildNode",c[2],d,m):(e(g).jqGrid("addRowData",c[2],m,a.addedrow),e(g).jqGrid("setSelection",c[2])),e.jgrid.hideModal("#"+k.themodal,{gb:"#gbox_"+_,jqm:a.jqModal,onClose:t.onClose})):t.clearAfterAdd?(t.reloadAfterSubmit?e(g).trigger("reloadGrid"):g.p.treeGrid===!0?e(g).jqGrid("addChildNode",c[2],d,m):e(g).jqGrid("addRowData",c[2],m,a.addedrow),s("_empty",g,w)):t.reloadAfterSubmit?e(g).trigger("reloadGrid"):g.p.treeGrid===!0?e(g).jqGrid("addChildNode",c[2],d,m):e(g).jqGrid("addRowData",c[2],m,a.addedrow)):(t.reloadAfterSubmit?(e(g).trigger("reloadGrid"),t.closeAfterEdit||setTimeout(function(){e(g).jqGrid("setSelection",m[r])},1e3)):g.p.treeGrid===!0?e(g).jqGrid("setTreeRow",m[r],m):e(g).jqGrid("setRowData",m[r],m),t.closeAfterEdit&&e.jgrid.hideModal("#"+k.themodal,{gb:"#gbox_"+_,jqm:a.jqModal,onClose:t.onClose})),e.isFunction(t.afterComplete)&&(n=i,setTimeout(function(){t.afterComplete(n,m,e("#"+w)),n=null},500)),(t.checkOnSubmit||t.checkOnUpdate)&&(e("#"+w).data("disabled",!1),"_empty"!=t._savedData[g.p.id+"_id"]))for(var u in t._savedData)m[u]&&(t._savedData[u]=m[u]);t.processing=!1,e("#sData","#"+C+"_2").removeClass("ui-state-active");try{e(":input:visible","#"+w)[0].focus()}catch(p){}}},e.jgrid.ajaxOptions,t.ajaxEditOptions),u.url||t.useDataProxy||(e.isFunction(g.p.dataProxy)?t.useDataProxy=!0:(c[0]=!1,c[1]+=" "+e.jgrid.errors.nourl)),c[0]&&(t.useDataProxy?g.p.dataProxy.call(g,u,"set_"+g.p.id):e.ajax(u))}c[0]===!1&&(e("#FormError>td","#"+C).html(c[1]),e("#FormError","#"+C).show())}function d(e,t){var n,i=!1;for(n in e)if(e[n]!=t[n]){i=!0;break}return i}function c(){e.each(g.p.colModel,function(e,t){t.editoptions&&t.editoptions.NullIfEmpty===!0&&m.hasOwnProperty(t.name)&&""==m[t.name]&&(m[t.name]="null")})}function u(){var n=!0;return e("#FormError","#"+C).hide(),t.checkOnUpdate&&(m={},b={},r(),v=e.extend({},m,b),(y=d(v,t._savedData))?(e("#"+w).data("disabled",!0),e(".confirm","#"+k.themodal).show(),n=!1):c()),n}function h(){if("_empty"!==n&&"undefined"!=typeof g.p.savedRow&&g.p.savedRow.length>0&&e.isFunction(e.fn.jqGrid.restoreRow))for(var t=0;t<g.p.savedRow.length;t++)if(g.p.savedRow[t].id==n){e(g).jqGrid("restoreRow",n);break}}function p(t,n){0===t?e("#pData","#"+C+"_2").addClass("ui-state-disabled"):e("#pData","#"+C+"_2").removeClass("ui-state-disabled"),t==n?e("#nData","#"+C+"_2").addClass("ui-state-disabled"):e("#nData","#"+C+"_2").removeClass("ui-state-disabled")}function f(){var t=e(g).jqGrid("getDataIDs"),n=e("#id_g","#"+C).val();return[e.inArray(n,t),t]}var g=this;if(g.grid&&n){var m,b,v,y,_=g.p.id,w="FrmGrid_"+_,C="TblGrid_"+_,k={themodal:"editmod"+_,modalhead:"edithd"+_,modalcontent:"editcnt"+_,scrollelm:w},x=e.isFunction(t.beforeShowForm)?t.beforeShowForm:!1,S=e.isFunction(t.afterShowForm)?t.afterShowForm:!1,j=e.isFunction(t.beforeInitData)?t.beforeInitData:!1,N=e.isFunction(t.onInitializeForm)?t.onInitializeForm:!1,T=!0,E=1,A=0;"new"===n?(n="_empty",a.caption=t.addCaption):a.caption=t.editCaption,a.recreateForm===!0&&null!==e("#"+k.themodal).html()&&e("#"+k.themodal).remove();var D=!0;if(a.checkOnUpdate&&a.jqModal&&!a.modal&&(D=!1),null!==e("#"+k.themodal).html()){if(j&&(T=j(e("#"+w)),"undefined"==typeof T&&(T=!0)),T===!1)return;h(),e(".ui-jqdialog-title","#"+k.modalhead).html(a.caption),e("#FormError","#"+C).hide(),t.topinfo?(e(".topinfo","#"+C+"_2").html(t.topinfo),e(".tinfo","#"+C+"_2").show()):e(".tinfo","#"+C+"_2").hide(),t.bottominfo?(e(".bottominfo","#"+C+"_2").html(t.bottominfo),e(".binfo","#"+C+"_2").show()):e(".binfo","#"+C+"_2").hide(),s(n,g,w),"_empty"!=n&&t.viewPagerButtons?e("#pData, #nData","#"+C+"_2").show():e("#pData, #nData","#"+C+"_2").hide(),t.processing===!0&&(t.processing=!1,e("#sData","#"+C+"_2").removeClass("ui-state-active")),e("#"+w).data("disabled")===!0&&(e(".confirm","#"+k.themodal).hide(),e("#"+w).data("disabled",!1)),x&&x(e("#"+w)),e("#"+k.themodal).data("onClose",t.onClose),e.jgrid.viewModal("#"+k.themodal,{gbox:"#gbox_"+_,jqm:a.jqModal,jqM:!1,overlay:a.overlay,modal:a.modal}),D||e(".jqmOverlay").click(function(){return u()?(e.jgrid.hideModal("#"+k.themodal,{gb:"#gbox_"+_,jqm:a.jqModal,onClose:t.onClose}),!1):!1}),S&&S(e("#"+w))}else{var O=isNaN(a.dataheight)?a.dataheight:a.dataheight+"px";O=e("<form name='FormPost' id='"+w+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+O+";'></form>").data("disabled",!1);var I=e("<table id='"+C+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");if(j&&(T=j(e("#"+w)),"undefined"==typeof T&&(T=!0)),T===!1)return;h(),e(g.p.colModel).each(function(){var e=this.formoptions;E=Math.max(E,e?e.colpos||0:0),A=Math.max(A,e?e.rowpos||0:0)}),e(O).append(I),j=e("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+2*E+"'></td></tr>"),j[0].rp=0,e(I).append(j),j=e("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*E+"'>"+t.topinfo+"</td></tr>"),j[0].rp=0,e(I).append(j),T=(j="rtl"==g.p.direction?!0:!1)?"nData":"pData";var M=j?"pData":"nData";o(n,g,I,E),T="<a href='javascript:void(0)' id='"+T+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>",M="<a href='javascript:void(0)' id='"+M+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>";var R="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+a.bSubmit+"</a>",P="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+a.bCancel+"</a>";if(T="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+C+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(j?M+T:T+M)+"</td><td class='EditButton'>"+R+P+"</td></tr>",T+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+t.bottominfo+"</td></tr>",T+="</tbody></table>",A>0){var F=[];e.each(e(I)[0].rows,function(e,t){F[e]=t}),F.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),e.each(F,function(t,n){e("tbody",I).append(n)})}a.gbox="#gbox_"+_;var z=!1;a.closeOnEscape===!0&&(a.closeOnEscape=!1,z=!0),O=e("<span></span>").append(O).append(T),e.jgrid.createModal(k,O,a,"#gview_"+g.p.id,e("#gbox_"+g.p.id)[0]),j&&(e("#pData, #nData","#"+C+"_2").css("float","right"),e(".EditButton","#"+C+"_2").css("text-align","left")),t.topinfo&&e(".tinfo","#"+C+"_2").show(),t.bottominfo&&e(".binfo","#"+C+"_2").show(),T=O=null,e("#"+k.themodal).keydown(function(n){var i=n.target;if(e("#"+w).data("disabled")===!0)return!1;if(t.savekey[0]===!0&&n.which==t.savekey[1]&&"TEXTAREA"!=i.tagName)return e("#sData","#"+C+"_2").trigger("click"),!1;if(27===n.which)return u()?(z&&e.jgrid.hideModal(this,{gb:a.gbox,jqm:a.jqModal,onClose:t.onClose}),!1):!1;if(t.navkeys[0]===!0){if("_empty"==e("#id_g","#"+C).val())return!0;if(n.which==t.navkeys[1])return e("#pData","#"+C+"_2").trigger("click"),!1;if(n.which==t.navkeys[2])return e("#nData","#"+C+"_2").trigger("click"),!1}}),a.checkOnUpdate&&(e("a.ui-jqdialog-titlebar-close span","#"+k.themodal).removeClass("jqmClose"),e("a.ui-jqdialog-titlebar-close","#"+k.themodal).unbind("click").click(function(){return u()?(e.jgrid.hideModal("#"+k.themodal,{gb:"#gbox_"+_,jqm:a.jqModal,onClose:t.onClose}),!1):!1})),a.saveicon=e.extend([!0,"left","ui-icon-disk"],a.saveicon),a.closeicon=e.extend([!0,"left","ui-icon-close"],a.closeicon),a.saveicon[0]===!0&&e("#sData","#"+C+"_2").addClass("right"==a.saveicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.saveicon[2]+"'></span>"),a.closeicon[0]===!0&&e("#cData","#"+C+"_2").addClass("right"==a.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+a.closeicon[2]+"'></span>"),(t.checkOnSubmit||t.checkOnUpdate)&&(R="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+a.bYes+"</a>",M="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+a.bNo+"</a>",P="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+a.bExit+"</a>",O=a.zIndex||999,O++,e("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+O+";display:none;'>&#160;"+(e.browser.msie&&6==e.browser.version?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"")+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(O+1)+"'>"+a.saveData+"<br/><br/>"+R+M+P+"</div>").insertAfter("#"+w),e("#sNew","#"+k.themodal).click(function(){return l(),e("#"+w).data("disabled",!1),e(".confirm","#"+k.themodal).hide(),!1}),e("#nNew","#"+k.themodal).click(function(){return e(".confirm","#"+k.themodal).hide(),e("#"+w).data("disabled",!1),setTimeout(function(){e(":input","#"+w)[0].focus()},0),!1}),e("#cNew","#"+k.themodal).click(function(){return e(".confirm","#"+k.themodal).hide(),e("#"+w).data("disabled",!1),e.jgrid.hideModal("#"+k.themodal,{gb:"#gbox_"+_,jqm:a.jqModal,onClose:t.onClose}),!1})),N&&N(e("#"+w)),"_empty"!=n&&t.viewPagerButtons?e("#pData,#nData","#"+C+"_2").show():e("#pData,#nData","#"+C+"_2").hide(),x&&x(e("#"+w)),e("#"+k.themodal).data("onClose",t.onClose),e.jgrid.viewModal("#"+k.themodal,{gbox:"#gbox_"+_,jqm:a.jqModal,overlay:a.overlay,modal:a.modal}),D||e(".jqmOverlay").click(function(){return u()?(e.jgrid.hideModal("#"+k.themodal,{gb:"#gbox_"+_,jqm:a.jqModal,onClose:t.onClose}),!1):!1}),S&&S(e("#"+w)),e(".fm-button","#"+k.themodal).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),e("#sData","#"+C+"_2").click(function(){return m={},b={},e("#FormError","#"+C).hide(),r(),c(),"_empty"==m[g.p.id+"_id"]?l():a.checkOnSubmit===!0?(v=e.extend({},m,b),(y=d(v,t._savedData))?(e("#"+w).data("disabled",!0),e(".confirm","#"+k.themodal).show()):l()):l(),!1}),e("#cData","#"+C+"_2").click(function(){return u()?(e.jgrid.hideModal("#"+k.themodal,{gb:"#gbox_"+_,jqm:a.jqModal,onClose:t.onClose}),!1):!1}),e("#nData","#"+C+"_2").click(function(){if(!u())return!1;e("#FormError","#"+C).hide();var t=f();return t[0]=parseInt(t[0],10),-1!=t[0]&&t[1][t[0]+1]&&(e.isFunction(a.onclickPgButtons)&&a.onclickPgButtons("next",e("#"+w),t[1][t[0]]),s(t[1][t[0]+1],g,w),e(g).jqGrid("setSelection",t[1][t[0]+1]),e.isFunction(a.afterclickPgButtons)&&a.afterclickPgButtons("next",e("#"+w),t[1][t[0]+1]),p(t[0]+1,t[1].length-1)),!1}),e("#pData","#"+C+"_2").click(function(){if(!u())return!1;e("#FormError","#"+C).hide();var t=f();return-1!=t[0]&&t[1][t[0]-1]&&(e.isFunction(a.onclickPgButtons)&&a.onclickPgButtons("prev",e("#"+w),t[1][t[0]]),s(t[1][t[0]-1],g,w),e(g).jqGrid("setSelection",t[1][t[0]-1]),e.isFunction(a.afterclickPgButtons)&&a.afterclickPgButtons("prev",e("#"+w),t[1][t[0]-1]),p(t[0]-1,t[1].length-1)),!1})}x=f(),p(x[0],x[1].length-1)}})},viewGridRow:function(t,n){return n=e.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"30%",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0},e.jgrid.view,n||{}),this.each(function(){function i(){(n.closeOnEscape===!0||n.navkeys[0]===!0)&&setTimeout(function(){e(".ui-jqdialog-titlebar-close","#"+h.modalhead).focus()},0)}function a(t,i,a,r){for(var o,s,l,d,c,u,h,p,f=0,g=[],m=!1,b="<td class='CaptionTD form-view-label ui-widget-content' width='"+n.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",v="",y=["integer","number","currency"],_=0,w=0,C=1;r>=C;C++)v+=1==C?b:"<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>";return e(i.p.colModel).each(function(){s=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1,s||"right"!==this.align||(this.formatter&&-1!==e.inArray(this.formatter,y)?_=Math.max(_,parseInt(this.width,10)):w=Math.max(w,parseInt(this.width,10)))}),u=0!==_?_:0!==w?w:0,m=e(i).jqGrid("getInd",t),e(i.p.colModel).each(function(t){if(o=this.name,h=!1,c=(s=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1)?"style='display:none'":"",p="boolean"!=typeof this.viewable?!0:this.viewable,"cb"!==o&&"subgrid"!==o&&"rn"!==o&&p){d=m===!1?"":o==i.p.ExpandColumn&&i.p.treeGrid===!0?e("td:eq("+t+")",i.rows[m]).text():e("td:eq("+t+")",i.rows[m]).html(),h="right"===this.align&&0!==u?!0:!1,e.extend({},this.editoptions||{},{id:o,name:o});var n=e.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),b=parseInt(n.rowpos,10)||f+1,y=parseInt(2*(parseInt(n.colpos,10)||1),10);if(n.rowabove){var _=e("<tr><td class='contentinfo' colspan='"+2*r+"'>"+n.rowcontent+"</td></tr>");e(a).append(_),_[0].rp=b}l=e(a).find("tr[rowpos="+b+"]"),0===l.length&&(l=e("<tr "+c+" rowpos='"+b+"'></tr>").addClass("FormData").attr("id","trv_"+o),e(l).append(v),e(a).append(l),l[0].rp=b),e("td:eq("+(y-2)+")",l[0]).html("<b>"+("undefined"==typeof n.label?i.p.colNames[t]:n.label)+"</b>"),e("td:eq("+(y-1)+")",l[0]).append("<span>"+d+"</span>").attr("id","v_"+o),h&&e("td:eq("+(y-1)+") span",l[0]).css({"text-align":"right",width:u+"px"}),g[f]=t,f++}}),f>0&&(t=e("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*r-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/></td></tr>"),t[0].rp=f+99,e(a).append(t)),g}function r(t,n){var i,a,r,o,s=0;(o=e(n).jqGrid("getInd",t,!0))&&(e("td",o).each(function(t){i=n.p.colModel[t].name,a=n.p.colModel[t].editrules&&n.p.colModel[t].editrules.edithidden===!0?!1:n.p.colModel[t].hidden===!0?!0:!1,"cb"!==i&&"subgrid"!==i&&"rn"!==i&&(r=i==n.p.ExpandColumn&&n.p.treeGrid===!0?e(this).text():e(this).html(),e.extend({},n.p.colModel[t].editoptions||{}),i=e.jgrid.jqID("v_"+i),e("#"+i+" span","#"+u).html(r),a&&e("#"+i,"#"+u).parents("tr:first").hide(),s++)}),s>0&&e("#id_g","#"+u).val(t))}function o(t,n){0===t?e("#pData","#"+u+"_2").addClass("ui-state-disabled"):e("#pData","#"+u+"_2").removeClass("ui-state-disabled"),t==n?e("#nData","#"+u+"_2").addClass("ui-state-disabled"):e("#nData","#"+u+"_2").removeClass("ui-state-disabled")}function s(){var t=e(l).jqGrid("getDataIDs"),n=e("#id_g","#"+u).val();return[e.inArray(n,t),t]}var l=this;if(l.grid&&t){n.imgpath||(n.imgpath=l.p.imgpath);var d=l.p.id,c="ViewGrid_"+d,u="ViewTbl_"+d,h={themodal:"viewmod"+d,modalhead:"viewhd"+d,modalcontent:"viewcnt"+d,scrollelm:c},p=e.isFunction(n.beforeInitData)?n.beforeInitData:!1,f=!0,g=1,m=0;if(null!==e("#"+h.themodal).html()){if(p&&(f=p(e("#"+c)),"undefined"==typeof f&&(f=!0)),f===!1)return;e(".ui-jqdialog-title","#"+h.modalhead).html(n.caption),e("#FormError","#"+u).hide(),r(t,l),e.isFunction(n.beforeShowForm)&&n.beforeShowForm(e("#"+c)),e.jgrid.viewModal("#"+h.themodal,{gbox:"#gbox_"+d,jqm:n.jqModal,jqM:!1,overlay:n.overlay,modal:n.modal}),i()}else{var b=isNaN(n.dataheight)?n.dataheight:n.dataheight+"px";b=e("<form name='FormPost' id='"+c+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+b+";'></form>");var v=e("<table id='"+u+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");if(p&&(f=p(e("#"+c)),"undefined"==typeof f&&(f=!0)),f===!1)return;e(l.p.colModel).each(function(){var e=this.formoptions;g=Math.max(g,e?e.colpos||0:0),m=Math.max(m,e?e.rowpos||0:0)}),e(b).append(v),a(t,l,v,g),p="rtl"==l.p.direction?!0:!1,f="<a href='javascript:void(0)' id='"+(p?"nData":"pData")+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>";var y="<a href='javascript:void(0)' id='"+(p?"pData":"nData")+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",_="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+n.bClose+"</a>";if(m>0){var w=[];e.each(e(v)[0].rows,function(e,t){w[e]=t}),w.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),e.each(w,function(t,n){e("tbody",v).append(n)})}n.gbox="#gbox_"+d;var C=!1;n.closeOnEscape===!0&&(n.closeOnEscape=!1,C=!0),b=e("<span></span>").append(b).append("<table border='0' class='EditTable' id='"+u+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+n.labelswidth+"'>"+(p?y+f:f+y)+"</td><td class='EditButton'>"+_+"</td></tr></tbody></table>"),e.jgrid.createModal(h,b,n,"#gview_"+l.p.id,e("#gview_"+l.p.id)[0]),p&&(e("#pData, #nData","#"+u+"_2").css("float","right"),e(".EditButton","#"+u+"_2").css("text-align","left")),n.viewPagerButtons||e("#pData, #nData","#"+u+"_2").hide(),b=null,e("#"+h.themodal).keydown(function(t){if(27===t.which)return C&&e.jgrid.hideModal(this,{gb:n.gbox,jqm:n.jqModal,onClose:n.onClose}),!1;if(n.navkeys[0]===!0){if(t.which===n.navkeys[1])return e("#pData","#"+u+"_2").trigger("click"),!1;if(t.which===n.navkeys[2])return e("#nData","#"+u+"_2").trigger("click"),!1}}),n.closeicon=e.extend([!0,"left","ui-icon-close"],n.closeicon),n.closeicon[0]===!0&&e("#cData","#"+u+"_2").addClass("right"==n.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+n.closeicon[2]+"'></span>"),e.isFunction(n.beforeShowForm)&&n.beforeShowForm(e("#"+c)),e.jgrid.viewModal("#"+h.themodal,{gbox:"#gbox_"+d,jqm:n.jqModal,modal:n.modal}),e(".fm-button:not(.ui-state-disabled)","#"+u+"_2").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),i(),e("#cData","#"+u+"_2").click(function(){return e.jgrid.hideModal("#"+h.themodal,{gb:"#gbox_"+d,jqm:n.jqModal,onClose:n.onClose}),!1}),e("#nData","#"+u+"_2").click(function(){e("#FormError","#"+u).hide();var t=s();return t[0]=parseInt(t[0],10),-1!=t[0]&&t[1][t[0]+1]&&(e.isFunction(n.onclickPgButtons)&&n.onclickPgButtons("next",e("#"+c),t[1][t[0]]),r(t[1][t[0]+1],l),e(l).jqGrid("setSelection",t[1][t[0]+1]),e.isFunction(n.afterclickPgButtons)&&n.afterclickPgButtons("next",e("#"+c),t[1][t[0]+1]),o(t[0]+1,t[1].length-1)),i(),!1}),e("#pData","#"+u+"_2").click(function(){e("#FormError","#"+u).hide();var t=s();return-1!=t[0]&&t[1][t[0]-1]&&(e.isFunction(n.onclickPgButtons)&&n.onclickPgButtons("prev",e("#"+c),t[1][t[0]]),r(t[1][t[0]-1],l),e(l).jqGrid("setSelection",t[1][t[0]-1]),e.isFunction(n.afterclickPgButtons)&&n.afterclickPgButtons("prev",e("#"+c),t[1][t[0]-1]),o(t[0]-1,t[1].length-1)),i(),!1})}b=s(),o(b[0],b[1].length-1)}})},delGridRow:function(n,i){return t=i=e.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},e.jgrid.del,i||{}),this.each(function(){var a=this;if(a.grid&&n){var r,o,s,l,d="function"==typeof i.beforeShowForm?!0:!1,c="function"==typeof i.afterShowForm?!0:!1,u=e.isFunction(i.beforeInitData)?i.beforeInitData:!1,h=a.p.id,p={},f=!0,g="DelTbl_"+h,m={themodal:"delmod"+h,modalhead:"delhd"+h,modalcontent:"delcnt"+h,scrollelm:g};if(jQuery.isArray(n)&&(n=n.join()),null!==e("#"+m.themodal).html()){if(u&&(f=u(e("#"+g)),"undefined"==typeof f&&(f=!0)),f===!1)return;e("#DelData>td","#"+g).text(n),e("#DelError","#"+g).hide(),t.processing===!0&&(t.processing=!1,e("#dData","#"+g).removeClass("ui-state-active")),d&&i.beforeShowForm(e("#"+g)),e.jgrid.viewModal("#"+m.themodal,{gbox:"#gbox_"+h,jqm:i.jqModal,jqM:!1,overlay:i.overlay,modal:i.modal})}else{var b=isNaN(i.dataheight)?i.dataheight:i.dataheight+"px";if(b="<div id='"+g+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+b+";'>",b+="<table class='DelTable'><tbody>",b+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>",b+="<tr id='DelData' style='display:none'><td >"+n+"</td></tr>",b+='<tr><td class="delmsg" style="white-space:pre;">'+i.msg+"</td></tr><tr><td >&#160;</td></tr>",b+="</tbody></table></div>",b+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+g+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr></tr><tr><td class='DelButton EditButton'>"+("<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+i.bSubmit+"</a>")+"&#160;"+("<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+i.bCancel+"</a>")+"</td></tr></tbody></table>",i.gbox="#gbox_"+h,e.jgrid.createModal(m,b,i,"#gview_"+a.p.id,e("#gview_"+a.p.id)[0]),u&&(f=u(e("#"+g)),"undefined"==typeof f&&(f=!0)),f===!1)return;e(".fm-button","#"+g+"_2").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),i.delicon=e.extend([!0,"left","ui-icon-scissors"],i.delicon),i.cancelicon=e.extend([!0,"left","ui-icon-cancel"],i.cancelicon),i.delicon[0]===!0&&e("#dData","#"+g+"_2").addClass("right"==i.delicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+i.delicon[2]+"'></span>"),i.cancelicon[0]===!0&&e("#eData","#"+g+"_2").addClass("right"==i.cancelicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+i.cancelicon[2]+"'></span>"),e("#dData","#"+g+"_2").click(function(){var n=[!0,""];
p={};var d=e("#DelData>td","#"+g).text();if("function"==typeof i.onclickSubmit&&(p=i.onclickSubmit(t,d)||{}),"function"==typeof i.beforeSubmit&&(n=i.beforeSubmit(d)),n[0]&&!t.processing){t.processing=!0,e(this).addClass("ui-state-active"),s=a.p.prmNames,r=e.extend({},t.delData,p),l=s.oper,r[l]=s.deloper,o=s.id,r[o]=d;var c=e.extend({url:t.url?t.url:e(a).jqGrid("getGridParam","editurl"),type:i.mtype,data:e.isFunction(i.serializeDelData)?i.serializeDelData(r):r,complete:function(o,s){if("success"!=s?(n[0]=!1,n[1]=e.isFunction(t.errorTextFormat)?t.errorTextFormat(o):s+" Status: '"+o.statusText+"'. Error code: "+o.status):"function"==typeof t.afterSubmit&&(n=t.afterSubmit(o,r)),n[0]===!1)e("#DelError>td","#"+g).html(n[1]),e("#DelError","#"+g).show();else{if(t.reloadAfterSubmit&&"local"!=a.p.datatype)e(a).trigger("reloadGrid");else{var l=[];if(l=d.split(","),a.p.treeGrid===!0)try{e(a).jqGrid("delTreeNode",l[0])}catch(c){}else for(var u=0;u<l.length;u++)e(a).jqGrid("delRowData",l[u]);a.p.selrow=null,a.p.selarrrow=[]}e.isFunction(t.afterComplete)&&setTimeout(function(){t.afterComplete(o,d)},500)}t.processing=!1,e("#dData","#"+g+"_2").removeClass("ui-state-active"),n[0]&&e.jgrid.hideModal("#"+m.themodal,{gb:"#gbox_"+h,jqm:i.jqModal,onClose:t.onClose})}},e.jgrid.ajaxOptions,i.ajaxDelOptions);c.url||t.useDataProxy||(e.isFunction(a.p.dataProxy)?t.useDataProxy=!0:(n[0]=!1,n[1]+=" "+e.jgrid.errors.nourl)),n[0]&&(t.useDataProxy?a.p.dataProxy.call(a,c,"del_"+a.p.id):e.ajax(c))}return n[0]===!1&&(e("#DelError>td","#"+g).html(n[1]),e("#DelError","#"+g).show()),!1}),e("#eData","#"+g+"_2").click(function(){return e.jgrid.hideModal("#"+m.themodal,{gb:"#gbox_"+h,jqm:i.jqModal,onClose:t.onClose}),!1}),d&&i.beforeShowForm(e("#"+g)),e.jgrid.viewModal("#"+m.themodal,{gbox:"#gbox_"+h,jqm:i.jqModal,overlay:i.overlay,modal:i.modal})}c&&i.afterShowForm(e("#"+g)),i.closeOnEscape===!0&&setTimeout(function(){e(".ui-jqdialog-titlebar-close","#"+m.modalhead).focus()},0)}})},navGrid:function(t,n,i,a,r,o,s){return n=e.extend({edit:!0,editicon:"ui-icon-pencil",add:!0,addicon:"ui-icon-plus",del:!0,delicon:"ui-icon-trash",search:!0,searchicon:"ui-icon-search",refresh:!0,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:!1,viewicon:"ui-icon-document",position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1},e.jgrid.nav,n||{}),this.each(function(){if(!this.nav){var l,d,c,u={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},h=this;if(h.grid&&"string"==typeof t)for(null===e("#"+u.themodal).html()&&("undefined"!=typeof window.innerWidth?(l=window.innerWidth,d=window.innerHeight):"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(l=document.documentElement.clientWidth,d=document.documentElement.clientHeight):(l=1024,d=768),e.jgrid.createModal(u,"<div>"+n.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+h.p.id,jqModal:!0,drag:!0,resize:!0,caption:n.alertcap,top:d/2-25,left:l/2-100,width:200,height:"auto",closeOnEscape:n.closeOnEscape},"","",!0)),l=1,n.cloneToTop&&h.p.toppager&&(l=2),d=0;l>d;d++){var p,f,g=e("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>");0===d?(p=t,f=h.p.id,p==h.p.toppager&&(f+="_top",l=1)):(p=h.p.toppager,f=h.p.id+"_top"),"rtl"==h.p.direction&&e(g).attr("dir","rtl").css("float","right"),n.add&&(a=a||{},c=e("<td class='ui-pg-button ui-corner-all'></td>"),e(c).append("<div class='ui-pg-div'><span class='ui-icon "+n.addicon+"'></span>"+n.addtext+"</div>"),e("tr",g).append(c),e(c,g).attr({title:n.addtitle||"",id:a.id||"add_"+f}).click(function(){return e(this).hasClass("ui-state-disabled")||("function"==typeof n.addfunc?n.addfunc():e(h).jqGrid("editGridRow","new",a)),!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),c=null),n.edit&&(c=e("<td class='ui-pg-button ui-corner-all'></td>"),i=i||{},e(c).append("<div class='ui-pg-div'><span class='ui-icon "+n.editicon+"'></span>"+n.edittext+"</div>"),e("tr",g).append(c),e(c,g).attr({title:n.edittitle||"",id:i.id||"edit_"+f}).click(function(){if(!e(this).hasClass("ui-state-disabled")){var t=h.p.selrow;t?"function"==typeof n.editfunc?n.editfunc(t):e(h).jqGrid("editGridRow",t,i):(e.jgrid.viewModal("#"+u.themodal,{gbox:"#gbox_"+h.p.id,jqm:!0}),e("#jqg_alrt").focus())}return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),c=null),n.view&&(c=e("<td class='ui-pg-button ui-corner-all'></td>"),s=s||{},e(c).append("<div class='ui-pg-div'><span class='ui-icon "+n.viewicon+"'></span>"+n.viewtext+"</div>"),e("tr",g).append(c),e(c,g).attr({title:n.viewtitle||"",id:s.id||"view_"+f}).click(function(){if(!e(this).hasClass("ui-state-disabled")){var t=h.p.selrow;t?e(h).jqGrid("viewGridRow",t,s):(e.jgrid.viewModal("#"+u.themodal,{gbox:"#gbox_"+h.p.id,jqm:!0}),e("#jqg_alrt").focus())}return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),c=null),n.del&&(c=e("<td class='ui-pg-button ui-corner-all'></td>"),r=r||{},e(c).append("<div class='ui-pg-div'><span class='ui-icon "+n.delicon+"'></span>"+n.deltext+"</div>"),e("tr",g).append(c),e(c,g).attr({title:n.deltitle||"",id:r.id||"del_"+f}).click(function(){if(!e(this).hasClass("ui-state-disabled")){var t;h.p.multiselect?(t=h.p.selarrrow,0===t.length&&(t=null)):t=h.p.selrow,t?"function"==typeof n.delfunc?n.delfunc(t):e(h).jqGrid("delGridRow",t,r):(e.jgrid.viewModal("#"+u.themodal,{gbox:"#gbox_"+h.p.id,jqm:!0}),e("#jqg_alrt").focus())}return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),c=null),(n.add||n.edit||n.del||n.view)&&e("tr",g).append("<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>"),n.search&&(c=e("<td class='ui-pg-button ui-corner-all'></td>"),o=o||{},e(c).append("<div class='ui-pg-div'><span class='ui-icon "+n.searchicon+"'></span>"+n.searchtext+"</div>"),e("tr",g).append(c),e(c,g).attr({title:n.searchtitle||"",id:o.id||"search_"+f}).click(function(){return e(this).hasClass("ui-state-disabled")||e(h).jqGrid("searchGrid",o),!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),o.showOnLoad&&o.showOnLoad===!0&&e(c,g).click(),c=null),n.refresh&&(c=e("<td class='ui-pg-button ui-corner-all'></td>"),e(c).append("<div class='ui-pg-div'><span class='ui-icon "+n.refreshicon+"'></span>"+n.refreshtext+"</div>"),e("tr",g).append(c),e(c,g).attr({title:n.refreshtitle||"",id:"refresh_"+f}).click(function(){if(!e(this).hasClass("ui-state-disabled")){e.isFunction(n.beforeRefresh)&&n.beforeRefresh(),h.p.search=!1;try{var t=h.p.id;h.p.postData.filters="",e("#fbox_"+t).jqFilter("resetFilter"),e.isFunction(h.clearToolbar)&&h.clearToolbar(!1)}catch(i){}switch(n.refreshstate){case"firstpage":e(h).trigger("reloadGrid",[{page:1}]);break;case"current":e(h).trigger("reloadGrid",[{current:!0}])}e.isFunction(n.afterRefresh)&&n.afterRefresh()}return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),c=null),c=e(".ui-jqgrid").css("font-size")||"11px",e("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+c+";visibility:hidden;' ></div>"),c=e(g).clone().appendTo("#testpg2").width(),e("#testpg2").remove(),e(p+"_"+n.position,p).append(g),h.p._nvtd&&(c>h.p._nvtd[0]&&(e(p+"_"+n.position,p).width(c),h.p._nvtd[0]=c),h.p._nvtd[1]=c),g=c=c=null,this.nav=!0}}})},navButtonAdd:function(t,n){return n=e.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},n||{}),this.each(function(){if(this.grid){0!==t.indexOf("#")&&(t="#"+t);var i=e(".navtable",t)[0],a=this;if(i&&(!n.id||null===e("#"+n.id,i).html())){var r=e("<td></td>");e(r).addClass("ui-pg-button ui-corner-all").append("NONE"==n.buttonicon.toString().toUpperCase()?"<div class='ui-pg-div'>"+n.caption+"</div>":"<div class='ui-pg-div'><span class='ui-icon "+n.buttonicon+"'></span>"+n.caption+"</div>"),n.id&&e(r).attr("id",n.id),"first"==n.position?0===i.rows[0].cells.length?e("tr",i).append(r):e("tr td:eq(0)",i).before(r):e("tr",i).append(r),e(r,i).attr("title",n.title||"").click(function(t){return e(this).hasClass("ui-state-disabled")||e.isFunction(n.onClickButton)&&n.onClickButton.call(a,t),!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")})}}})},navSeparatorAdd:function(t,n){return n=e.extend({sepclass:"ui-separator",sepcontent:""},n||{}),this.each(function(){if(this.grid){0!==t.indexOf("#")&&(t="#"+t);var i=e(".navtable",t)[0];if(i){var a="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+n.sepclass+"'></span>"+n.sepcontent+"</td>";e("tr",i).append(a)}}})},GridToForm:function(t,n){return this.each(function(){if(this.grid){var i=e(this).jqGrid("getRowData",t);if(i)for(var a in i)e("[name="+e.jgrid.jqID(a)+"]",n).is("input:radio")||e("[name="+e.jgrid.jqID(a)+"]",n).is("input:checkbox")?e("[name="+e.jgrid.jqID(a)+"]",n).each(function(){e(this).val()==i[a]?e(this).attr("checked","checked"):e(this).attr("checked","")}):e("[name="+e.jgrid.jqID(a)+"]",n).val(i[a])}})},FormToGrid:function(t,n,i,a){return this.each(function(){if(this.grid){i||(i="set"),a||(a="first");var r=e(n).serializeArray(),o={};e.each(r,function(e,t){o[t.name]=t.value}),"add"==i?e(this).jqGrid("addRowData",t,o,a):"set"==i&&e(this).jqGrid("setRowData",t,o)}})}})}(jQuery),function(e){e.fn.jqFilter=function(t){if("string"==typeof t){var n=e.fn.jqFilter[t];if(!n)throw"jqFilter - No such method: "+t;var i=e.makeArray(arguments).slice(1);return n.apply(this,i)}var a=e.extend(!0,{filter:null,columns:[],onChange:null,checkValues:null,error:!1,errmsg:"",errorcheck:!0,showQuery:!0,sopt:null,ops:[{name:"eq",description:"equal",operator:"="},{name:"ne",description:"not equal",operator:"<>"},{name:"lt",description:"less",operator:"<"},{name:"le",description:"less or equal",operator:"<="},{name:"gt",description:"greater",operator:">"},{name:"ge",description:"greater or equal",operator:">="},{name:"bw",description:"begins with",operator:"LIKE"},{name:"bn",description:"does not begin with",operator:"NOT LIKE"},{name:"in",description:"in",operator:"IN"},{name:"ni",description:"not in",operator:"NOT IN"},{name:"ew",description:"ends with",operator:"LIKE"},{name:"en",description:"does not end with",operator:"NOT LIKE"},{name:"cn",description:"contains",operator:"LIKE"},{name:"nc",description:"does not contain",operator:"NOT LIKE"},{name:"nu",description:"is null",operator:"IS NULL"},{name:"nn",description:"is not null",operator:"IS NOT NULL"}],numopts:["eq","ne","lt","le","gt","ge","nu","nn","in","ni"],stropts:["eq","ne","bw","bn","ew","en","cn","nc","nu","nn","in","ni"],_gridsopt:[],groupOps:["AND","OR"],groupButton:!0},t||{});return this.each(function(){if(!this.filter){this.p=a,(null===this.p.filter||void 0===this.p.filter)&&(this.p.filter={groupOp:this.p.groupOps[0],rules:[],groups:[]});var t,n,i=this.p.columns.length,r=/msie/i.test(navigator.userAgent)&&!window.opera;if(this.p._gridsopt.length)for(t=0;t<this.p._gridsopt.length;t++)this.p.ops[t].description=this.p._gridsopt[t];if(this.p.initFilter=e.extend(!0,{},this.p.filter),i){for(t=0;i>t;t++)n=this.p.columns[t],n.stype?n.inputtype=n.stype:n.inputtype||(n.inputtype="text"),n.sorttype?n.searchtype=n.sorttype:n.searchtype||(n.searchtype="string"),void 0===n.hidden&&(n.hidden=!1),n.label||(n.label=n.name),n.index&&(n.name=n.index),n.hasOwnProperty("searchoptions")||(n.searchoptions={}),n.hasOwnProperty("searchrules")||(n.searchrules={});this.p.showQuery&&e(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;'><tbody><tr><td class='query'></td></tr></tbody></table>");var o=function(t,n){var i=[!0,""];if(e.isFunction(n.searchrules))i=n.searchrules(t,n);else if(e.jgrid&&e.jgrid.checkValues)try{i=e.jgrid.checkValues(t,-1,null,n.searchrules,n.label)}catch(r){}i&&i.length&&i[0]===!1&&(a.error=!i[0],a.errmsg=i[1])};this.onchange=function(){return this.p.error=!1,this.p.errmsg="",e.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):!1},this.reDraw=function(){e("table.group:first",this).remove();var t=this.createTableForGroup(a.filter,null);e(this).append(t)},this.createTableForGroup=function(t,n){var i,r=this,o=e("<table class='group ui-widget ui-widget-content' style='border:0px none;'><tbody></tbody></table>");null===n&&e(o).append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='left'></th></tr>");var s=e("<tr></tr>");e(o).append(s);var l=e("<th colspan='5' align='left'></th>");s.append(l);var d=e("<select class='opsel'></select>");l.append(d),s="";var c;for(i=0;i<a.groupOps.length;i++)c=t.groupOp===r.p.groupOps[i]?" selected='selected'":"",s+="<option value='"+r.p.groupOps[i]+"'"+c+">"+r.p.groupOps[i]+"</option>";d.append(s).bind("change",function(){t.groupOp=e(d).val(),r.onchange()}),s="<span></span>",this.p.groupButton&&(s=e("<input type='button' value='+ {}' title='Add subgroup' class='add-group'/>"),s.bind("click",function(){return void 0===t.groups&&(t.groups=[]),t.groups.push({groupOp:a.groupOps[0],rules:[],groups:[]}),r.reDraw(),r.onchange(),!1})),l.append(s),s=e("<input type='button' value='+' title='Add rule' class='add-rule ui-add'/>");var u;if(s.bind("click",function(){for(void 0===t.rules&&(t.rules=[]),i=0;i<r.p.columns.length;i++){var e="undefined"==typeof r.p.columns[i].search?!0:r.p.columns[i].search,n=r.p.columns[i].hidden===!0;if(r.p.columns[i].searchoptions.searchhidden===!0&&e||e&&!n){u=r.p.columns[i];break}}return t.rules.push({field:u.name,op:(u.searchoptions.sopt?u.searchoptions.sopt:r.p.sopt?r.p.sopt:"string"===u.searchtype?r.p.stropts:r.p.numopts)[0],data:""}),r.reDraw(),!1}),l.append(s),null!==n&&(s=e("<input type='button' value='-' title='Delete group' class='delete-group'/>"),l.append(s),s.bind("click",function(){for(i=0;i<n.groups.length;i++)if(n.groups[i]===t){n.groups.splice(i,1);break}return r.reDraw(),r.onchange(),!1})),void 0!==t.groups)for(i=0;i<t.groups.length;i++)l=e("<tr></tr>"),o.append(l),s=e("<td class='first'></td>"),l.append(s),s=e("<td colspan='4'></td>"),s.append(this.createTableForGroup(t.groups[i],t)),l.append(s);if(void 0===t.groupOp&&(t.groupOp=r.p.groupOps[0]),void 0!==t.rules)for(i=0;i<t.rules.length;i++)o.append(this.createTableRowForRule(t.rules[i],t));return o},this.createTableRowForRule=function(t,n){var i,o,s,l,d,c=this,u=e("<tr></tr>"),h="";u.append("<td class='first'></td>");var p=e("<td class='columns'></td>");u.append(p);var f=e("<select></select>");for(p.append(f),f.bind("change",function(){for(t.field=e(f).val(),s=e(this).parents("tr:first"),i=0;i<c.p.columns.length;i++)if(c.p.columns[i].name===t.field){l=c.p.columns[i];break}if(l){l.searchoptions.id=e.jgrid.randId(),r&&"text"===l.inputtype&&(l.searchoptions.size||(l.searchoptions.size=10));var n=e.jgrid.createEl(l.inputtype,l.searchoptions,"",!0,c.p.ajaxSelectOptions,!0);e(n).addClass("input-elm"),o=l.searchoptions.sopt?l.searchoptions.sopt:c.p.sopt?c.p.sopt:"string"===l.searchtype?c.p.stropts:c.p.numopts;var a="",d="";for(i=0;i<c.p.ops.length;i++)-1!==e.inArray(c.p.ops[i].name,o)&&(d=t.op===c.p.ops[i].name?" selected=selected":"",a+="<option value='"+c.p.ops[i].name+"'"+d+">"+c.p.ops[i].description+"</option>");e(".selectopts",s).empty().append(a),e(".data",s).empty().append(n),e(".input-elm",s).bind("change",function(){t.data=e(this).val(),e.isArray(t.data)&&(t.data=t.data.join(",")),c.onchange()}),setTimeout(function(){t.data=e(n).val(),c.onchange()},0)}}),i=p=0;i<c.p.columns.length;i++){d="undefined"==typeof c.p.columns[i].search?!0:c.p.columns[i].search;var g=c.p.columns[i].hidden===!0;(c.p.columns[i].searchoptions.searchhidden===!0&&d||d&&!g)&&(d="",t.field===c.p.columns[i].name&&(d=" selected='selected'",p=i),h+="<option value='"+c.p.columns[i].name+"'"+d+">"+c.p.columns[i].label+"</option>")}f.append(h),h=e("<td class='operators'></td>"),u.append(h),l=a.columns[p],l.searchoptions.id=e.jgrid.randId(),r&&"text"===l.inputtype&&(l.searchoptions.size||(l.searchoptions.size=10)),p=e.jgrid.createEl(l.inputtype,l.searchoptions,t.data,!0,c.p.ajaxSelectOptions,!0);var m=e("<select class='selectopts'></select>");for(h.append(m),m.bind("change",function(){t.op=e(m).val(),s=e(this).parents("tr:first");var n=e(".input-elm",s)[0];"nu"===t.op||"nn"===t.op?(t.data="",n.value="",n.setAttribute("readonly","true"),n.setAttribute("disabled","true")):(n.removeAttribute("readonly"),n.removeAttribute("disabled")),c.onchange()}),o=l.searchoptions.sopt?l.searchoptions.sopt:c.p.sopt?c.p.sopt:"string"===l.searchtype?a.stropts:c.p.numopts,h="",i=0;i<c.p.ops.length;i++)-1!==e.inArray(c.p.ops[i].name,o)&&(d=t.op===c.p.ops[i].name?" selected='selected'":"",h+="<option value='"+c.p.ops[i].name+"'"+d+">"+c.p.ops[i].description+"</option>");return m.append(h),h=e("<td class='data'></td>"),u.append(h),h.append(p),e(p).addClass("input-elm").bind("change",function(){t.data=e(this).val(),e.isArray(t.data)&&(t.data=t.data.join(",")),c.onchange()}),h=e("<td></td>"),u.append(h),p=e("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del'/>"),h.append(p),p.bind("click",function(){for(i=0;i<n.rules.length;i++)if(n.rules[i]===t){n.rules.splice(i,1);break}return c.reDraw(),c.onchange(),!1}),u},this.getStringForGroup=function(e){var t,n="(";if(void 0!==e.groups)for(t=0;t<e.groups.length;t++){n.length>1&&(n+=" "+e.groupOp+" ");try{n+=this.getStringForGroup(e.groups[t])}catch(i){alert(i)}}if(void 0!==e.rules)try{for(t=0;t<e.rules.length;t++)n.length>1&&(n+=" "+e.groupOp+" "),n+=this.getStringForRule(e.rules[t])}catch(a){alert(a)}return n+=")","()"===n?"":n},this.getStringForRule=function(t){var n,i,r="",s="";for(n=0;n<this.p.ops.length;n++)if(this.p.ops[n].name===t.op){r=this.p.ops[n].operator,s=this.p.ops[n].name;break}for(n=0;n<this.p.columns.length;n++)if(this.p.columns[n].name===t.field){i=this.p.columns[n];break}return n=t.data,("bw"===s||"bn"===s)&&(n+="%"),("ew"===s||"en"===s)&&(n="%"+n),("cn"===s||"nc"===s)&&(n="%"+n+"%"),("in"===s||"ni"===s)&&(n=" ("+n+")"),a.errorcheck&&o(t.data,i),-1!==e.inArray(i.searchtype,["int","integer","float","number","currency"])||"nn"===s||"nu"===s?t.field+" "+r+" "+n:t.field+" "+r+' "'+n+'"'},this.resetFilter=function(){this.p.filter=e.extend(!0,{},this.p.initFilter),this.reDraw(),this.onchange()},this.hideError=function(){e("th.ui-state-error",this).html(""),e("tr.error",this).hide()},this.showError=function(){e("th.ui-state-error",this).html(this.p.errmsg),e("tr.error",this).show()},this.toUserFriendlyString=function(){return this.getStringForGroup(a.filter)},this.toString=function(){function e(n){var i,a="(";if(void 0!==n.groups)for(i=0;i<n.groups.length;i++)a.length>1&&(a+="OR"===n.groupOp?" || ":" && "),a+=e(n.groups[i]);if(void 0!==n.rules)for(i=0;i<n.rules.length;i++){a.length>1&&(a+="OR"===n.groupOp?" || ":" && ");var r=n.rules[i];if(t.p.errorcheck){var s=void 0,l=void 0;for(s=0;s<t.p.columns.length;s++)if(t.p.columns[s].name===r.field){l=t.p.columns[s];break}l&&o(r.data,l)}a+=r.op+"(item."+r.field+",'"+r.data+"')"}return a+=")","()"===a?"":a}var t=this;return e(this.p.filter)},this.reDraw(),this.p.showQuery&&this.onchange(),this.filter=!0}}})},e.extend(e.fn.jqFilter,{toSQLString:function(){var e="";return this.each(function(){e=this.toUserFriendlyString()}),e},filterData:function(){var e;return this.each(function(){e=this.p.filter}),e},getParameter:function(e){return void 0!==e&&this.p.hasOwnProperty(e)?this.p[e]:this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(e){"string"==typeof e&&(e=jQuery.jgrid.parse(e)),this.each(function(){this.p.filter=e,this.reDraw(),this.onchange()})}})}(jQuery),function(e){e.jgrid.extend({editRow:function(t,n,i,a,r,o,s,l,d){var c,u={keys:n||!1,oneditfunc:i||null,successfunc:a||null,url:r||null,extraparam:o||{},aftersavefunc:s||null,errorfunc:l||null,afterrestorefunc:d||null,restoreAfterErorr:!0},h=e.makeArray(arguments).slice(1);return c=h[0]&&"object"==typeof h[0]&&!e.isFunction(h[0])?e.extend(u,h[0]):u,this.each(function(){var n,i,a,r,o=this,s=0,l=null,u={};o.grid&&(a=e(o).jqGrid("getInd",t,!0),a!==!1&&("0"!=(e(a).attr("editable")||"0")||e(a).hasClass("not-editable-row")||(r=o.p.colModel,e("td",a).each(function(a){n=r[a].name;var d=o.p.treeGrid===!0&&n==o.p.ExpandColumn;if(d)i=e("span:first",this).html();else try{i=e.unformat(this,{rowId:t,colModel:r[a]},a)}catch(c){i=e(this).html()}if("cb"!=n&&"subgrid"!=n&&"rn"!=n&&(o.p.autoencode&&(i=e.jgrid.htmlDecode(i)),u[n]=i,r[a].editable===!0)){null===l&&(l=a),d?e("span:first",this).html(""):e(this).html("");var h=e.extend({},r[a].editoptions||{},{id:t+"_"+n,name:n});r[a].edittype||(r[a].edittype="text"),h=e.jgrid.createEl(r[a].edittype,h,i,!0,e.extend({},e.jgrid.ajaxOptions,o.p.ajaxSelectOptions||{})),e(h).addClass("editable"),d?e("span:first",this).append(h):e(this).append(h),"select"==r[a].edittype&&r[a].editoptions.multiple===!0&&e.browser.msie&&e(h).width(e(h).width()),s++}}),s>0&&(u.id=t,o.p.savedRow.push(u),e(a).attr("editable","1"),e("td:eq("+l+") input",a).focus(),c.keys===!0&&e(a).bind("keydown",function(n){return 27===n.keyCode&&e(o).jqGrid("restoreRow",t,d),13===n.keyCode?"TEXTAREA"==n.target.tagName?!0:(e(o).jqGrid("saveRow",t,c),!1):void n.stopPropagation()}),e.isFunction(c.oneditfunc)&&c.oneditfunc.call(o,t)))))})},saveRow:function(t,n,i,a,r,o,s){var l,d={successfunc:n||null,url:i||null,extraparam:a||{},aftersavefunc:r||null,errorfunc:o||null,afterrestorefunc:s||null,restoreAfterErorr:!0},c=e.makeArray(arguments).slice(1);l=c[0]&&"object"==typeof c[0]&&!e.isFunction(c[0])?e.extend(d,c[0]):d;var u,h,p,f,g=!1,m=this[0],b={},v={},y={};if(!m.grid)return g;if(f=e(m).jqGrid("getInd",t,!0),f===!1)return g;if(d=e(f).attr("editable"),l.url=l.url?l.url:m.p.editurl,"1"===d){var _;if(e("td",f).each(function(t){if(_=m.p.colModel[t],u=_.name,"cb"!=u&&"subgrid"!=u&&_.editable===!0&&"rn"!=u&&!e(this).hasClass("not-editable-cell")){switch(_.edittype){case"checkbox":var n=["Yes","No"];_.editoptions&&(n=_.editoptions.value.split(":")),b[u]=e("input",this).attr("checked")?n[0]:n[1];break;case"text":case"password":case"textarea":case"button":b[u]=e("input, textarea",this).val();break;case"select":if(_.editoptions.multiple){n=e("select",this);var i=[];b[u]=e(n).val(),b[u]=b[u]?b[u].join(","):"",e("select > option:selected",this).each(function(t,n){i[t]=e(n).text()}),v[u]=i.join(",")}else b[u]=e("select>option:selected",this).val(),v[u]=e("select>option:selected",this).text();_.formatter&&"select"==_.formatter&&(v={});break;case"custom":try{if(!_.editoptions||!e.isFunction(_.editoptions.custom_value))throw"e1";if(b[u]=_.editoptions.custom_value.call(m,e(".customelement",this),"get"),void 0===b[u])throw"e2"}catch(a){"e1"==a&&e.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose),"e2"==a?e.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose):e.jgrid.info_dialog(jQuery.jgrid.errors.errcap,a.message,jQuery.jgrid.edit.bClose)}}if(p=e.jgrid.checkValues(b[u],t,m),p[0]===!1)return p[1]=b[u]+" "+p[1],!1;m.p.autoencode&&(b[u]=e.jgrid.htmlEncode(b[u])),"clientArray"!==l.url&&_.editoptions&&_.editoptions.NullIfEmpty===!0&&""==b[u]&&(y[u]="null")}}),p[0]===!1){try{var w=e.jgrid.findPos(e("#"+e.jgrid.jqID(t),m.grid.bDiv)[0]);e.jgrid.info_dialog(e.jgrid.errors.errcap,p[1],e.jgrid.edit.bClose,{left:w[0],top:w[1]})}catch(C){alert(p[1])}return g}if(b&&(d=m.p.prmNames,c=d.oper,w=d.id,b[c]=d.editoper,b[w]=t,"undefined"==typeof m.p.inlineData&&(m.p.inlineData={}),b=e.extend({},b,m.p.inlineData,l.extraparam)),"clientArray"==l.url){for(b=e.extend({},b,v),m.p.autoencode&&e.each(b,function(t,n){b[t]=e.jgrid.htmlDecode(n)}),w=e(m).jqGrid("setRowData",t,b),e(f).attr("editable","0"),d=0;d<m.p.savedRow.length;d++)if(m.p.savedRow[d].id==t){h=d;break}h>=0&&m.p.savedRow.splice(h,1),e.isFunction(l.aftersavefunc)&&l.aftersavefunc.call(m,t,w),g=!0}else e("#lui_"+m.p.id).show(),y=e.extend({},b,y),e.ajax(e.extend({url:l.url,data:e.isFunction(m.p.serializeRowData)?m.p.serializeRowData.call(m,y):y,type:"POST",async:!1,complete:function(n,i){if(e("#lui_"+m.p.id).hide(),"success"===i)if((e.isFunction(l.succesfunc)?l.succesfunc.call(m,n):!0)===!0){m.p.autoencode&&e.each(b,function(t,n){b[t]=e.jgrid.htmlDecode(n)}),b=e.extend({},b,v),e(m).jqGrid("setRowData",t,b),e(f).attr("editable","0");for(var a=0;a<m.p.savedRow.length;a++)if(m.p.savedRow[a].id==t){h=a;break}h>=0&&m.p.savedRow.splice(h,1),e.isFunction(l.aftersavefunc)&&l.aftersavefunc.call(m,t,n),g=!0}else e.isFunction(l.errorfunc)&&l.errorfunc.call(m,t,n,i),l.restoreAfterError===!0&&e(m).jqGrid("restoreRow",t,l.afterrestorefunc)},error:function(n,i){if(e("#lui_"+m.p.id).hide(),e.isFunction(l.errorfunc))l.errorfunc.call(m,t,n,i);else try{jQuery.jgrid.info_dialog(jQuery.jgrid.errors.errcap,'<div class="ui-state-error">'+n.responseText+"</div>",jQuery.jgrid.edit.bClose,{buttonalign:"right"})}catch(a){alert(n.responseText)}l.restoreAfterError===!0&&e(m).jqGrid("restoreRow",t,l.afterrestorefunc)}},e.jgrid.ajaxOptions,m.p.ajaxRowOptions||{}));e(f).unbind("keydown")}return g},restoreRow:function(t,n){return this.each(function(){var i,a,r=this,o={};if(r.grid&&(a=e(r).jqGrid("getInd",t,!0),a!==!1)){for(var s=0;s<r.p.savedRow.length;s++)if(r.p.savedRow[s].id==t){i=s;break}if(i>=0){if(e.isFunction(e.fn.datepicker))try{e("input.hasDatepicker","#"+e.jgrid.jqID(a.id)).datepicker("hide")}catch(l){}e.each(r.p.colModel,function(){this.editable===!0&&this.name in r.p.savedRow[i]&&!e(this).hasClass("not-editable-cell")&&(o[this.name]=r.p.savedRow[i][this.name])}),e(r).jqGrid("setRowData",t,o),e(a).attr("editable","0").unbind("keydown"),r.p.savedRow.splice(i,1)}e.isFunction(n)&&n.call(r,t)}})}})}(jQuery),function(e){e.jgrid.extend({editCell:function(t,n,i){return this.each(function(){var a,r,o,s=this;if(s.grid&&s.p.cellEdit===!0){if(n=parseInt(n,10),s.p.selrow=s.rows[t].id,s.p.knv||e(s).jqGrid("GridNav"),s.p.savedRow.length>0){if(i===!0&&t==s.p.iRow&&n==s.p.iCol)return;e(s).jqGrid("saveCell",s.p.savedRow[0].id,s.p.savedRow[0].ic)}else window.setTimeout(function(){e("#"+s.p.knv).attr("tabindex","-1").focus()},0);if(a=s.p.colModel[n].name,"subgrid"!=a&&"cb"!=a&&"rn"!=a){if(o=e("td:eq("+n+")",s.rows[t]),s.p.colModel[n].editable!==!0||i!==!0||o.hasClass("not-editable-cell"))parseInt(s.p.iCol,10)>=0&&parseInt(s.p.iRow,10)>=0&&(e("td:eq("+s.p.iCol+")",s.rows[s.p.iRow]).removeClass("edit-cell ui-state-highlight"),e(s.rows[s.p.iRow]).removeClass("selected-row ui-state-hover")),o.addClass("edit-cell ui-state-highlight"),e(s.rows[t]).addClass("selected-row ui-state-hover"),e.isFunction(s.p.onSelectCell)&&(r=o.html().replace(/\&#160\;/gi,""),s.p.onSelectCell.call(s,s.rows[t].id,a,r,t,n));else{parseInt(s.p.iCol,10)>=0&&parseInt(s.p.iRow,10)>=0&&(e("td:eq("+s.p.iCol+")",s.rows[s.p.iRow]).removeClass("edit-cell ui-state-highlight"),e(s.rows[s.p.iRow]).removeClass("selected-row ui-state-hover")),e(o).addClass("edit-cell ui-state-highlight"),e(s.rows[t]).addClass("selected-row ui-state-hover");try{r=e.unformat(o,{rowId:s.rows[t].id,colModel:s.p.colModel[n]},n)}catch(l){r=e(o).html()}if(s.p.autoencode&&(r=e.jgrid.htmlDecode(r)),s.p.colModel[n].edittype||(s.p.colModel[n].edittype="text"),s.p.savedRow.push({id:t,ic:n,name:a,v:r}),e.isFunction(s.p.formatCell)){var d=s.p.formatCell.call(s,s.rows[t].id,a,r,t,n);void 0!==d&&(r=d)}d=e.extend({},s.p.colModel[n].editoptions||{},{id:t+"_"+a,name:a});var c=e.jgrid.createEl(s.p.colModel[n].edittype,d,r,!0,e.extend({},e.jgrid.ajaxOptions,s.p.ajaxSelectOptions||{}));e.isFunction(s.p.beforeEditCell)&&s.p.beforeEditCell.call(s,s.rows[t].id,a,r,t,n),e(o).html("").append(c).attr("tabindex","0"),window.setTimeout(function(){e(c).focus()},0),e("input, select, textarea",o).bind("keydown",function(i){if(27===i.keyCode&&(e("input.hasDatepicker",o).length>0?e(".ui-datepicker").is(":hidden")?e(s).jqGrid("restoreCell",t,n):e("input.hasDatepicker",o).datepicker("hide"):e(s).jqGrid("restoreCell",t,n)),13===i.keyCode&&e(s).jqGrid("saveCell",t,n),9==i.keyCode){if(s.grid.hDiv.loading)return!1;i.shiftKey?e(s).jqGrid("prevCell",t,n):e(s).jqGrid("nextCell",t,n)}i.stopPropagation()}),e.isFunction(s.p.afterEditCell)&&s.p.afterEditCell.call(s,s.rows[t].id,a,r,t,n)}s.p.iCol=n,s.p.iRow=t}}})},saveCell:function(t,n){return this.each(function(){var i,a=this;if(a.grid&&a.p.cellEdit===!0){if(i=a.p.savedRow.length>=1?0:null,null!==i){var r,o,s=e("td:eq("+n+")",a.rows[t]),l=a.p.colModel[n],d=l.name,c=e.jgrid.jqID(d);switch(l.edittype){case"select":if(l.editoptions.multiple){c=e("#"+t+"_"+c,a.rows[t]);var u=[];(r=e(c).val())?r.join(","):r="",e("option:selected",c).each(function(t,n){u[t]=e(n).text()}),o=u.join(",")}else r=e("#"+t+"_"+c+">option:selected",a.rows[t]).val(),o=e("#"+t+"_"+c+">option:selected",a.rows[t]).text();l.formatter&&(o=r);break;case"checkbox":var h=["Yes","No"];l.editoptions&&(h=l.editoptions.value.split(":")),o=r=e("#"+t+"_"+c,a.rows[t]).attr("checked")?h[0]:h[1];break;case"password":case"text":case"textarea":case"button":o=r=e("#"+t+"_"+c,a.rows[t]).val();break;case"custom":try{if(!l.editoptions||!e.isFunction(l.editoptions.custom_value))throw"e1";if(r=l.editoptions.custom_value.call(a,e(".customelement",s),"get"),void 0===r)throw"e2";o=r}catch(p){"e1"==p&&e.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose),"e2"==p?e.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose):e.jgrid.info_dialog(jQuery.jgrid.errors.errcap,p.message,jQuery.jgrid.edit.bClose)}}if(o!=a.p.savedRow[i].v){e.isFunction(a.p.beforeSaveCell)&&(i=a.p.beforeSaveCell.call(a,a.rows[t].id,d,r,t,n))&&(o=r=i);var f=e.jgrid.checkValues(r,n,a);if(f[0]===!0){if(i={},e.isFunction(a.p.beforeSubmitCell)&&((i=a.p.beforeSubmitCell.call(a,a.rows[t].id,d,r,t,n))||(i={})),e("input.hasDatepicker",s).length>0&&e("input.hasDatepicker",s).datepicker("hide"),"remote"==a.p.cellsubmit)if(a.p.cellurl){var g={};a.p.autoencode&&(r=e.jgrid.htmlEncode(r)),g[d]=r,h=a.p.prmNames,l=h.id,c=h.oper,g[l]=a.rows[t].id,g[c]=h.editoper,g=e.extend(i,g),e("#lui_"+a.p.id).show(),a.grid.hDiv.loading=!0,e.ajax(e.extend({url:a.p.cellurl,data:e.isFunction(a.p.serializeCellData)?a.p.serializeCellData.call(a,g):g,type:"POST",complete:function(i,l){if(e("#lui_"+a.p.id).hide(),a.grid.hDiv.loading=!1,"success"==l)if(e.isFunction(a.p.afterSubmitCell)){var c=a.p.afterSubmitCell.call(a,i,g.id,d,r,t,n);c[0]===!0?(e(s).empty(),e(a).jqGrid("setCell",a.rows[t].id,n,o,!1,!1,!0),e(s).addClass("dirty-cell"),e(a.rows[t]).addClass("edited"),e.isFunction(a.p.afterSaveCell)&&a.p.afterSaveCell.call(a,a.rows[t].id,d,r,t,n),a.p.savedRow.splice(0,1)):(e.jgrid.info_dialog(e.jgrid.errors.errcap,c[1],e.jgrid.edit.bClose),e(a).jqGrid("restoreCell",t,n))}else e(s).empty(),e(a).jqGrid("setCell",a.rows[t].id,n,o,!1,!1,!0),e(s).addClass("dirty-cell"),e(a.rows[t]).addClass("edited"),e.isFunction(a.p.afterSaveCell)&&a.p.afterSaveCell.call(a,a.rows[t].id,d,r,t,n),a.p.savedRow.splice(0,1)},error:function(i,r){e("#lui_"+a.p.id).hide(),a.grid.hDiv.loading=!1,e.isFunction(a.p.errorCell)?a.p.errorCell.call(a,i,r):e.jgrid.info_dialog(e.jgrid.errors.errcap,i.status+" : "+i.statusText+"<br/>"+r,e.jgrid.edit.bClose),e(a).jqGrid("restoreCell",t,n)
}},e.jgrid.ajaxOptions,a.p.ajaxCellOptions||{}))}else try{e.jgrid.info_dialog(e.jgrid.errors.errcap,e.jgrid.errors.nourl,e.jgrid.edit.bClose),e(a).jqGrid("restoreCell",t,n)}catch(m){}"clientArray"==a.p.cellsubmit&&(e(s).empty(),e(a).jqGrid("setCell",a.rows[t].id,n,o,!1,!1,!0),e(s).addClass("dirty-cell"),e(a.rows[t]).addClass("edited"),e.isFunction(a.p.afterSaveCell)&&a.p.afterSaveCell.call(a,a.rows[t].id,d,r,t,n),a.p.savedRow.splice(0,1))}else try{window.setTimeout(function(){e.jgrid.info_dialog(e.jgrid.errors.errcap,r+" "+f[1],e.jgrid.edit.bClose)},100),e(a).jqGrid("restoreCell",t,n)}catch(b){}}else e(a).jqGrid("restoreCell",t,n)}e.browser.opera?e("#"+a.p.knv).attr("tabindex","-1").focus():window.setTimeout(function(){e("#"+a.p.knv).attr("tabindex","-1").focus()},0)}})},restoreCell:function(t,n){return this.each(function(){var i,a=this;if(a.grid&&a.p.cellEdit===!0){if(i=a.p.savedRow.length>=1?0:null,null!==i){var r=e("td:eq("+n+")",a.rows[t]);if(e.isFunction(e.fn.datepicker))try{e("input.hasDatepicker",r).datepicker("hide")}catch(o){}e(r).empty().attr("tabindex","-1"),e(a).jqGrid("setCell",a.rows[t].id,n,a.p.savedRow[i].v,!1,!1,!0),e.isFunction(a.p.afterRestoreCell)&&a.p.afterRestoreCell.call(a,a.rows[t].id,a.p.savedRow[i].v,t,n),a.p.savedRow.splice(0,1)}window.setTimeout(function(){e("#"+a.p.knv).attr("tabindex","-1").focus()},0)}})},nextCell:function(t,n){return this.each(function(){var i=!1;if(this.grid&&this.p.cellEdit===!0){for(var a=n+1;a<this.p.colModel.length;a++)if(this.p.colModel[a].editable===!0){i=a;break}i!==!1?e(this).jqGrid("editCell",t,i,!0):this.p.savedRow.length>0&&e(this).jqGrid("saveCell",t,n)}})},prevCell:function(t,n){return this.each(function(){var i=!1;if(this.grid&&this.p.cellEdit===!0){for(var a=n-1;a>=0;a--)if(this.p.colModel[a].editable===!0){i=a;break}i!==!1?e(this).jqGrid("editCell",t,i,!0):this.p.savedRow.length>0&&e(this).jqGrid("saveCell",t,n)}})},GridNav:function(){return this.each(function(){function t(t,n,a){if("v"==a.substr(0,1)){var r=e(i.grid.bDiv)[0].clientHeight,o=e(i.grid.bDiv)[0].scrollTop,s=i.rows[t].offsetTop+i.rows[t].clientHeight,l=i.rows[t].offsetTop;"vd"==a&&s>=r&&(e(i.grid.bDiv)[0].scrollTop=e(i.grid.bDiv)[0].scrollTop+i.rows[t].clientHeight),"vu"==a&&o>l&&(e(i.grid.bDiv)[0].scrollTop=e(i.grid.bDiv)[0].scrollTop-i.rows[t].clientHeight)}"h"==a&&(a=e(i.grid.bDiv)[0].clientWidth,r=e(i.grid.bDiv)[0].scrollLeft,o=i.rows[t].cells[n].offsetLeft,i.rows[t].cells[n].offsetLeft+i.rows[t].cells[n].clientWidth>=a+parseInt(r,10)?e(i.grid.bDiv)[0].scrollLeft=e(i.grid.bDiv)[0].scrollLeft+i.rows[t].cells[n].clientWidth:r>o&&(e(i.grid.bDiv)[0].scrollLeft=e(i.grid.bDiv)[0].scrollLeft-i.rows[t].cells[n].clientWidth))}function n(e,t){var n,a;if("lft"==t)for(n=e+1,a=e;a>=0;a--)if(i.p.colModel[a].hidden!==!0){n=a;break}if("rgt"==t)for(n=e-1,a=e;a<i.p.colModel.length;a++)if(i.p.colModel[a].hidden!==!0){n=a;break}return n}var i=this;if(i.grid&&i.p.cellEdit===!0){i.p.knv=i.p.id+"_kn";var a,r,o=e("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+i.p.knv+"'></span></span>");e(o).insertBefore(i.grid.cDiv),e("#"+i.p.knv).focus().keydown(function(o){switch(r=o.keyCode,"rtl"==i.p.direction&&(37==r?r=39:39==r&&(r=37)),r){case 38:i.p.iRow-1>0&&(t(i.p.iRow-1,i.p.iCol,"vu"),e(i).jqGrid("editCell",i.p.iRow-1,i.p.iCol,!1));break;case 40:i.p.iRow+1<=i.rows.length-1&&(t(i.p.iRow+1,i.p.iCol,"vd"),e(i).jqGrid("editCell",i.p.iRow+1,i.p.iCol,!1));break;case 37:i.p.iCol-1>=0&&(a=n(i.p.iCol-1,"lft"),t(i.p.iRow,a,"h"),e(i).jqGrid("editCell",i.p.iRow,a,!1));break;case 39:i.p.iCol+1<=i.p.colModel.length-1&&(a=n(i.p.iCol+1,"rgt"),t(i.p.iRow,a,"h"),e(i).jqGrid("editCell",i.p.iRow,a,!1));break;case 13:parseInt(i.p.iCol,10)>=0&&parseInt(i.p.iRow,10)>=0&&e(i).jqGrid("editCell",i.p.iRow,i.p.iCol,!0)}return!1})}})},getChangedCells:function(t){var n=[];return t||(t="all"),this.each(function(){var i,a=this;!a.grid||a.p.cellEdit!==!0||e(a.rows).each(function(r){var o={};e(this).hasClass("edited")&&(e("td",this).each(function(n){if(i=a.p.colModel[n].name,"cb"!==i&&"subgrid"!==i)if("dirty"==t){if(e(this).hasClass("dirty-cell"))try{o[i]=e.unformat(this,{rowId:a.rows[r].id,colModel:a.p.colModel[n]},n)}catch(s){o[i]=e.jgrid.htmlDecode(e(this).html())}}else try{o[i]=e.unformat(this,{rowId:a.rows[r].id,colModel:a.p.colModel[n]},n)}catch(l){o[i]=e.jgrid.htmlDecode(e(this).html())}}),o.id=this.id,n.push(o))})}),n}})}(jQuery),function(e){e.fn.jqm=function(i){var a={overlay:50,closeoverlay:!0,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:r,ajaxText:"",target:r,modal:r,toTop:r,onShow:r,onHide:r,onLoad:r};return this.each(function(){return this._jqm?n[this._jqm].c=e.extend({},n[this._jqm].c,i):(t++,this._jqm=t,n[t]={c:e.extend(a,e.jqm.params,i),a:r,w:e(this).addClass("jqmID"+t),s:t},void(a.trigger&&e(this).jqmAddTrigger(a.trigger)))})},e.fn.jqmAddClose=function(e){return c(this,e,"jqmHide")},e.fn.jqmAddTrigger=function(e){return c(this,e,"jqmShow")},e.fn.jqmShow=function(t){return this.each(function(){e.jqm.open(this._jqm,t)})},e.fn.jqmHide=function(t){return this.each(function(){e.jqm.close(this._jqm,t)})},e.jqm={hash:{},open:function(t,s){var d=n[t],c=d.c,u="."+c.closeClass,h=parseInt(d.w.css("z-index"));h=h>0?h:3e3;var p=e("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":h-1,opacity:c.overlay/100});if(d.a)return r;if(d.t=s,d.a=!0,d.w.css("z-index",h),c.modal?(i[0]||setTimeout(function(){l("bind")},1),i.push(t)):c.overlay>0?c.closeoverlay&&d.w.jqmAddClose(p):p=r,d.o=p?p.addClass(c.overlayClass).prependTo("body"):r,a&&(e("html,body").css({height:"100%",width:"100%"}),p)){p=p.css({position:"absolute"})[0];for(var f in{Top:1,Left:1})p.style.setExpression(f.toLowerCase(),"(_=(document.documentElement.scroll"+f+" || document.body.scroll"+f+"))+'px'")}return c.ajax?(h=c.target||d.w,p=c.ajax,h="string"==typeof h?e(h,d.w):e(h),p="@"==p.substr(0,1)?e(s).attr(p.substring(1)):p,h.html(c.ajaxText).load(p,function(){c.onLoad&&c.onLoad.call(this,d),u&&d.w.jqmAddClose(e(u,d.w)),o(d)})):u&&d.w.jqmAddClose(e(u,d.w)),c.toTop&&d.o&&d.w.before('<span id="jqmP'+d.w[0]._jqm+'"></span>').insertAfter(d.o),c.onShow?c.onShow(d):d.w.show(),o(d),r},close:function(t){return t=n[t],t.a?(t.a=r,i[0]&&(i.pop(),i[0]||l("unbind")),t.c.toTop&&t.o&&e("#jqmP"+t.w[0]._jqm).after(t.w).remove(),t.c.onHide?t.c.onHide(t):(t.w.hide(),t.o&&t.o.remove()),r):r},params:{}};var t=0,n=e.jqm.hash,i=[],a=e.browser.msie&&"6.0"==e.browser.version,r=!1,o=function(t){var n=e('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0});a&&(t.o?t.o.html('<p style="width:100%;height:100%"/>').prepend(n):e("iframe.jqm",t.w)[0]||t.w.prepend(n)),s(t)},s=function(t){try{e(":input:visible",t.w)[0].focus()}catch(n){}},l=function(t){e(document)[t]("keypress",d)[t]("keydown",d)[t]("mousedown",d)},d=function(t){var a=n[i[i.length-1]];return(t=!e(t.target).parents(".jqmID"+a.s)[0])&&s(a),!t},c=function(t,i,a){return t.each(function(){var t=this._jqm;e(i).each(function(){this[a]||(this[a]=[],e(this).click(function(){for(var e in{jqmShow:1,jqmHide:1})for(var t in this[e])n[this[e][t]]&&n[this[e][t]].w[e](this);return r})),this[a].push(t)})})}}(jQuery),function(e){e.fn.jqDrag=function(e){return r(this,e,"d")},e.fn.jqResize=function(e,t){return r(this,e,"r",t)},e.jqDnR={dnr:{},e:0,drag:function(e){return"d"==i.k?a.css({left:i.X+e.pageX-i.pX,top:i.Y+e.pageY-i.pY}):(a.css({width:Math.max(e.pageX-i.pX+i.W,0),height:Math.max(e.pageY-i.pY+i.H,0)}),M1&&t.css({width:Math.max(e.pageX-M1.pX+M1.W,0),height:Math.max(e.pageY-M1.pY+M1.H,0)})),!1},stop:function(){e(document).unbind("mousemove",n.drag).unbind("mouseup",n.stop)}};var t,n=e.jqDnR,i=n.dnr,a=n.e,r=function(n,r,s,l){return n.each(function(){r=r?e(r,n):n,r.bind("mousedown",{e:n,k:s},function(n){var r=n.data,s={};if(a=r.e,t=l?e(l):!1,"relative"!=a.css("position"))try{a.position(s)}catch(d){}if(i={X:s.left||o("left")||0,Y:s.top||o("top")||0,W:o("width")||a[0].scrollWidth||0,H:o("height")||a[0].scrollHeight||0,pX:n.pageX,pY:n.pageY,k:r.k},M1=t&&"d"!=r.k?{X:s.left||f1("left")||0,Y:s.top||f1("top")||0,W:t[0].offsetWidth||f1("width")||0,H:t[0].offsetHeight||f1("height")||0,pX:n.pageX,pY:n.pageY,k:r.k}:!1,e("input.hasDatepicker",a[0])[0])try{e("input.hasDatepicker",a[0]).datepicker("hide")}catch(c){}return e(document).mousemove(e.jqDnR.drag).mouseup(e.jqDnR.stop),!1})})},o=function(e){return parseInt(a.css(e))||!1};f1=function(e){return parseInt(t.css(e))||!1}}(jQuery),function(e){e.jgrid.extend({setSubGrid:function(){return this.each(function(){var t;if(this.p.subGridOptions=e.extend({plusicon:"ui-icon-plus",minusicon:"ui-icon-minus",openicon:"ui-icon-carat-1-sw",expandOnLoad:!1,delayOnLoad:50,selectOnExpand:!1,reloadOnExpand:!0},this.p.subGridOptions||{}),this.p.colNames.unshift(""),this.p.colModel.unshift({name:"subgrid",width:e.browser.safari?this.p.subGridWidth+this.p.cellLayout:this.p.subGridWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,fixed:!0}),t=this.p.subGridModel,t[0]){t[0].align=e.extend([],t[0].align||[]);for(var n=0;n<t[0].name.length;n++)t[0].align[n]=t[0].align[n]||"left"}})},addSubGridCell:function(e,t){var n,i,a="";return this.each(function(){a=this.formatCol(e,t),i=this.p.id,n=this.p.subGridOptions.plusicon}),'<td role="grid" aria-describedby="'+i+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+a+"><a href='javascript:void(0);'><span class='ui-icon "+n+"'></span></a></td>"},addSubGrid:function(t){return this.each(function(){var n=this;if(n.grid){var i,a,r,o,s,l=function(t,i,a){i=e("<td align='"+n.p.subGridModel[0].align[a]+"'></td>").html(i),e(t).append(i)},d=function(t,i){var a,r,o,s=e("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),d=e("<tr></tr>");for(r=0;r<n.p.subGridModel[0].name.length;r++)a=e("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+n.p.direction+"'></th>"),e(a).html(n.p.subGridModel[0].name[r]),e(a).width(n.p.subGridModel[0].width[r]),e(d).append(a);return e(s).append(d),t&&(o=n.p.xmlReader.subgrid,e(o.root+" "+o.row,t).each(function(){if(d=e("<tr class='ui-widget-content ui-subtblcell'></tr>"),o.repeatitems===!0)e(o.cell,this).each(function(t){l(d,e(this).text()||"&#160;",t)});else{var t=n.p.subGridModel[0].mapping||n.p.subGridModel[0].name;if(t)for(r=0;r<t.length;r++)l(d,e(t[r],this).text()||"&#160;",r)}e(s).append(d)})),a=e("table:first",n.grid.bDiv).attr("id")+"_",e("#"+a+i).append(s),n.grid.hDiv.loading=!1,e("#load_"+n.p.id).hide(),!1},c=function(t,i){var a,r,o,s,d,c=e("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),u=e("<tr></tr>");for(r=0;r<n.p.subGridModel[0].name.length;r++)a=e("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+n.p.direction+"'></th>"),e(a).html(n.p.subGridModel[0].name[r]),e(a).width(n.p.subGridModel[0].width[r]),e(u).append(a);if(e(c).append(u),t&&(s=n.p.jsonReader.subgrid,a=t[s.root],"undefined"!=typeof a))for(r=0;r<a.length;r++){if(o=a[r],u=e("<tr class='ui-widget-content ui-subtblcell'></tr>"),s.repeatitems===!0)for(s.cell&&(o=o[s.cell]),d=0;d<o.length;d++)l(u,o[d]||"&#160;",d);else{var h=n.p.subGridModel[0].mapping||n.p.subGridModel[0].name;if(h.length)for(d=0;d<h.length;d++)l(u,o[h[d]]||"&#160;",d)}e(c).append(u)}return r=e("table:first",n.grid.bDiv).attr("id")+"_",e("#"+r+i).append(c),n.grid.hDiv.loading=!1,e("#load_"+n.p.id).hide(),!1},u=function(t){var i,a,r,o;if(i=e(t).attr("id"),a={nd_:(new Date).getTime()},a[n.p.prmNames.subgridid]=i,!n.p.subGridModel[0])return!1;if(n.p.subGridModel[0].params)for(o=0;o<n.p.subGridModel[0].params.length;o++)for(r=0;r<n.p.colModel.length;r++)n.p.colModel[r].name==n.p.subGridModel[0].params[o]&&(a[n.p.colModel[r].name]=e("td:eq("+r+")",t).text().replace(/\&#160\;/gi,""));if(!n.grid.hDiv.loading)switch(n.grid.hDiv.loading=!0,e("#load_"+n.p.id).show(),n.p.subgridtype||(n.p.subgridtype=n.p.datatype),e.isFunction(n.p.subgridtype)?n.p.subgridtype.call(n,a):n.p.subgridtype=n.p.subgridtype.toLowerCase(),n.p.subgridtype){case"xml":case"json":e.ajax(e.extend({type:n.p.mtype,url:n.p.subGridUrl,dataType:n.p.subgridtype,data:e.isFunction(n.p.serializeSubGridData)?n.p.serializeSubGridData.call(n,a):a,complete:function(t){"xml"==n.p.subgridtype?d(t.responseXML,i):c(e.jgrid.parse(t.responseText),i)}},e.jgrid.ajaxOptions,n.p.ajaxSubgridOptions||{}))}return!1},h=0;e.each(n.p.colModel,function(){(this.hidden===!0||"rn"==this.name||"cb"==this.name)&&h++}),e(n.rows).each(function(l){var d=this;e(d).hasClass("jqgrow")&&(e(this.cells[t]).bind("click",function(){if(s=d.nextSibling,e(this).hasClass("sgcollapsed")){if(a=n.p.id,i=d.id,n.p.subGridOptions.reloadOnExpand===!0||n.p.subGridOptions.reloadOnExpand===!1&&!e(s).hasClass("ui-subgrid")){if(r=t>=1?"<td colspan='"+t+"'>&#160;</td>":"",o=!0,e.isFunction(n.p.subGridBeforeExpand)&&(o=n.p.subGridBeforeExpand.call(n,a+"_"+i,i)),o===!1)return!1;e(d).after("<tr role='row' class='ui-subgrid'>"+r+"<td class='ui-widget-content subgrid-cell'><span class='ui-icon "+n.p.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(n.p.colNames.length-1-h,10)+"' class='ui-widget-content subgrid-data'><div id="+a+"_"+i+" class='tablediv'></div></td></tr>"),e.isFunction(n.p.subGridRowExpanded)?n.p.subGridRowExpanded.call(n,a+"_"+i,i):u(d)}else e(s).show();e(this).html("<a href='javascript:void(0);'><span class='ui-icon "+n.p.subGridOptions.minusicon+"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded"),n.p.subGridOptions.selectOnExpand&&e(n).jqGrid("setSelection",i)}else if(e(this).hasClass("sgexpanded")){if(o=!0,e.isFunction(n.p.subGridRowColapsed)&&(i=d.id,o=n.p.subGridRowColapsed.call(n,a+"_"+i,i)),o===!1)return!1;n.p.subGridOptions.reloadOnExpand===!0?e(s).remove(".ui-subgrid"):e(s).hasClass("ui-subgrid")&&e(s).hide(),e(this).html("<a href='javascript:void(0);'><span class='ui-icon "+n.p.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed")}return!1}),n.p.subGridOptions.expandOnLoad===!0&&setTimeout(function(){e(d.cells[t]).trigger("click")},l*n.p.subGridOptions.delayOnLoad))}),n.subGridXml=function(e,t){d(e,t)},n.subGridJson=function(e,t){c(e,t)}}})},expandSubGridRow:function(t){return this.each(function(){if((this.grid||t)&&this.p.subGrid===!0){var n=e(this).jqGrid("getInd",t,!0);n&&(n=e("td.sgcollapsed",n)[0])&&e(n).trigger("click")}})},collapseSubGridRow:function(t){return this.each(function(){if((this.grid||t)&&this.p.subGrid===!0){var n=e(this).jqGrid("getInd",t,!0);n&&(n=e("td.sgexpanded",n)[0])&&e(n).trigger("click")}})},toggleSubGridRow:function(t){return this.each(function(){if((this.grid||t)&&this.p.subGrid===!0){var n=e(this).jqGrid("getInd",t,!0);if(n){var i=e("td.sgcollapsed",n)[0];i?e(i).trigger("click"):(i=e("td.sgexpanded",n)[0])&&e(i).trigger("click")}}})}})}(jQuery),function(e){e.jgrid.extend({groupingSetup:function(){return this.each(function(){var t=this.p.groupingView;if(null===t||"object"!=typeof t&&!e.isFunction(t))this.p.grouping=!1;else if(t.groupField.length){"undefined"==typeof t.visibiltyOnNextGrouping&&(t.visibiltyOnNextGrouping=[]);for(var n=0;n<t.groupField.length;n++)if(t.groupOrder[n]||(t.groupOrder[n]="asc"),t.groupText[n]||(t.groupText[n]="{0}"),"boolean"!=typeof t.groupColumnShow[n]&&(t.groupColumnShow[n]=!0),"boolean"!=typeof t.groupSummary[n]&&(t.groupSummary[n]=!1),t.groupColumnShow[n]===!0?(t.visibiltyOnNextGrouping[n]=!0,e(this).jqGrid("showCol",t.groupField[n])):(t.visibiltyOnNextGrouping[n]=e("#"+this.p.id+"_"+t.groupField[n]).is(":visible"),e(this).jqGrid("hideCol",t.groupField[n])),t.sortitems[n]=[],t.sortnames[n]=[],t.summaryval[n]=[],t.groupSummary[n]){t.summary[n]=[];for(var i=this.p.colModel,a=0,r=i.length;r>a;a++)i[a].summaryType&&t.summary[n].push({nm:i[a].name,st:i[a].summaryType,v:""})}this.p.scroll=!1,this.p.rownumbers=!1,this.p.subGrid=!1,this.p.treeGrid=!1,this.p.gridview=!0}else this.p.grouping=!1})},groupingPrepare:function(t,n,i,a){return this.each(function(){n[0]+="";var r=n[0].toString().split(" ").join(""),o=this.p.groupingView,s=this;i.hasOwnProperty(r)?i[r].push(t):(i[r]=[],i[r].push(t),o.sortitems[0].push(r),o.sortnames[0].push(e.trim(n[0].toString())),o.summaryval[0][r]=e.extend(!0,[],o.summary[0])),o.groupSummary[0]&&e.each(o.summaryval[0][r],function(){this.v=e.isFunction(this.st)?this.st.call(s,this.v,this.nm,a):e(s).jqGrid("groupingCalculations."+this.st,this.v,this.nm,a)})}),i},groupingToggle:function(t){return this.each(function(){var n=this.p.groupingView,i=t.lastIndexOf("_"),a=t.substring(0,i+1);i=parseInt(t.substring(i+1),10)+1;var r=n.minusicon,o=n.plusicon,s=e("#"+t)[0].nextSibling,l=e("#"+t+" span.tree-wrap-"+this.p.direction),d=!1;if(l.hasClass(r)){if(n.showSummaryOnHide&&n.groupSummary[0]){if(s)for(;s&&!e(s).hasClass("jqfoot");)e(s).hide(),s=s.nextSibling}else if(s)for(;s&&e(s).attr("id")!=a+String(i);)e(s).hide(),s=s.nextSibling;l.removeClass(r).addClass(o),d=!0}else{if(s)for(;s&&e(s).attr("id")!=a+String(i);)e(s).show(),s=s.nextSibling;l.removeClass(o).addClass(r),d=!1}e.isFunction(this.p.onClickGroup)&&this.p.onClickGroup.call(this,t,d)}),!1},groupingRender:function(t,n){return this.each(function(){var i,a,r,o,s=this,l=s.p.groupingView,d="",c="",u="";for(l.groupDataSorted||(l.sortitems[0].sort(),l.sortnames[0].sort(),"desc"==l.groupOrder[0].toLowerCase()&&(l.sortitems[0].reverse(),l.sortnames[0].reverse())),u=l.groupCollapse?l.plusicon:l.minusicon,u+=" tree-wrap-"+s.p.direction,o=0;n>o;){if(s.p.colModel[o].name==l.groupField[0]){r=o;break}o++}e.each(l.sortitems[0],function(o,h){i=s.p.id+"ghead_"+o,c="<span style='cursor:pointer;' class='ui-icon "+u+"' onclick=\"jQuery('#"+s.p.id+"').jqGrid('groupingToggle','"+i+"');return false;\"></span>";try{a=s.formatter(i,l.sortnames[0][o],r,l.sortitems[0])}catch(p){a=l.sortnames[0][o]}d+='<tr id="'+i+'" role="row" class= "ui-widget-content jqgroup ui-row-'+s.p.direction+'"><td colspan="'+n+'">'+c+e.jgrid.format(l.groupText[0],a,t[h].length)+"</td></tr>";for(var f=0;f<t[h].length;f++)d+=t[h][f].join("");if(l.groupSummary[0]){f="",l.groupCollapse&&!l.showSummaryOnHide&&(f=' style="display:none;"'),d+="<tr"+f+' role="row" class="ui-widget-content jqfoot ui-row-'+s.p.direction+'">',f=l.summaryval[0][h];for(var g,m=s.p.colModel,b=t[h].length,v=0;n>v;v++){var y="<td "+s.formatCol(v,1,"")+">&#160;</td>",_="{0}";e.each(f,function(){if(this.nm==m[v].name){m[v].summaryTpl&&(_=m[v].summaryTpl),"avg"==this.st&&this.v&&b>0&&(this.v/=b);try{g=s.formatter("",this.v,v,this)}catch(t){g=this.v}return y="<td "+s.formatCol(v,1,"")+">"+e.jgrid.format(_,g)+"</td>",!1}}),d+=y}d+="</tr>"}}),e("#"+s.p.id+" tbody:first").append(d),d=null})},groupingGroupBy:function(t,n){return this.each(function(){"string"==typeof t&&(t=[t]);var i=this.p.groupingView;this.p.grouping=!0;for(var a=0;a<i.groupField.length;a++)!i.groupColumnShow[a]&&i.visibiltyOnNextGrouping[a]&&e(this).jqGrid("showCol",i.groupField[a]);for(a=0;a<t.length;a++)i.visibiltyOnNextGrouping[a]=e("#"+this.p.id+"_"+t[a]).is(":visible");this.p.groupingView=e.extend(this.p.groupingView,n||{}),i.groupField=t,e(this).trigger("reloadGrid")})},groupingRemove:function(t){return this.each(function(){if("undefined"==typeof t&&(t=!0),this.p.grouping=!1,t===!0){for(var n=this.p.groupingView,i=0;i<n.groupField.length;i++)!n.groupColumnShow[i]&&n.visibiltyOnNextGrouping[i]&&e(this).jqGrid("showCol",n.groupField);e("tr.jqgroup, tr.jqfoot","#"+this.p.id+" tbody:first").remove(),e("tr.jqgrow:hidden","#"+this.p.id+" tbody:first").show()}else e(this).trigger("reloadGrid")})},groupingCalculations:{sum:function(e,t,n){return parseFloat(e||0)+parseFloat(n[t]||0)},min:function(e,t,n){return""===e?parseFloat(n[t]||0):Math.min(parseFloat(e),parseFloat(n[t]||0))},max:function(e,t,n){return""===e?parseFloat(n[t]||0):Math.max(parseFloat(e),parseFloat(n[t]||0))},count:function(e,t,n){return""===e&&(e=0),n.hasOwnProperty(t)?e+1:0},avg:function(e,t,n){return parseFloat(e||0)+parseFloat(n[t]||0)}}})}(jQuery),function(e){e.jgrid.extend({setTreeNode:function(t,n){return this.each(function(){var i=this;if(i.grid&&i.p.treeGrid)for(var a,r,o,s,l=i.p.expColInd,d=i.p.treeReader.expanded_field,c=i.p.treeReader.leaf_field,u=i.p.treeReader.level_field,h=i.p.treeReader.icon_field,p=i.p.treeReader.loaded;n>t;)s=i.p.data[i.p._index[i.rows[t].id]],"nested"==i.p.treeGridModel&&(s[c]||(a=parseInt(s[i.p.treeReader.left_field],10),r=parseInt(s[i.p.treeReader.right_field],10),s[c]=r===a+1?"true":"false",i.rows[t].cells[i.p._treeleafpos].innerHTML=s[c])),a=parseInt(s[u],10),0===i.p.tree_root_level?(o=a+1,r=a):(o=a,r=a-1),o="<div class='tree-wrap tree-wrap-"+i.p.direction+"' style='width:"+18*o+"px;'>",o+="<div style='"+("rtl"==i.p.direction?"right:":"left:")+18*r+"px;' class='ui-icon ",void 0!==s[p]&&(s[p]="true"==s[p]||s[p]===!0?!0:!1),"true"==s[c]||s[c]===!0?(o+=(void 0!==s[h]&&""!==s[h]?s[h]:i.p.treeIcons.leaf)+" tree-leaf treeclick'",s[c]=!0,r="leaf"):(s[c]=!1,r=""),s[d]=("true"==s[d]||s[d]===!0?!0:!1)&&s[p],o+=s[d]===!0?i.p.treeIcons.minus+" tree-minus treeclick'":i.p.treeIcons.plus+" tree-plus treeclick'",o+="</div></div>",e(i.rows[t].cells[l]).wrapInner("<span class='cell-wrapper"+r+"'></span>").prepend(o),a!==parseInt(i.p.tree_root_level,10)&&((s=(s=e(i).jqGrid("getNodeParent",s))&&s.hasOwnProperty(d)?s[d]:!0)||e(i.rows[t]).css("display","none")),e(i.rows[t].cells[l]).find("div.treeclick").bind("click",function(t){return t=e(t.target||t.srcElement,i.rows).closest("tr.jqgrow")[0].id,t=i.p._index[t],i.p.data[t][c]||(i.p.data[t][d]?(e(i).jqGrid("collapseRow",i.p.data[t]),e(i).jqGrid("collapseNode",i.p.data[t])):(e(i).jqGrid("expandRow",i.p.data[t]),e(i).jqGrid("expandNode",i.p.data[t]))),!1}),i.p.ExpandColClick===!0&&e(i.rows[t].cells[l]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(t){t=e(t.target||t.srcElement,i.rows).closest("tr.jqgrow")[0].id;var n=i.p._index[t];return i.p.data[n][c]||(i.p.data[n][d]?(e(i).jqGrid("collapseRow",i.p.data[n]),e(i).jqGrid("collapseNode",i.p.data[n])):(e(i).jqGrid("expandRow",i.p.data[n]),e(i).jqGrid("expandNode",i.p.data[n]))),e(i).jqGrid("setSelection",t),!1}),t++})},setTreeGrid:function(){return this.each(function(){var t,n,i=this,a=0,r=!1,o=[];if(i.p.treeGrid){i.p.treedatatype||e.extend(i.p,{treedatatype:i.p.datatype}),i.p.subGrid=!1,i.p.altRows=!1,i.p.pgbuttons=!1,i.p.pginput=!1,i.p.gridview=!0,i.p.multiselect=!1,i.p.rowList=[],i.p.expColInd=0,i.p.treeIcons=e.extend({plus:"ui-icon-triangle-1-"+("rtl"==i.p.direction?"w":"e"),minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},i.p.treeIcons||{}),"nested"==i.p.treeGridModel?i.p.treeReader=e.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},i.p.treeReader):"adjacency"==i.p.treeGridModel&&(i.p.treeReader=e.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},i.p.treeReader));for(n in i.p.colModel)if(i.p.colModel.hasOwnProperty(n)){t=i.p.colModel[n].name,t!=i.p.ExpandColumn||r||(r=!0,i.p.expColInd=a),a++;for(var s in i.p.treeReader)i.p.treeReader[s]==t&&o.push(t)}e.each(i.p.treeReader,function(t,n){n&&-1===e.inArray(n,o)&&("leaf_field"===t&&(i.p._treeleafpos=a),a++,i.p.colNames.push(n),i.p.colModel.push({name:n,width:1,hidden:!0,sortable:!1,resizable:!1,hidedlg:!0,editable:!0,search:!1}))})}})},expandRow:function(t){this.each(function(){var n=this;if(n.grid&&n.p.treeGrid){var i=e(n).jqGrid("getNodeChildren",t),a=n.p.treeReader.expanded_field;e(i).each(function(){var t=e.jgrid.getAccessor(this,n.p.localReader.id);e("#"+t,n.grid.bDiv).css("display",""),this[a]&&e(n).jqGrid("expandRow",this)})}})},collapseRow:function(t){this.each(function(){var n=this;if(n.grid&&n.p.treeGrid){var i=e(n).jqGrid("getNodeChildren",t),a=n.p.treeReader.expanded_field;e(i).each(function(){var t=e.jgrid.getAccessor(this,n.p.localReader.id);e("#"+t,n.grid.bDiv).css("display","none"),this[a]&&e(n).jqGrid("collapseRow",this)})}})},getRootNodes:function(){var t=[];return this.each(function(){var n=this;if(n.grid&&n.p.treeGrid)switch(n.p.treeGridModel){case"nested":var i=n.p.treeReader.level_field;e(n.p.data).each(function(){parseInt(this[i],10)===parseInt(n.p.tree_root_level,10)&&t.push(this)});break;case"adjacency":var a=n.p.treeReader.parent_id_field;e(n.p.data).each(function(){(null===this[a]||"null"==String(this[a]).toLowerCase())&&t.push(this)})}}),t},getNodeDepth:function(t){var n=null;return this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case"nested":n=parseInt(t[this.p.treeReader.level_field],10)-parseInt(this.p.tree_root_level,10);break;case"adjacency":n=e(this).jqGrid("getNodeAncestors",t).length}}),n},getNodeParent:function(t){var n=null;return this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case"nested":var i=this.p.treeReader.left_field,a=this.p.treeReader.right_field,r=this.p.treeReader.level_field,o=parseInt(t[i],10),s=parseInt(t[a],10),l=parseInt(t[r],10);e(this.p.data).each(function(){return parseInt(this[r],10)===l-1&&parseInt(this[i],10)<o&&parseInt(this[a],10)>s?(n=this,!1):void 0});break;case"adjacency":var d=this.p.treeReader.parent_id_field,c=this.p.localReader.id;e(this.p.data).each(function(){return this[c]==t[d]?(n=this,!1):void 0})}}),n},getNodeChildren:function(t){var n=[];return this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case"nested":var i=this.p.treeReader.left_field,a=this.p.treeReader.right_field,r=this.p.treeReader.level_field,o=parseInt(t[i],10),s=parseInt(t[a],10),l=parseInt(t[r],10);e(this.p.data).each(function(){parseInt(this[r],10)===l+1&&parseInt(this[i],10)>o&&parseInt(this[a],10)<s&&n.push(this)});break;case"adjacency":var d=this.p.treeReader.parent_id_field,c=this.p.localReader.id;e(this.p.data).each(function(){this[d]==t[c]&&n.push(this)})}}),n},getFullTreeNode:function(t){var n=[];return this.each(function(){var i;if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case"nested":var a=this.p.treeReader.left_field,r=this.p.treeReader.right_field,o=this.p.treeReader.level_field,s=parseInt(t[a],10),l=parseInt(t[r],10),d=parseInt(t[o],10);e(this.p.data).each(function(){parseInt(this[o],10)>=d&&parseInt(this[a],10)>=s&&parseInt(this[a],10)<=l&&n.push(this)});break;case"adjacency":if(t){n.push(t);var c=this.p.treeReader.parent_id_field,u=this.p.localReader.id;e(this.p.data).each(function(e){for(i=n.length,e=0;i>e;e++)if(n[e][u]==this[c]){n.push(this);break}})}}}),n},getNodeAncestors:function(t){var n=[];return this.each(function(){if(this.grid&&this.p.treeGrid)for(var i=e(this).jqGrid("getNodeParent",t);i;)n.push(i),i=e(this).jqGrid("getNodeParent",i)}),n},isVisibleNode:function(t){var n=!0;return this.each(function(){if(this.grid&&this.p.treeGrid){var i=e(this).jqGrid("getNodeAncestors",t),a=this.p.treeReader.expanded_field;e(i).each(function(){return n=n&&this[a],n?void 0:!1})}}),n},isNodeLoaded:function(t){var n;return this.each(function(){if(this.grid&&this.p.treeGrid){var i=this.p.treeReader.leaf_field;n=void 0!==t?void 0!==t.loaded?t.loaded:t[i]||e(this).jqGrid("getNodeChildren",t).length>0?!0:!1:!1}}),n},expandNode:function(t){return this.each(function(){if(this.grid&&this.p.treeGrid){var n=this.p.treeReader.expanded_field,i=this.p.treeReader.parent_id_field,a=this.p.treeReader.loaded,r=this.p.treeReader.level_field,o=this.p.treeReader.left_field,s=this.p.treeReader.right_field;if(!t[n]){var l=e.jgrid.getAccessor(t,this.p.localReader.id),d=e("#"+l,this.grid.bDiv)[0],c=this.p._index[l];e(this).jqGrid("isNodeLoaded",this.p.data[c])?(t[n]=!0,e("div.treeclick",d).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")):(t[n]=!0,e("div.treeclick",d).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus"),this.p.treeANode=d.rowIndex,this.p.datatype=this.p.treedatatype,"nested"==this.p.treeGridModel?e(this).jqGrid("setGridParam",{postData:{nodeid:l,n_left:t[o],n_right:t[s],n_level:t[r]}}):e(this).jqGrid("setGridParam",{postData:{nodeid:l,parentid:t[i],n_level:t[r]}}),e(this).trigger("reloadGrid"),t[a]=!0,"nested"==this.p.treeGridModel?e(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}}):e(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}}))}}})},collapseNode:function(t){return this.each(function(){if(this.grid&&this.p.treeGrid&&t.expanded){t.expanded=!1;var n=e.jgrid.getAccessor(t,this.p.localReader.id);n=e("#"+n,this.grid.bDiv)[0],e("div.treeclick",n).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus")}})},SortTree:function(t,n,i,a){return this.each(function(){if(this.grid&&this.p.treeGrid){var r,o,s,l,d=[],c=this;for(r=e(this).jqGrid("getRootNodes"),r=e.jgrid.from(r),r.orderBy(t,n,i,a),l=r.select(),r=0,o=l.length;o>r;r++)s=l[r],d.push(s),e(this).jqGrid("collectChildrenSortTree",d,s,t,n,i,a);e.each(d,function(t){var n=e.jgrid.getAccessor(this,c.p.localReader.id);e("#"+c.p.id+" tbody tr:eq("+t+")").after(e("tr#"+n,c.grid.bDiv))}),d=l=r=null}})},collectChildrenSortTree:function(t,n,i,a,r,o){return this.each(function(){if(this.grid&&this.p.treeGrid){var s,l,d,c;for(s=e(this).jqGrid("getNodeChildren",n),s=e.jgrid.from(s),s.orderBy(i,a,r,o),c=s.select(),s=0,l=c.length;l>s;s++)d=c[s],t.push(d),e(this).jqGrid("collectChildrenSortTree",t,d,i,a,r,o)}})},setTreeRow:function(t,n){var i=!1;return this.each(function(){this.grid&&this.p.treeGrid&&(i=e(this).jqGrid("setRowData",t,n))}),i},delTreeNode:function(t){return this.each(function(){var n,i,a,r=this.p.localReader.id,o=this.p.treeReader.left_field,s=this.p.treeReader.right_field;if(this.grid&&this.p.treeGrid){var l=this.p._index[t];if(void 0!==l){if(n=parseInt(this.p.data[l][s],10),i=n-parseInt(this.p.data[l][o],10)+1,l=e(this).jqGrid("getFullTreeNode",this.p.data[l]),l.length>0)for(var d=0;d<l.length;d++)e(this).jqGrid("delRowData",l[d][r]);if("nested"===this.p.treeGridModel){if(r=e.jgrid.from(this.p.data).greater(o,n,{stype:"integer"}).select(),r.length)for(a in r)r[a][o]=parseInt(r[a][o],10)-i;if(r=e.jgrid.from(this.p.data).greater(s,n,{stype:"integer"}).select(),r.length)for(a in r)r[a][s]=parseInt(r[a][s],10)-i}}}})},addChildNode:function(t,n,i){var a=this[0];if(i){var r,o,s,l,d,c=a.p.treeReader.expanded_field,u=a.p.treeReader.leaf_field,h=a.p.treeReader.level_field,p=a.p.treeReader.parent_id_field,f=a.p.treeReader.left_field,g=a.p.treeReader.right_field,m=a.p.treeReader.loaded;r=0;var b,v=n;if(!t){if(d=a.p.data.length-1,d>=0)for(;d>=0;)r=Math.max(r,parseInt(a.p.data[d][a.p.localReader.id],10)),d--;t=r+1}var y=e(a).jqGrid("getInd",n);if(b=!1,void 0===n||null===n||""===n?(v=n=null,r="last",l=a.p.tree_root_level,d=a.p.data.length+1):(r="after",o=a.p._index[n],s=a.p.data[o],n=s[a.p.localReader.id],l=parseInt(s[h],10)+1,d=e(a).jqGrid("getFullTreeNode",s),d.length?(v=d=d[d.length-1][a.p.localReader.id],d=e(a).jqGrid("getInd",v)+1):d=e(a).jqGrid("getInd",n)+1,s[u]&&(b=!0,s[c]=!0,e(a.rows[y]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(a.p.treeIcons.leaf+" tree-leaf").addClass(a.p.treeIcons.minus+" tree-minus"),a.p.data[o][u]=!1,s[m]=!0)),o=d+1,i[c]=!1,i[m]=!0,i[h]=l,i[u]=!0,"adjacency"===a.p.treeGridModel&&(i[p]=n),"nested"===a.p.treeGridModel){var _;if(null!==n){if(u=parseInt(s[g],10),h=e.jgrid.from(a.p.data),h=h.greaterOrEquals(g,u,{stype:"integer"}),h=h.select(),h.length)for(_ in h)h[_][f]=h[_][f]>u?parseInt(h[_][f],10)+2:h[_][f],h[_][g]=h[_][g]>=u?parseInt(h[_][g],10)+2:h[_][g];i[f]=u,i[g]=u+1}else{if(u=parseInt(e(a).jqGrid("getCol",g,!1,"max"),10),h=e.jgrid.from(a.p.data).greater(f,u,{stype:"integer"}).select(),h.length)for(_ in h)h[_][f]=parseInt(h[_][f],10)+2;if(h=e.jgrid.from(a.p.data).greater(g,u,{stype:"integer"}).select(),h.length)for(_ in h)h[_][g]=parseInt(h[_][g],10)+2;
i[f]=u+1,i[g]=u+2}}(null===n||e(a).jqGrid("isNodeLoaded",s)||b)&&(e(a).jqGrid("addRowData",t,i,r,v),e(a).jqGrid("setTreeNode",d,o)),s&&!s[c]&&e(a.rows[y]).find("div.treeclick").click()}}})}(jQuery),function(e){e.jgrid.extend({jqGridImport:function(t){return t=e.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},t||{}),this.each(function(){var n=this,i=function(t,i){var a,r=e(i.xmlGrid.config,t)[0],o=e(i.xmlGrid.data,t)[0];if(xmlJsonClass.xml2json&&e.jgrid.parse){r=xmlJsonClass.xml2json(r," "),r=e.jgrid.parse(r);for(var s in r)r.hasOwnProperty(s)&&(a=r[s]);o?(o=r.grid.datatype,r.grid.datatype="xmlstring",r.grid.datastr=t,e(n).jqGrid(a).jqGrid("setGridParam",{datatype:o})):e(n).jqGrid(a)}else alert("xml2json or parse are not present")},a=function(t,i){if(t&&"string"==typeof t){var a=e.jgrid.parse(t),r=a[i.jsonGrid.config];if(a=a[i.jsonGrid.data]){var o=r.datatype;r.datatype="jsonstring",r.datastr=a,e(n).jqGrid(r).jqGrid("setGridParam",{datatype:o})}else e(n).jqGrid(r)}};switch(t.imptype){case"xml":e.ajax(e.extend({url:t.impurl,type:t.mtype,data:t.impData,dataType:"xml",complete:function(n,a){"success"==a&&(i(n.responseXML,t),e.isFunction(t.importComplete)&&t.importComplete(n))}},t.ajaxOptions));break;case"xmlstring":if(t.impstring&&"string"==typeof t.impstring){var r=e.jgrid.stringToDoc(t.impstring);r&&(i(r,t),e.isFunction(t.importComplete)&&t.importComplete(r),t.impstring=null),r=null}break;case"json":e.ajax(e.extend({url:t.impurl,type:t.mtype,data:t.impData,dataType:"json",complete:function(n,i){"success"==i&&(a(n.responseText,t),e.isFunction(t.importComplete)&&t.importComplete(n))}},t.ajaxOptions));break;case"jsonstring":t.impstring&&"string"==typeof t.impstring&&(a(t.impstring,t),e.isFunction(t.importComplete)&&t.importComplete(t.impstring),t.impstring=null)}})},jqGridExport:function(t){t=e.extend({exptype:"xmlstring",root:"grid",ident:"	"},t||{});var n=null;return this.each(function(){if(this.grid){var i=e.extend({},e(this).jqGrid("getGridParam"));if(i.rownumbers&&(i.colNames.splice(0,1),i.colModel.splice(0,1)),i.multiselect&&(i.colNames.splice(0,1),i.colModel.splice(0,1)),i.subGrid&&(i.colNames.splice(0,1),i.colModel.splice(0,1)),i.knv=null,i.treeGrid)for(var a in i.treeReader)i.treeReader.hasOwnProperty(a)&&(i.colNames.splice(i.colNames.length-1),i.colModel.splice(i.colModel.length-1));switch(t.exptype){case"xmlstring":n="<"+t.root+">"+xmlJsonClass.json2xml(i,t.ident)+"</"+t.root+">";break;case"jsonstring":n="{"+xmlJsonClass.toJson(i,t.root,t.ident)+"}",void 0!==i.postData.filters&&(n=n.replace(/filters":"/,'filters":'),n=n.replace(/}]}"/,"}]}"))}}}),n},excelExport:function(t){return t=e.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},t||{}),this.each(function(){if(this.grid){var n;"remote"==t.exptype&&(n=e.extend({},this.p.postData),n[t.oper]=t.tag,n=jQuery.param(n),n=-1!=t.url.indexOf("?")?t.url+"&"+n:t.url+"?"+n,window.location=n)}})}})}(jQuery);var xmlJsonClass={xml2json:function(e,t){9===e.nodeType&&(e=e.documentElement);var n=this.toJson(this.toObj(this.removeWhite(e)),e.nodeName,"	");return"{\n"+t+(t?n.replace(/\t/g,t):n.replace(/\t|\n/g,""))+"\n}"},json2xml:function(e,t){var n,i=function(e,t,n){var a,r,o="";if(e instanceof Array)if(0===e.length)o+=n+"<"+t+">__EMPTY_ARRAY_</"+t+">\n";else for(a=0,r=e.length;r>a;a+=1){var s=n+i(e[a],t,n+"	")+"\n";o+=s}else if("object"==typeof e){a=!1,o+=n+"<"+t;for(r in e)e.hasOwnProperty(r)&&("@"===r.charAt(0)?o+=" "+r.substr(1)+'="'+e[r].toString()+'"':a=!0);if(o+=a?">":"/>",a){for(r in e)e.hasOwnProperty(r)&&("#text"===r?o+=e[r]:"#cdata"===r?o+="<![CDATA["+e[r]+"]]>":"@"!==r.charAt(0)&&(o+=i(e[r],r,n+"	")));o+=("\n"===o.charAt(o.length-1)?n:"")+"</"+t+">"}}else o+="function"==typeof e?n+"<"+t+"><![CDATA["+e+"]]></"+t+">":'""'===e.toString()||0===e.toString().length?n+"<"+t+">__EMPTY_STRING_</"+t+">":n+"<"+t+">"+e.toString()+"</"+t+">";return o},a="";for(n in e)e.hasOwnProperty(n)&&(a+=i(e[n],n,""));return t?a.replace(/\t/g,t):a.replace(/\t|\n/g,"")},toObj:function(e){var t={},n=/function/i;if(1===e.nodeType){if(e.attributes.length){var i;for(i=0;i<e.attributes.length;i+=1)t["@"+e.attributes[i].nodeName]=(e.attributes[i].nodeValue||"").toString()}if(e.firstChild){var a,r=i=0,o=!1;for(a=e.firstChild;a;a=a.nextSibling)1===a.nodeType?o=!0:3===a.nodeType&&a.nodeValue.match(/[^ \f\n\r\t\v]/)?i+=1:4===a.nodeType&&(r+=1);if(o)if(2>i&&2>r)for(this.removeWhite(e),a=e.firstChild;a;a=a.nextSibling)3===a.nodeType?t["#text"]=this.escape(a.nodeValue):4===a.nodeType?n.test(a.nodeValue)?t[a.nodeName]=[t[a.nodeName],a.nodeValue]:t["#cdata"]=this.escape(a.nodeValue):t[a.nodeName]?t[a.nodeName]instanceof Array?t[a.nodeName][t[a.nodeName].length]=this.toObj(a):t[a.nodeName]=[t[a.nodeName],this.toObj(a)]:t[a.nodeName]=this.toObj(a);else e.attributes.length?t["#text"]=this.escape(this.innerXml(e)):t=this.escape(this.innerXml(e));else if(i)e.attributes.length?t["#text"]=this.escape(this.innerXml(e)):(t=this.escape(this.innerXml(e)),"__EMPTY_ARRAY_"===t?t="[]":"__EMPTY_STRING_"===t&&(t=""));else if(r)if(r>1)t=this.escape(this.innerXml(e));else for(a=e.firstChild;a;a=a.nextSibling){if(n.test(e.firstChild.nodeValue)){t=e.firstChild.nodeValue;break}t["#cdata"]=this.escape(a.nodeValue)}}e.attributes.length||e.firstChild||(t=null)}else 9===e.nodeType?t=this.toObj(e.documentElement):alert("unhandled node type: "+e.nodeType);return t},toJson:function(e,t,n,i){void 0===i&&(i=!0);var a=t?'"'+t+'"':"",r="	",o="\n";if(i||(o=r=""),"[]"===e)a+=t?":[]":"[]";else if(e instanceof Array){var s,l,d=[];for(l=0,s=e.length;s>l;l+=1)d[l]=this.toJson(e[l],"",n+r,i);a+=(t?":[":"[")+(d.length>1?o+n+r+d.join(","+o+n+r)+o+n:d.join(""))+"]"}else if(null===e)a+=(t&&":")+"null";else if("object"==typeof e){s=[];for(l in e)e.hasOwnProperty(l)&&(s[s.length]=this.toJson(e[l],l,n+r,i));a+=(t?":{":"{")+(s.length>1?o+n+r+s.join(","+o+n+r)+o+n:s.join(""))+"}"}else a+="string"==typeof e?(t&&":")+'"'+e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"':(t&&":")+'"'+e.toString()+'"';return a},innerXml:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else{var n=function(e){var t,i="";if(1===e.nodeType){for(i+="<"+e.nodeName,t=0;t<e.attributes.length;t+=1)i+=" "+e.attributes[t].nodeName+'="'+(e.attributes[t].nodeValue||"").toString()+'"';if(e.firstChild){for(i+=">",t=e.firstChild;t;t=t.nextSibling)i+=n(t);i+="</"+e.nodeName+">"}else i+="/>"}else 3===e.nodeType?i+=e.nodeValue:4===e.nodeType&&(i+="<![CDATA["+e.nodeValue+"]]>");return i};for(e=e.firstChild;e;e=e.nextSibling)t+=n(e)}return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();var t;for(t=e.firstChild;t;)if(3===t.nodeType)if(t.nodeValue.match(/[^ \f\n\r\t\v]/))t=t.nextSibling;else{var n=t.nextSibling;e.removeChild(t),t=n}else 1===t.nodeType&&this.removeWhite(t),t=t.nextSibling;return e}};!function(a){if(a.browser.msie&&8==a.browser.version&&(a.expr[":"].hidden=function(e){return 0===e.offsetWidth||0===e.offsetHeight||"none"==e.style.display}),a.jgrid._multiselect=!1,a.ui&&a.ui.multiselect){if(a.ui.multiselect.prototype._setSelected){var q=a.ui.multiselect.prototype._setSelected;a.ui.multiselect.prototype._setSelected=function(e,t){var n=q.call(this,e,t);if(t&&this.selectedList){var i=this.element;this.selectedList.find("li").each(function(){a(this).data("optionLink")&&a(this).data("optionLink").remove().appendTo(i)})}return n}}a.ui.multiselect.prototype.destroy&&(a.ui.multiselect.prototype.destroy=function(){this.element.show(),this.container.remove(),void 0===a.Widget?a.widget.prototype.destroy.apply(this,arguments):a.Widget.prototype.destroy.apply(this,arguments)}),a.jgrid._multiselect=!0}a.jgrid.extend({sortableColumns:function(e){return this.each(function(){function t(){n.p.disableClick=!0}var n=this,i={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_cb,#jqgh_rn,#jqgh_subgrid),:hidden)",placeholder:{element:function(e){return a(document.createElement(e[0].nodeName)).addClass(e[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(e,t){t.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),t.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10))}},update:function(e,t){var i=a(t.item).parent();i=a(">th",i);var r={};a.each(n.p.colModel,function(e){r[this.name]=e});var o=[];i.each(function(){var e=a(">div",this).get(0).id.replace(/^jqgh_/,"");e in r&&o.push(r[e])}),a(n).jqGrid("remapColumns",o,!0,!0),a.isFunction(n.p.sortable.update)&&n.p.sortable.update(o),setTimeout(function(){n.p.disableClick=!1},50)}};if(n.p.sortable.options?a.extend(i,n.p.sortable.options):a.isFunction(n.p.sortable)&&(n.p.sortable={update:n.p.sortable}),i.start){var r=i.start;i.start=function(e,n){t(),r.call(this,e,n)}}else i.start=t;n.p.sortable.exclude&&(i.items+=":not("+n.p.sortable.exclude+")"),e.sortable(i).data("sortable").floating=!0})},columnChooser:function(e){function t(e,t){e&&("string"==typeof e?a.fn[e]&&a.fn[e].apply(t,a.makeArray(arguments).slice(2)):a.isFunction(e)&&e.apply(t,a.makeArray(arguments).slice(2)))}var n=this;if(!a("#colchooser_"+n[0].p.id).length){var i=a('<div id="colchooser_'+n[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>'),r=a("select",i);if(e=a.extend({width:420,height:240,classname:null,done:function(e){e&&n.jqGrid("remapColumns",e,!0)},msel:"multiselect",dlog:"dialog",dlog_opts:function(e){var t={};return t[e.bSubmit]=function(){e.apply_perm(),e.cleanup(!1)},t[e.bCancel]=function(){e.cleanup(!0)},{buttons:t,close:function(){e.cleanup(!0)},modal:e.modal?e.modal:!1,resizable:e.resizable?e.resizable:!0,width:e.width+20}},apply_perm:function(){a("option",r).each(function(){this.selected?n.jqGrid("showCol",o[this.value].name):n.jqGrid("hideCol",o[this.value].name)});var t=[];a("option[selected]",r).each(function(){t.push(parseInt(this.value,10))}),a.each(t,function(){delete l[o[parseInt(this,10)].name]}),a.each(l,function(){var e=parseInt(this,10),n=t,i=e;if(i>=0){var a=n.slice(),r=a.splice(i,Math.max(n.length-i,i));i>n.length&&(i=n.length),a[i]=e,t=a.concat(r)}else t=void 0}),e.done&&e.done.call(n,t)},cleanup:function(a){t(e.dlog,i,"destroy"),t(e.msel,r,"destroy"),i.remove(),a&&e.done&&e.done.call(n)},msel_opts:{}},a.jgrid.col,e||{}),a.ui&&a.ui.multiselect&&"multiselect"==e.msel){if(!a.jgrid._multiselect)return void alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");e.msel_opts=a.extend(a.ui.multiselect.defaults,e.msel_opts)}e.caption&&i.attr("title",e.caption),e.classname&&(i.addClass(e.classname),r.addClass(e.classname)),e.width&&(a(">div",i).css({width:e.width,margin:"0 auto"}),r.css("width",e.width)),e.height&&(a(">div",i).css("height",e.height),r.css("height",e.height-10));var o=n.jqGrid("getGridParam","colModel"),s=n.jqGrid("getGridParam","colNames"),l={},d=[];r.empty(),a.each(o,function(e){l[this.name]=e,this.hidedlg?this.hidden||d.push(e):r.append("<option value='"+e+"' "+(this.hidden?"":"selected='selected'")+">"+s[e]+"</option>")});var c=a.isFunction(e.dlog_opts)?e.dlog_opts.call(n,e):e.dlog_opts;t(e.dlog,i,c),c=a.isFunction(e.msel_opts)?e.msel_opts.call(n,e):e.msel_opts,t(e.msel,r,c)}},sortableRows:function(e){return this.each(function(){var t=this;t.grid&&(t.p.treeGrid||a.fn.sortable&&(e=a.extend({cursor:"move",axis:"y",items:".jqgrow"},e||{}),e.start&&a.isFunction(e.start)?(e._start_=e.start,delete e.start):e._start_=!1,e.update&&a.isFunction(e.update)?(e._update_=e.update,delete e.update):e._update_=!1,e.start=function(n,i){if(a(i.item).css("border-width","0px"),a("td",i.item).each(function(e){this.style.width=t.grid.cols[e].style.width}),t.p.subGrid){var r=a(i.item).attr("id");try{a(t).jqGrid("collapseSubGridRow",r)}catch(o){}}e._start_&&e._start_.apply(this,[n,i])},e.update=function(n,i){a(i.item).css("border-width",""),t.p.rownumbers===!0&&a("td.jqgrid-rownum",t.rows).each(function(e){a(this).html(e+1)}),e._update_&&e._update_.apply(this,[n,i])},a("tbody:first",t).sortable(e),a("tbody:first",t).disableSelection()))})},gridDnD:function(e){return this.each(function(){function t(){var e=a.data(n,"dnd");a("tr.jqgrow:not(.ui-draggable)",n).draggable(a.isFunction(e.drag)?e.drag.call(a(n),e):e.drag)}var n=this;if(n.grid&&!n.p.treeGrid&&a.fn.draggable&&a.fn.droppable)if(null===a("#jqgrid_dnd").html()&&a("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>"),"string"==typeof e&&"updateDnD"==e&&n.p.jqgdnd===!0)t();else if(e=a.extend({drag:function(e){return a.extend({start:function(t,i){if(n.p.subGrid){var r=a(i.helper).attr("id");try{a(n).jqGrid("collapseSubGridRow",r)}catch(o){}}for(r=0;r<a.data(n,"dnd").connectWith.length;r++)"0"==a(a.data(n,"dnd").connectWith[r]).jqGrid("getGridParam","reccount")&&a(a.data(n,"dnd").connectWith[r]).jqGrid("addRowData","jqg_empty_row",{});i.helper.addClass("ui-state-highlight"),a("td",i.helper).each(function(e){this.style.width=n.grid.headers[e].width+"px"}),e.onstart&&a.isFunction(e.onstart)&&e.onstart.call(a(n),t,i)},stop:function(t,i){if(i.helper.dropped){var r=a(i.helper).attr("id");a(n).jqGrid("delRowData",r)}for(r=0;r<a.data(n,"dnd").connectWith.length;r++)a(a.data(n,"dnd").connectWith[r]).jqGrid("delRowData","jqg_empty_row");e.onstop&&a.isFunction(e.onstop)&&e.onstop.call(a(n),t,i)}},e.drag_opts||{})},drop:function(e){return a.extend({accept:function(e){if(!a(e).hasClass("jqgrow"))return e;var t=a(e).closest("table.ui-jqgrid-btable");return t.length>0&&void 0!==a.data(t[0],"dnd")?(e=a.data(t[0],"dnd").connectWith,-1!=a.inArray("#"+this.id,e)?!0:!1):e},drop:function(t,i){if(a(i.draggable).hasClass("jqgrow")){var r=a(i.draggable).attr("id");if(r=i.draggable.parent().parent().jqGrid("getRowData",r),!e.dropbyname){var o,s=0,l={},d=a("#"+this.id).jqGrid("getGridParam","colModel");try{for(var c in r)r.hasOwnProperty(c)&&d[s]&&(o=d[s].name,l[o]=r[c]),s++;r=l}catch(u){}}if(i.helper.dropped=!0,e.beforedrop&&a.isFunction(e.beforedrop)&&(o=e.beforedrop.call(this,t,i,r,a("#"+n.id),a(this)),"undefined"!=typeof o&&null!==o&&"object"==typeof o&&(r=o)),i.helper.dropped){var h;e.autoid&&(a.isFunction(e.autoid)?h=e.autoid.call(this,r):(h=Math.ceil(1e3*Math.random()),h=e.autoidprefix+h)),a("#"+this.id).jqGrid("addRowData",h,r,e.droppos)}e.ondrop&&a.isFunction(e.ondrop)&&e.ondrop.call(this,t,i,r)}}},e.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5e3},dropbyname:!1,droppos:"first",autoid:!0,autoidprefix:"dnd_"},e||{}),e.connectWith){e.connectWith=e.connectWith.split(","),e.connectWith=a.map(e.connectWith,function(e){return a.trim(e)}),a.data(n,"dnd",e),"0"!=n.p.reccount&&!n.p.jqgdnd&&t(),n.p.jqgdnd=!0;for(var i=0;i<e.connectWith.length;i++)a(e.connectWith[i]).droppable(a.isFunction(e.drop)?e.drop.call(a(n),e):e.drop)}})},gridResize:function(b){return this.each(function(){var g=this;g.grid&&a.fn.resizable&&(b=a.extend({},b||{}),b.alsoResize?(b._alsoResize_=b.alsoResize,delete b.alsoResize):b._alsoResize_=!1,b.stop&&a.isFunction(b.stop)?(b._stop_=b.stop,delete b.stop):b._stop_=!1,b.stop=function(e,t){a(g).jqGrid("setGridParam",{height:a("#gview_"+g.p.id+" .ui-jqgrid-bdiv").height()}),a(g).jqGrid("setGridWidth",t.size.width,b.shrinkToFit),b._stop_&&b._stop_.call(g,e,t)},b.alsoResize=b._alsoResize_?eval("("+("{'#gview_"+g.p.id+" .ui-jqgrid-bdiv':true,'"+b._alsoResize_+"':true}")+")"):a(".ui-jqgrid-bdiv","#gview_"+g.p.id),delete b._alsoResize_,a("#gbox_"+g.p.id).resizable(b))})}})}(jQuery)}),define("jquery-layout",["jquery"],function(jQuery){!function($){var min=Math.min,max=Math.max,round=Math.floor,isStr=function(e){return"string"===$.type(e)},runPluginCallbacks=function(Instance,a_fn){function g(e){return e}if($.isArray(a_fn))for(var i=0,c=a_fn.length;c>i;i++){var fn=a_fn[i];try{isStr(fn)&&(fn=eval(fn)),$.isFunction(fn)&&g(fn)(Instance)}catch(ex){}}};$.layout={version:"1.3.rc30.7",revision:.033007,browser:{mozilla:!!Aloha.browser.mozilla,webkit:!!Aloha.browser.webkit||!!Aloha.browser.safari,msie:!!Aloha.browser.msie,isIE6:Aloha.browser.msie&&6==Aloha.browser.version,boxModel:$.support.boxModel!==!1||!Aloha.browser.msie,version:Aloha.browser.version},effects:{slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}},blind:{},clip:{},explode:{},fade:{},fold:{},puff:{},size:{all:{easing:"swing"}}},config:{optionRootKeys:"effects,panes,north,south,west,east,center".split(","),allPanes:"north,south,west,east,center".split(","),borderPanes:"north,south,west,east".split(","),oppositeEdge:{north:"south",south:"north",east:"west",west:"east"},offscreenCSS:{left:"-99999px",right:"auto"},offscreenReset:"offscreenReset",hidden:{visibility:"hidden"},visible:{visibility:"visible"},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",overflow:"auto"}},north:{side:"top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{side:"bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{side:"right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{side:"left",sizeType:"Width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},callbacks:{},getParentPaneElem:function(e){var t=$(e),n=t.data("layout")||t.data("parentLayout");if(n){var i=n.container;if(i.data("layoutPane"))return i;var a=i.closest("."+$.layout.defaults.panes.paneClass);if(a.data("layoutPane"))return a}return null},getParentPaneInstance:function(e){var t=$.layout.getParentPaneElem(e);return t?t.data("layoutPane"):null},getParentLayoutInstance:function(e){var t=$.layout.getParentPaneElem(e);return t?t.data("parentLayout"):null},getEventObject:function(e){return"object"==typeof e&&e.stopPropagation?e:null},parsePaneName:function(e){var t=$.layout.getEventObject(e);return t?(t.stopPropagation(),$(this).data("layoutEdge")):e},plugins:{draggable:!!$.fn.draggable,effects:{core:!!$.effects,slide:$.effects&&($.effects.slide||$.effects.effect.slide)}},onCreate:[],onLoad:[],onReady:[],onDestroy:[],onUnload:[],afterOpen:[],afterClose:[],scrollbarWidth:function(){return window.scrollbarWidth||$.layout.getScrollbarSize("width")},scrollbarHeight:function(){return window.scrollbarHeight||$.layout.getScrollbarSize("height")},getScrollbarSize:function(e){var t=$('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; overflow: scroll;"></div>').appendTo("body"),n={width:t.css("width")-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),window.scrollbarWidth=n.width,window.scrollbarHeight=n.height,e.match(/^(width|height)$/)?n[e]:n},showInvisibly:function(e,t){if(e&&e.length&&(t||"none"===e.css("display"))){var n=e[0].style,i={display:n.display||"",visibility:n.visibility||""};return e.css({display:"block",visibility:"hidden"}),i}return{}},getElementDimensions:function(e,t){var n,i,a,r={css:{},inset:{}},o=r.css,s={bottom:0},l=$.layout.cssNum,d=e.offset();return r.offsetLeft=d.left,r.offsetTop=d.top,t||(t={}),$.each("Left,Right,Top,Bottom".split(","),function(l,d){n=o["border"+d]=$.layout.borderWidth(e,d),i=o["padding"+d]=$.layout.cssNum(e,"padding"+d),a=d.toLowerCase(),r.inset[a]=t[a]>=0?t[a]:i,s[a]=r.inset[a]+n}),o.width=e.css("width"),o.height=e.height(),o.top=l(e,"top",!0),o.bottom=l(e,"bottom",!0),o.left=l(e,"left",!0),o.right=l(e,"right",!0),r.outerWidth=e.outerWidth(),r.outerHeight=e.outerHeight(),r.innerWidth=max(0,r.outerWidth-s.left-s.right),r.innerHeight=max(0,r.outerHeight-s.top-s.bottom),r.layoutWidth=e.innerWidth(),r.layoutHeight=e.innerHeight(),r},getElementStyles:function(e,t){var n,i,a,r,o,s,l={},d=e[0].style,c=t.split(","),u="Top,Bottom,Left,Right".split(","),h="Color,Style,Width".split(",");for(r=0;r<c.length;r++)if(n=c[r],n.match(/(border|padding|margin)$/))for(o=0;4>o;o++)if(i=u[o],"border"===n)for(s=0;3>s;s++)a=h[s],l[n+i+a]=d[n+i+a];else l[n+i]=d[n+i];else l[n]=d[n];return l},cssWidth:function(e,t){if(0>=t)return 0;if(!$.layout.browser.boxModel)return t;var n=$.layout.borderWidth,i=$.layout.cssNum,a=t-n(e,"Left")-n(e,"Right")-i(e,"paddingLeft")-i(e,"paddingRight");return max(0,a)},cssHeight:function(e,t){if(0>=t)return 0;if(!$.layout.browser.boxModel)return t;var n=$.layout.borderWidth,i=$.layout.cssNum,a=t-n(e,"Top")-n(e,"Bottom")-i(e,"paddingTop")-i(e,"paddingBottom");return max(0,a)},cssNum:function(e,t,n){e.jquery||(e=$(e));var i=$.layout.showInvisibly(e),a=$.css(e[0],t,!0),r=n&&"auto"==a?a:Math.round(parseFloat(a)||0);return e.css(i),r},borderWidth:function(e,t){e.jquery&&(e=e[0]);var n="border"+t.substr(0,1).toUpperCase()+t.substr(1);return"none"===$.css(e,n+"Style",!0)?0:Math.round(parseFloat($.css(e,n+"Width",!0))||0)},isMouseOverElem:function(e,t){var n=$(t||this),i=n.offset(),a=i.top,r=i.left,o=r+n.outerWidth(),s=a+n.outerHeight(),l=e.pageX,d=e.pageY;return $.layout.browser.msie&&0>l&&0>d||l>=r&&o>=l&&d>=a&&s>=d},msg:function(e,t,n,i){function a(){var e=$.support.fixedPosition?"fixed":"absolute",t=$('<div id="layoutLogger" style="position: '+e+'; top: 5px; z-index: 999999; max-width: 25%; overflow: hidden; border: 1px solid #000; border-radius: 5px; background: #FBFBFB; box-shadow: 0 2px 10px rgba(0,0,0,0.3);"><div style="font-size: 13px; font-weight: bold; padding: 5px 10px; background: #F6F6F6; border-radius: 5px 5px 0 0; cursor: move;"><span style="float: right; padding-left: 7px; cursor: pointer;" title="Remove Console" onclick="$(this).closest(\'#layoutLogger\').remove()">X</span>Layout console.log</div><ul style="font-size: 13px; font-weight: none; list-style: none; margin: 0; padding: 0 0 2px;"></ul></div>').appendTo("body");return t.css("left",$(window).width()-t.outerWidth()-5),$.ui.draggable&&t.draggable({handle:":first-child"}),t}if($.isPlainObject(e)&&window.debugData){"string"==typeof t?(i=n,n=t):"object"==typeof n&&(i=n,n=null);var r=n||"log( <object> )",o=$.extend({sort:!1,returnHTML:!1,display:!1},i);t===!0||o.display?debugData(e,r,o):window.console&&console.log(debugData(e,r,o))}else if(t)alert(e);else if(window.console)console.log(e);else{var s="#layoutLogger",l=$(s);l.length||(l=a()),l.children("ul").append('<li style="padding: 4px 10px; margin: 0; border-top: 1px solid #CCC;">'+e.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</li>")}}},$.layout.defaults={name:"",containerClass:"ui-layout-container",inset:null,scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,maskPanesEarly:!1,onresizeall_start:null,onresizeall_end:null,onload_start:null,onload_end:null,onunload_start:null,onunload_end:null,initPanes:!0,showErrorMessages:!0,showDebugMessages:!1,zIndex:null,zIndexes:{pane_normal:0,content_mask:1,resizer_normal:2,pane_sliding:100,pane_animate:1e3,resizer_drag:1e4},errors:{pane:"pane",selector:"selector",addButtonError:"Error Adding Button \n\nInvalid ",containerMissing:"UI Layout Initialization Error\n\nThe specified layout-container does not exist.",centerPaneMissing:"UI Layout Initialization Error\n\nThe center-pane element does not exist.\n\nThe center-pane is a required element.",noContainerHeight:"UI Layout Initialization Warning\n\nThe layout-container \"CONTAINER\" has no height.\n\nTherefore the layout is 0-height and hence 'invisible'!",callbackError:"UI Layout Callback Error\n\nThe EVENT callback is not a valid function."},panes:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskContents:!1,maskObjects:!1,maskZindex:null,resizingGrid:!1,livePaneResizing:!1,liveContentResizing:!1,liveResizingTolerance:1,sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:$.layout.browser.webkit,preventPrematureSlideClose:!1,tips:{Open:"Open",Close:"Close",Resize:"Resize",Slide:"Slide Open",Pin:"Pin",Unpin:"Un-Pin",noRoomToOpen:"Not enough room to show this panel.",minSizeWarning:"Panel has reached its minimum size",maxSizeWarning:"Panel has reached its maximum size"},showOverflowOnHover:!1,enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},fxOpacityFix:!0,animatePaneSizing:!1,children:null,containerSelector:"",initChildren:!0,destroyChildren:!0,resizeChildren:!0,triggerEventsOnLoad:!1,triggerEventsDuringLiveResize:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0}},$.layout.optionsMap={layout:"name,instanceKey,stateManagement,effects,inset,zIndexes,errors,zIndex,scrollToBookmarkOnLoad,showErrorMessages,maskPanesEarly,outset,resizeWithWindow,resizeWithWindowDelay,resizeWithWindowMaxDelay,onresizeall,onresizeall_start,onresizeall_end,onload,onunload".split(","),center:"paneClass,contentSelector,contentIgnoreSelector,findNestedContent,applyDemoStyles,triggerEventsOnLoad,showOverflowOnHover,maskContents,maskObjects,liveContentResizing,containerSelector,children,initChildren,resizeChildren,destroyChildren,onresize,onresize_start,onresize_end,onsizecontent,onsizecontent_start,onsizecontent_end".split(","),noDefault:"paneSelector,resizerCursor,customHotkey".split(",")},$.layout.transformData=function(e,t){var n,i,a,r,o,s,l,d=t?{panes:{},center:{}}:{};if("object"!=typeof e)return d;for(i in e)for(n=d,o=e[i],a=i.split("__"),l=a.length-1,s=0;l>=s;s++)r=a[s],s===l?n[r]=$.isPlainObject(o)?$.layout.transformData(o):o:(n[r]||(n[r]={}),n=n[r]);return d},$.layout.backwardCompatibility={map:{applyDefaultStyles:"applyDemoStyles",childOptions:"children",initChildLayout:"initChildren",destroyChildLayout:"destroyChildren",resizeChildLayout:"resizeChildren",resizeNestedLayout:"resizeChildren",resizeWhileDragging:"livePaneResizing",resizeContentWhileDragging:"liveContentResizing",triggerEventsWhileDragging:"triggerEventsDuringLiveResize",maskIframesOnResize:"maskContents",useStateCookie:"stateManagement.enabled","cookie.autoLoad":"stateManagement.autoLoad","cookie.autoSave":"stateManagement.autoSave","cookie.keys":"stateManagement.stateKeys","cookie.name":"stateManagement.cookie.name","cookie.domain":"stateManagement.cookie.domain","cookie.path":"stateManagement.cookie.path","cookie.expires":"stateManagement.cookie.expires","cookie.secure":"stateManagement.cookie.secure",noRoomToOpenTip:"tips.noRoomToOpen",togglerTip_open:"tips.Close",togglerTip_closed:"tips.Open",resizerTip:"tips.Resize",sliderTip:"tips.Slide"},renameOptions:function(e){function t(t,n){for(var i,a=t.split("."),r=a.length-1,o={branch:e,key:a[r]},s=0;r>s;s++)i=a[s],o.branch=void 0==o.branch[i]?n?o.branch[i]={}:{}:o.branch[i];return o}var n,i,a,r=$.layout.backwardCompatibility.map;for(var o in r)n=t(o),a=n.branch[n.key],void 0!==a&&(i=t(r[o],!0),i.branch[i.key]=a,delete n.branch[n.key])},renameAllOptions:function(e){var t=$.layout.backwardCompatibility.renameOptions;return t(e),e.defaults&&("object"!=typeof e.panes&&(e.panes={}),$.extend(!0,e.panes,e.defaults),delete e.defaults),e.panes&&t(e.panes),$.each($.layout.config.allPanes,function(n,i){e[i]&&t(e[i])}),e}},$.fn.layout=function(opts){function keyDown(e){if(!e)return!0;var t=e.keyCode;if(33>t)return!0;var n,i,a,r,o={38:"north",40:"south",37:"west",39:"east"},s=(e.altKey,e.shiftKey),l=e.ctrlKey,d=l&&t>=37&&40>=t;return d&&options[o[t]].enableCursorHotkey?r=o[t]:(l||s)&&$.each(_c.borderPanes,function(e,o){return n=options[o],i=n.customHotkey,a=n.customHotkeyModifier,(s&&"SHIFT"==a||l&&"CTRL"==a||l&&s)&&i&&t===(isNaN(i)||9>=i?i.toUpperCase().charCodeAt(0):i)?(r=o,!1):void 0}),r&&$Ps[r]&&options[r].closable&&!state[r].isHidden?(toggle(r),e.stopPropagation(),e.returnValue=!1,!1):!0}function allowOverflow(e){if(isInitialized()){this&&this.tagName&&(e=this);var t;if(isStr(e)?t=$Ps[e]:$(e).data("layoutRole")?t=$(e):$(e).parents().each(function(){return $(this).data("layoutRole")?(t=$(this),!1):void 0}),t&&t.length){var n=t.data("layoutEdge"),i=state[n];if(i.cssSaved&&resetOverflow(n),i.isSliding||i.isResizing||i.isClosed)return void(i.cssSaved=!1);var a={zIndex:options.zIndexes.resizer_normal+1},r={},o=t.css("overflow"),s=t.css("overflowX"),l=t.css("overflowY");"visible"!=o&&(r.overflow=o,a.overflow="visible"),s&&!s.match(/(visible|auto)/)&&(r.overflowX=s,a.overflowX="visible"),l&&!l.match(/(visible|auto)/)&&(r.overflowY=s,a.overflowY="visible"),i.cssSaved=r,t.css(a),$.each(_c.allPanes,function(e,t){t!=n&&resetOverflow(t)})}}}function resetOverflow(e){if(isInitialized()){this&&this.tagName&&(e=this);var t;if(isStr(e)?t=$Ps[e]:$(e).data("layoutRole")?t=$(e):$(e).parents().each(function(){return $(this).data("layoutRole")?(t=$(this),!1):void 0}),t&&t.length){var n=t.data("layoutEdge"),i=state[n],a=i.cssSaved||{};i.isSliding||i.isResizing||t.css("zIndex",options.zIndexes.pane_normal),t.css(a),i.cssSaved=!1}}}var browser=$.layout.browser,_c=$.layout.config,cssW=$.layout.cssWidth,cssH=$.layout.cssHeight,elDims=$.layout.getElementDimensions,styles=$.layout.getElementStyles,evtObj=$.layout.getEventObject,evtPane=$.layout.parsePaneName,options=$.extend(!0,{},$.layout.defaults),effects=options.effects=$.extend(!0,{},$.layout.effects),state={id:"layout"+$.now(),initialized:!1,paneResizing:!1,panesSliding:{},container:{innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0,layoutWidth:0,layoutHeight:0},north:{childIdx:0},south:{childIdx:0},east:{childIdx:0},west:{childIdx:0},center:{childIdx:0}},children={north:null,south:null,east:null,west:null,center:null},timer={data:{},set:function(e,t,n){timer.clear(e),timer.data[e]=setTimeout(t,n)},clear:function(e){var t=timer.data;t[e]&&(clearTimeout(t[e]),delete t[e])}},_log=function(e,t,n){var i=options;
return(i.showErrorMessages&&!n||n&&i.showDebugMessages)&&$.layout.msg(i.name+" / "+e,t!==!1),!1},_runCallbacks=function(evtName,pane,skipBoundEvents){function g(e){return e}var hasPane=pane&&isStr(pane),s=hasPane?state[pane]:state,o=hasPane?options[pane]:options,lName=options.name,lng=evtName+(evtName.match(/_/)?"":"_end"),shrt=lng.match(/_end$/)?lng.substr(0,lng.length-4):"",fn=o[lng]||o[shrt],retVal="NC",args=[],$P;if(hasPane||"boolean"!==$.type(pane)||(skipBoundEvents=pane,pane=""),fn)try{isStr(fn)&&(fn.match(/,/)?(args=fn.split(","),fn=eval(args[0])):fn=eval(fn)),$.isFunction(fn)&&(retVal=args.length?g(fn)(args[1]):hasPane?g(fn)(pane,$Ps[pane],s,o,lName):g(fn)(Instance,s,o,lName))}catch(ex){_log(options.errors.callbackError.replace(/EVENT/,$.trim((pane||"")+" "+lng)),!1)}return skipBoundEvents||retVal===!1||(hasPane?($P=$Ps[pane],o=options[pane],s=state[pane],$P.triggerHandler("layoutpane"+lng,[pane,$P,s,o,lName]),shrt&&$P.triggerHandler("layoutpane"+shrt,[pane,$P,s,o,lName])):($N.triggerHandler("layout"+lng,[Instance,s,o,lName]),shrt&&$N.triggerHandler("layout"+shrt,[Instance,s,o,lName]))),(hasPane&&"onresize_end"===evtName||"onsizecontent_end"===evtName)&&resizeChildren(pane+"",!0),retVal},_fixIframe=function(e){if(!browser.mozilla){var t=$Ps[e];"IFRAME"===state[e].tagName?t.css(_c.hidden).css(_c.visible):t.find("IFRAME").css(_c.hidden).css(_c.visible)}},cssSize=function(e,t){var n="horz"==_c[e].dir?cssH:cssW;return n($Ps[e],t)},cssMinDims=function(e){var t=$Ps[e],n=_c[e].dir,i={minWidth:1001-cssW(t,1e3),minHeight:1001-cssH(t,1e3)};return"horz"===n&&(i.minSize=i.minHeight),"vert"===n&&(i.minSize=i.minWidth),i},setOuterWidth=function(e,t,n){var i,a=e;isStr(e)?a=$Ps[e]:e.jquery||(a=$(e)),i=cssW(a,t),a.css({width:i}),i>0?n&&a.data("autoHidden")&&a.innerHeight()>0&&(a.show().data("autoHidden",!1),browser.mozilla||a.css(_c.hidden).css(_c.visible)):n&&!a.data("autoHidden")&&a.hide().data("autoHidden",!0)},setOuterHeight=function(e,t,n){var i,a=e;isStr(e)?a=$Ps[e]:e.jquery||(a=$(e)),i=cssH(a,t),a.css({height:i,visibility:"visible"}),i>0&&a.innerWidth()>0?n&&a.data("autoHidden")&&(a.show().data("autoHidden",!1),browser.mozilla||a.css(_c.hidden).css(_c.visible)):n&&!a.data("autoHidden")&&a.hide().data("autoHidden",!0)},_parseSize=function(e,t,n){if(n||(n=_c[e].dir),isStr(t)&&t.match(/%/)&&(t="100%"===t?-1:parseInt(t,10)/100),0===t)return 0;if(t>=1)return parseInt(t,10);var i=options,a=0;if("horz"==n?a=sC.innerHeight-($Ps.north?i.north.spacing_open:0)-($Ps.south?i.south.spacing_open:0):"vert"==n&&(a=sC.innerWidth-($Ps.west?i.west.spacing_open:0)-($Ps.east?i.east.spacing_open:0)),-1===t)return a;if(t>0)return round(a*t);if("center"==e)return 0;var r="horz"===n?"height":"width",o=$Ps[e],s="height"===r?$Cs[e]:!1,l=$.layout.showInvisibly(o),d=o.css(r),c=s?s.css(r):0;return o.css(r,"auto"),s&&s.css(r,"auto"),t="height"===r?o.outerHeight():o.outerWidth(),o.css(r,d).css(l),s&&s.css(r,c),t},getPaneSize=function(e,t){var n=$Ps[e],i=options[e],a=state[e],r=t?i.spacing_open:0,o=t?i.spacing_closed:0;return!n||a.isHidden?0:a.isClosed||a.isSliding&&t?o:"horz"===_c[e].dir?n.outerHeight()+r:n.outerWidth()+r},setSizeLimits=function(e,t){if(isInitialized()){var n=options[e],i=state[e],a=_c[e],r=a.dir,o=(a.sizeType.toLowerCase(),void 0!=t?t:i.isSliding),s=($Ps[e],n.spacing_open),l=_c.oppositeEdge[e],d=state[l],c=$Ps[l],u=!c||d.isVisible===!1||d.isSliding?0:"horz"==r?c.outerHeight():c.outerWidth(),h=(!c||d.isHidden?0:options[l][d.isClosed!==!1?"spacing_closed":"spacing_open"])||0,p="horz"==r?sC.innerHeight:sC.innerWidth,f=cssMinDims("center"),g="horz"==r?max(options.center.minHeight,f.minHeight):max(options.center.minWidth,f.minWidth),m=p-s-(o?0:_parseSize("center",g,r)+u+h),b=i.minSize=max(_parseSize(e,n.minSize),cssMinDims(e).minSize),v=i.maxSize=min(n.maxSize?_parseSize(e,n.maxSize):1e5,m),y=i.resizerPosition={},_=sC.inset.top,w=sC.inset.left,C=sC.innerWidth,k=sC.innerHeight,x=n.spacing_open;switch(e){case"north":y.min=_+b,y.max=_+v;break;case"west":y.min=w+b,y.max=w+v;break;case"south":y.min=_+k-v-x,y.max=_+k-b-x;break;case"east":y.min=w+C-v-x,y.max=w+C-b-x}}},calcNewCenterPaneDims=function(){var e={top:getPaneSize("north",!0),bottom:getPaneSize("south",!0),left:getPaneSize("west",!0),right:getPaneSize("east",!0),width:0,height:0};return e.width=sC.innerWidth-e.left-e.right,e.height=sC.innerHeight-e.bottom-e.top,e.top+=sC.inset.top,e.bottom+=sC.inset.bottom,e.left+=sC.inset.left,e.right+=sC.inset.right,e},getHoverClasses=function(e,t){var n=$(e),i=n.data("layoutRole"),a=n.data("layoutEdge"),r=options[a],o=r[i+"Class"],s="-"+a,l="-open",d="-closed",c="-sliding",u="-hover ",h=n.hasClass(o+d)?d:l,p=h===d?l:d,f=o+u+(o+s+u)+(o+h+u)+(o+s+h+u);return t&&(f+=o+p+u+(o+s+p+u)),"resizer"==i&&n.hasClass(o+c)&&(f+=o+c+u+(o+s+c+u)),$.trim(f)},addHover=function(e,t){var n=$(t||this);e&&"toggler"===n.data("layoutRole")&&e.stopPropagation(),n.addClass(getHoverClasses(n))},removeHover=function(e,t){var n=$(t||this);n.removeClass(getHoverClasses(n,!0))},onResizerEnter=function(){var e=$(this).data("layoutEdge"),t=state[e];t.isClosed||t.isResizing||state.paneResizing||($.fn.disableSelection&&$("body").disableSelection(),options.maskPanesEarly&&showMasks(e))},onResizerLeave=function(e,t){var n=t||this,i=$(n).data("layoutEdge"),a=i+"ResizerLeave";timer.clear(i+"_openSlider"),timer.clear(a),t?state.paneResizing||($.fn.enableSelection&&$("body").enableSelection(),options.maskPanesEarly&&hideMasks()):timer.set(a,function(){onResizerLeave(e,n)},200)},_create=function(){initOptions();var e=options,t=state;return t.creatingLayout=!0,runPluginCallbacks(Instance,$.layout.onCreate),!1===_runCallbacks("onload_start")?"cancel":(_initContainer(),initHotkeys(),$(window).bind("unload."+sID,unload),runPluginCallbacks(Instance,$.layout.onLoad),e.initPanes&&_initLayoutElements(),delete t.creatingLayout,state.initialized)},isInitialized=function(){return state.initialized||state.creatingLayout?!0:_initLayoutElements()},_initLayoutElements=function(e){var t=options;if(!$N.is(":visible"))return!e&&browser.webkit&&"BODY"===$N[0].tagName&&setTimeout(function(){_initLayoutElements(!0)},50),!1;if(!getPane("center").length)return _log(t.errors.centerPaneMissing);if(state.creatingLayout=!0,$.extend(sC,elDims($N,t.inset)),initPanes(),t.scrollToBookmarkOnLoad){var n=self.location;n.hash&&n.replace(n.hash)}return Instance.hasParentLayout?t.resizeWithWindow=!1:t.resizeWithWindow&&$(window).bind("resize."+sID,windowResize),delete state.creatingLayout,state.initialized=!0,runPluginCallbacks(Instance,$.layout.onReady),_runCallbacks("onload_end"),!0},createChildren=function(e,t){var n=evtPane.call(this,e),i=$Ps[n];if(i){var a=$Cs[n],r=state[n],o=options[n],s=options.stateManagement||{},l=t?o.children=t:o.children;if($.isPlainObject(l))l=[l];else if(!l||!$.isArray(l))return;$.each(l,function(e,t){if($.isPlainObject(t)){var o=t.containerSelector?i.find(t.containerSelector):a||i;o.each(function(){var e=$(this),i=e.data("layout");if(!i){if(setInstanceKey({container:e,options:t},r),s.includeChildren&&state.stateData[n]){var a=state.stateData[n].children||{},o=a[t.instanceKey],l=t.stateManagement||(t.stateManagement={autoLoad:!0});l.autoLoad===!0&&o&&(l.autoSave=!1,l.includeChildren=!0,l.autoLoad=$.extend(!0,{},o))}i=e.layout(t),i&&refreshChildren(n,i)}})}})}},setInstanceKey=function(e,t){var n=e.container,i=e.options,a=i.stateManagement,r=i.instanceKey||n.data("layoutInstanceKey");return r||(r=(a&&a.cookie?a.cookie.name:"")||i.name),r=r?r.replace(/[^\w-]/gi,"_").replace(/_{2,}/g,"_"):"layout"+ ++t.childIdx,i.instanceKey=r,n.data("layoutInstanceKey",r),r},refreshChildren=function(e,t){var n,i=$Ps[e],a=children[e],r=state[e];$.isPlainObject(a)&&($.each(a,function(e,t){t.destroyed&&delete a[e]}),$.isEmptyObject(a)&&(a=children[e]=null)),t||a||(t=i.data("layout")),t&&(t.hasParentLayout=!0,n=t.options,setInstanceKey(t,r),a||(a=children[e]={}),a[n.instanceKey]=t.container.data("layout")),Instance[e].children=children[e],t||createChildren(e)},windowResize=function(){var e=options,t=Number(e.resizeWithWindowDelay);10>t&&(t=100),timer.clear("winResize"),timer.set("winResize",function(){timer.clear("winResize"),timer.clear("winResizeRepeater");var t=elDims($N,e.inset);(t.innerWidth!==sC.innerWidth||t.innerHeight!==sC.innerHeight)&&resizeAll()},t),timer.data.winResizeRepeater||setWindowResizeRepeater()},setWindowResizeRepeater=function(){var e=Number(options.resizeWithWindowMaxDelay);e>0&&timer.set("winResizeRepeater",function(){setWindowResizeRepeater(),resizeAll()},e)},unload=function(){_runCallbacks("onunload_start"),runPluginCallbacks(Instance,$.layout.onUnload),_runCallbacks("onunload_end")},_initContainer=function(){var e,t,n=$N[0],i=$("html"),a=sC.tagName=n.tagName,r=sC.id=n.id,o=sC.className=n.className,s=options,l=s.name,d="position,margin,padding,border",c="layoutCSS",u={},h="hidden",p=$N.data("parentLayout"),f=$N.data("layoutEdge"),g=p&&f,m=$.layout.cssNum;sC.selector=$N.selector.split(".slice")[0],sC.ref=(s.name?s.name+" layout / ":"")+a+(r?"#"+r:o?".["+o+"]":""),sC.isBody="BODY"===a,g||sC.isBody||(e=$N.closest("."+$.layout.defaults.panes.paneClass),p=e.data("parentLayout"),f=e.data("layoutEdge"),g=p&&f),$N.data({layout:Instance,layoutContainer:sID}).addClass(s.containerClass);var b={destroy:"",initPanes:"",resizeAll:"resizeAll",resize:"resizeAll"};for(l in b)$N.bind("layout"+l.toLowerCase()+"."+sID,Instance[b[l]||l]);g&&(Instance.hasParentLayout=!0,p.refreshChildren(f,Instance)),$N.data(c)||(sC.isBody?($N.data(c,$.extend(styles($N,d),{height:$N.css("height"),overflow:$N.css("overflow"),overflowX:$N.css("overflowX"),overflowY:$N.css("overflowY")})),i.data(c,$.extend(styles(i,"padding"),{height:"auto",overflow:i.css("overflow"),overflowX:i.css("overflowX"),overflowY:i.css("overflowY")}))):$N.data(c,styles($N,d+",top,bottom,left,right,width,height,overflow,overflowX,overflowY")));try{if(u={overflow:h,overflowX:h,overflowY:h},$N.css(u),s.inset&&!$.isPlainObject(s.inset)&&(t=parseInt(s.inset,10)||0,s.inset={top:t,bottom:t,left:t,right:t}),sC.isBody)s.outset?$.isPlainObject(s.outset)||(t=parseInt(s.outset,10)||0,s.outset={top:t,bottom:t,left:t,right:t}):s.outset={top:m(i,"paddingTop"),bottom:m(i,"paddingBottom"),left:m(i,"paddingLeft"),right:m(i,"paddingRight")},i.css(u).css({height:"100%",border:"none",padding:0,margin:0}),browser.isIE6?($N.css({width:"100%",height:"100%",border:"none",padding:0,margin:0,position:"relative"}),s.inset||(s.inset=elDims($N).inset)):($N.css({width:"auto",height:"auto",margin:0,position:"absolute"}),$N.css(s.outset)),$.extend(sC,elDims($N,s.inset));else{var v=$N.css("position");v&&v.match(/(fixed|absolute|relative)/)||$N.css("position","relative"),$N.is(":visible")&&($.extend(sC,elDims($N,s.inset)),sC.innerHeight<1&&_log(s.errors.noContainerHeight.replace(/CONTAINER/,sC.ref)))}m($N,"minWidth")&&$N.parent().css("overflowX","auto"),m($N,"minHeight")&&$N.parent().css("overflowY","auto")}catch(y){}},initHotkeys=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,function(e,t){var n=options[t];return n.enableCursorHotkey||n.customHotkey?($(document).bind("keydown."+sID,keyDown),!1):void 0})},initOptions=function(){function e(e){var t=options[e],n=options.panes;t.fxSettings||(t.fxSettings={}),n.fxSettings||(n.fxSettings={}),$.each(["_open","_close","_size"],function(i,a){var r="fxName"+a,o="fxSpeed"+a,s="fxSettings"+a,l=t[r]=t[r]||n[r]||t.fxName||n.fxName||"none";"none"!==l&&options.effects[l]&&$.effects&&($.effects[l]||$.effects.effect[l])||(l=t[r]="none");var d=options.effects[l]||{},c=d.all||null,u=d[e]||null;t[o]=t[o]||n[o]||t.fxSpeed||n.fxSpeed||null,t[s]=$.extend(!0,{},c,u,n.fxSettings,t.fxSettings,n[s],t[s])}),delete t.fxName,delete t.fxSpeed,delete t.fxSettings}var t,n,i,a,r,o,s;if(opts=$.layout.transformData(opts,!0),opts=$.layout.backwardCompatibility.renameAllOptions(opts),!$.isEmptyObject(opts.panes)){for(t=$.layout.optionsMap.noDefault,r=0,o=t.length;o>r;r++)i=t[r],delete opts.panes[i];for(t=$.layout.optionsMap.layout,r=0,o=t.length;o>r;r++)i=t[r],delete opts.panes[i]}t=$.layout.optionsMap.layout;var l=$.layout.config.optionRootKeys;for(i in opts)a=opts[i],$.inArray(i,l)<0&&$.inArray(i,t)<0&&(opts.panes[i]||(opts.panes[i]=$.isPlainObject(a)?$.extend(!0,{},a):a),delete opts[i]);$.extend(!0,options,opts),$.each(_c.allPanes,function(a,r){if(_c[r]=$.extend(!0,{},_c.panes,_c[r]),n=options.panes,s=options[r],"center"===r)for(t=$.layout.optionsMap.center,a=0,o=t.length;o>a;a++)i=t[a],opts.center[i]||!opts.panes[i]&&s[i]||(s[i]=n[i]);else s=options[r]=$.extend(!0,{},n,s),e(r),s.resizerClass||(s.resizerClass="ui-layout-resizer"),s.togglerClass||(s.togglerClass="ui-layout-toggler");s.paneClass||(s.paneClass="ui-layout-pane")});var d=opts.zIndex,c=options.zIndexes;d>0&&(c.pane_normal=d,c.content_mask=max(d+1,c.content_mask),c.resizer_normal=max(d+2,c.resizer_normal)),delete options.panes},getPane=function(e){var t=options[e].paneSelector;if("#"===t.substr(0,1))return $N.find(t).eq(0);var n=$N.children(t).eq(0);return n.length?n:$N.children("form:first").children(t).eq(0)},initPanes=function(e){evtPane(e),$.each(_c.allPanes,function(e,t){addPane(t,!0)}),initHandles(),$.each(_c.borderPanes,function(e,t){$Ps[t]&&state[t].isVisible&&(setSizeLimits(t),makePaneFit(t))}),sizeMidPanes("center"),$.each(_c.allPanes,function(e,t){afterInitPane(t)})},addPane=function(e,t){if(t||isInitialized()){var n,i,a,r=options[e],o=state[e],s=_c[e],l=s.dir,d=(o.fx,r.spacing_open||0,"center"===e),c={},u=$Ps[e];if(u?removePane(e,!1,!0,!1):$Cs[e]=!1,u=$Ps[e]=getPane(e),!u.length)return void($Ps[e]=!1);if(!u.data("layoutCSS")){var h="position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border";u.data("layoutCSS",styles(u,h))}Instance[e]={name:e,pane:$Ps[e],content:$Cs[e],options:options[e],state:state[e],children:children[e]},u.data({parentLayout:Instance,layoutPane:Instance[e],layoutEdge:e,layoutRole:"pane"}).css(s.cssReq).css("zIndex",options.zIndexes.pane_normal).css(r.applyDemoStyles?s.cssDemo:{}).addClass(r.paneClass+" "+r.paneClass+"-"+e).bind("mouseenter."+sID,addHover).bind("mouseleave."+sID,removeHover);var p,f={hide:"",show:"",toggle:"",close:"",open:"",slideOpen:"",slideClose:"",slideToggle:"",size:"sizePane",sizePane:"sizePane",sizeContent:"",sizeHandles:"",enableClosable:"",disableClosable:"",enableSlideable:"",disableSlideable:"",enableResizable:"",disableResizable:"",swapPanes:"swapPanes",swap:"swapPanes",move:"swapPanes",removePane:"removePane",remove:"removePane",createChildren:"",resizeChildren:"",resizeAll:"resizeAll",resizeLayout:"resizeAll"};for(p in f)u.bind("layoutpane"+p.toLowerCase()+"."+sID,Instance[f[p]||p]);initContent(e,!1),d||(n=o.size=_parseSize(e,r.size),i=_parseSize(e,r.minSize)||1,a=_parseSize(e,r.maxSize)||1e5,n>0&&(n=max(min(n,a),i)),o.autoResize=r.autoResize,o.isClosed=!1,o.isSliding=!1,o.isResizing=!1,o.isHidden=!1,o.pins||(o.pins=[])),o.tagName=u[0].tagName,o.edge=e,o.noRoom=!1,o.isVisible=!0,setPanePosition(e),"horz"===l?c.height=cssH(u,n):"vert"===l&&(c.width=cssW(u,n)),u.css(c),"horz"!=l&&sizeMidPanes(e,!0),r.initClosed&&r.closable&&!r.initHidden?close(e,!0,!0):r.initHidden||r.initClosed?hide(e):o.noRoom||u.css("display","block"),u.css("visibility","visible"),r.showOverflowOnHover&&u.hover(allowOverflow,resetOverflow),state.initialized&&(initHandles(e),initHotkeys(e),afterInitPane(e))}},afterInitPane=function(e){var t=$Ps[e],n=state[e],i=options[e];t&&(t.data("layout")&&refreshChildren(e,t.data("layout")),n.isVisible&&(state.initialized?resizeAll():sizeContent(e),i.triggerEventsOnLoad?_runCallbacks("onresize_end",e):resizeChildren(e,!0)),i.initChildren&&i.children&&createChildren(e))},setPanePosition=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,function(e,t){var n=$Ps[t],i=$Rs[t],a=(options[t],state[t]),r=_c[t].side,o={};if(n){switch(t){case"north":o.top=sC.inset.top,o.left=sC.inset.left,o.right=sC.inset.right;break;case"south":o.bottom=sC.inset.bottom,o.left=sC.inset.left,o.right=sC.inset.right;break;case"west":o.left=sC.inset.left;break;case"east":o.right=sC.inset.right;break;case"center":}n.css(o),i&&a.isClosed?i.css(r,sC.inset[r]):i&&!a.isHidden&&i.css(r,sC.inset[r]+getPaneSize(t))}})},initHandles=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,function(e,t){var n=$Ps[t];if($Rs[t]=!1,$Ts[t]=!1,n){var i=options[t],a=state[t],r=(_c[t],"#"===i.paneSelector.substr(0,1)?i.paneSelector.substr(1):""),o=i.resizerClass,s=i.togglerClass,l=(a.isVisible?i.spacing_open:i.spacing_closed,"-"+t),d=(a.isVisible?"-open":"-closed",Instance[t]),c=d.resizer=$Rs[t]=$("<div></div>"),u=d.toggler=i.closable?$Ts[t]=$("<div></div>"):!1;!a.isVisible&&i.slidable&&c.attr("title",i.tips.Slide).css("cursor",i.sliderCursor),c.attr("id",r?r+"-resizer":"").data({parentLayout:Instance,layoutPane:Instance[t],layoutEdge:t,layoutRole:"resizer"}).css(_c.resizers.cssReq).css("zIndex",options.zIndexes.resizer_normal).css(i.applyDemoStyles?_c.resizers.cssDemo:{}).addClass(o+" "+o+l).hover(addHover,removeHover).hover(onResizerEnter,onResizerLeave).appendTo($N),i.resizerDblClickToggle&&c.bind("dblclick."+sID,toggle),u&&(u.attr("id",r?r+"-toggler":"").data({parentLayout:Instance,layoutPane:Instance[t],layoutEdge:t,layoutRole:"toggler"}).css(_c.togglers.cssReq).css(i.applyDemoStyles?_c.togglers.cssDemo:{}).addClass(s+" "+s+l).hover(addHover,removeHover).bind("mouseenter",onResizerEnter).appendTo(c),i.togglerContent_open&&$("<span>"+i.togglerContent_open+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).data("layoutRole","togglerContent").data("layoutEdge",t).addClass("content content-open").css("display","none").appendTo(u),i.togglerContent_closed&&$("<span>"+i.togglerContent_closed+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).addClass("content content-closed").css("display","none").appendTo(u),enableClosable(t)),initResizable(t),a.isVisible?setAsOpen(t):(setAsClosed(t),bindStartSlidingEvents(t,!0))}}),sizeHandles()},initContent=function(e,t){if(isInitialized()){var n,i=options[e],a=i.contentSelector,r=Instance[e],o=$Ps[e];a&&(n=r.content=$Cs[e]=i.findNestedContent?o.find(a).eq(0):o.children(a).eq(0)),n&&n.length?(n.data("layoutRole","content"),n.data("layoutCSS")||n.data("layoutCSS",styles(n,"height")),n.css(_c.content.cssReq),i.applyDemoStyles&&(n.css(_c.content.cssDemo),o.css(_c.content.cssDemoPane)),o.css("overflowX").match(/(scroll|auto)/)&&o.css("overflow","hidden"),state[e].content={},t!==!1&&sizeContent(e)):r.content=$Cs[e]=!1}},initResizable=function(e){var t=$.layout.plugins.draggable;e=e?e.split(","):_c.borderPanes,$.each(e,function(e,i){var a=options[i];if(!t||!$Ps[i]||!a.resizable)return a.resizable=!1,!0;var r,o,s=state[i],l=options.zIndexes,d=_c[i],c="horz"==d.dir?"top":"left",u=($Ps[i],$Rs[i]),h=a.resizerClass,p=0,f=h+"-drag",g=h+"-"+i+"-drag",m=h+"-dragging",b=h+"-"+i+"-dragging",v=h+"-dragging-limit",y=h+"-"+i+"-dragging-limit",_=!1;s.isClosed||u.attr("title",a.tips.Resize).css("cursor",a.resizerCursor),u.draggable({containment:$N[0],axis:"horz"==d.dir?"y":"x",delay:0,distance:1,grid:a.resizingGrid,helper:"clone",opacity:a.resizerDragOpacity,addClasses:!1,zIndex:l.resizer_drag,start:function(e,t){return a=options[i],s=state[i],o=a.livePaneResizing,!1===_runCallbacks("ondrag_start",i)?!1:(s.isResizing=!0,state.paneResizing=i,timer.clear(i+"_closeSlider"),setSizeLimits(i),r=s.resizerPosition,p=t.position[c],u.addClass(f+" "+g),_=!1,$("body").disableSelection(),void showMasks(i))},drag:function(e,t){_||(t.helper.addClass(m+" "+b).css({right:"auto",bottom:"auto"}).children().css("visibility","hidden"),_=!0,s.isSliding&&$Ps[i].css("zIndex",l.pane_sliding));var d=0;t.position[c]<r.min?(t.position[c]=r.min,d=-1):t.position[c]>r.max&&(t.position[c]=r.max,d=1),d?(t.helper.addClass(v+" "+y),window.defaultStatus=d>0&&i.match(/(north|west)/)||0>d&&i.match(/(south|east)/)?a.tips.maxSizeWarning:a.tips.minSizeWarning):(t.helper.removeClass(v+" "+y),window.defaultStatus=""),o&&Math.abs(t.position[c]-p)>=a.liveResizingTolerance&&(p=t.position[c],n(e,t,i))},stop:function(e,t){$("body").enableSelection(),window.defaultStatus="",u.removeClass(f+" "+g),s.isResizing=!1,state.paneResizing=!1,n(e,t,i,!0)}})});var n=function(e,t,n,i){var a,r=t.position,o=_c[n],s=options[n],l=state[n];switch(n){case"north":a=r.top;break;case"west":a=r.left;break;case"south":a=sC.layoutHeight-r.top-s.spacing_open;break;case"east":a=sC.layoutWidth-r.left-s.spacing_open}var d=a-sC.inset[o.side];if(i)!1!==_runCallbacks("ondrag_end",n)&&manualSizePane(n,d,!1,!0),hideMasks(!0),l.isSliding&&showMasks(n);else{if(Math.abs(d-l.size)<s.liveResizingTolerance)return;manualSizePane(n,d,!1,!0),sizeMasks()}}},sizeMask=function(){var e=$(this),t=e.data("layoutMask"),n=state[t];"IFRAME"==n.tagName&&n.isVisible&&e.css({top:n.offsetTop,left:n.offsetLeft,width:n.outerWidth,height:n.outerHeight})},sizeMasks=function(){$Ms.each(sizeMask)},showMasks=function(e,t){var n,i,a=_c[e],r=["center"],o=options.zIndexes,s=$.extend({objectsOnly:!1,forSliding:state[e].isSliding},t);s.forSliding&&r.push(_c.oppositeEdge[e]),"horz"===a.dir&&(r.push("west"),r.push("east")),$.each(r,function(e,t){i=state[t],n=options[t],i.isVisible&&(n.maskObjects||!s.objectsOnly&&n.maskContents)&&getMasks(t).each(function(){sizeMask.call(this),this.style.zIndex=i.isSliding?o.pane_sliding+1:o.pane_normal+1,this.style.display="block"})})},hideMasks=function(e){if(e||!state.paneResizing)$Ms.hide();else if(!e&&!$.isEmptyObject(state.panesSliding))for(var t,n,i=$Ms.length-1;i>=0;i--)n=$Ms.eq(i),t=n.data("layoutMask"),options[t].maskObjects||n.hide()},getMasks=function(e){for(var t,n=$([]),i=0,a=$Ms.length;a>i;i++)t=$Ms.eq(i),t.data("layoutMask")===e&&(n=n.add(t));return n.length?n:createMasks(e)},createMasks=function(e){var t,n,i,a,r,o=$Ps[e],s=state[e],l=options[e],d=options.zIndexes,c=$([]);if(!l.maskContents&&!l.maskObjects)return c;for(r=0;r<(l.maskObjects?2:1);r++)t=l.maskObjects&&0==r,n=document.createElement(t?"iframe":"div"),i=$(n).data("layoutMask",e),n.className="ui-layout-mask ui-layout-mask-"+e,a=n.style,a.display="block",a.position="absolute",a.background="#FFF",t&&(n.frameborder=0,n.src="about:blank",a.opacity=0,a.filter="Alpha(Opacity='0')",a.border=0),"IFRAME"==s.tagName?(a.zIndex=d.pane_normal+1,$N.append(n)):(i.addClass("ui-layout-mask-inside-pane"),a.zIndex=l.maskZindex||d.content_mask,a.top=0,a.left=0,a.width="100%",a.height="100%",o.append(n)),c=c.add(n),$Ms=$Ms.add(n);return c},destroy=function(e,t){$(window).unbind("."+sID),$(document).unbind("."+sID),"object"==typeof e?evtPane(e):t=e,$N.clearQueue().removeData("layout").removeData("layoutContainer").removeClass(options.containerClass).unbind("."+sID),$Ms.remove(),$.each(_c.allPanes,function(e,n){removePane(n,!1,!0,t)});var n="layoutCSS";$N.data(n)&&!$N.data("layoutRole")&&$N.css($N.data(n)).removeData(n),"BODY"===sC.tagName&&($N=$("html")).data(n)&&$N.css($N.data(n)).removeData(n),runPluginCallbacks(Instance,$.layout.onDestroy),unload();for(var i in Instance)i.match(/^(container|options)$/)||delete Instance[i];return Instance.destroyed=!0,Instance},removePane=function(e,t,n,i){if(isInitialized()){var a=evtPane.call(this,e),r=$Ps[a],o=$Cs[a],s=$Rs[a],l=$Ts[a];r&&$.isEmptyObject(r.data())&&(r=!1),o&&$.isEmptyObject(o.data())&&(o=!1),s&&$.isEmptyObject(s.data())&&(s=!1),l&&$.isEmptyObject(l.data())&&(l=!1),r&&r.stop(!0,!0);var d=options[a],c=state[a],u="layout",h="layoutCSS",p=children[a],f=$.isPlainObject(p)&&!$.isEmptyObject(p),g=void 0!==i?i:d.destroyChildren;if(f&&g&&($.each(p,function(e,t){t.destroyed||t.destroy(!0),t.destroyed&&delete p[e]}),$.isEmptyObject(p)&&(p=children[a]=null,f=!1)),r&&t&&!f)r.remove();else if(r&&r[0]){var m=d.paneClass,b=m+"-"+a,v="-open",y="-sliding",_="-closed",w=[m,m+v,m+_,m+y,b,b+v,b+_,b+y];$.merge(w,getHoverClasses(r,!0)),r.removeClass(w.join(" ")).removeData("parentLayout").removeData("layoutPane").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+sID),f&&o?(o.width(o.width()),$.each(p,function(e,t){t.resizeAll()})):o&&o.css(o.data(h)).removeData(h).removeData("layoutRole"),r.data(u)||r.css(r.data(h)).removeData(h)}l&&l.remove(),s&&s.remove(),Instance[a]=$Ps[a]=$Cs[a]=$Rs[a]=$Ts[a]=!1,c={removed:!0},n||resizeAll()}},_hidePane=function(e){var t=$Ps[e],n=options[e],i=t[0].style;n.useOffscreenClose?(t.data(_c.offscreenReset)||t.data(_c.offscreenReset,{left:i.left,right:i.right}),t.css(_c.offscreenCSS)):t.hide().removeData(_c.offscreenReset)},_showPane=function(e){var t=$Ps[e],n=options[e],i=_c.offscreenCSS,a=t.data(_c.offscreenReset),r=t[0].style;t.show().removeData(_c.offscreenReset),n.useOffscreenClose&&a&&(r.left==i.left&&(r.left=a.left),r.right==i.right&&(r.right=a.right))},hide=function(e,t){if(isInitialized()){var n=evtPane.call(this,e),i=options[n],a=state[n],r=$Ps[n],o=$Rs[n];r&&!a.isHidden&&(state.initialized&&!1===_runCallbacks("onhide_start",n)||(a.isSliding=!1,delete state.panesSliding[n],o&&o.hide(),!state.initialized||a.isClosed?(a.isClosed=!0,a.isHidden=!0,a.isVisible=!1,state.initialized||_hidePane(n),sizeMidPanes("horz"===_c[n].dir?"":"center"),(state.initialized||i.triggerEventsOnLoad)&&_runCallbacks("onhide_end",n)):(a.isHiding=!0,close(n,!1,t))))}},show=function(e,t,n,i){if(isInitialized()){{var a=evtPane.call(this,e),r=(options[a],state[a]),o=$Ps[a];$Rs[a]}o&&r.isHidden&&!1!==_runCallbacks("onshow_start",a)&&(r.isShowing=!0,r.isSliding=!1,delete state.panesSliding[a],t===!1?close(a,!0):open(a,!1,n,i))}},toggle=function(e,t){if(isInitialized()){var n=evtObj(e),i=evtPane.call(this,e),a=state[i];n&&n.stopImmediatePropagation(),a.isHidden?show(i):a.isClosed?open(i,!!t):close(i)}},_closePane=function(e){var t=($Ps[e],state[e]);_hidePane(e),t.isClosed=!0,t.isVisible=!1},close=function(e,t,n,i){function a(){h.isMoving=!1,bindStartSlidingEvents(r,!0);var e=_c.oppositeEdge[r];state[e].noRoom&&(setSizeLimits(e),makePaneFit(e)),i||!state.initialized&&!u.triggerEventsOnLoad||(s||_runCallbacks("onclose_end",r),s&&_runCallbacks("onshow_end",r),l&&_runCallbacks("onhide_end",r))}var r=evtPane.call(this,e);if(!state.initialized&&$Ps[r])return void _closePane(r);if(isInitialized()){{var o,s,l,d,c=$Ps[r],u=($Rs[r],$Ts[r],options[r]),h=state[r];_c[r]}$N.queue(function(e){if(!c||!u.closable&&!h.isShowing&&!h.isHiding||!t&&h.isClosed&&!h.isShowing)return e();var i=!h.isShowing&&!1===_runCallbacks("onclose_start",r);return s=h.isShowing,l=h.isHiding,d=h.isSliding,delete h.isShowing,delete h.isHiding,i?e():(o=!n&&!h.isClosed&&"none"!=u.fxName_close,h.isMoving=!0,h.isClosed=!0,h.isVisible=!1,l?h.isHidden=!0:s&&(h.isHidden=!1),h.isSliding?bindStopSlidingEvents(r,!1):sizeMidPanes("horz"===_c[r].dir?"":"center",!1),setAsClosed(r),void(o?(lockPaneForFX(r,!0),c.hide(u.fxName_close,u.fxSettings_close,u.fxSpeed_close,function(){lockPaneForFX(r,!1),h.isClosed&&a(),e()})):(_hidePane(r),a(),e())))})}},setAsClosed=function(e){var t=($Ps[e],$Rs[e]),n=$Ts[e],i=options[e],a=(state[e],_c[e].side),r=i.resizerClass,o=i.togglerClass,s="-"+e,l="-open",d="-sliding",c="-closed";t.css(a,sC.inset[a]).removeClass(r+l+" "+r+s+l).removeClass(r+d+" "+r+s+d).addClass(r+c+" "+r+s+c),i.resizable&&$.layout.plugins.draggable&&t.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title",""),n&&(n.removeClass(o+l+" "+o+s+l).addClass(o+c+" "+o+s+c).attr("title",i.tips.Open),n.children(".content-open").hide(),n.children(".content-closed").css("display","block")),syncPinBtns(e,!1),state.initialized&&sizeHandles()},open=function(e,t,n,i){function a(){c.isMoving=!1,_fixIframe(s),c.isSliding||sizeMidPanes("vert"==_c[s].dir?"center":"",!1),setAsOpen(s)}if(isInitialized()){{var r,o,s=evtPane.call(this,e),l=$Ps[s],d=($Rs[s],$Ts[s],options[s]),c=state[s];_c[s]}$N.queue(function(e){if(!l||!d.resizable&&!d.closable&&!c.isShowing||c.isVisible&&!c.isSliding)return e();if(c.isHidden&&!c.isShowing)return e(),void show(s,!0);c.autoResize&&c.size!=d.size?sizePane(s,d.size,!0,!0,!0):setSizeLimits(s,t);var u=_runCallbacks("onopen_start",s);return"abort"===u?e():("NC"!==u&&setSizeLimits(s,t),c.minSize>c.maxSize?(syncPinBtns(s,!1),!i&&d.tips.noRoomToOpen&&alert(d.tips.noRoomToOpen),e()):(t?bindStopSlidingEvents(s,!0):c.isSliding?bindStopSlidingEvents(s,!1):d.slidable&&bindStartSlidingEvents(s,!1),c.noRoom=!1,makePaneFit(s),o=c.isShowing,delete c.isShowing,r=!n&&c.isClosed&&"none"!=d.fxName_open,c.isMoving=!0,c.isVisible=!0,c.isClosed=!1,o&&(c.isHidden=!1),void(r?(lockPaneForFX(s,!0),l.show(d.fxName_open,d.fxSettings_open,d.fxSpeed_open,function(){lockPaneForFX(s,!1),c.isVisible&&a(),e()})):(_showPane(s),a(),e()))))})}},setAsOpen=function(e,t){var n=$Ps[e],i=$Rs[e],a=$Ts[e],r=options[e],o=state[e],s=_c[e].side,l=r.resizerClass,d=r.togglerClass,c="-"+e,u="-open",h="-closed",p="-sliding";i.css(s,sC.inset[s]+getPaneSize(e)).removeClass(l+h+" "+l+c+h).addClass(l+u+" "+l+c+u),o.isSliding?i.addClass(l+p+" "+l+c+p):i.removeClass(l+p+" "+l+c+p),removeHover(0,i),r.resizable&&$.layout.plugins.draggable?i.draggable("enable").css("cursor",r.resizerCursor).attr("title",r.tips.Resize):o.isSliding||i.css("cursor","default"),a&&(a.removeClass(d+h+" "+d+c+h).addClass(d+u+" "+d+c+u).attr("title",r.tips.Close),removeHover(0,a),a.children(".content-closed").hide(),a.children(".content-open").css("display","block")),syncPinBtns(e,!o.isSliding),$.extend(o,elDims(n)),state.initialized&&(sizeHandles(),sizeContent(e,!0)),!t&&(state.initialized||r.triggerEventsOnLoad)&&n.is(":visible")&&(_runCallbacks("onopen_end",e),o.isShowing&&_runCallbacks("onshow_end",e),state.initialized&&_runCallbacks("onresize_end",e))},slideOpen=function(e){function t(){a.isClosed?a.isMoving||open(i,!0):bindStopSlidingEvents(i,!0)}if(isInitialized()){var n=evtObj(e),i=evtPane.call(this,e),a=state[i],r=options[i].slideDelay_open;n&&n.stopImmediatePropagation(),a.isClosed&&n&&"mouseenter"===n.type&&r>0?timer.set(i+"_openSlider",t,r):t()}},slideClose=function(e){function t(){r.isClosed?bindStopSlidingEvents(i,!1):r.isMoving||close(i)}if(isInitialized()){var n=evtObj(e),i=evtPane.call(this,e),a=options[i],r=state[i],o=r.isMoving?1e3:300;if(!r.isClosed&&!r.isResizing)if("click"===a.slideTrigger_close)t();else{if(a.preventQuickSlideClose&&r.isMoving)return;if(a.preventPrematureSlideClose&&n&&$.layout.isMouseOverElem(n,$Ps[i]))return;n?timer.set(i+"_closeSlider",t,max(a.slideDelay_close,o)):t()}}},slideToggle=function(e){var t=evtPane.call(this,e);toggle(t,!0)},lockPaneForFX=function(e,t){var n=$Ps[e],i=state[e],a=options[e],r=options.zIndexes;t?(showMasks(e,{objectsOnly:!0}),n.css({zIndex:r.pane_animate}),"south"==e?n.css({top:sC.inset.top+sC.innerHeight-n.outerHeight()}):"east"==e&&n.css({left:sC.inset.left+sC.innerWidth-n.outerWidth()})):(hideMasks(),n.css({zIndex:i.isSliding?r.pane_sliding:r.pane_normal}),"south"==e?n.css({top:"auto"}):"east"!=e||n.css("left").match(/\-99999/)||n.css({left:"auto"}),browser.msie&&a.fxOpacityFix&&"slide"!=a.fxName_open&&n.css("filter")&&1==n.css("opacity")&&n[0].style.removeAttribute("filter"))},bindStartSlidingEvents=function(e,t){var n=options[e],i=($Ps[e],$Rs[e]),a=n.slideTrigger_open.toLowerCase();!i||t&&!n.slidable||(a.match(/mouseover/)?a=n.slideTrigger_open="mouseenter":a.match(/(click|dblclick|mouseenter)/)||(a=n.slideTrigger_open="click"),n.resizerDblClickToggle&&a.match(/click/)&&i[t?"unbind":"bind"]("dblclick."+sID,toggle),i[t?"bind":"unbind"](a+"."+sID,slideOpen).css("cursor",t?n.sliderCursor:"default").attr("title",t?n.tips.Slide:""))},bindStopSlidingEvents=function(e,t){function n(t){timer.clear(e+"_closeSlider"),t.stopPropagation()}var i=options[e],a=state[e],r=(_c[e],options.zIndexes),o=i.slideTrigger_close.toLowerCase(),s=t?"bind":"unbind",l=$Ps[e],d=$Rs[e];timer.clear(e+"_closeSlider"),t?(a.isSliding=!0,state.panesSliding[e]=!0,bindStartSlidingEvents(e,!1)):(a.isSliding=!1,delete state.panesSliding[e]),l.css("zIndex",t?r.pane_sliding:r.pane_normal),d.css("zIndex",t?r.pane_sliding+2:r.resizer_normal),o.match(/(click|mouseleave)/)||(o=i.slideTrigger_close="mouseleave"),d[s](o,slideClose),"mouseleave"===o&&(l[s]("mouseleave."+sID,slideClose),d[s]("mouseenter."+sID,n),l[s]("mouseenter."+sID,n)),t?"click"!==o||i.resizable||(d.css("cursor",t?i.sliderCursor:"default"),d.attr("title",t?i.tips.Close:"")):timer.clear(e+"_closeSlider")
},makePaneFit=function(e,t,n,i){var a=options[e],r=state[e],o=_c[e],s=$Ps[e],l=$Rs[e],d="vert"===o.dir,c=!1;if(("center"===e||d&&r.noVerticalRoom)&&(c=r.maxHeight>=0,c&&r.noRoom?(_showPane(e),l&&l.show(),r.isVisible=!0,r.noRoom=!1,d&&(r.noVerticalRoom=!1),_fixIframe(e)):c||r.noRoom||(_hidePane(e),l&&l.hide(),r.isVisible=!1,r.noRoom=!0)),"center"===e);else if(r.minSize<=r.maxSize){if(c=!0,r.size>r.maxSize)sizePane(e,r.maxSize,n,!0,i);else if(r.size<r.minSize)sizePane(e,r.minSize,n,!0,i);else if(l&&r.isVisible&&s.is(":visible")){var u=r.size+sC.inset[o.side];$.layout.cssNum(l,o.side)!=u&&l.css(o.side,u)}r.noRoom&&(r.wasOpen&&a.closable?a.autoReopen?open(e,!1,!0,!0):r.noRoom=!1:show(e,r.wasOpen,!0,!0))}else r.noRoom||(r.noRoom=!0,r.wasOpen=!r.isClosed&&!r.isSliding,r.isClosed||(a.closable?close(e,!0,!0):hide(e,!0)))},manualSizePane=function(e,t,n,i,a){if(isInitialized()){var r=evtPane.call(this,e),o=options[r],s=state[r],l=a||o.livePaneResizing&&!s.isResizing;s.autoResize=!1,sizePane(r,t,n,i,l)}},sizePane=function(e,t,n,i,a){function r(){for(var e="width"===f?u.outerWidth():u.outerHeight(),i=[{pane:l,count:1,target:t,actual:e,correct:t===e,attempt:t,cssSize:s}],r=i[0],d={},m="Inaccurate size after resizing the "+l+"-pane.";!(r.correct||(d={pane:l,count:r.count+1,target:t},d.attempt=r.actual>t?max(0,r.attempt-(r.actual-t)):max(0,r.attempt+(t-r.actual)),d.cssSize=cssSize(l,d.attempt),u.css(f,d.cssSize),d.actual="width"==f?u.outerWidth():u.outerHeight(),d.correct=t===d.actual,1===i.length&&(_log(m,!1,!0),_log(r,!1,!0)),_log(d,!1,!0),i.length>3));)i.push(d),r=i[i.length-1];c.size=t,$.extend(c,elDims(u)),c.isVisible&&u.is(":visible")&&(h&&h.css(p,t+sC.inset[p]),sizeContent(l)),!n&&!g&&state.initialized&&c.isVisible&&_runCallbacks("onresize_end",l),n||(c.isSliding||sizeMidPanes("horz"==_c[l].dir?"":"center",g,a),sizeHandles());var b=_c.oppositeEdge[l];o>t&&state[b].noRoom&&(setSizeLimits(b),makePaneFit(b,!1,n)),i.length>1&&_log(m+"\nSee the Error Console for details.",!0,!0)}if(isInitialized()){var o,s,l=evtPane.call(this,e),d=options[l],c=state[l],u=$Ps[l],h=$Rs[l],p=_c[l].side,f=_c[l].sizeType.toLowerCase(),g=c.isResizing&&!d.triggerEventsDuringLiveResize,m=i!==!0&&d.animatePaneSizing;$N.queue(function(e){if(setSizeLimits(l),o=c.size,t=_parseSize(l,t),t=max(t,_parseSize(l,d.minSize)),t=min(t,c.maxSize),t<c.minSize)return e(),void makePaneFit(l,!1,n);if(!a&&t===o)return e();if(!n&&state.initialized&&c.isVisible&&_runCallbacks("onresize_start",l),s=cssSize(l,t),m&&u.is(":visible")){var i=$.layout.effects.size[l]||$.layout.effects.size.all,h=d.fxSettings_size.easing||i.easing,p=options.zIndexes,g={};g[f]=s+"px",c.isMoving=!0,u.css({zIndex:p.pane_animate}).show().animate(g,d.fxSpeed_size,h,function(){u.css({zIndex:c.isSliding?p.pane_sliding:p.pane_normal}),c.isMoving=!1,r(),e()})}else u.css(f,s),u.is(":visible")?r():(c.size=t,$.extend(c,elDims(u))),e()})}},sizeMidPanes=function(e,t,n){e=(e?e:"east,west,center").split(","),$.each(e,function(e,i){if($Ps[i]){var a=options[i],r=state[i],o=$Ps[i],s=($Rs[i],!0),l={},d=$.layout.showInvisibly(o),c=calcNewCenterPaneDims();if($.extend(r,elDims(o)),"center"===i){if(!n&&r.isVisible&&c.width===r.outerWidth&&c.height===r.outerHeight)return o.css(d),!0;if($.extend(r,cssMinDims(i),{maxWidth:c.width,maxHeight:c.height}),l=c,l.width=cssW(o,l.width),l.height=cssH(o,l.height),s=l.width>=0&&l.height>=0,!state.initialized&&a.minWidth>c.width){var u=a.minWidth-r.outerWidth,h=options.east.minSize||0,p=options.west.minSize||0,f=state.east.size,g=state.west.size,m=f,b=g;if(u>0&&state.east.isVisible&&f>h&&(m=max(f-h,f-u),u-=f-m),u>0&&state.west.isVisible&&g>p&&(b=max(g-p,g-u),u-=g-b),0===u)return f&&f!=h&&sizePane("east",m,!0,!0,n),g&&g!=p&&sizePane("west",b,!0,!0,n),sizeMidPanes("center",t,n),void o.css(d)}}else{if(r.isVisible&&!r.noVerticalRoom&&$.extend(r,elDims(o),cssMinDims(i)),!n&&!r.noVerticalRoom&&c.height===r.outerHeight)return o.css(d),!0;l.top=c.top,l.bottom=c.bottom,l.height=cssH(o,c.height),r.maxHeight=l.height,s=r.maxHeight>=0,s||(r.noVerticalRoom=!0)}if(s?(!t&&state.initialized&&_runCallbacks("onresize_start",i),o.css(l),"center"!==i&&sizeHandles(i),!r.noRoom||r.isClosed||r.isHidden||makePaneFit(i),r.isVisible&&($.extend(r,elDims(o)),state.initialized&&sizeContent(i))):!r.noRoom&&r.isVisible&&makePaneFit(i),o.css(d),!r.isVisible)return!0;if("center"===i){var v=browser.isIE6||!browser.boxModel;$Ps.north&&(v||"IFRAME"==state.north.tagName)&&$Ps.north.css("width",cssW($Ps.north,sC.innerWidth)),$Ps.south&&(v||"IFRAME"==state.south.tagName)&&$Ps.south.css("width",cssW($Ps.south,sC.innerWidth))}!t&&state.initialized&&_runCallbacks("onresize_end",i)}})},resizeAll=function(e){var t=sC.innerWidth,n=sC.innerHeight;if(evtPane(e),$N.is(":visible")){if(!state.initialized)return void _initLayoutElements();if($.extend(sC,elDims($N,options.inset)),sC.outerHeight){if(e===!0&&setPanePosition(),!1===_runCallbacks("onresizeall_start"))return!1;{var i,a,r;sC.innerHeight<n,sC.innerWidth<t}$.each(["south","north","east","west"],function(e,t){$Ps[t]&&(a=options[t],r=state[t],r.autoResize&&r.size!=a.size?sizePane(t,a.size,!0,!0,!0):(setSizeLimits(t),makePaneFit(t,!1,!0,!0)))}),sizeMidPanes("",!0,!0),sizeHandles(),$.each(_c.allPanes,function(e,t){i=$Ps[t],i&&state[t].isVisible&&_runCallbacks("onresize_end",t)}),_runCallbacks("onresizeall_end")}}},resizeChildren=function(e,t){var n=evtPane.call(this,e);if(options[n].resizeChildren){t||refreshChildren(n);var i=children[n];$.isPlainObject(i)&&$.each(i,function(e,t){t.resizeAll()})}},sizeContent=function(e,t){if(isInitialized()){var n=evtPane.call(this,e);n=n?n.split(","):_c.allPanes,$.each(n,function(e,n){function i(e){return max(l.css.paddingBottom,parseInt(e.css("marginBottom"),10)||0)}function a(){var e=options[n].contentIgnoreSelector,t=o.nextAll().not(".ui-layout-mask").not(e||":lt(0)"),a=t.filter(":visible"),r=a.filter(":last");d={top:o[0].offsetTop,height:o.outerHeight(),numFooters:t.length,hiddenFooters:t.length-a.length,spaceBelow:0},d.spaceAbove=d.top,d.bottom=d.top+d.height,d.spaceBelow=r.length?r[0].offsetTop+r.outerHeight()-d.bottom+i(r):i(o)}var r=$Ps[n],o=$Cs[n],s=options[n],l=state[n],d=l.content;if(!r||!o||!r.is(":visible"))return!0;if((o.length||(initContent(n,!1),o))&&!1!==_runCallbacks("onsizecontent_start",n)){(!l.isMoving&&!l.isResizing||s.liveContentResizing||t||void 0==d.top)&&(a(),d.hiddenFooters>0&&"hidden"===r.css("overflow")&&(r.css("overflow","visible"),a(),r.css("overflow","hidden")));var c=l.innerHeight-(d.spaceAbove-l.css.paddingTop)-(d.spaceBelow-l.css.paddingBottom);o.is(":visible")&&d.height==c||(setOuterHeight(o,c,!0),d.height=c),state.initialized&&_runCallbacks("onsizecontent_end",n)}})}},sizeHandles=function(e){var t=evtPane.call(this,e);t=t?t.split(","):_c.borderPanes,$.each(t,function(e,t){var n,i=options[t],a=state[t],r=$Ps[t],o=$Rs[t],s=$Ts[t];if(r&&o){var l,d,c,u=_c[t].dir,h=a.isClosed?"_closed":"_open",p=i["spacing"+h],f=i["togglerAlign"+h],g=i["togglerLength"+h];if(0===p)return void o.hide();if(a.noRoom||a.isHidden||o.show(),"horz"===u?(l=sC.innerWidth,a.resizerLength=l,d=$.layout.cssNum(r,"left"),o.css({width:cssW(o,l),height:cssH(o,p),left:d>-9999?d:sC.inset.left})):(l=r.outerHeight(),a.resizerLength=l,o.css({height:cssH(o,l),width:cssW(o,p),top:sC.inset.top+getPaneSize("north",!0)})),removeHover(i,o),s){if(0===g||a.isSliding&&i.hideTogglerOnSlide)return void s.hide();if(s.show(),!(g>0)||"100%"===g||g>l)g=l,c=0;else if(isStr(f))switch(f){case"top":case"left":c=0;break;case"bottom":case"right":c=l-g;break;case"middle":case"center":default:c=round((l-g)/2)}else{var m=parseInt(f,10);c=f>=0?m:l-g+m}if("horz"===u){var b=cssW(s,g);s.css({width:b,height:cssH(s,p),left:c,top:0}),s.children(".content").each(function(){n=$(this),n.css("marginLeft",round((b-n.outerWidth())/2))})}else{var v=cssH(s,g);s.css({height:v,width:cssW(s,p),top:c,left:0}),s.children(".content").each(function(){n=$(this),n.css("marginTop",round((v-n.outerHeight())/2))})}removeHover(0,s)}state.initialized||!i.initHidden&&!a.noRoom||(o.hide(),s&&s.hide())}})},enableClosable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Ts[t],i=options[t];n&&(i.closable=!0,n.bind("click."+sID,function(e){e.stopPropagation(),toggle(t)}).css("visibility","visible").css("cursor","pointer").attr("title",state[t].isClosed?i.tips.Open:i.tips.Close).show())}},disableClosable=function(e,t){if(isInitialized()){var n=evtPane.call(this,e),i=$Ts[n];i&&(options[n].closable=!1,state[n].isClosed&&open(n,!1,!0),i.unbind("."+sID).css("visibility",t?"hidden":"visible").css("cursor","default").attr("title",""))}},enableSlidable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&n.data("draggable")&&(options[t].slidable=!0,state[t].isClosed&&bindStartSlidingEvents(t,!0))}},disableSlidable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&(options[t].slidable=!1,state[t].isSliding?close(t,!1,!0):(bindStartSlidingEvents(t,!1),n.css("cursor","default").attr("title",""),removeHover(null,n[0])))}},enableResizable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t],i=options[t];n&&n.data("draggable")&&(i.resizable=!0,n.draggable("enable"),state[t].isClosed||n.css("cursor",i.resizerCursor).attr("title",i.tips.Resize))}},disableResizable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&n.data("draggable")&&(options[t].resizable=!1,n.draggable("disable").css("cursor","default").attr("title",""),removeHover(null,n[0]))}},swapPanes=function(e,t){function n(e){var t=$Ps[e],n=$Cs[e];return t?{pane:e,P:t?t[0]:!1,C:n?n[0]:!1,state:$.extend(!0,{},state[e]),options:$.extend(!0,{},options[e])}:!1}function i(e,t){if(e){var n,i,a=e.P,r=e.C,o=e.pane,l=_c[t],d=$.extend(!0,{},state[t]),c=options[t],u={resizerCursor:c.resizerCursor};$.each("fxName,fxSpeed,fxSettings".split(","),function(e,t){u[t+"_open"]=c[t+"_open"],u[t+"_close"]=c[t+"_close"],u[t+"_size"]=c[t+"_size"]}),$Ps[t]=$(a).data({layoutPane:Instance[t],layoutEdge:t}).css(_c.hidden).css(l.cssReq),$Cs[t]=r?$(r):!1,options[t]=$.extend(!0,{},e.options,u),state[t]=$.extend(!0,{},e.state),n=new RegExp(c.paneClass+"-"+o,"g"),a.className=a.className.replace(n,c.paneClass+"-"+t),initHandles(t),l.dir!=_c[o].dir?(i=s[t]||0,setSizeLimits(t),i=max(i,state[t].minSize),manualSizePane(t,i,!0,!0)):$Rs[t].css(l.side,sC.inset[l.side]+(state[t].isVisible?getPaneSize(t):0)),e.state.isVisible&&!d.isVisible?setAsOpen(t,!0):(setAsClosed(t),bindStartSlidingEvents(t,!0)),e=null}}if(isInitialized()){var a=evtPane.call(this,e);if(state[a].edge=t,state[t].edge=a,!1===_runCallbacks("onswap_start",a)||!1===_runCallbacks("onswap_start",t))return state[a].edge=a,void(state[t].edge=t);var r=n(a),o=n(t),s={};s[a]=r?r.state.size:0,s[t]=o?o.state.size:0,$Ps[a]=!1,$Ps[t]=!1,state[a]={},state[t]={},$Ts[a]&&$Ts[a].remove(),$Ts[t]&&$Ts[t].remove(),$Rs[a]&&$Rs[a].remove(),$Rs[t]&&$Rs[t].remove(),$Rs[a]=$Rs[t]=$Ts[a]=$Ts[t]=!1,i(r,t),i(o,a),r=o=s=null,$Ps[a]&&$Ps[a].css(_c.visible),$Ps[t]&&$Ps[t].css(_c.visible),resizeAll(),_runCallbacks("onswap_end",a),_runCallbacks("onswap_end",t)}},syncPinBtns=function(e,t){$.layout.plugins.buttons&&$.each(state[e].pins,function(n,i){$.layout.buttons.setPinState(Instance,$(i),e,t)})},$N=$(this).eq(0);if(!$N.length)return _log(options.errors.containerMissing);if($N.data("layoutContainer")&&$N.data("layout"))return $N.data("layout");var $Ps={},$Cs={},$Rs={},$Ts={},$Ms=$([]),sC=state.container,sID=state.id,Instance={options:options,state:state,container:$N,panes:$Ps,contents:$Cs,resizers:$Rs,togglers:$Ts,hide:hide,show:show,toggle:toggle,open:open,close:close,slideOpen:slideOpen,slideClose:slideClose,slideToggle:slideToggle,setSizeLimits:setSizeLimits,_sizePane:sizePane,sizePane:manualSizePane,sizeContent:sizeContent,swapPanes:swapPanes,showMasks:showMasks,hideMasks:hideMasks,initContent:initContent,addPane:addPane,removePane:removePane,createChildren:createChildren,refreshChildren:refreshChildren,enableClosable:enableClosable,disableClosable:disableClosable,enableSlidable:enableSlidable,disableSlidable:disableSlidable,enableResizable:enableResizable,disableResizable:disableResizable,allowOverflow:allowOverflow,resetOverflow:resetOverflow,destroy:destroy,initPanes:isInitialized,resizeAll:resizeAll,runCallbacks:_runCallbacks,hasParentLayout:!1,children:children,north:!1,south:!1,west:!1,east:!1,center:!1};return"cancel"===_create()?null:Instance},$(function(){var e=$.layout.browser;e.msie&&(e.boxModel=$.support.boxModel)})}(jQuery),function(e){e.ui||(e.ui={}),e.ui.cookie={acceptsCookies:!!navigator.cookieEnabled,read:function(t){for(var n,i=document.cookie,a=i?i.split(";"):[],r=0,o=a.length;o>r;r++)if(n=e.trim(a[r]).split("="),n[0]==t)return decodeURIComponent(n[1]);return null},write:function(e,t,n){var i="",a="",r=!1,o=n||{},s=o.expires;s&&s.toUTCString?a=s:(null===s||"number"==typeof s)&&(a=new Date,s>0?a.setDate(a.getDate()+s):(a.setFullYear(1970),r=!0)),a&&(i+=";expires="+a.toUTCString()),o.path&&(i+=";path="+o.path),o.domain&&(i+=";domain="+o.domain),o.secure&&(i+=";secure"),document.cookie=e+"="+(r?"":encodeURIComponent(t))+i},clear:function(t){e.ui.cookie.write(t,"",{expires:-1})}},e.cookie||(e.cookie=function(t,n,i){var a=e.ui.cookie;if(null===n)a.clear(t);else{if(void 0===n)return a.read(t);a.write(t,n,i)}}),e.layout.plugins.stateManagement=!0,e.layout.config.optionRootKeys.push("stateManagement"),e.layout.defaults.stateManagement={enabled:!1,autoSave:!0,autoLoad:!0,includeChildren:!0,stateKeys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden",cookie:{name:"",domain:"",path:"",expires:"",secure:!1}},e.layout.optionsMap.layout.push("stateManagement"),e.layout.state={saveCookie:function(t,n,i){var a=t.options,r=a.stateManagement,o=e.extend(!0,{},r.cookie,i||null),s=t.state.stateData=t.readState(n||r.stateKeys);return e.ui.cookie.write(o.name||a.name||"Layout",e.layout.state.encodeJSON(s),o),e.extend(!0,{},s)},deleteCookie:function(t){var n=t.options;e.ui.cookie.clear(n.stateManagement.cookie.name||n.name||"Layout")},readCookie:function(t){var n=t.options,i=e.ui.cookie.read(n.stateManagement.cookie.name||n.name||"Layout");return i?e.layout.state.decodeJSON(i):{}},loadCookie:function(t){var n=e.layout.state.readCookie(t);return n&&(t.state.stateData=e.extend(!0,{},n),t.loadState(n)),n},loadState:function(t,n,i){if(n=e.layout.transformData(n),e.isPlainObject(n)&&!e.isEmptyObject(n)){t.state.stateData=n;var a=e.extend(!0,{},n);return e.each(e.layout.config.allPanes,function(e,t){a[t]&&delete a[t].children}),void e.extend(!0,t.options,a)}},readState:function(t,n){"string"===e.type(n)&&(n={keys:n}),n||(n={});var i,a,r,o,s,l,d,c=t.options.stateManagement,u=n.includeChildren,h=void 0!==u?u:c.includeChildren,p=n.stateKeys||c.stateKeys,f={isClosed:"initClosed",isHidden:"initHidden"},g=t.state,m=e.layout.config.allPanes,b={};e.isArray(p)&&(p=p.join(",")),p=p.replace(/__/g,".").split(",");for(var v=0,y=p.length;y>v;v++)i=p[v].split("."),a=i[0],r=i[1],e.inArray(a,m)<0||(o=g[a][r],void 0!=o&&("isClosed"==r&&g[a].isSliding&&(o=!0),(b[a]||(b[a]={}))[f[r]?f[r]:r]=o));return h&&e.each(m,function(n,i){l=t.children[i],s=g.stateData[i],e.isPlainObject(l)&&!e.isEmptyObject(l)&&(d=b[i]||(b[i]={}),d.children||(d.children={}),e.each(l,function(t,n){n.state.initialized?d.children[t]=e.layout.state.readState(n):s&&s.children&&s.children[t]&&(d.children[t]=e.extend(!0,{},s.children[t]))}))}),b},encodeJSON:function(t){function n(t){var i,a,r,o=[],s=0,l=e.isArray(t);for(i in t)a=t[i],r=typeof a,"string"==r?a='"'+a+'"':"object"==r&&(a=n(a)),o[s++]=(l?"":'"'+i+'":')+a;return(l?"[":"{")+o.join(",")+(l?"]":"}")}return n(t)},decodeJSON:function(t){try{return e.parseJSON?e.parseJSON(t):window.eval("("+t+")")||{}}catch(n){return{}}},_create:function(t){var n=e.layout.state,i=t.options,a=i.stateManagement;if(e.extend(t,{readCookie:function(){return n.readCookie(t)},deleteCookie:function(){n.deleteCookie(t)},saveCookie:function(e,i){return n.saveCookie(t,e,i)},loadCookie:function(){return n.loadCookie(t)},loadState:function(e,i){n.loadState(t,e,i)},readState:function(e){return n.readState(t,e)},encodeJSON:n.encodeJSON,decodeJSON:n.decodeJSON}),t.state.stateData={},a.autoLoad)if(e.isPlainObject(a.autoLoad))e.isEmptyObject(a.autoLoad)||t.loadState(a.autoLoad);else if(a.enabled)if(e.isFunction(a.autoLoad)){var r={};try{r=a.autoLoad(t,t.state,t.options,t.options.name||"")}catch(o){}r&&e.isPlainObject(r)&&!e.isEmptyObject(r)&&t.loadState(r)}else t.loadCookie()},_unload:function(t){var n=t.options.stateManagement;if(n.enabled&&n.autoSave)if(e.isFunction(n.autoSave))try{n.autoSave(t,t.state,t.options,t.options.name||"")}catch(i){}else t.saveCookie()}},e.layout.onCreate.push(e.layout.state._create),e.layout.onUnload.push(e.layout.state._unload),e.layout.plugins.buttons=!0,e.layout.defaults.autoBindCustomButtons=!1,e.layout.optionsMap.layout.push("autoBindCustomButtons"),e.layout.buttons={init:function(t){var n,i="ui-layout-button-",a=t.options.name||"";e.each("toggle,open,close,pin,toggle-slide,open-slide".split(","),function(r,o){e.each(e.layout.config.borderPanes,function(r,s){e("."+i+o+"-"+s).each(function(){n=e(this).data("layoutName")||e(this).attr("layoutName"),(void 0==n||n===a)&&t.bindButton(this,o,s)})})})},get:function(t,n,i,a){var r=e(n),o=t.options,s=o.errors.addButtonError;if(r.length)if(e.inArray(i,e.layout.config.borderPanes)<0)e.layout.msg(s+" "+o.errors.pane+": "+i,!0),r=e("");else{var l=o[i].buttonClass+"-"+a;r.addClass(l+" "+l+"-"+i).data("layoutName",o.name)}else e.layout.msg(s+" "+o.errors.selector+": "+n,!0);return r},bind:function(t,n,i,a){var r=e.layout.buttons;switch(i.toLowerCase()){case"toggle":r.addToggle(t,n,a);break;case"open":r.addOpen(t,n,a);break;case"close":r.addClose(t,n,a);break;case"pin":r.addPin(t,n,a);break;case"toggle-slide":r.addToggle(t,n,a,!0);break;case"open-slide":r.addOpen(t,n,a,!0)}return t},addToggle:function(t,n,i,a){return e.layout.buttons.get(t,n,i,"toggle").click(function(e){t.toggle(i,!!a),e.stopPropagation()}),t},addOpen:function(t,n,i,a){return e.layout.buttons.get(t,n,i,"open").attr("title",t.options[i].tips.Open).click(function(e){t.open(i,!!a),e.stopPropagation()}),t},addClose:function(t,n,i){return e.layout.buttons.get(t,n,i,"close").attr("title",t.options[i].tips.Close).click(function(e){t.close(i),e.stopPropagation()}),t},addPin:function(t,n,i){var a=e.layout.buttons,r=a.get(t,n,i,"pin");if(r.length){var o=t.state[i];r.click(function(n){a.setPinState(t,e(this),i,o.isSliding||o.isClosed),o.isSliding||o.isClosed?t.open(i):t.close(i),n.stopPropagation()}),a.setPinState(t,r,i,!o.isClosed&&!o.isSliding),o.pins.push(n)}return t},setPinState:function(e,t,n,i){var a=t.attr("pin");if(!a||i!==("down"==a)){var r=e.options[n],o=r.buttonClass+"-pin",s=o+"-"+n,l=o+"-up "+s+"-up",d=o+"-down "+s+"-down";t.attr("pin",i?"down":"up").attr("title",i?r.tips.Unpin:r.tips.Pin).removeClass(i?l:d).addClass(i?d:l)}},syncPinBtns:function(t,n,i){e.each(t.state[n].pins,function(a,r){e.layout.buttons.setPinState(t,e(r),n,i)})},_load:function(t){var n=e.layout.buttons;e.extend(t,{bindButton:function(e,i,a){return n.bind(t,e,i,a)},addToggleBtn:function(e,i,a){return n.addToggle(t,e,i,a)},addOpenBtn:function(e,i,a){return n.addOpen(t,e,i,a)},addCloseBtn:function(e,i){return n.addClose(t,e,i)},addPinBtn:function(e,i){return n.addPin(t,e,i)}});for(var i=0;4>i;i++){var a=e.layout.config.borderPanes[i];t.state[a].pins=[]}t.options.autoBindCustomButtons&&n.init(t)},_unload:function(){}},e.layout.onLoad.push(e.layout.buttons._load),e.layout.plugins.browserZoom=!0,e.layout.defaults.browserZoomCheckInterval=1e3,e.layout.optionsMap.layout.push("browserZoomCheckInterval"),e.layout.browserZoom={_init:function(t){e.layout.browserZoom.ratio()!==!1&&e.layout.browserZoom._setTimer(t)},_setTimer:function(t){if(!t.destroyed){var n=t.options,i=t.state,a=t.hasParentLayout?5e3:Math.max(n.browserZoomCheckInterval,100);setTimeout(function(){if(!t.destroyed&&n.resizeWithWindow){var a=e.layout.browserZoom.ratio();a!==i.browserZoom&&(i.browserZoom=a,t.resizeAll()),e.layout.browserZoom._setTimer(t)}},a)}},ratio:function(){function t(e,t){return(parseInt(e,10)/parseInt(t,10)*100).toFixed()}var n,i,a,r=window,o=screen,s=document,l=s.documentElement||s.body,d=e.layout.browser,c=d.version;return d.msie&&c>8||!d.msie?!1:o.deviceXDPI&&o.systemXDPI?t(o.deviceXDPI,o.systemXDPI):d.webkit&&(n=s.body.getBoundingClientRect)?t(n.left-n.right,s.body.offsetWidth):d.webkit&&(i=r.outerWidth)?t(i,r.innerWidth):(i=o.width)&&(a=l.clientWidth)?t(i,a):!1}},e.layout.onReady.push(e.layout.browserZoom._init)}(jQuery)}),define("RepositoryBrowser",["jquery","Class","PubSub","repository-browser-i18n-"+(window&&window.__DEPS__&&window.__DEPS__.lang||"en"),"jstree","jqgrid","jquery-layout"],function(e,t,n,i){function a(e){e.each(function(){u(this).attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}).each(function(){this.onselectstart=function(){return!1}})})}function r(e){switch(e){case"folder":return"folder";case"document":return"document";default:return""}}function o(){return++f}function s(e,t){e._cachedRepositoryObjects[t.uid]=t}function l(e,t){return e._cachedRepositoryObjects[t]}function d(e){return e.find("a:first").attr("data-repo-obj")}function c(t,n){var i=o(),a=!1===t.hasMoreItems||"folder"!==t.baseType?null:"closed",l=null;if(t.children){a="open",l=[];var d,u;for(d=0;d<t.children.length;d++)u=c(t.children[d],n),l.push(u),s(n,u.resource)}var h=e.extend(t,{uid:i,loaded:!1});return{state:a,resource:h,children:l,attr:{rel:t.type,"data-repo-obj":i},data:{title:t.name,icon:r(t.baseType),attr:{"data-repo-obj":i}}}}var u=e,h=[],p=0,f=(new Date).getTime(),g={repositoryManager:null,repositoryFilter:[],objectTypeFilter:[],renditionFilter:["cmis:none"],filter:["url"],element:null,isFloating:!1,verticalPadding:100,horizontalPadding:50,maxHeight:1e3,minHeight:400,minWidth:400,maxWidth:1200,treeWidth:300,listWidth:"auto",pageSize:8,adaptPageSize:!1,rowHeight:32,rootPath:"",rootFolderId:"aloha",columns:{icon:{title:"",width:30,sortable:!1,resizable:!1},name:{title:"Name",width:200,sorttype:"text"},url:{title:"URL",width:220,sorttype:"text"},preview:{title:"Preview",width:150,sorttype:"text"}},i18n:{Browsing:"Browsing",Close:"Close","in":"in","Input search text...":"Input search text...",numerous:"numerous",of:"of","Repository Browser":"Repository Browser",Search:"Search","Searching for":"Searching for",Viewing:"Viewing"}},m=t.extend({_cachedRepositoryObjects:{},_searchQuery:null,_orderBy:null,_prefilledValue:null,$_grid:null,$_tree:null,$_list:null,_isOpened:!0,_constructor:function(){this.init.apply(this,arguments)},init:function(e){e=u.extend({},g,e,{i18n:i}),e.element&&0!==e.element.length||(e.isFloating=!0,e.element=this._createOverlay()),e.maxWidth<e.minWidth&&(e.maxWidth=e.minWidth),u.extend(this,e),this._prefilledValue=this._i18n("Input search text..."),this._cachedRepositoryObjects={},this._searchQuery=null,this._orderBy=null,this._pagingCount=null,this._pagingOffset=0,this._pagingBtns={first:null,end:null,next:null,prev:null},this._initializeUI(),h.push(this),n.pub("repository-browser.initialized",{data:this})},_i18n:function(e){return this.i18n[e]||e},_initializeUI:function(){this.element.attr("data-repository-browser",++f),this.element.width(this.maxWidth),this.$_grid=this._createGrid(this.element).resize(),this._setInitialHeight(),this.$_tree=this._createTree(this.$_grid.find(".ui-layout-west")),this.$_list=this._createList(this.$_grid.find(".ui-layout-center"));var e=this,t=this.treeWidth/5;this.$_grid.layout({enableCursorHotkey:!1,west__size:this.treeWidth-1,west__minSize:this.treeWidth-t,west__maxSize:this.treeWidth+t,center__size:"auto",paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",onresize:function(t,n){"center"===t&&e.$_list.setGridWidth(n.width())}}).sizePane("west",this.treeWidth),a(this.$_grid),this._preloadImages(),u(function(){u(window).resize(function(){e._onWindowResized()})}),this.element.mousedown(function(){u.each(h,function(e){this.element.css("z-index",99999+e)}),u(this).css("z-index",99999+h.length+1)}),u(".repository-browser-grid").css("width",this.maxWidth),this.close(),this._adaptPageSize()},_setInitialHeight:function(){var e=this.maxHeight-u(window).height()+this.verticalPadding,t=e>0?Math.max(this.minHeight,this.maxHeight-e):this.maxHeight;this.$_grid.height(t)},_onWindowResized:function(){var e,t,n=this.maxWidth-u(window).width()+this.horizontalPadding,i=n>0?Math.max(this.minWidth,this.maxWidth-n):this.maxWidth;this.element.width(i),this.$_grid.width(i),this._setInitialHeight(),e=this.$_grid.find(".repository-browser-tree-header"),this.$_tree.height(this.$_grid.height()-e.outerHeight(!0)),t=this.$_grid.find(".ui-layout-center"),t.find(".ui-jqgrid-bdiv").height(this.$_grid.height()-(t.find(".ui-jqgrid-titlebar").height()+t.find(".ui-jqgrid-hdiv").height()+t.find(".ui-jqgrid-pager").height())),this._adaptPageSize()&&this._currentFolder&&this._fetchItems(this._currentFolder)},_preloadImages:function(){for(var e=this.rootPath+"img/",t=["arrow-000-medium.png","arrow-180.png","arrow-315-medium.png","arrow-stop-180.png","arrow-stop.png","arrow.png","control-stop-square-small.png","folder-horizontal-open.png","folder-open.png","magnifier-left.png","page.png","picture.png","sort-alphabet-descending.png","sort-alphabet.png"],n=t.length;n;){var i=document.createElement("img");i.src=e+t[--n]}},_processRepoResponse:function(e,t,n){"function"==typeof t&&(n=t,t=void 0);var i,a,r=this,o=[],l=r._currentFolder&&r._currentFolder.id,d=null;for(a=0;a<e.length;a++)i=c(e[a],r),o.push(i),s(r,i.resource),l===i.resource.id&&(d=i.resource);n(o,t),d&&window.setTimeout(function(){r.$_tree.jstree("select_node",'li[data-repo-obj="'+d.uid+'"]')},0)},_fetchRepoRoot:function(e){this._currentFolder||(this._currentFolder=this.getSelectedFolder()),this.repositoryManager&&this.getRepoChildren({inFolderId:this.rootFolderId,repositoryFilter:this.repositoryFilter},e)},_getObjectFromCache:function(e){if(e&&e.length){var t=e.find("a:first").attr("data-repo-obj");return this._cachedRepositoryObjects[t]}return null},_onTreeNodeSelected:function(e,t){if(!t.args[0].context){var n=this,i=l(n,d(t.rslt.obj));i&&(n._pagingOffset=0,n._currentFolder=i,n._clearSearch(),n._fetchItems(i),n.folderSelected(i))}},_createTree:function(t){var n=u('<div class="repository-browser-tree">'),i=u('<div class="repository-browser-tree-header repository-browser-grab-handle">'+this._i18n("Repository Browser")+"</div>");t.append(i,n),n.height(this.$_grid.height()-i.outerHeight(!0)),n.bind("loaded.jstree",function(){e(this).find(">ul>li:first").css("padding-top",5),e(this).find('li[rel="repository"]:first').each(function(e,t){n.jstree("open_node",t)})});var a=this;return n.bind("select_node.jstree",function(e,t){a._onTreeNodeSelected(e,t)}),n.bind("open_node.jstree",function(e,t){a.folderOpened(t.rslt.obj)}),n.bind("close_node.jstree",function(e,t){a.folderClosed(t.rslt.obj)}),n.jstree({types:this.types,rootFolderId:this.rootFolderId,plugins:["themes","json_data","ui","types"],core:{animation:250},themes:{url:this.rootPath+"css/jstree.css",dots:!0,icons:!0,theme:"browser"},json_data:{data:function(e,t){a.repositoryManager?(a.jstree_callback=t,a._fetchSubnodes(e,t)):t()},correct_state:!0},ui:{select_limit:1}}),n},_createGrid:function(e){var t=u('<div class="repository-browser-grid				             repository-browser-shadow							 repository-browser-rounded-top">					<div class="ui-layout-west"></div>					<div class="ui-layout-center"></div>				</div>');return e.append(t),t},_createList:function(e){var t=u('<table id="repository-browser-list-'+ ++f+'" class="repository-browser-list"></table>'),n=[{name:"id",sorttype:"int",firstsortorder:"asc",hidden:!0}],i=[""];u.each(this.columns,function(e,t){i.push(t.title||"&nbsp;"),n.push({name:e,width:t.width,sortable:t.sortable,sorttype:t.sorttype,resizable:t.resizable,fixed:t.fixed})});var a="repository-browser-list-page-"+ ++f;e.append(t,u('<div id="'+a+'">')),t.jqGrid({datatype:"local",width:e.width(),shrinkToFit:!0,colNames:i,colModel:n,caption:"&nbsp;",altRows:!0,altclass:"repository-browser-list-altrow",resizeclass:"repository-browser-list-resizable",pager:"#"+a,viewrecords:!0,onPaging:function(){},loadError:function(){},ondblClickRow:function(){},gridComplete:function(){},loadComplete:function(){}}),e.find(".ui-jqgrid-bdiv").height(this.$_grid.height()-(e.find(".ui-jqgrid-titlebar").height()+e.find(".ui-jqgrid-hdiv").height()+e.find(".ui-jqgrid-pager").height()));var r=this;t.click(function(){r.rowClicked.apply(r,arguments)}),e.find(".ui-pg-button").unbind().find(">span.ui-icon").each(function(){var e=this.className.match(/ui\-icon\-seek\-([a-z]+)/)[1];r._pagingBtns[e]=u(this).parent().addClass("ui-state-disabled").click(function(){u(this).hasClass("ui-state-disabled")||r._doPaging(e)})}),e.find(".ui-pg-input").parent().hide(),e.find(".ui-separator").parent().css("opacity",0).first().hide(),this._createTitlebar(e);var o=t[0].p;return e.find(".ui-jqgrid-view tr:first th div").each(function(e){!1!==o.colModel[e].sortable&&(u(this).css("cursor","pointer"),u(this).unbind().click(function(t){t.stopPropagation(),r._sortList(o.colModel[e],this)}))}),t},_clearSearch:function(){var e=this.$_grid.find(".repository-browser-search-field");e.val(this._prefilledValue).addClass("repository-browser-search-field-empty"),this._searchQuery=null},_createTitlebar:function(e){var t=e.find(".ui-jqgrid-titlebar"),n=u('<div class="repository-browser-btns">					<input type="text" class="repository-browser-search-field" />					<span class="repository-browser-btn repository-browser-search-btn">						<span class="repository-browser-search-icon"></span>					</span>					<span class="repository-browser-btn repository-browser-close-btn">'+this._i18n("Close")+'</span>					<div class="repository-browser-clear"></div>				</div>'),i=this;t.addClass("repository-browser-grab-handle").append(n),t.find(".repository-browser-search-btn").html(this._i18n("Search")).click(function(){i._triggerSearch()});var a=t.find(".repository-browser-search-field");this._clearSearch(),a.keypress(function(e){13===e.keyCode&&i._triggerSearch()}),a.focus(function(){u(this).val()===i._prefilledValue&&u(this).val("").removeClass("repository-browser-search-field-empty")}),a.blur(function(){""===u(this).val()&&i._clearSearch()}),t.find(".repository-browser-close-btn").click(function(){i.close()}),t.find(".repository-browser-btn").mousedown(function(){u(this).addClass("repository-browser-pressed")}).mouseup(function(){u(this).removeClass("repository-browser-pressed")})},_triggerSearch:function(){var e=this.$_grid.find("input.repository-browser-search-field"),t=e.val();(u(e).hasClass("aloha-browser-search-field-empty")||""===t)&&(t=null),this._pagingOffset=0,this._searchQuery=t,this._fetchItems(this._currentFolder)},_sortList:function(e,t){this.$_grid.find("span.ui-grid-ico-sort").addClass("ui-state-disabled"),e.sortorder="asc"===e.sortorder?"desc":"asc",u(t).find("span.s-ico").show().find(".ui-icon-"+e.sortorder).removeClass("ui-state-disabled"),this._setSortOrder(e.name,e.sortorder),this._fetchItems(this._currentFolder)},_doPaging:function(e){switch(e){case"first":this._pagingOffset=0;break;case"end":this._pagingOffset=this._pagingCount%this.pageSize===0?this._pagingCount-this.pageSize:this._pagingCount-this._pagingCount%this.pageSize;break;case"next":this._pagingOffset+=this.pageSize;break;case"prev":this._pagingOffset-=this.pageSize,this._pagingOffset<0&&(this._pagingOffset=0)}this._fetchItems(this._currentFolder)},_setSortOrder:function(e,t){var n,i,a,r={},o=!1,s=this._orderBy||[];for(r[e]=t||"asc",a=0;a<s.length;++a){n=s[a];for(i in n)if(n.hasOwnProperty(i)&&i===e){s.splice(a,1),s.unshift(r),o=!0;break}if(o)break}o&&s.unshift(r),this._orderBy=s},_listItems:function(e){var t,n,i=this.$_list.clearGridData();
for(t=0;t<e.length;t++)n=e[t].resource,i.addRowData(n.uid,u.extend({id:n.id},this.renderRowCols(n)))},handleTimeout:function(){},_processItems:function(e,t){this._pagingCount=t&&u.isNumeric(t.numItems)?t.numItems:null,this.$_grid.find(".loading").hide(),this.$_list.show(),this._listItems(e);var n="ui-state-disabled",i=this._pagingBtns;this._pagingOffset<=0?i.first.add(i.prev).addClass(n):i.first.add(i.prev).removeClass(n),u.isNumeric(this._pagingCount)?this._pagingOffset+this.pageSize>=this._pagingCount?i.end.add(i.next).addClass(n):i.end.add(i.next).removeClass(n):(i.end.addClass(n),e.length<=this.pageSize?i.next.addClass(n):i.next.removeClass(n));var a,r;0===e.length&&0===this._pagingOffset?(a=0,r=0):(a=this._pagingOffset+1,r=a+e.length-1),this.$_grid.find(".ui-paging-info").html(this._i18n("Viewing")+" "+a+" - "+r+" "+this._i18n("of")+" "+(u.isNumeric(this._pagingCount)?this._pagingCount:this._i18n("numerous"))),t&&t.timeout&&this.handleTimeout()},_createOverlay:function(){0===u(".repository-browser-modal-overlay").length&&u("body").append('<div class="repository-browser-modal-overlay" style="top: -99999px; z-index: 99999;"></div>');var e=this;u(".repository-browser-modal-overlay").click(function(){e.close()});var t=u('<div class="repository-browser-modal-window" style="top: -99999px; z-index: 99999;">');return u("body").append(t),t},_fetchSubnodes:function(e,t){if(-1===e)this._fetchRepoRoot(t);else{var n;for(n=0;n<e.length;n++){var i=this._getObjectFromCache(e.eq(n));i&&this.fetchChildren(i,t)}}},getRepoChildren:function(e,t){if(this.repositoryManager){var n=this;this.repositoryManager.getChildren(e,function(e){n._processRepoResponse(e,t)})}},queryRepository:function(e,t){if(this.repositoryManager){var n=this;this.repositoryManager.query(e,function(e){n._processRepoResponse(e.results>0?e.items:[],{numItems:e.numItems,hasMoreItems:e.hasMoreItems,timeout:e.timeout},t)})}},renderRowCols:function(e){var t={};return u.each(this.columns,function(n){switch(n){case"icon":t.icon='<div class="repository-browser-icon repository-browser-icon-'+e.type+'"></div>';break;default:t[n]=e[n]||"--"}}),t},onSelect:function(){},fetchChildren:function(e,t){if((!0===e.hasMoreItems||"folder"===e.baseType)&&!1===e.loaded){var n=this;this.getRepoChildren({inFolderId:e.id,repositoryId:e.repositoryId},function(i){n._cachedRepositoryObjects[e.uid].loaded=!0,"function"==typeof t&&t(i)})}},rowClicked:function(e){var t=u(e.target).parent("tr");if(t.length){var n=t.attr("id"),i=this._cachedRepositoryObjects[n];return this.onSelect(i),i}return null},getFieldOfHeader:function(e){return e.find("div.ui-jqgrid-sortable").attr("id").replace("jqgh_","")},_fetchItems:function(e){if(e){var t="string"==typeof this._searchQuery;this.$_list.setCaption("string"==typeof this._searchQuery?this._i18n("Searching for")+' "'+this._searchQuery+'" '+this._i18n("in")+" "+e.name:this._i18n("Browsing")+": "+e.name),this.$_list.hide(),this.$_grid.find(".loading").show();var n=this;this.queryRepository({repositoryId:e.repositoryId,inFolderId:e.id,queryString:this._searchQuery,orderBy:this._orderBy,skipCount:this._pagingOffset,maxItems:this.pageSize,objectTypeFilter:this.objectTypeFilter,renditionFilter:this.renditionFilter,filter:this.filter,recursive:t},function(e,t){n._processItems(e,t)})}},setObjectTypeFilter:function(e){this.objectTypeFilter="string"==typeof e?[e]:e},getObjectTypeFilter:function(){return this.objectTypeFilter},show:function(){this.open()},open:function(){if(!this._isOpened){this._isOpened=!0;var e=this.element;if(this.isFloating){u(".repository-browser-modal-overlay").stop().css({top:0,left:0}).show(),e.stop().show(),this._onWindowResized(),this.$_grid.resize();{u(window)}e.css({left:this.horizontalPadding/2,top:this.verticalPadding/2}).draggable({handle:e.find(".repository-browser-grab-handle")}),this.$_grid.css({marginTop:0,opacity:0}).animate({marginTop:0,opacity:1},1500,"easeOutExpo",function(){Aloha.browser.msie&&u(this).add(e).css("filter","progid:DXImageTransform.Microsoft.gradient(enabled=false)")})}else e.stop().show().css({opacity:1,filter:"progid:DXImageTransform.Microsoft.gradient(enabled=false)"}),this._onWindowResized(),this.$_grid.resize();++p}},close:function(){this._isOpened&&(this._isOpened=!1,this.element.fadeOut(250,function(){u(this).css("top",0).hide(),(0===p||0===--p)&&u(".repository-browser-modal-overlay").hide()}))},refresh:function(){this._currentFolder&&this._fetchItems(this._currentFolder)},folderOpened:function(e){var t=this,n=l(t,d(e));n&&t.repositoryManager.folderOpened(n)},folderClosed:function(e){var t=this._getObjectFromCache(e);t&&this.repositoryManager&&this.repositoryManager.folderClosed(t)},folderSelected:function(e){this.repositoryManager&&this.repositoryManager.folderSelected(e)},getSelectedFolder:function(){return this.repositoryManager&&"function"==typeof this.repositoryManager.getSelectedFolder?this.repositoryManager.getSelectedFolder():void 0},_adaptPageSize:function(){var e,t,n;return this.adaptPageSize&&this.$_list&&this.rowHeight?(n=this.$_grid.find(".ui-jqgrid-bdiv"),e=n.innerHeight()-20,e?(t=Math.floor(e/this.rowHeight),0>=t&&(t=1),t!==this.pageSize?(this.pageSize=t,!0):!1):!1):!1}});return m}),define("repository-browser-i18n-de",[],function(){return{Browsing:"Durchsuchen",Close:"Schließen","in":"in","Input search text...":"Suchtext einfügen...",numerous:"zahlreiche",of:"von","Repository Browser":"Repository Browser",Search:"Suchen","Searching for":"Suche nach",Viewing:"Anzeige","button.switch-metaview.tooltip":"Zwischen Metaansicht und normaler Ansicht umschalten"}}),define("repository-browser-i18n-en",[],function(){return{Browsing:"Browsing",Close:"Close","in":"in","Input search text...":"Input search text...",numerous:"numerous",of:"of","Repository Browser":"Repository Browser",Search:"Search","Searching for":"Searching for",Viewing:"Viewing","button.switch-metaview.tooltip":"Switch between meta and normal view"}}),define("linkbrowser/nls/i18n",{root:{"button.addlink.tooltip":"Insert Link","button.removelink.tooltip":"Remove Link","newlink.defaulttext":"New Link","floatingmenu.tab.link":"Link"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("linkbrowser/linkbrowser-plugin",["aloha","jquery","aloha/plugin","aloha/pluginmanager","ui/ui","ui/button","link/link-plugin","RepositoryBrowser","i18n!linkbrowser/nls/i18n","i18n!aloha/nls/i18n"],function(e,t,n,i,a,r,o,s,l){var d=s.extend({init:function(t){this._super(t);var n=this;this._linkBrowserButton=a.adopt("linkBrowser",r,{tooltip:l.t("button.addlink.tooltip"),icon:"aloha-icon-tree",scope:"Aloha.continuoustext",click:function(){n.show()}}),this._linkBrowserButton.hide(),this.url=e.getAlohaUrl()+"/../plugins/extra/linkbrowser/",e.bind("aloha-link-selected",function(){n._linkBrowserButton.show()}),e.bind("aloha-link-unselected",function(){n._linkBrowserButton.hide()})},onSelect:function(t){o.hrefField.setItem(t);var n=e.Selection.getRangeObject(),i=n.startContainer=n.endContainer,a=n.startOffset=n.endOffset;n.select(),n.startContainer=n.endContainer=i,n.startOffset=n.endOffset=a,n.select(),e.trigger("aloha-link-selected-in-linkbrowser",t),this.close()},renderRowCols:function(e){{var n={},i=this.url,a="__page__";e.id.match(/(\d+)\./)}return t.each(this.columns,function(t){switch(t){case"icon":n.icon='<div class="aloha-browser-icon						aloha-browser-icon-'+a+'"></div>';break;case"translations":if(!e.renditions)break;for(var r,o=e.renditions,s=o.length,l=[];s>0;--s)r=o[s],"translation"==r.kind&&l.push('<img src="'+i+"img/flags/"+r.language+'.png"									  alt="'+r.language+'"									  title="'+r.filename+'" />');n.translations=l.join("");break;case"language":n.language=e.language;break;default:n[t]=e[t]||"--"}}),n}}),c=n.create("linkbrowser",{dependencies:["link"],browser:null,init:function(){var t={repositoryManager:e.RepositoryManager,repositoryFilter:[],objectTypeFilter:["website","file","image","language"],renditionFilter:["*"],filter:["language"],columns:{icon:{title:"",width:30,sortable:!1,resizable:!1},name:{title:"Name",width:320,sorttype:"text"},language:{title:"",width:30,sorttype:"text"},translations:{title:"",width:350,sorttype:"text"}},rootPath:e.settings.baseUrl+"/vendor/repository-browser/"};this.browser=new d(t)}});return c}),define("imagebrowser/nls/i18n",{root:{"button.addimage.tooltip":"Insert Image","button.removeimage.tooltip":"Remove Image","newimage.defaulttext":"New Image","floatingmenu.tab.img":"Image"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("imagebrowser/imagebrowser-plugin",["aloha","jquery","aloha/plugin","aloha/pluginmanager","ui/ui","ui/button","image/image-plugin","RepositoryBrowser","i18n!imagebrowser/nls/i18n","i18n!aloha/nls/i18n"],function(e,t,n,i,a,r,o,s,l){var d=s.extend({init:function(t){this._super(t);var n=this;this._imageBrowserButton=a.adopt("imageBrowser",r,{tooltip:l.t("button.addimage.tooltip"),icon:"aloha-icon-tree",scope:"Aloha.continuoustext","class":"aloha-imagebrowser-button",click:function(){n.open()}}),this._imageBrowserButton.show(!1),this.url=e.getAlohaUrl()+"/../plugins/extra/imagebrowser/",e.bind("aloha-image-selected",function(){n._imageBrowserButton.show(!0)}),e.bind("aloha-image-unselected",function(){n._imageBrowserButton.show(!1)})},onSelect:function(e){null!==e.type.match("image")&&(o.ui.imgSrcField.setItem(e),o.resetSize(),this.close())},listItems:function(e){var n=this,i=this.list.clearGridData();t.each(e,function(){var e=this.resource;null!==e.type.match("image")&&i.addRowData(e.uid,t.extend({id:e.id},n.renderRowCols(e)))})},renderRowCols:function(e){{var n={};this.url,e.id.match(/(\d+)\./)}return t.each(this.columns,function(t){switch(t){case"icon":if(!e.renditions)break;1===e.renditions.length&&"thumbnail"===e.renditions[0].kind&&(n.icon='<img width="'+e.renditions[0].width+'" height="'+e.renditions[0].height+' " src="'+e.renditions[0].url+'"/>');break;default:n[t]=e[t]||"--"}}),n}}),c=n.create("imagebrowser",{dependencies:["image"],browser:null,init:function(){var t={repositoryManager:e.RepositoryManager,repositoryFilter:[],objectTypeFilter:["image"],renditionFilter:["*"],filter:["language"],columns:{icon:{title:"",width:75,sortable:!1,resizable:!1},name:{title:"Name",width:320,sorttype:"text"}},rootPath:e.settings.baseUrl+"/vendor/repository-browser/"};this.browser=new d(t)}});return c}),define("ribbon/ribbon-plugin",["jquery","aloha/plugin","ui/menuButton","ui/utils","jqueryui"],function(e,t,n,i){var a=t.create("ribbon",{init:function(){if(this.settings.enable||"undefined"==typeof this.settings.enable){var t=this;this._visible=!1,this._toolbar=e("<div>",{"class":"aloha-ribbon-toolbar ui-menubar ui-widget-header ui-helper-clearfix"});var n=i.makeButtonElement({"class":"aloha-ribbon-in"}).button().hide().click(function(){t._toolbar.animate({left:0}),e("body").animate({paddingTop:30}),n.hide()}).appendTo(this._toolbar),a=(i.makeButtonElement({"class":"aloha-ribbon-out"}).button().click(function(){t._toolbar.animate({left:-t._toolbar.outerWidth()+n.outerWidth()+10}),e("body").animate({paddingTop:0}),n.show()}).appendTo(this._toolbar),e("<div>",{"class":"aloha aloha-ribbon"}).appendTo("body"));this._icon=e("<div>").prependTo(this._toolbar),this.setIcon(""),this._toolbar.appendTo(a),e("body").css({position:"relative",paddingTop:30})}},setIcon:function(e){this._icon&&this._icon.attr("class","aloha-ribbon-icon "+e)},addButton:function(t){this._toolbar&&(t=e.extend({},t,{siblingContainer:this._toolbar}),this._toolbar.append(n.makeMenuButton(t)))},hide:function(){this._toolbar&&(this._toolbar.hide(),this._visible=!1)},show:function(){this._toolbar&&(this._toolbar.show(),this._visible=!0)},isVisible:function(){return this._visible}});return a}),define("wai-lang/nls/i18n",{root:{"floatingmenu.tab.wai-lang":"Language annotation","button.add-wai-lang-remove.tooltip":"Remove language annotation","button.add-wai-lang.tooltip":"Add language annotation"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("wai-lang/../../../shared/languages/./iso639-1-de",[],function(){var e={aa:{name:"Afar"},ab:{name:"Abchasen"},af:{name:"Afrikaans"},ak:{name:"Akan"},sq:{name:"Albanisch"},am:{name:"Amharisch"},ar:{name:"Arabisch",flag:"ae"},an:{name:"Aragonesisch"},hy:{name:"Armenisch"},as:{name:"Assamesisch"},av:{name:"Avarisch"},ae:{name:"Avestan"},ay:{name:"Aymara"},az:{name:"Aserbaidschanisch"},ba:{name:"Baschkirisch"},bm:{name:"Bambara"},eu:{name:"Baskisch"},be:{name:"Weißrussisch",flag:"by"},bn:{name:"Bengalisch"},bh:{name:"Bihari Sprachen"},bi:{name:"Bislama"},bs:{name:"Bosnisch"},br:{name:"Bretonisch"},bg:{name:"Bulgarisch",flag:"bg"},my:{name:"Birmanisch"},ca:{name:"Katalanisch, Valencia",flag:"es"},ch:{name:"Chamorro"},ce:{name:"Tschetschenisch"},zh:{name:"Chinesisch"},cu:{name:"Kirchenslawisch; Altslawisch; Altbulgarisch; Altkirchenslawisch"},cv:{name:"Tschuwaschische Sprache"},kw:{name:"Cornish"},co:{name:"Korsisch"},cr:{name:"Cree"},cs:{name:"Tschechisch"},da:{name:"Dänisch",flag:"dk"},dv:{name:"Divehi; Dhivehi; maledivische"},nl:{name:"Niederländisch, Flämisch"},dz:{name:"Dzongkha"},en:{name:"Englisch",flag:"gb"},eo:{name:"Esperanto"},et:{name:"Estnisch",flag:"ee"},ee:{name:"Ewe"},fo:{name:"Färöisch"},fj:{name:"Fidschi"},fi:{name:"Finnisch",flag:"fi"},fr:{name:"Französisch"},fy:{name:"Westfriesisch"},ff:{name:"Fulah"},ka:{name:"Georgisch"},de:{name:"Deutsch",flag:"de"},gd:{name:"Gälisch, Schottisch-Gälisch"},ga:{name:"Irisch",flag:"ie"},gl:{name:"Galizisch"},gv:{name:"Manx"},el:{name:"Griechisch, Modern (1453 -)"},gn:{name:"Guarani"},gu:{name:"Gujarati"},ht:{name:"Haitianisch"},ha:{name:"Hausa"},he:{name:"Hebräisch",flag:"il"},hz:{name:"Herero"},hi:{name:"Hindi",flag:"in"},ho:{name:"Hiri Motu"},hr:{name:"Kroatisch",flag:"hr"},hu:{name:"Ungarisch",flag:"hu"},ig:{name:"Igbo"},is:{name:"Isländisch"},io:{name:"Ido"},ii:{name:"Sichuan Yi; Nuosu"},iu:{name:"Inuktitut"},ie:{name:"Interlingue; Okzidental"},ia:{name:"Interlingua (International Auxiliary Language Association)"},id:{name:"Indonesisch",flag:"id"},ik:{name:"Inupiaq"},it:{name:"Italienisch",flag:"it"},jv:{name:"Javaner"},ja:{name:"Japanisch",flag:"jp"},kl:{name:"Kalaallisut; Grönländisch"},kn:{name:"Kannada"},ks:{name:"Kashmiri"},kr:{name:"Kanuri"},kk:{name:"Kasachisch"},km:{name:"Mittel-Khmer"},ki:{name:"Kikuyu; Gikuyu"},rw:{name:"Kinyarwanda"},ky:{name:"Kirgisisch"},kv:{name:"Komi"},kg:{name:"Kongo"},ko:{name:"Koreanisch",flag:"kr"},kj:{name:"Kuanyama; Kwanyama"},ku:{name:"Kurdisch"},lo:{name:"Lao"},la:{name:"Latein"},lv:{name:"Lettisch",flag:"lv"},li:{name:"Limburgisch"},ln:{name:"Lingála"},lt:{name:"Litauisch",flag:"lt"},lb:{name:"Luxemburgisch, Lëtzebuergesch"},lu:{name:"Luba-Katanga"},lg:{name:"Ganda"},mk:{name:"Mazedonisch"},mh:{name:"Marshallese"},ml:{name:"Malayalam"},mi:{name:"Maori"},mr:{name:"Marathi"},ms:{name:"Malaiisch"},mg:{name:"Malagasy"},mt:{name:"Maltesisch",flag:"mt"},mn:{name:"Mongolisch"},na:{name:"Nauru"},nv:{name:"Navajo; Navaho"},nr:{name:"Ndebele, Süd, Süd-Ndebele"},nd:{name:"Ndebele, Nord, Nord-Ndebele"},ng:{name:"Ndonga"},ne:{name:"Nepali"},nn:{name:"Norwegisch Nynorsk"},nb:{name:"Bokmål, Norwegisch, Norwegisch Bokmål"},no:{name:"Norwegisch",flag:"no"},ny:{name:"Chichewa; Chewa; Nyanja"},oc:{name:"Occitan (post 1500); provenzalischen"},oj:{name:"Ojibwa"},or:{name:"Oriya"},om:{name:"Oromo"},os:{name:"Ossetisch"},pa:{name:"Panjabi, Punjabi"},fa:{name:"Persisch"},pi:{name:"Pali"},pl:{name:"Polnisch",flag:"pl"},pt:{name:"Portugiesisch",flag:"pt"},ps:{name:"Paschtu, Paschtu"},qu:{name:"Quechua"},rm:{name:"Rätoromanisch"},ro:{name:"Rumänisch; Moldawisch; Moldauisch"},rn:{name:"Rundi"},ru:{name:"Russisch",flag:"ru"},sg:{name:"Sango"},sa:{name:"Sanskrit"},si:{name:"Singhalesisch"},sk:{name:"Slowakisch"},sl:{name:"Slowenisch",flag:"si"},se:{name:"Nord Sami"},sm:{name:"Samoaner"},sn:{name:"Shona"},sd:{name:"Sindhi"},so:{name:"Somali"},st:{name:"Sotho, Südlich"},es:{name:"Spanisch, Kastilisch",flag:"es"},sc:{name:"Sardisch"},sr:{name:"Serbisch",flag:"rs"},ss:{name:"Swati"},su:{name:"Sundanesisch"},sw:{name:"Swahili"},sv:{name:"Schwedisch",flag:"se"},ty:{name:"Tahitianisch"},ta:{name:"Tamilisch"},tt:{name:"Tatar"},te:{name:"Telugu"},tg:{name:"Tadschikisch"},tl:{name:"Tagalog"},th:{name:"Thailändisch",flag:"th"},bo:{name:"Tibetisch"},ti:{name:"Tigrinya"},to:{name:"Tonga (Tonga-Inseln)"},tn:{name:"Tswana"},ts:{name:"Tsonga"},tk:{name:"Turkmenisch"},tr:{name:"Türkisch",flag:"tr"},tw:{name:"Twi"},ug:{name:"Uigurisch"},uk:{name:"Ukrainisch",flag:"ua"},ur:{name:"Urdu"},uz:{name:"Usbekisch"},ve:{name:"Venda"},vi:{name:"Vietnamesisch",flag:"vn"},vo:{name:"Volapük"},cy:{name:"Walisisch"},wa:{name:"Wallonisch"},wo:{name:"Wolof"},xh:{name:"Xhosa"},yi:{name:"Jiddisch"},yo:{name:"Yoruba"},za:{name:"Zhuang; Chuang"},zu:{name:"Zulu"}};return e}),define("wai-lang/../../../shared/languages/./iso639-2-de",[],function(){var e={aar:{name:"Afar"},abk:{name:"Abchasen"},ace:{name:"Achinese"},ach:{name:"Acholi"},ada:{name:"Adangme"},ady:{name:"Adyghe; Adygei"},afa:{name:"Afro-Asiatische Sprachen"},afh:{name:"Afrihili"},afr:{name:"Afrikaans"},ain:{name:"Ainu"},aka:{name:"Akan"},akk:{name:"Akkadisch"},alb:{name:"Albanisch"},sqi:{name:"Albanisch",flag:"al"},ale:{name:"Aleutisch"},alg:{name:"Algonkin-Sprachen"},alt:{name:"Südaltai"},amh:{name:"Amharisch"},ang:{name:"Englisch, Alt (ca.450-1100)"},anp:{name:"Angika"},apa:{name:"Apache Sprachen"},ara:{name:"Arabisch",flag:"ae"},arc:{name:"Offizielles Aramäisch (700-300 v. Chr.); Reichsaramäisch (700-300 v. Chr.)"},arg:{name:"Aragonesisch"},arm:{name:"Armenisch"},hye:{name:"Armenisch"},arn:{name:"Mapudungun; Mapuche"},arp:{name:"Arapaho"},art:{name:"Künstliche Sprachen"},arw:{name:"Arawak"},asm:{name:"Assamesisch"},ast:{name:"Asturisch"},ath:{name:"Athapascan Sprachen"},aus:{name:"Australische Sprachen"},ava:{name:"Avarisch"},ave:{name:"Avestan"},awa:{name:"Awadhi"},aym:{name:"Aymara"},aze:{name:"Aserbaidschanisch"},bad:{name:"Banda Sprachen"},bai:{name:"Bamileke Sprachen"},bak:{name:"Baschkirisch"},bal:{name:"Baluchi"},bam:{name:"Bambara"},ban:{name:"Balinesisch"},baq:{name:"Baskisch"},eus:{name:"Baskisch"},bas:{name:"Basa"},bat:{name:"Baltische Sprachen"},bej:{name:"Beja; Bedawiyet"},bel:{name:"Weißrussisch",flag:"by"},bem:{name:"Bemba"},ben:{name:"Bengalisch"},ber:{name:"Berbersprachen"},bho:{name:"Bhojpuri"},bih:{name:"Bihari Sprachen"},bik:{name:"Bikol"},bin:{name:"Bini, Edo"},bis:{name:"Bislama"},bla:{name:"Siksika"},bnt:{name:"Bantusprachen"},bos:{name:"Bosnisch"},bra:{name:"Braj"},bre:{name:"Bretonisch"},btk:{name:"Batak Sprachen"},bua:{name:"Buriatisch"},bug:{name:"Buginesisch"},bul:{name:"Bulgarisch",flag:"bg"},bur:{name:"Birmanisch"},mya:{name:"Birmanisch"},byn:{name:"Blin; Bilin"},cad:{name:"Caddo"},cai:{name:"Zentralamerikanische indische Sprachen"},car:{name:"Galibi Carib"},cat:{name:"Katalanisch, Valencia",flag:"es"},cau:{name:"Kaukasische Sprachen"},ceb:{name:"Cebuano"},cel:{name:"Keltische Sprachen"},cha:{name:"Chamorro"},chb:{name:"Chibcha"},che:{name:"Tschetschenisch"},chg:{name:"Dschag."},chi:{name:"Chinesisch"},zho:{name:"Chinesisch",flag:"cn"},chk:{name:"Chuukese"},chm:{name:"Mari"},chn:{name:"Chinook-Jargon"},cho:{name:"Choctaw"},chp:{name:"Chipewyan; Dene Suline"},chr:{name:"Cherokee"},chu:{name:"Kirchenslawisch; Altslawisch; Altbulgarisch; Altkirchenslawisch"},chv:{name:"Tschuwaschische Sprache"},chy:{name:"Cheyenne"},cmc:{name:"Chamic Sprachen"},cop:{name:"Koptisch"},cor:{name:"Cornish"},cos:{name:"Korsisch"},cpe:{name:"Kreolsprachen, englisch-basiert"},cpf:{name:"Kreolsprachen, französisch-basiert"},cpp:{name:"Kreolsprachen, portugiesisch-basiert"},cre:{name:"Cree"},crh:{name:"Krimtatarisch; Krim-türkisch"},crp:{name:"Kreolsprachen"},csb:{name:"Kaschubisch"},cus:{name:"Kuschitische Sprachen"},cze:{name:"Tschechisch"},ces:{name:"Tschechisch",flag:"cz"},dak:{name:"Dakota"},dan:{name:"Dänisch",flag:"dk"},dar:{name:"Dargwa"},day:{name:"Land Dayak Sprachen"},del:{name:"Delaware"},den:{name:"Slave (Athapascan)"},dgr:{name:"Dogrib"},din:{name:"Dinka"},div:{name:"Divehi; Dhivehi; maledivische"},doi:{name:"Dogri"},dra:{name:"Dravidische Sprachen"},dsb:{name:"Niedersorbisch"},dua:{name:"Duala"},dum:{name:"Niederländisch, Mittel (ca.1050-1350)"},dut:{name:"Niederländisch, Flämisch"},nld:{name:"Niederländisch, Flämisch",flag:"nl"},dyu:{name:"Dyula"},dzo:{name:"Dzongkha"},efi:{name:"Efik"},egy:{name:"Ägyptisch (Altertümlich)"},eka:{name:"Ekajuk"},elx:{name:"Elamite"},eng:{name:"Englisch",flag:"gb"},enm:{name:"Englisch, Mittle (1100-1500)"},epo:{name:"Esperanto"},est:{name:"Estnisch",flag:"ee"},ewe:{name:"Ewe"},ewo:{name:"Ewondo"},fan:{name:"Fang"},fao:{name:"Färöisch"},fat:{name:"Fanti"},fij:{name:"Fidschi"},fil:{name:"Filipinisch"},fin:{name:"Finnisch",flag:"fi"},fiu:{name:"Finno-ugrischen Sprachen"},fon:{name:"Fon"},fre:{name:"Französisch"},fra:{name:"Französisch",flag:"fr"},frm:{name:"Französisch, Mittel (ca.1400-1600)"},fro:{name:"Französisch, Alt (842-ca.1400)"},frr:{name:"Nordfriesisch"},frs:{name:"Ostfriesisch"},fry:{name:"Westfriesisch"},ful:{name:"Fulah"},fur:{name:"Friaulisch"},gaa:{name:"Ga"},gay:{name:"Gayo"},gba:{name:"Gbaya"},gem:{name:"Germanische Sprachen"},geo:{name:"Georgisch"},kat:{name:"Georgisch"},ger:{name:"Deutsch",flag:"de"},deu:{name:"Deutsch",flag:"de"},gez:{name:"Geez"},gil:{name:"Gilbertesisch"},gla:{name:"Gälisch, Schottisch-Gälisch"},gle:{name:"Irisch",flag:"ie"},glg:{name:"Galizisch"},glv:{name:"Manx"},gmh:{name:"Deutsch, Mittlehoch (ca.1050-1500)"},goh:{name:"Deutsch, Althoch (ca.750-1050)"},gon:{name:"Gondi"},gor:{name:"Gorontalo"},got:{name:"Gotisch"},grb:{name:"Grebo"},grc:{name:"Altgriechisch (bis 1453)"},gre:{name:"Griechisch, Modern (1453 -)"},ell:{name:"Griechisch, Modern (1453 -)",flag:"gr"},grn:{name:"Guarani"},gsw:{name:"Schweizerdeutsch, Alemannisch, Elsässisch"},guj:{name:"Gujarati"},gwi:{name:"Gwich'in"},hai:{name:"Haida"},hat:{name:"Haitianisch"},hau:{name:"Hausa"},haw:{name:"Hawaii"},heb:{name:"Hebräisch",flag:"il"},her:{name:"Herero"},hil:{name:"Hiligaynon"},him:{name:"Himachali Sprachen; Pahari westliche Sprachen"},hin:{name:"Hindi",flag:"in"},hit:{name:"Hethitisch"},hmn:{name:"Hmong, Mong"},hmo:{name:"Hiri Motu"},hrv:{name:"Kroatisch",flag:"hr"},hsb:{name:"Obersorbisch"},hun:{name:"Ungarisch",flag:"hu"},hup:{name:"Hupa"},iba:{name:"Iban"},ibo:{name:"Igbo"},ice:{name:"Isländisch"},isl:{name:"Isländisch",flag:"is"},ido:{name:"Ido"},iii:{name:"Sichuan Yi; Nuosu"},ijo:{name:"Ijo Sprachen"},iku:{name:"Inuktitut"},ile:{name:"Interlingue; Okzidental"},ilo:{name:"Iloko"},ina:{name:"Interlingua (International Auxiliary Language Association)"},inc:{name:"Indische Sprachen"},ind:{name:"Indonesisch",flag:"id"},ine:{name:"Indoeuropäische Sprachen"},inh:{name:"Inguschisch"},ipk:{name:"Inupiaq"},ira:{name:"Iranische Sprachen"},iro:{name:"Irokesen Sprachen"},ita:{name:"Italienisch",flag:"it"},jav:{name:"Javaner"},jbo:{name:"Lojban"},jpn:{name:"Japanisch",flag:"jp"},jpr:{name:"Jüdisch-persisch"},jrb:{name:"Jüdisch-arabisch"},kaa:{name:"Kara-Kalpak"},kab:{name:"Kabyle"},kac:{name:"Kachin; Jingpho"},kal:{name:"Kalaallisut; Grönländisch"},kam:{name:"Kamba"},kan:{name:"Kannada"},kar:{name:"Karen Sprachen"},kas:{name:"Kashmiri"},kau:{name:"Kanuri"},kaw:{name:"Kawi"},kaz:{name:"Kasachisch"},kbd:{name:"Kabardinisch"},kha:{name:"Khasi"},khi:{name:"Khoisan-Sprache"},khm:{name:"Mittel-Khmer"},kho:{name:"Khotanesisch; Sakan"},kik:{name:"Kikuyu; Gikuyu"},kin:{name:"Kinyarwanda"},kir:{name:"Kirgisisch"},kmb:{name:"Kimbundu"},kok:{name:"Konkani"},kom:{name:"Komi"},kon:{name:"Kongo"},kor:{name:"Koreanisch",flag:"kr"},kos:{name:"Kosraeanisch"},kpe:{name:"Kpelle"},krc:{name:"Karatschai-Balkar"},krl:{name:"Karelisch"},kro:{name:"Kru Sprachen"},kru:{name:"Kurukh"},kua:{name:"Kuanyama; Kwanyama"},kum:{name:"Kumykisch"},kur:{name:"Kurdisch"},kut:{name:"Kutenai"},lad:{name:"Ladino"},lah:{name:"Lahnda"},lam:{name:"Lamba"},lao:{name:"Lao"},lat:{name:"Latein"},lav:{name:"Lettisch",flag:"lv"},lez:{name:"Lesgisch"},lim:{name:"Limburgisch"},lin:{name:"Lingála"},lit:{name:"Litauisch",flag:"lt"},lol:{name:"Mongo"},loz:{name:"Lozi"},ltz:{name:"Luxemburgisch, Lëtzebuergesch"},lua:{name:"Luba-Lulua"},lub:{name:"Luba-Katanga"},lug:{name:"Ganda"},lui:{name:"Luiseno"},lun:{name:"Lunda"},luo:{name:"Luo (Kenia und Tansania)"},lus:{name:"Lushai"},mac:{name:"Mazedonisch"},mkd:{name:"Mazedonisch",flag:"mk"},mad:{name:"Maduresisch"},mag:{name:"Magahi"},mah:{name:"Marshallese"},mai:{name:"Maithili"},mak:{name:"Makasar"},mal:{name:"Malayalam"},man:{name:"Mandingo"},mao:{name:"Maori"},mri:{name:"Maori"},map:{name:"Austronesische Sprachen"},mar:{name:"Marathi"},mas:{name:"Masai"},may:{name:"Malaiisch"},msa:{name:"Malaiisch",flag:"my"},mdf:{name:"Moksha"},mdr:{name:"Mandar"},men:{name:"Mende"},mga:{name:"Irisch, Mittel (900-1200)"},mic:{name:"Mi'kmaq; Micmac"},min:{name:"Minangkabau"},mis:{name:"Unkodierte Sprachen"},mkh:{name:"Mon-Khmer-Sprachen"},mlg:{name:"Malagasy"},mlt:{name:"Maltesisch",flag:"mt"},mnc:{name:"Manchu"},mni:{name:"Manipuri"},mno:{name:"Manobo Sprachen"},moh:{name:"Mohawk"},mon:{name:"Mongolisch"},mos:{name:"Mossi"},mul:{name:"Mehrere Sprachen"},mun:{name:"Munda-Sprachen"},mus:{name:"Bach"},mwl:{name:"Mirandesisch"},mwr:{name:"Marwari"},myn:{name:"Maya-Sprachen"},myv:{name:"Erzya"},nah:{name:"Nahuatl Sprachen"},nai:{name:"Nordamerikanische Indianer Sprachen"},nap:{name:"Neapolitanisch"},nau:{name:"Nauru"},nav:{name:"Navajo; Navaho"},nbl:{name:"Ndebele, Süd, Süd-Ndebele"},nde:{name:"Ndebele, Nord, Nord-Ndebele"},ndo:{name:"Ndonga"},nds:{name:"Plattdeutsch; Niedersächsisch, Deutsch"},nep:{name:"Nepali"},"new":{name:"Nepal Bhasa; Newari"},nia:{name:"Nias"},nic:{name:"Niger-Kordofanianische Sprachen"},niu:{name:"Niuean"},nno:{name:"Norwegisch Nynorsk"},nob:{name:"Bokmål, Norwegisch, Norwegisch Bokmål"},nog:{name:"Nogai"},non:{name:"Norwegisch, Alt"},nor:{name:"Norwegisch",flag:"no"},nqo:{name:"N'Ko"},nso:{name:"Pedi; Sepedi; Nord Sotho"},nub:{name:"Nubische Sprachen"},nwc:{name:"Klassische Newari; Alt Newari; Klassische Nepal Bhasa"},nya:{name:"Chichewa; Chewa; Nyanja"},nym:{name:"Nyamwezi"},nyn:{name:"Nyankole"},nyo:{name:"Nyoro"},nzi:{name:"Nzima"},oci:{name:"Occitan (post 1500); provenzalischen"},oji:{name:"Ojibwa"},ori:{name:"Oriya"},orm:{name:"Oromo"},osa:{name:"Osage"},oss:{name:"Ossetisch"},ota:{name:"Türkisch, osmanische (1500-1928)"},oto:{name:"Otomian Sprachen"},paa:{name:"Papua-Sprachen"},pag:{name:"Pangasinan"},pal:{name:"Pahlavi"},pam:{name:"Pampanga; Kapampangan"},pan:{name:"Panjabi, Punjabi"},pap:{name:"Papiamento"},pau:{name:"Palau"},peo:{name:"Persisch, Alt (ca.600-400 v. Chr.)"},per:{name:"Persisch"},fas:{name:"Persisch"},phi:{name:"Philippinische Sprachen"},phn:{name:"Phönizisch"},pli:{name:"Pali"},pol:{name:"Polnisch",flag:"pl"},pon:{name:"Pohnpeian"},por:{name:"Portugiesisch",flag:"pt"},pra:{name:"Prakrit Sprachen"},pro:{name:"Provençal, Alt (bis 1500)"},pus:{name:"Paschtu, Paschtu"},"qaa-qtz":{name:"Reserviert für den lokalen Gebrauch"},que:{name:"Quechua"},raj:{name:"Rajasthani"},rap:{name:"Rapanui"},rar:{name:"Rarotongan; Cook Islands Maori"},roa:{name:"Romanische Sprachen"},roh:{name:"Rätoromanisch"},rom:{name:"Roma"},rum:{name:"Rumänisch; Moldawisch; Moldauisch"},ron:{name:"Rumänisch; Moldawisch; Moldauisch",flag:"ro"},run:{name:"Rundi"},rup:{name:"Aromunischen; Arumanian; Macedo-Rumänischen"},rus:{name:"Russisch",flag:"ru"},sad:{name:"Sandawe"},sag:{name:"Sango"},sah:{name:"Yakut"},sai:{name:"Südamerikanische Indianer (Andere)"},sal:{name:"Salishan Sprachen"},sam:{name:"Samariter Aramäisch"},san:{name:"Sanskrit"},sas:{name:"Sasak"},sat:{name:"Santali"},scn:{name:"Sizilianisch"},sco:{name:"Schottisch"},sel:{name:"Selkupisch"},sem:{name:"Semitische Sprachen"},sga:{name:"Irisch, Alt (bis 900)"},sgn:{name:"Registrierte Sprachen"},shn:{name:"Shan"},sid:{name:"Sidamo"},sin:{name:"Singhalesisch"},sio:{name:"Sioux-Sprachen"},sit:{name:"Sino-tibetische Sprachen"},sla:{name:"Slawische Sprachen"},slo:{name:"Slowakisch"},slk:{name:"Slowakisch",flag:"sk"},slv:{name:"Slowenisch",flag:"si"},sma:{name:"Süd Sami"},sme:{name:"Nord Sami"},smi:{name:"Sami Sprachen"},smj:{name:"Lulesamisch"},smn:{name:"Inari-Samen"},smo:{name:"Samoaner"},sms:{name:"Skolt Sami"},sna:{name:"Shona"},snd:{name:"Sindhi"},snk:{name:"Soninke"},sog:{name:"Sogdisch"},som:{name:"Somali"},son:{name:"Songhai Sprachen"},sot:{name:"Sotho, Südlich"},spa:{name:"Spanisch, Kastilisch",flag:"es"},srd:{name:"Sardisch"},srn:{name:"Sranan Tongo"},srp:{name:"Serbisch",flag:"rs"},srr:{name:"Serer"},ssa:{name:"Nilosaharanische Sprachen"},ssw:{name:"Swati"},suk:{name:"Sukuma"},sun:{name:"Sundanesisch"},sus:{name:"Susu"},sux:{name:"Sumerisch"},swa:{name:"Swahili"},swe:{name:"Schwedisch",flag:"se"},syc:{name:"Klassisch Syrisch"},syr:{name:"Syrisch"},tah:{name:"Tahitianisch"},tai:{name:"Tai Sprachen"},tam:{name:"Tamilisch"},tat:{name:"Tatar"},tel:{name:"Telugu"},tem:{name:"Timne"},ter:{name:"Tereno"},tet:{name:"Tetum"},tgk:{name:"Tadschikisch"},tgl:{name:"Tagalog"},tha:{name:"Thailändisch",flag:"th"},tib:{name:"Tibetisch"},bod:{name:"Tibetisch"},tig:{name:"Tigre"},tir:{name:"Tigrinya"},tiv:{name:"Tiv"},tkl:{name:"Tokelau"},tlh:{name:"Klingonisch; tlhIngan-Hol"},tli:{name:"Tlingit"},tmh:{name:"Tamashek"},tog:{name:"Tonga (Nyasa)"},ton:{name:"Tonga (Tonga-Inseln)"},tpi:{name:"Tok Pisin"},tsi:{name:"Tsimshian"},tsn:{name:"Tswana"},tso:{name:"Tsonga"},tuk:{name:"Turkmenisch"},tum:{name:"Tumbuka"},tup:{name:"Tupi-Sprachen"},tur:{name:"Türkisch",flag:"tr"},tut:{name:"Altaische Sprachen"},tvl:{name:"Tuvalu"},twi:{name:"Twi"},tyv:{name:"Tuvinisch"},udm:{name:"Udmurtisch"},uga:{name:"Ugaritisch"},uig:{name:"Uigurisch"},ukr:{name:"Ukrainisch",flag:"ua"},umb:{name:"Umbundu"},und:{name:"Unbestimmt"},urd:{name:"Urdu"},uzb:{name:"Usbekisch"},vai:{name:"Vai"},ven:{name:"Venda"},vie:{name:"Vietnamesisch",flag:"vn"},vol:{name:"Volapük"},vot:{name:"Wotisch"},wak:{name:"Wakashan Sprachen"},wal:{name:"Walamo"},war:{name:"Waray"},was:{name:"Washo"},wel:{name:"Walisisch"},cym:{name:"Walisisch"},wen:{name:"Sorbische Sprachen"},wln:{name:"Wallonisch"},wol:{name:"Wolof"},xal:{name:"Kalmücken; Oirat"},xho:{name:"Xhosa"},yao:{name:"Yao"},yap:{name:"Yap"},yid:{name:"Jiddisch"},yor:{name:"Yoruba"},ypk:{name:"Yupik Sprachen"},zap:{name:"Zapoteken"},zbl:{name:"Bliss-Symbole; Blissymbolics; Bliss"},zen:{name:"Zenaga"},zha:{name:"Zhuang; Chuang"},znd:{name:"Zande Sprachen"},zul:{name:"Zulu"},zun:{name:"Zuni"},zxx:{name:"Kein sprachlicher Inhalt; Entfällt"},zza:{name:"Zaza; Dimili; Dimli; Kirdki; Kirmanjki; Zazaki"}};return e}),define("wai-lang/../../../shared/languages/./iso639-1-en",[],function(){var e={aa:{name:"Afar"},ab:{name:"Abkhazian"},af:{name:"Afrikaans"},ak:{name:"Akan"},sq:{name:"Albanian"},am:{name:"Amharic"},ar:{name:"Arabic",flag:"ae"},an:{name:"Aragonese"},hy:{name:"Armenian"},as:{name:"Assamese"},av:{name:"Avaric"},ae:{name:"Avestan"},ay:{name:"Aymara"},az:{name:"Azerbaijani"},ba:{name:"Bashkir"},bm:{name:"Bambara"},eu:{name:"Basque"},be:{name:"Belarusian",flag:"by"},bn:{name:"Bengali"},bh:{name:"Bihari languages"},bi:{name:"Bislama"},bs:{name:"Bosnian"},br:{name:"Breton"},bg:{name:"Bulgarian",flag:"bg"},my:{name:"Burmese"},ca:{name:"Catalan; Valencian",flag:"es"},ch:{name:"Chamorro"},ce:{name:"Chechen"},zh:{name:"Chinese"},cu:{name:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic"},cv:{name:"Chuvash"},kw:{name:"Cornish"},co:{name:"Corsican"},cr:{name:"Cree"},cs:{name:"Czech"},da:{name:"Danish",flag:"dk"},dv:{name:"Divehi; Dhivehi; Maldivian"},nl:{name:"Dutch; Flemish"},dz:{name:"Dzongkha"},en:{name:"English",flag:"gb"},eo:{name:"Esperanto"},et:{name:"Estonian",flag:"ee"},ee:{name:"Ewe"},fo:{name:"Faroese"},fj:{name:"Fijian"},fi:{name:"Finnish",flag:"fi"},fr:{name:"French"},fy:{name:"Western Frisian"},ff:{name:"Fulah"},ka:{name:"Georgian"},de:{name:"German",flag:"de"},gd:{name:"Gaelic; Scottish Gaelic"},ga:{name:"Irish",flag:"ie"},gl:{name:"Galician"},gv:{name:"Manx"},el:{name:"Greek, Modern (1453-)"},gn:{name:"Guarani"},gu:{name:"Gujarati"},ht:{name:"Haitian; Haitian Creole"},ha:{name:"Hausa"},he:{name:"Hebrew",flag:"il"},hz:{name:"Herero"},hi:{name:"Hindi",flag:"in"},ho:{name:"Hiri Motu"},hr:{name:"Croatian",flag:"hr"},hu:{name:"Hungarian",flag:"hu"},ig:{name:"Igbo"},is:{name:"Icelandic"},io:{name:"Ido"},ii:{name:"Sichuan Yi; Nuosu"},iu:{name:"Inuktitut"},ie:{name:"Interlingue; Occidental"},ia:{name:"Interlingua (International Auxiliary Language Association)"},id:{name:"Indonesian",flag:"id"},ik:{name:"Inupiaq"},it:{name:"Italian",flag:"it"},jv:{name:"Javanese"},ja:{name:"Japanese",flag:"jp"},kl:{name:"Kalaallisut; Greenlandic"},kn:{name:"Kannada"},ks:{name:"Kashmiri"},kr:{name:"Kanuri"},kk:{name:"Kazakh"},km:{name:"Central Khmer"},ki:{name:"Kikuyu; Gikuyu"},rw:{name:"Kinyarwanda"},ky:{name:"Kirghiz; Kyrgyz"},kv:{name:"Komi"},kg:{name:"Kongo"},ko:{name:"Korean",flag:"kr"},kj:{name:"Kuanyama; Kwanyama"},ku:{name:"Kurdish"},lo:{name:"Lao"},la:{name:"Latin"},lv:{name:"Latvian",flag:"lv"},li:{name:"Limburgan; Limburger; Limburgish"},ln:{name:"Lingala"},lt:{name:"Lithuanian",flag:"lt"},lb:{name:"Luxembourgish; Letzeburgesch"},lu:{name:"Luba-Katanga"},lg:{name:"Ganda"},mk:{name:"Macedonian"},mh:{name:"Marshallese"},ml:{name:"Malayalam"},mi:{name:"Maori"},mr:{name:"Marathi"},ms:{name:"Malay"},mg:{name:"Malagasy"},mt:{name:"Maltese",flag:"mt"},mn:{name:"Mongolian"},na:{name:"Nauru"},nv:{name:"Navajo; Navaho"},nr:{name:"Ndebele, South; South Ndebele"},nd:{name:"Ndebele, North; North Ndebele"},ng:{name:"Ndonga"},ne:{name:"Nepali"},nn:{name:"Norwegian Nynorsk; Nynorsk, Norwegian"},nb:{name:"Bokmål, Norwegian; Norwegian Bokmål"},no:{name:"Norwegian",flag:"no"},ny:{name:"Chichewa; Chewa; Nyanja"},oc:{name:"Occitan (post 1500); Provençal"},oj:{name:"Ojibwa"},or:{name:"Oriya"},om:{name:"Oromo"},os:{name:"Ossetian; Ossetic"},pa:{name:"Panjabi; Punjabi"},fa:{name:"Persian"},pi:{name:"Pali"},pl:{name:"Polish",flag:"pl"},pt:{name:"Portuguese",flag:"pt"},ps:{name:"Pushto; Pashto"},qu:{name:"Quechua"},rm:{name:"Romansh"},ro:{name:"Romanian; Moldavian; Moldovan"},rn:{name:"Rundi"},ru:{name:"Russian",flag:"ru"},sg:{name:"Sango"},sa:{name:"Sanskrit"},si:{name:"Sinhala; Sinhalese"},sk:{name:"Slovak"},sl:{name:"Slovenian",flag:"si"},se:{name:"Northern Sami"},sm:{name:"Samoan"},sn:{name:"Shona"},sd:{name:"Sindhi"},so:{name:"Somali"},st:{name:"Sotho, Southern"},es:{name:"Spanish; Castilian",flag:"es"},sc:{name:"Sardinian"},sr:{name:"Serbian",flag:"rs"},ss:{name:"Swati"},su:{name:"Sundanese"},sw:{name:"Swahili"},sv:{name:"Swedish",flag:"se"},ty:{name:"Tahitian"},ta:{name:"Tamil"},tt:{name:"Tatar"},te:{name:"Telugu"},tg:{name:"Tajik"},tl:{name:"Tagalog"},th:{name:"Thai",flag:"th"},bo:{name:"Tibetan"},ti:{name:"Tigrinya"},to:{name:"Tonga (Tonga Islands)"},tn:{name:"Tswana"},ts:{name:"Tsonga"},tk:{name:"Turkmen"},tr:{name:"Turkish",flag:"tr"},tw:{name:"Twi"},ug:{name:"Uighur; Uyghur"},uk:{name:"Ukrainian",flag:"ua"},ur:{name:"Urdu"},uz:{name:"Uzbek"},ve:{name:"Venda"},vi:{name:"Vietnamese",flag:"vn"},vo:{name:"Volapük"},cy:{name:"Welsh"},wa:{name:"Walloon"},wo:{name:"Wolof"},xh:{name:"Xhosa"},yi:{name:"Yiddish"},yo:{name:"Yoruba"},za:{name:"Zhuang; Chuang"},zu:{name:"Zulu"}};
return e}),define("wai-lang/../../../shared/languages/./iso639-2-en",[],function(){var e={aar:{name:"Afar"},abk:{name:"Abkhazian"},ace:{name:"Achinese"},ach:{name:"Acoli"},ada:{name:"Adangme"},ady:{name:"Adyghe; Adygei"},afa:{name:"Afro-Asiatic languages"},afh:{name:"Afrihili"},afr:{name:"Afrikaans"},ain:{name:"Ainu"},aka:{name:"Akan"},akk:{name:"Akkadian"},alb:{name:"Albanian"},sqi:{name:"Albanian",flag:"al"},ale:{name:"Aleut"},alg:{name:"Algonquian languages"},alt:{name:"Southern Altai"},amh:{name:"Amharic"},ang:{name:"English, Old (ca.450-1100)"},anp:{name:"Angika"},apa:{name:"Apache languages"},ara:{name:"Arabic",flag:"ae"},arc:{name:"Official Aramaic (700-300 BCE); Imperial Aramaic (700-300 BCE)"},arg:{name:"Aragonese"},arm:{name:"Armenian"},hye:{name:"Armenian"},arn:{name:"Mapudungun; Mapuche"},arp:{name:"Arapaho"},art:{name:"Artificial languages"},arw:{name:"Arawak"},asm:{name:"Assamese"},ast:{name:"Asturian; Bable; Leonese; Asturleonese"},ath:{name:"Athapascan languages"},aus:{name:"Australian languages"},ava:{name:"Avaric"},ave:{name:"Avestan"},awa:{name:"Awadhi"},aym:{name:"Aymara"},aze:{name:"Azerbaijani"},bad:{name:"Banda languages"},bai:{name:"Bamileke languages"},bak:{name:"Bashkir"},bal:{name:"Baluchi"},bam:{name:"Bambara"},ban:{name:"Balinese"},baq:{name:"Basque"},eus:{name:"Basque"},bas:{name:"Basa"},bat:{name:"Baltic languages"},bej:{name:"Beja; Bedawiyet"},bel:{name:"Belarusian",flag:"by"},bem:{name:"Bemba"},ben:{name:"Bengali"},ber:{name:"Berber languages"},bho:{name:"Bhojpuri"},bih:{name:"Bihari languages"},bik:{name:"Bikol"},bin:{name:"Bini; Edo"},bis:{name:"Bislama"},bla:{name:"Siksika"},bnt:{name:"Bantu (Other)"},bos:{name:"Bosnian"},bra:{name:"Braj"},bre:{name:"Breton"},btk:{name:"Batak languages"},bua:{name:"Buriat"},bug:{name:"Buginese"},bul:{name:"Bulgarian",flag:"bg"},bur:{name:"Burmese"},mya:{name:"Burmese"},byn:{name:"Blin; Bilin"},cad:{name:"Caddo"},cai:{name:"Central American Indian languages"},car:{name:"Galibi Carib"},cat:{name:"Catalan; Valencian",flag:"es"},cau:{name:"Caucasian languages"},ceb:{name:"Cebuano"},cel:{name:"Celtic languages"},cha:{name:"Chamorro"},chb:{name:"Chibcha"},che:{name:"Chechen"},chg:{name:"Chagatai"},chi:{name:"Chinese"},zho:{name:"Chinese",flag:"cn"},chk:{name:"Chuukese"},chm:{name:"Mari"},chn:{name:"Chinook jargon"},cho:{name:"Choctaw"},chp:{name:"Chipewyan; Dene Suline"},chr:{name:"Cherokee"},chu:{name:"Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic"},chv:{name:"Chuvash"},chy:{name:"Cheyenne"},cmc:{name:"Chamic languages"},cop:{name:"Coptic"},cor:{name:"Cornish"},cos:{name:"Corsican"},cpe:{name:"Creoles and pidgins, English based"},cpf:{name:"Creoles and pidgins, French-based "},cpp:{name:"Creoles and pidgins, Portuguese-based "},cre:{name:"Cree"},crh:{name:"Crimean Tatar; Crimean Turkish"},crp:{name:"Creoles and pidgins "},csb:{name:"Kashubian"},cus:{name:"Cushitic languages"},cze:{name:"Czech"},ces:{name:"Czech",flag:"cz"},dak:{name:"Dakota"},dan:{name:"Danish",flag:"dk"},dar:{name:"Dargwa"},day:{name:"Land Dayak languages"},del:{name:"Delaware"},den:{name:"Slave (Athapascan)"},dgr:{name:"Dogrib"},din:{name:"Dinka"},div:{name:"Divehi; Dhivehi; Maldivian"},doi:{name:"Dogri"},dra:{name:"Dravidian languages"},dsb:{name:"Lower Sorbian"},dua:{name:"Duala"},dum:{name:"Dutch, Middle (ca.1050-1350)"},dut:{name:"Dutch; Flemish"},nld:{name:"Dutch; Flemish",flag:"nl"},dyu:{name:"Dyula"},dzo:{name:"Dzongkha"},efi:{name:"Efik"},egy:{name:"Egyptian (Ancient)"},eka:{name:"Ekajuk"},elx:{name:"Elamite"},eng:{name:"English",flag:"gb"},enm:{name:"English, Middle (1100-1500)"},epo:{name:"Esperanto"},est:{name:"Estonian",flag:"ee"},ewe:{name:"Ewe"},ewo:{name:"Ewondo"},fan:{name:"Fang"},fao:{name:"Faroese"},fat:{name:"Fanti"},fij:{name:"Fijian"},fil:{name:"Filipino; Pilipino"},fin:{name:"Finnish",flag:"fi"},fiu:{name:"Finno-Ugrian languages"},fon:{name:"Fon"},fre:{name:"French"},fra:{name:"French",flag:"fr"},frm:{name:"French, Middle (ca.1400-1600)"},fro:{name:"French, Old (842-ca.1400)"},frr:{name:"Northern Frisian"},frs:{name:"Eastern Frisian"},fry:{name:"Western Frisian"},ful:{name:"Fulah"},fur:{name:"Friulian"},gaa:{name:"Ga"},gay:{name:"Gayo"},gba:{name:"Gbaya"},gem:{name:"Germanic languages"},geo:{name:"Georgian"},kat:{name:"Georgian"},ger:{name:"German",flag:"de"},deu:{name:"German",flag:"de"},gez:{name:"Geez"},gil:{name:"Gilbertese"},gla:{name:"Gaelic; Scottish Gaelic"},gle:{name:"Irish",flag:"ie"},glg:{name:"Galician"},glv:{name:"Manx"},gmh:{name:"German, Middle High (ca.1050-1500)"},goh:{name:"German, Old High (ca.750-1050)"},gon:{name:"Gondi"},gor:{name:"Gorontalo"},got:{name:"Gothic"},grb:{name:"Grebo"},grc:{name:"Greek, Ancient (to 1453)"},gre:{name:"Greek, Modern (1453-)"},ell:{name:"Greek, Modern (1453-)",flag:"gr"},grn:{name:"Guarani"},gsw:{name:"Swiss German; Alemannic; Alsatian"},guj:{name:"Gujarati"},gwi:{name:"Gwich'in"},hai:{name:"Haida"},hat:{name:"Haitian; Haitian Creole"},hau:{name:"Hausa"},haw:{name:"Hawaiian"},heb:{name:"Hebrew",flag:"il"},her:{name:"Herero"},hil:{name:"Hiligaynon"},him:{name:"Himachali languages; Western Pahari languages"},hin:{name:"Hindi",flag:"in"},hit:{name:"Hittite"},hmn:{name:"Hmong; Mong"},hmo:{name:"Hiri Motu"},hrv:{name:"Croatian",flag:"hr"},hsb:{name:"Upper Sorbian"},hun:{name:"Hungarian",flag:"hu"},hup:{name:"Hupa"},iba:{name:"Iban"},ibo:{name:"Igbo"},ice:{name:"Icelandic"},isl:{name:"Icelandic",flag:"is"},ido:{name:"Ido"},iii:{name:"Sichuan Yi; Nuosu"},ijo:{name:"Ijo languages"},iku:{name:"Inuktitut"},ile:{name:"Interlingue; Occidental"},ilo:{name:"Iloko"},ina:{name:"Interlingua (International Auxiliary Language Association)"},inc:{name:"Indic languages"},ind:{name:"Indonesian",flag:"id"},ine:{name:"Indo-European languages"},inh:{name:"Ingush"},ipk:{name:"Inupiaq"},ira:{name:"Iranian languages"},iro:{name:"Iroquoian languages"},ita:{name:"Italian",flag:"it"},jav:{name:"Javanese"},jbo:{name:"Lojban"},jpn:{name:"Japanese",flag:"jp"},jpr:{name:"Judeo-Persian"},jrb:{name:"Judeo-Arabic"},kaa:{name:"Kara-Kalpak"},kab:{name:"Kabyle"},kac:{name:"Kachin; Jingpho"},kal:{name:"Kalaallisut; Greenlandic"},kam:{name:"Kamba"},kan:{name:"Kannada"},kar:{name:"Karen languages"},kas:{name:"Kashmiri"},kau:{name:"Kanuri"},kaw:{name:"Kawi"},kaz:{name:"Kazakh"},kbd:{name:"Kabardian"},kha:{name:"Khasi"},khi:{name:"Khoisan languages"},khm:{name:"Central Khmer"},kho:{name:"Khotanese; Sakan"},kik:{name:"Kikuyu; Gikuyu"},kin:{name:"Kinyarwanda"},kir:{name:"Kirghiz; Kyrgyz"},kmb:{name:"Kimbundu"},kok:{name:"Konkani"},kom:{name:"Komi"},kon:{name:"Kongo"},kor:{name:"Korean",flag:"kr"},kos:{name:"Kosraean"},kpe:{name:"Kpelle"},krc:{name:"Karachay-Balkar"},krl:{name:"Karelian"},kro:{name:"Kru languages"},kru:{name:"Kurukh"},kua:{name:"Kuanyama; Kwanyama"},kum:{name:"Kumyk"},kur:{name:"Kurdish"},kut:{name:"Kutenai"},lad:{name:"Ladino"},lah:{name:"Lahnda"},lam:{name:"Lamba"},lao:{name:"Lao"},lat:{name:"Latin"},lav:{name:"Latvian",flag:"lv"},lez:{name:"Lezghian"},lim:{name:"Limburgan; Limburger; Limburgish"},lin:{name:"Lingala"},lit:{name:"Lithuanian",flag:"lt"},lol:{name:"Mongo"},loz:{name:"Lozi"},ltz:{name:"Luxembourgish; Letzeburgesch"},lua:{name:"Luba-Lulua"},lub:{name:"Luba-Katanga"},lug:{name:"Ganda"},lui:{name:"Luiseno"},lun:{name:"Lunda"},luo:{name:"Luo (Kenya and Tanzania)"},lus:{name:"Lushai"},mac:{name:"Macedonian"},mkd:{name:"Macedonian",flag:"mk"},mad:{name:"Madurese"},mag:{name:"Magahi"},mah:{name:"Marshallese"},mai:{name:"Maithili"},mak:{name:"Makasar"},mal:{name:"Malayalam"},man:{name:"Mandingo"},mao:{name:"Maori"},mri:{name:"Maori"},map:{name:"Austronesian languages"},mar:{name:"Marathi"},mas:{name:"Masai"},may:{name:"Malay"},msa:{name:"Malay",flag:"my"},mdf:{name:"Moksha"},mdr:{name:"Mandar"},men:{name:"Mende"},mga:{name:"Irish, Middle (900-1200)"},mic:{name:"Mi'kmaq; Micmac"},min:{name:"Minangkabau"},mis:{name:"Uncoded languages"},mkh:{name:"Mon-Khmer languages"},mlg:{name:"Malagasy"},mlt:{name:"Maltese",flag:"mt"},mnc:{name:"Manchu"},mni:{name:"Manipuri"},mno:{name:"Manobo languages"},moh:{name:"Mohawk"},mon:{name:"Mongolian"},mos:{name:"Mossi"},mul:{name:"Multiple languages"},mun:{name:"Munda languages"},mus:{name:"Creek"},mwl:{name:"Mirandese"},mwr:{name:"Marwari"},myn:{name:"Mayan languages"},myv:{name:"Erzya"},nah:{name:"Nahuatl languages"},nai:{name:"North American Indian languages"},nap:{name:"Neapolitan"},nau:{name:"Nauru"},nav:{name:"Navajo; Navaho"},nbl:{name:"Ndebele, South; South Ndebele"},nde:{name:"Ndebele, North; North Ndebele"},ndo:{name:"Ndonga"},nds:{name:"Low German; Low Saxon; German, Low; Saxon, Low"},nep:{name:"Nepali"},"new":{name:"Nepal Bhasa; Newari"},nia:{name:"Nias"},nic:{name:"Niger-Kordofanian languages"},niu:{name:"Niuean"},nno:{name:"Norwegian Nynorsk; Nynorsk, Norwegian"},nob:{name:"Bokmål, Norwegian; Norwegian Bokmål"},nog:{name:"Nogai"},non:{name:"Norse, Old"},nor:{name:"Norwegian",flag:"no"},nqo:{name:"N'Ko"},nso:{name:"Pedi; Sepedi; Northern Sotho"},nub:{name:"Nubian languages"},nwc:{name:"Classical Newari; Old Newari; Classical Nepal Bhasa"},nya:{name:"Chichewa; Chewa; Nyanja"},nym:{name:"Nyamwezi"},nyn:{name:"Nyankole"},nyo:{name:"Nyoro"},nzi:{name:"Nzima"},oci:{name:"Occitan (post 1500); Provençal"},oji:{name:"Ojibwa"},ori:{name:"Oriya"},orm:{name:"Oromo"},osa:{name:"Osage"},oss:{name:"Ossetian; Ossetic"},ota:{name:"Turkish, Ottoman (1500-1928)"},oto:{name:"Otomian languages"},paa:{name:"Papuan languages"},pag:{name:"Pangasinan"},pal:{name:"Pahlavi"},pam:{name:"Pampanga; Kapampangan"},pan:{name:"Panjabi; Punjabi"},pap:{name:"Papiamento"},pau:{name:"Palauan"},peo:{name:"Persian, Old (ca.600-400 B.C.)"},per:{name:"Persian"},fas:{name:"Persian"},phi:{name:"Philippine languages"},phn:{name:"Phoenician"},pli:{name:"Pali"},pol:{name:"Polish",flag:"pl"},pon:{name:"Pohnpeian"},por:{name:"Portuguese",flag:"pt"},pra:{name:"Prakrit languages"},pro:{name:"Provençal, Old (to 1500)"},pus:{name:"Pushto; Pashto"},"qaa-qtz":{name:"Reserved for local use"},que:{name:"Quechua"},raj:{name:"Rajasthani"},rap:{name:"Rapanui"},rar:{name:"Rarotongan; Cook Islands Maori"},roa:{name:"Romance languages"},roh:{name:"Romansh"},rom:{name:"Romany"},rum:{name:"Romanian; Moldavian; Moldovan"},ron:{name:"Romanian; Moldavian; Moldovan",flag:"ro"},run:{name:"Rundi"},rup:{name:"Aromanian; Arumanian; Macedo-Romanian"},rus:{name:"Russian",flag:"ru"},sad:{name:"Sandawe"},sag:{name:"Sango"},sah:{name:"Yakut"},sai:{name:"South American Indian (Other)"},sal:{name:"Salishan languages"},sam:{name:"Samaritan Aramaic"},san:{name:"Sanskrit"},sas:{name:"Sasak"},sat:{name:"Santali"},scn:{name:"Sicilian"},sco:{name:"Scots"},sel:{name:"Selkup"},sem:{name:"Semitic languages"},sga:{name:"Irish, Old (to 900)"},sgn:{name:"Sign Languages"},shn:{name:"Shan"},sid:{name:"Sidamo"},sin:{name:"Sinhala; Sinhalese"},sio:{name:"Siouan languages"},sit:{name:"Sino-Tibetan languages"},sla:{name:"Slavic languages"},slo:{name:"Slovak"},slk:{name:"Slovak",flag:"sk"},slv:{name:"Slovenian",flag:"si"},sma:{name:"Southern Sami"},sme:{name:"Northern Sami"},smi:{name:"Sami languages"},smj:{name:"Lule Sami"},smn:{name:"Inari Sami"},smo:{name:"Samoan"},sms:{name:"Skolt Sami"},sna:{name:"Shona"},snd:{name:"Sindhi"},snk:{name:"Soninke"},sog:{name:"Sogdian"},som:{name:"Somali"},son:{name:"Songhai languages"},sot:{name:"Sotho, Southern"},spa:{name:"Spanish; Castilian",flag:"es"},srd:{name:"Sardinian"},srn:{name:"Sranan Tongo"},srp:{name:"Serbian",flag:"rs"},srr:{name:"Serer"},ssa:{name:"Nilo-Saharan languages"},ssw:{name:"Swati"},suk:{name:"Sukuma"},sun:{name:"Sundanese"},sus:{name:"Susu"},sux:{name:"Sumerian"},swa:{name:"Swahili"},swe:{name:"Swedish",flag:"se"},syc:{name:"Classical Syriac"},syr:{name:"Syriac"},tah:{name:"Tahitian"},tai:{name:"Tai languages"},tam:{name:"Tamil"},tat:{name:"Tatar"},tel:{name:"Telugu"},tem:{name:"Timne"},ter:{name:"Tereno"},tet:{name:"Tetum"},tgk:{name:"Tajik"},tgl:{name:"Tagalog"},tha:{name:"Thai",flag:"th"},tib:{name:"Tibetan"},bod:{name:"Tibetan"},tig:{name:"Tigre"},tir:{name:"Tigrinya"},tiv:{name:"Tiv"},tkl:{name:"Tokelau"},tlh:{name:"Klingon; tlhIngan-Hol"},tli:{name:"Tlingit"},tmh:{name:"Tamashek"},tog:{name:"Tonga (Nyasa)"},ton:{name:"Tonga (Tonga Islands)"},tpi:{name:"Tok Pisin"},tsi:{name:"Tsimshian"},tsn:{name:"Tswana"},tso:{name:"Tsonga"},tuk:{name:"Turkmen"},tum:{name:"Tumbuka"},tup:{name:"Tupi languages"},tur:{name:"Turkish",flag:"tr"},tut:{name:"Altaic languages"},tvl:{name:"Tuvalu"},twi:{name:"Twi"},tyv:{name:"Tuvinian"},udm:{name:"Udmurt"},uga:{name:"Ugaritic"},uig:{name:"Uighur; Uyghur"},ukr:{name:"Ukrainian",flag:"ua"},umb:{name:"Umbundu"},und:{name:"Undetermined"},urd:{name:"Urdu"},uzb:{name:"Uzbek"},vai:{name:"Vai"},ven:{name:"Venda"},vie:{name:"Vietnamese",flag:"vn"},vol:{name:"Volapük"},vot:{name:"Votic"},wak:{name:"Wakashan languages"},wal:{name:"Walamo"},war:{name:"Waray"},was:{name:"Washo"},wel:{name:"Welsh"},cym:{name:"Welsh"},wen:{name:"Sorbian languages"},wln:{name:"Walloon"},wol:{name:"Wolof"},xal:{name:"Kalmyk; Oirat"},xho:{name:"Xhosa"},yao:{name:"Yao"},yap:{name:"Yapese"},yid:{name:"Yiddish"},yor:{name:"Yoruba"},ypk:{name:"Yupik languages"},zap:{name:"Zapotec"},zbl:{name:"Blissymbols; Blissymbolics; Bliss"},zen:{name:"Zenaga"},zha:{name:"Zhuang; Chuang"},znd:{name:"Zande languages"},zul:{name:"Zulu"},zun:{name:"Zuni"},zxx:{name:"No linguistic content; Not applicable"},zza:{name:"Zaza; Dimili; Dimli; Kirdki; Kirmanjki; Zazaki"}};return e}),define("wai-lang/../../../shared/languages/languages",["aloha","jquery","./iso639-1-de","./iso639-2-de","./iso639-1-en","./iso639-2-en"],function(e,t,n,i,a,r){var o={"iso639-1-de":n,"iso639-2-de":i,"iso639-1-en":a,"iso639-2-en":r},s=e.getAlohaUrl()+"/../plugins/shared/languages/";return e.AbstractRepository.extend({languageCodes:[],locale:"de",iso:"iso639-1",objectType:"language",flags:!1,_constructor:function(e,t,n,i,a){this._super(e),"undefined"!=typeof t&&(this.flags=t),"undefined"!=typeof n&&(this.iso="iso639-1"===n?"iso639-1":"iso639-2"),"undefined"!=typeof i&&(this.locale=i),"undefined"!=typeof a&&(this.objectType=a);var r=o[this.iso+"-"+this.locale];this.storeLanguageCodes(r),this.languageData=r},init:function(){},markObject:function(){},errorHandler:function(e){console.log("error",this,"Error while loading languages. "+e)},storeLanguageCodes:function(n){var i=this,a=s+"img/";t.each(n,function(t,n){var r=n;r.id=t,r.repositoryId=i.repositoryId,r.type=i.objectType,i.flags&&(r.url=r.flag?a+r.flag+".png":a+"default.png"),i.languageCodes.push(new e.RepositoryDocument(r))})},_searchInLanguageCodes:function(e,n){var i,a,r,o,s=new RegExp("^"+e.queryString,"i"),l=[];for(i=0;i<this.languageCodes.length;++i)o=this.languageCodes[i],a=!e.queryString||o.name.match(s),r=!e.objectTypeFilter||!e.objectTypeFilter.length||t.inArray(o.type,e.objectTypeFilter)>-1,a&&r&&l.push(o);n.call(this,l)},query:function(e,t){this._searchInLanguageCodes(e,t)},getObjectById:function(e,t){var n,i;for(n=0;n<this.languageCodes.length;++n)if(i=this.languageCodes[n],i.id===e){t.call(this,[i]);break}}})}),define("wai-lang/wai-lang-plugin",["aloha","jquery","PubSub","aloha/plugin","aloha/selection","util/dom","ui/ui","ui/scopes","ui/button","ui/toggleButton","ui/port-helper-attribute-field","i18n!wai-lang/nls/i18n","../../../shared/languages/languages"],function(e,t,n,i,a,r,o,s,l,d,c,u,h){function p(e){e&&(e.foreground(),e.focus()),N.show(),T.show()}function f(e){return!0===e||1===e||"true"===e||"1"===e}function g(){var e=t(this);return e.hasClass(j)||e.is("[lang]")}function m(t){return e.activeEditable?t.findMarkup(g,e.activeEditable.obj):null}function b(e){e.isCollapsed()&&r.extendToWord(e),r.addMarkup(e,t('<span class="'+j+'"></span>'),!1),e.select()}function v(e){var t=m(e);t&&(r.removeFromDOM(t,e,!0),e.select())}function y(){var e=a.getRangeObject();m(e)||b(e),p(N)}function _(){if(e.activeEditable){var t=a.getRangeObject();m(t)?v(t):(b(t),p(N))}}function w(e){var n=t(e);n.addClass(j).attr("data-gentics-aloha-repository","wai-languages").attr("data-gentics-aloha-object-id",n.attr("lang"))}function C(e){N=c({name:"wailangfield",width:320,valueField:"id",minChars:1,scope:"Aloha.continuoustext"}),e._wailangButton=o.adopt("wailang",d,{tooltip:u.t("button.add-wai-lang.tooltip"),icon:"aloha-icon aloha-icon-wai-lang",scope:"Aloha.continuoustext",click:_}),T=o.adopt("removewailang",l,{tooltip:u.t("button.add-wai-lang-remove.tooltip"),icon:"aloha-icon aloha-icon-wai-lang-remove",scope:"Aloha.continuoustext",click:function(){v(a.getRangeObject())}}),N.setTemplate(e.flags?'<div class="aloha-wai-lang-img-item"><img class="aloha-wai-lang-img" src="{url}" /><div class="aloha-wai-lang-label-item">{name} ({id})</div></div>':'<div class="aloha-wai-lang-img-item"><div class="aloha-wai-lang-label-item">{name} ({id})</div></div>'),N.setObjectTypeFilter(e.objectTypeFilter)}function k(e){return e._instanceId}function x(e,t){var n=e.getId()+":"+k(t);return A[n]||(A[n]=t.getEditableConfig(e.obj)),A[n]}function S(i){n.sub("aloha.editable.activated",function(e){var n=x(e.data.editable,i);t.inArray("span",n)>-1?i._wailangButton.show():i._wailangButton.hide()}),e.bind("aloha-selection-changed",function(e,t){var n=m(t);n?(i._wailangButton.setState(!0),N.setTargetObject(n,"lang"),N.show(),T.show(),s.enterScope(i.name,"wai-lang")):(i._wailangButton.setState(!1),N.setTargetObject(null),N.hide(),T.hide(),s.leaveScope(i.name,"wai-lang",!0))}),N.addListener("blur",function(){this.getValue()||v(a.getRangeObject())}),e.bind("aloha-editable-created",function(e,t){t.obj.bind("keydown",i.hotKey.insertAnnotation,function(){return y(),!1}),t.obj.find("span[lang]").each(function(){w(this)})})}var j="aloha-wai-lang",N=null,T=null,E=function(e){var t=0;return function(){return e+"-"+ ++t}}(),A={};return i.create("wai-lang",{config:["span"],iso639:"iso639-1",flags:!1,objectTypeFilter:["language/wai"],hotKey:{insertAnnotation:u.t("insertAnnotation","ctrl+shift+l")},init:function(){this._instanceId=E("wai-lang"),this.settings.objectTypeFilter&&(this.objectTypeFilter=this.settings.objectTypeFilter),this.settings.hotKey&&t.extend(!0,this.hotKey,this.settings.hotKey),this.settings.iso639&&(this.iso639=this.settings.iso639),this.flags=f(this.settings.flags),C(this),S(this);new h("wai-languages",this.flags,"iso639-1"==this.iso639?"iso639-1":"iso639-2",e.settings.locale,"language/wai")},formatLanguageSpan:_,makeClean:function(e){e.find("span[lang]").each(function(){var e=t(this);e.removeClass(j).removeAttr("data-gentics-aloha-repository").removeAttr("data-gentics-aloha-object-id").attr("xml:lang",e.attr("lang"))})}})}),define("headerids/nls/i18n",{root:{"headerids.label.target":"Target","headerids.button.reset":"Reset","headerids.button.set":"Set",internal_hyperlink:"Internal Hyperlink"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("headerids/headerids-plugin",["aloha","jquery","PubSub","aloha/plugin","util/html","i18n!headerids/nls/i18n"],function(e,t,n,i,a,r){function o(){var e=[],n=u;return c.each(arguments,function(){e.push("."+(""==this?n:n+"-"+this))}),t.trim(e.join(" "))}function s(){var e=[],n=u;return c.each(arguments,function(){e.push(""==this?n:n+"-"+this)}),t.trim(e.join(" "))}function l(e){return e.find("h1,h2,h3,h4,h5,h6").not(".aloha-customized,.aloha-editable,.aloha-block")}function d(e){for(var t=e,n=1;c("#"+e).length>0;)e=t+"_"+(++n).toString();return e}var c=t,u="aloha-headerids";return i.create("headerids",{_constructor:function(){this._super("headerids")},config:["true"],init:function(){var t=this,i=function(e){var n=e.data.obj||e.data.editable.obj;t.check(n)};n.sub("aloha.editable.created",i),n.sub("aloha.editable.activated",i),n.sub("aloha.editable.deactivated",i),e.bind("aloha-plugins-loaded",function(){t.initSidebar(e.Sidebar.right)})},check:function(e){var t=this;c.inArray("true",t.getEditableConfig(e))>-1&&l(e).each(function(e,n){t.processH(n)})},processH:function(e){var t=e.id;if(!t){var n=c(e);t="heading_"+this.sanitize(n.text()),t=d(t),n.attr("id",t)}return t},sanitize:function(t){var n=e.settings.sanitizeCharacters||{},i=t;for(var r in n)n.hasOwnProperty(r)&&(i=i.replace(r,n[r]));return a.trimWhitespaceCharacters(i).replace(/[^a-z0-9]/gi,"_")},initSidebar:function(e){var n=this;n.sidebar=e,e.addPanel({id:s("sidebar-panel"),title:r.t("internal_hyperlink"),content:"",expanded:!0,activeOn:"h1, h2, h3, h4, h5, h6",onInit:function(){var e=this,i=this.setContent('<label class="'+s("label")+'" for="'+s("input")+'">'+r.t("headerids.label.target")+'</label><input id="'+s("input")+'" class="'+s("input")+'" type="text" name="value"/> <button class="'+s("reset-button")+'">'+r.t("headerids.button.reset")+'</button><button class="'+s("set-button")+'">'+r.t("headerids.button.set")+"</button>").content;i.find(o("set-button")).click(function(){var i=(e.content,t(o("input"))),a=n.sanitize(i.val());i.val(a),t(e.effective).attr("id",a).addClass("aloha-customized")}),i.find(o("reset-button")).click(function(){e.content;n.processH(e.effective),t(e.effective).removeClass("aloha-customized"),e.content.find(o("input")).val(e.effective.attr("id"))})},onActivate:function(e){this.effective=e,this.content.find(o("input")).val(n.processH(e[0]))}}),e.show()},makeClean:function(e){this.check(e)}})}),define("metaview/nls/i18n",{root:{"button.switch-metaview.tooltip":"Switch between meta and normal view"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("metaview/metaview-plugin",["jquery","aloha/core","aloha/plugin","ui/ui","ui/toggleButton","i18n!metaview/nls/i18n","i18n!aloha/nls/i18n"],function(e,t,n,i,a,r){function o(e){return p[e[0].id]}function s(e,t){e.addClass("aloha-metaview"),t.setState(!0),p[e[0].id]=!0}function l(e,t){e.removeClass("aloha-metaview"),t.setState(!1),p[e[0].id]=!1}function d(e,t){o(e)?l(e,t):s(e,t)}function c(e,t){return e.getEditableConfig(t)}function u(t){return"array"===e.type(t)&&-1!==e.inArray("enabled",t)}function h(t){return"array"===e.type(t)&&-1!==e.inArray("metaview",t)}var p={},f=i.adopt("toggleMetaView",a,{tooltip:r.t("button.switch-metaview.tooltip"),icon:"aloha-icon aloha-icon-metaview",scope:"Aloha.continuoustext",click:function(){d(t.activeEditable.obj,this)}});return n.create("metaview",{config:["metaview"],init:function(){var e=this;t.bind("aloha-editable-activated",function(){var n=c(e,t.activeEditable.obj);u(n)?(f.show(!0),s(t.activeEditable.obj,f)):h(n)?(f.show(!0),o(t.activeEditable.obj)?s(t.activeEditable.obj,f):l(t.activeEditable.obj,f)):f.show(!1)}),t.bind("aloha-editable-deactivated",function(){t.activeEditable.obj.removeClass("aloha-metaview")})}})}),define("listenforcer/listenforcer-plugin",["aloha","jquery","aloha/plugin","aloha/console"],function(e,t,n,i){function a(e,n){if(-1!==t.inArray(e[0],r)){e.find(".aloha-end-br").remove();var i=!1;e.find("li").each(function(){return""!==t.trim(t(this).text())?(i=!0,!1):void 0}),i||e.html(n);var a,o=e.find(">ul,>ol"),s=o.length;if(s>1){var l=t(o[0]);for(a=1;s>a;++a)l.append(t(o[a]).find(">li")),t(o[a]).remove()}e.find(">*:not(ul,ol)").remove()}}var r=[];return n.create("listenforcer",{_constructor:function(){this._super("listenforcer")},init:function(){var n,r,o=this,s=this.settings.editables||[],l=s.length;for(r=0;l>r;r++)n=s[r],"string"==typeof n||n.nodeName||n instanceof t?t(n).each(function(){o.addEditableToEnforcementList(this)}):i.warn("Aloha List Enforcer Plugin",'Object "'+n.toString()+'" can not be used as a jQuery selector with which to register an editable to be list enforced.');e.bind("aloha-editable-activated",function(e,t){a(t.editable.obj,"<ul><li><br /></li></ul>")}),e.bind("aloha-editable-deactivated",function(e,t){a(t.editable.obj,"")}),e.bind("aloha-smart-content-changed",function(t,n){e.activeEditable&&e.activeEditable.isActive===!0&&a(n.editable.obj,"<ul><li><br /></li></ul>")})},addEditableToEnforcementList:function(e){e&&r.push(e)}})}),Aloha._load&&Aloha._load()}();
